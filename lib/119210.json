{
  "comments": [
    "I met NullPointerException when weaving. Doesn\u0027t Aj support this situations?\n\npublic class TestLib {\n\n\t  private static int myInt;\n\t  static {\n\t\t  myInt \u003d 1;\n\t  }\n\t  public static void main(String[] args) {\n\t\t// TODO Auto-generated method stub\n\t\tSystem.out.println(\"myInt\u003d\"+myInt);\n\t  }\n}\n\npublic aspect ThreadAspectLib {\n\tpointcut setThreadLocalsField():set(private int TestLib.myInt);\n\t\n\tInteger around():setThreadLocalsField()\n\t{\n\t\ttry{\n\t\t\treturn new Integer(2);\n\t\t}\n\t\tcatch(Exception e)\n\t\t{\n\t\t\te.printStackTrace();\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\n---- AspectJ Properties ---\nAspectJ Compiler DEVELOPMENT built on Tuesday Jun 14, 2005 at 15:41:05 GMT\n---- Dump Properties ---\nDump file: ajcore.20051205.145247.250.txt\nDump reason: java.lang.NullPointerException\nDump on exception: true\nDump at exit condition: abort\n---- Exception Information ---\njava.lang.NullPointerException\n\tat org.aspectj.weaver.ResolvedTypeX$Primitive.isAssignableFrom(ResolvedTypeX.java:985)\n\tat org.aspectj.weaver.ResolvedTypeX.isAssignableFrom(ResolvedTypeX.java:96)\n\tat org.aspectj.weaver.Advice.match(Advice.java:143)\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1673)\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.matchSetInstruction(BcelClassWeaver.java:1543)\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java(Compiled Code))\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java(Compiled Code))\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:377)\n\tat org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:94)\n\tat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1362)\n\tat org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:1327)\n\tat org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:1106)\n\tat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:993)\n\tat org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:286)\n\tat org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:165)\n\tat org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)\n\tat org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:368)\n\tat org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:727)\n\tat org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:206)\n\tat org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBuildManager.java:140)\n\tat org.aspectj.ajdt.ajc.AjdtCommand.doCommand(AjdtCommand.java:112)\n\tat org.aspectj.ajdt.ajc.AjdtCommand.runCommand(AjdtCommand.java:60)\n\tat org.aspectj.tools.ajc.Main.run(Main.java:318)\n\tat org.aspectj.tools.ajc.Main.runMain(Main.java:228)\n\tat org.aspectj.tools.ant.taskdefs.AjcTask.executeInSameVM(AjcTask.java:1194)\n\tat org.aspectj.tools.ant.taskdefs.AjcTask.execute(AjcTask.java:985)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n\tat org.apache.tools.ant.Task.perform(Task.java:364)\n\tat org.apache.tools.ant.Target.execute(Target.java:341)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:369)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:690)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:200)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n---- System Properties ---\njava.assistive\u003dON\njava.runtime.name\u003dJava(TM) 2 Runtime Environment, Standard Edition\nsun.boot.library.path\u003dC:\\Program Files\\IBM\\Java141\\jre\\bin\njava.vm.version\u003d1.4.1\njava.vm.vendor\u003dIBM Corporation\njava.vendor.url\u003dhttp://www.ibm.com/\npath.separator\u003d;\njava.vm.name\u003dClassic VM\nfile.encoding.pkg\u003dsun.io",
    "You are running on quite an old version of AspectJ.  If you compile this program on a more recent build, you won\u0027t get an NPE.  However, I\u0027m still investigating what does happen - thinking about what the right result is.  \nAre you compiling with the -1.5 flag?  \nAre you expecting autoboxing to allow transformation of int to Integer and vice versa?",
    "through the magic of autoboxing, this probably ought to work ...",
    "Hang on ... from the docs:\n\nhttp://eclipse.org/aspectj/doc/released/progguide/semantics-joinPoints.html\n\nField set\n    When a field is assigned to. Field set join points are considered to have one argument, the value the field is being set to. No value is returned from a field set join point, so its return type is considered to be void.\n\nso the advice doesn\u0027t match, correctly, with the right message:\n\n\"incompatible return type applying to field-set(int TestLib.myInt)\"\n\n\nHowever, I checked the related case, where around advice using the boxed form of a primitive matches on a join point returning the unboxed form, and that blew up!\n\nSo, I\u0027ve fixed this case and its reverse (the advice uses the unboxed form and join point returns the boxed form).\n\nfix checked in.",
    "fix available in aj - will be in AJDT in a few days."
  ],
  "commentCreationDates": [
    "2005-12-05T07:49:12+01:00",
    "2005-12-05T09:13:06+01:00",
    "2005-12-07T12:06:43+01:00",
    "2005-12-08T15:41:46+01:00",
    "2005-12-08T17:30:49+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.aspectj.weaver.ResolvedTypeX$Primitive.isAssignableFrom",
          "source": "ResolvedTypeX.java:985"
        },
        {
          "method": "org.aspectj.weaver.ResolvedTypeX.isAssignableFrom",
          "source": "ResolvedTypeX.java:96"
        },
        {
          "method": "org.aspectj.weaver.Advice.match",
          "source": "Advice.java:143"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java:1673"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.matchSetInstruction",
          "source": "BcelClassWeaver.java:1543"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java(Compiled Code)"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java(Compiled Code)"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:377"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:94"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:1362"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump",
          "source": "BcelWeaver.java:1327"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify",
          "source": "BcelWeaver.java:1106"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:993"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompilerAdapter.java:286"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "AjCompilerAdapter.java:165"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0",
          "source": "CompilerAdapter.aj:70"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:368"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:727"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:206"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild",
          "source": "AjBuildManager.java:140"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.doCommand",
          "source": "AjdtCommand.java:112"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.runCommand",
          "source": "AjdtCommand.java:60"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.run",
          "source": "Main.java:318"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.runMain",
          "source": "Main.java:228"
        },
        {
          "method": "org.aspectj.tools.ant.taskdefs.AjcTask.executeInSameVM",
          "source": "AjcTask.java:1194"
        },
        {
          "method": "org.aspectj.tools.ant.taskdefs.AjcTask.execute",
          "source": "AjcTask.java:985"
        },
        {
          "method": "org.apache.tools.ant.UnknownElement.execute",
          "source": "UnknownElement.java:275"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:364"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:341"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:369"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTarget",
          "source": "Project.java:1214"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:1062"
        },
        {
          "method": "org.apache.tools.ant.Main.runBuild",
          "source": "Main.java:690"
        },
        {
          "method": "org.apache.tools.ant.Main.startAnt",
          "source": "Main.java:200"
        },
        {
          "method": "org.apache.tools.ant.launch.Launcher.run",
          "source": "Launcher.java:196"
        },
        {
          "method": "org.apache.tools.ant.launch.Launcher.main",
          "source": "Launcher.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "119210",
      "date": "2005-12-05T07:49:12+01:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "119210",
  "bugId": "119210",
  "date": "2005-12-05T07:49:12+01:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}