{
  "comments": [
    "Created an attachment (id\u003d84199)\nannotation jar\n\nThe following code will not resolve with the given annotation:\n\npublic class Test {\n\t\n\t@TestAnnotation\n\tprivate String foo;\n\n}\n\npublic @interface TestAnnotation {\n\t\n\tClass targetItem() default void.class;\n}\n\n\nNOTE:  The annotation must be in a referenced jar file (in binary form).  One is attached for convenience.\n\nMany exceptions occur as a result.  Below is one of them.\n\nException occurred during problem detection:\n----------------------------------- SOURCE BEGIN -------------------------------------\n\npublic class Test {\n\t\n\t@TestAnnotation\n\tprivate String foo;\n\n}\n\n----------------------------------- SOURCE END -------------------------------------\n\n\njava.lang.ClassCastException: org.eclipse.jdt.internal.compiler.lookup.BaseTypeBinding\n\tat org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.convertMemberValue(BinaryTypeBinding.java:54)\n\tat org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.createMethod(BinaryTypeBinding.java:511)\n\tat org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.createMethods(BinaryTypeBinding.java:560)\n\tat org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.cachePartsFrom(BinaryTypeBinding.java:329)\n\tat org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createBinaryTypeFrom(LookupEnvironment.java:731)\n\tat org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createBinaryTypeFrom(LookupEnvironment.java:710)\n\tat org.eclipse.jdt.internal.compiler.Compiler.accept(Compiler.java:276)\n\tat org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.askForType(LookupEnvironment.java:130)\n\tat org.eclipse.jdt.internal.compiler.lookup.PackageBinding.getTypeOrPackage(PackageBinding.java:178)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.getTypeOrPackage(Scope.java:2416)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.getType(Scope.java:2144)\n\tat org.eclipse.jdt.internal.compiler.ast.SingleTypeReference.getTypeBinding(SingleTypeReference.java:44)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType(TypeReference.java:134)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType(TypeReference.java:125)\n\tat org.eclipse.jdt.internal.compiler.ast.Annotation.resolveType(Annotation.java:231)\n\tat org.eclipse.jdt.internal.compiler.ast.ASTNode.resolveAnnotations(ASTNode.java:590)\n\tat org.eclipse.jdt.internal.compiler.lookup.FieldBinding.getAnnotationTagBits(FieldBinding.java:252)\n\tat org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.resolveTypeFor(SourceTypeBinding.java:1256)\n\tat org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.fields(SourceTypeBinding.java:608)\n\tat org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.faultInTypesForFieldsAndMethods(SourceTypeBinding.java:586)\n\tat org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.faultInTypes(CompilationUnitScope.java:431)\n\tat org.eclipse.jdt.internal.compiler.Compiler.resolve(Compiler.java:724)\n\tat org.eclipse.jdt.internal.core.CompilationUnitProblemFinder.process(CompilationUnitProblemFinder.java:187)\n\tat org.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:183)\n\tat org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:252)\n\tat org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:510)\n\tat org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:1001)\n\tat org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.makeConsistent(ReconcileWorkingCopyOperation.java:170)\n\tat org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:89)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:720)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:780)\n\tat org.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1151)\n\tat org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:124)\n\tat org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.access$0(JavaReconcilingStrategy.java:108)\n\tat org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy$1.run(JavaReconcilingStrategy.java:89)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:87)\n\tat org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:149)\n\tat org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:86)\n\tat org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:102)\n\tat org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:75)\n\tat org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:206)",
    "I\u0027ll investigate.",
    "Reproduced.\nThe problem only exists if the class default value is from a base type.\nvoid.class, int.class, ...",
    "Created an attachment (id\u003d84209)\nProposed fix + regression tests\n\n",
    "Released for 3.4M4.\nRegression tests added in org.eclipse.jdt.core.tests.compiler.regression.AnnotationTest#test247\norg.eclipse.jdt.core.tests.compiler.regression.AnnotationTest#test248",
    "Verifier, in order to reproduce the storage of annotations must be enabled.\nThe reconciling is one way to do that.",
    "Philippe, we might want to backport to 3.3.2.",
    "+1 for 3.3.2",
    "Since in 3.3.x doesn\u0027t do a cast to ReferenceBinding, there is no need to backport.",
    "Verified for 3.4M4 using build I20071210-1800."
  ],
  "commentCreationDates": [
    "2007-11-30T16:50:43+01:00",
    "2007-11-30T17:16:31+01:00",
    "2007-11-30T18:18:03+01:00",
    "2007-11-30T18:21:28+01:00",
    "2007-11-30T19:15:40+01:00",
    "2007-11-30T19:16:33+01:00",
    "2007-11-30T19:19:18+01:00",
    "2007-12-03T10:04:59+01:00",
    "2007-12-03T14:53:52+01:00",
    "2007-12-12T09:37:39+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.jdt.internal.compiler.lookup.BaseTypeBinding",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.convertMemberValue",
          "source": "BinaryTypeBinding.java:54"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.createMethod",
          "source": "BinaryTypeBinding.java:511"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.createMethods",
          "source": "BinaryTypeBinding.java:560"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.cachePartsFrom",
          "source": "BinaryTypeBinding.java:329"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createBinaryTypeFrom",
          "source": "LookupEnvironment.java:731"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createBinaryTypeFrom",
          "source": "LookupEnvironment.java:710"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.accept",
          "source": "Compiler.java:276"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.askForType",
          "source": "LookupEnvironment.java:130"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.PackageBinding.getTypeOrPackage",
          "source": "PackageBinding.java:178"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.getTypeOrPackage",
          "source": "Scope.java:2416"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.getType",
          "source": "Scope.java:2144"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.SingleTypeReference.getTypeBinding",
          "source": "SingleTypeReference.java:44"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType",
          "source": "TypeReference.java:134"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType",
          "source": "TypeReference.java:125"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.Annotation.resolveType",
          "source": "Annotation.java:231"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.ASTNode.resolveAnnotations",
          "source": "ASTNode.java:590"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.FieldBinding.getAnnotationTagBits",
          "source": "FieldBinding.java:252"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.resolveTypeFor",
          "source": "SourceTypeBinding.java:1256"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.fields",
          "source": "SourceTypeBinding.java:608"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.faultInTypesForFieldsAndMethods",
          "source": "SourceTypeBinding.java:586"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.faultInTypes",
          "source": "CompilationUnitScope.java:431"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.resolve",
          "source": "Compiler.java:724"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnitProblemFinder.process",
          "source": "CompilationUnitProblemFinder.java:187"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.buildStructure",
          "source": "CompilationUnit.java:183"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.generateInfos",
          "source": "Openable.java:252"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaElement.openWhenClosed",
          "source": "JavaElement.java:510"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent",
          "source": "CompilationUnit.java:1001"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.makeConsistent",
          "source": "ReconcileWorkingCopyOperation.java:170"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation",
          "source": "ReconcileWorkingCopyOperation.java:89"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:720"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:780"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.reconcile",
          "source": "CompilationUnit.java:1151"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:124"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.access$0",
          "source": "JavaReconcilingStrategy.java:108"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy$1.run",
          "source": "JavaReconcilingStrategy.java:89"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:87"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:149"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile",
          "source": "CompositeReconcilingStrategy.java:86"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile",
          "source": "JavaCompositeReconcilingStrategy.java:102"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.MonoReconciler.process",
          "source": "MonoReconciler.java:75"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run",
          "source": "AbstractReconciler.java:206"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "211609",
      "date": "2007-11-30T16:50:43+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "211609",
  "bugId": "211609",
  "date": "2007-11-30T16:50:43+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}