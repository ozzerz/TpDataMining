{
  "comments": [
    "I haven\u0027t been able to reproduce it so far, but I saw the following trace showed\nup in my log.  I think it\u0027s updating the classpath of all of the projects when\nthe resource change event may already have a conflicting rule in place.\n\n!ENTRY org.eclipse.core.resources 4 2 2005-07-20 00:40:44.587\n!MESSAGE Problems occurred when invoking code from plug-in:\n\"org.eclipse.core.resources\".\n!STACK 0\njava.lang.IllegalArgumentException: Attempted to beginRule: R/, does not match\nouter scope rule:\nMultiRule[P/84046,P/antlr,P/commons-beanutils,P/commons-digester,P/commons-fileupload,P/commons-logging,P/commons-validator,P/D,P/Design,P/docs,P/DTDs,P/EclipseWTP,P/F,P/f2,P/Flexible003,P/fresh,P/FsingleModule,P/images,P/J0000,P/J2,P/j2eeWebProject0,P/jakarta-oro,P/jakarta-tomcat-5.5.4-jsp-examples]\n\tat org.eclipse.core.internal.runtime.Assert.isLegal(Assert.java:58)\n\tat org.eclipse.core.internal.jobs.ThreadJob.illegalPush(ThreadJob.java:117)\n\tat org.eclipse.core.internal.jobs.ThreadJob.push(ThreadJob.java:211)\n\tat org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:81)\n\tat org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:190)\n\tat org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:96)\n\tat\norg.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1674)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1714)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:782)\n\tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:2834)\n\tat org.eclipse.jdt.core.JavaCore$6.run(JavaCore.java:3951)\n\tat\norg.eclipse.jdt.internal.core.BatchOperation.executeOperation(BatchOperation.java:39)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:718)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1719)\n\tat org.eclipse.jdt.core.JavaCore.run(JavaCore.java:3760)\n\tat org.eclipse.jdt.core.JavaCore.setClasspathContainer(JavaCore.java:3934)\n\tat\norg.eclipse.jdt.internal.launching.JREContainerInitializer.initialize(JREContainerInitializer.java:54)\n\tat\norg.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1591)\n\tat\norg.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1040)\n\tat org.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1326)\n\tat\norg.eclipse.jst.common.jdt.internal.classpath.FlexibleProjectContainer$Listener.resourceChanged(FlexibleProjectContainer.java:330)\n\tat\norg.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:276)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat\norg.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:270)\n\tat\norg.eclipse.core.internal.events.NotificationManager.handleEvent(NotificationManager.java:242)\n\tat org.eclipse.core.internal.resources.Workspace.broadcastEvent(Workspace.java:195)\n\tat org.eclipse.core.internal.resources.Project.close(Project.java:171)\n\tat\norg.eclipse.ui.actions.CloseResourceAction.invokeOperation(CloseResourceAction.java:169)\n\tat org.eclipse.ui.actions.WorkspaceAction.execute(WorkspaceAction.java:133)\n\tat\norg.eclipse.ui.actions.WorkspaceAction$2.runInWorkspace(WorkspaceAction.java:424)\n\tat\norg.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)",
    "Hi - Are you adding a Job rule with the specific projects?   Looks like jdt is\nusing the workspace root, so this rule may need to include that.",
    "Chuck, I am not sure why you assigned this to me. Did you mean to assign it to \nNitin?",
    "Looking at the stack again... do we want to open this against jdt?\n\nThe platform is in the middle of a close resource action, and the container is\njust calling: JavaCore.getClasspathContainer() - which gets the rule conflict.\n\nNot sure why this should be illegal.\n\nI\u0027ll move to jdt.",
    "Looking at the stack again... do we want to open this against jdt?\n\nThe platform is in the middle of a close resource action, and the container is\njust calling: JavaCore.getClasspathContainer() - which gets the rule conflict.\n\nNot sure why this should be illegal.\n\nI\u0027ll move to jdt.",
    "Moving to Platform/Resources.",
    "Closing a project uses a project-level scheduling rule. The call to\nJavaCore.getClasspathContainer() can actually modify resources, and in order to\ndo that it uses the workspace root as the scheduling rule (and it has to). One\ncannot try to begin a rule that is more comprehensive than the current rule.\nThus, calling that method from a resource change listener is not safe. Also,\ndoing so from a PRE_CLOSE resource change listener is not valid either.",
    "A similar issue in PDE: bug 94435.",
    "Looks like the jdt team will consider a fix in 3.2....\n\n*** This bug has been marked as a duplicate of 94764 ***",
    "Bug 94764 is in Platform/Resources, not JDT, and is only about improving error\nreporting, so this problem will still occur even if that bug is fixed.\n\nIt is wrong to call JavaCore.getClasspathContainer() from a PRE_CLOSE resource\nchange listener, because it may create resources, and you are not allowed to do\nso from this type of resource change listener.",
    "Ok Kostantin, looks like this is back to you again...\n\nJavaCore.getClasspathContainer() can\u0027t be called on the PRE_CLOSE event, so maybe\nlisten for this in your FlexibleProjectContainer$Listener class?",
    "Thanks for doing the legwork to investigate this. I committed the fix. Haven\u0027t released it as there are other changes in the plugin. This may or may not be in RC1.",
    "Can\u0027t reproduce on 1.0rc4"
  ],
  "commentCreationDates": [
    "2005-07-20T07:03:47+02:00",
    "2005-08-02T21:28:39+02:00",
    "2005-08-02T21:32:54+02:00",
    "2005-08-29T17:13:33+02:00",
    "2005-08-29T17:14:19+02:00",
    "2005-08-30T20:28:13+02:00",
    "2005-08-30T21:16:53+02:00",
    "2005-08-30T21:28:35+02:00",
    "2005-09-09T05:58:42+02:00",
    "2005-09-09T17:47:20+02:00",
    "2005-09-09T20:22:41+02:00",
    "2005-12-01T02:32:55+01:00",
    "2005-12-13T23:53:44+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Attempted to beginRule: R/, does not match outer scope rule: MultiRule[P/84046,P/antlr,P/commons-beanutils,P/commons-digester,P/commons-fileupload,P/commons-logging,P/commons-validator,P/D,P/Design,P/docs,P/DTDs,P/EclipseWTP,P/F,P/f2,P/Flexible003,P/fresh,P/FsingleModule,P/images,P/J0000,P/J2,P/j2eeWebProject0,P/jakarta-oro,P/jakarta-tomcat-5.5.4-jsp-examples]",
      "elements": [
        {
          "method": "org.eclipse.core.internal.runtime.Assert.isLegal",
          "source": "Assert.java:58"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.illegalPush",
          "source": "ThreadJob.java:117"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.push",
          "source": "ThreadJob.java:211"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ImplicitJobs.begin",
          "source": "ImplicitJobs.java:81"
        },
        {
          "method": "org.eclipse.core.internal.jobs.JobManager.beginRule",
          "source": "JobManager.java:190"
        },
        {
          "method": "org.eclipse.core.internal.resources.WorkManager.checkIn",
          "source": "WorkManager.java:96"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.prepareOperation",
          "source": "Workspace.java:1674"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1714"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:782"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setRawClasspath",
          "source": "JavaProject.java:2834"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore$6.run",
          "source": "JavaCore.java:3951"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BatchOperation.executeOperation",
          "source": "BatchOperation.java:39"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:718"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1719"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.run",
          "source": "JavaCore.java:3760"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.setClasspathContainer",
          "source": "JavaCore.java:3934"
        },
        {
          "method": "org.eclipse.jdt.internal.launching.JREContainerInitializer.initialize",
          "source": "JREContainerInitializer.java:54"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:1591"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:1040"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1326"
        },
        {
          "method": "org.eclipse.jst.common.jdt.internal.classpath.FlexibleProjectContainer$Listener.resourceChanged",
          "source": "FlexibleProjectContainer.java:330"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager$2.run",
          "source": "NotificationManager.java:276"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.notify",
          "source": "NotificationManager.java:270"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.handleEvent",
          "source": "NotificationManager.java:242"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.broadcastEvent",
          "source": "Workspace.java:195"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.close",
          "source": "Project.java:171"
        },
        {
          "method": "org.eclipse.ui.actions.CloseResourceAction.invokeOperation",
          "source": "CloseResourceAction.java:169"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceAction.execute",
          "source": "WorkspaceAction.java:133"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceAction$2.runInWorkspace",
          "source": "WorkspaceAction.java:424"
        },
        {
          "method": "org.eclipse.core.internal.resources.InternalWorkspaceJob.run",
          "source": "InternalWorkspaceJob.java:38"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "104456",
      "date": "2005-07-20T07:03:47+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "normal"
    }
  ],
  "groupId": "104456",
  "bugId": "104456",
  "date": "2005-07-20T07:03:47+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "normal"
}