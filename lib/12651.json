{
  "comments": [
    "I believe there is a bug in the \norg.eclipse.jdt.internal.codeassist.CompletionEngine.  When I am code assisting \nin the detail pane of the variables view for a class such as \"Sample$1\n$InnerClass\"  I get the following NPE.  \n\nI believe the completion engine should be using the topLevelType instead of the \ntype at line 598 to generate the typeDeclaration.\n\nNPE:\njava.lang.NullPointerException\n\tat org.eclipse.jdt.internal.codeassist.CompletionEngine.complete\n(CompletionEngine.java:605)\n\tat org.eclipse.jdt.internal.core.SourceType.codeComplete\n(SourceType.java:68)\n\tat \norg.eclipse.jdt.internal.debug.ui.display.DetailsCompletionProcessor.computeComp\nletionProposals(DetailsCompletionProcessor.java:64)\n\tat \norg.eclipse.jface.text.contentassist.ContentAssistant.computeCompletionProposals\n(ContentAssistant.java:1197)\n\tat \norg.eclipse.jface.text.contentassist.CompletionProposalPopup.computeProposals\n(CompletionProposalPopup.java:103)\n\tat org.eclipse.jface.text.contentassist.CompletionProposalPopup.access$3\n(CompletionProposalPopup.java:102)\n\tat org.eclipse.jface.text.contentassist.CompletionProposalPopup$1.run\n(CompletionProposalPopup.java:71)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:56)\n\tat \norg.eclipse.jface.text.contentassist.CompletionProposalPopup.showProposals\n(CompletionProposalPopup.java:66)\n\tat org.eclipse.jface.text.contentassist.ContentAssistant$2.run\n(ContentAssistant.java:265)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:29)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages\n(Synchronizer.java:93)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:1397)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1211)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:755)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:738)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:777)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:319)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:14)",
    "I can not reproduce this problem.\nCould you give me a more accurate test case ?",
    "Created an attachment (id\u003d543)\nSample.java\n",
    "Test Case (using latest code in HEAD on dev.eclipse.org):\nUse the attached source (Sample.java), breakpoint on line 32.\nDebug, hit breakpoint\nGo to the variables view showing the detail pane\nSelect the \"this\" variable\nCode assist in the detail pane (popup menu or ctrl-space)\n\n\n",
    "There is an error in my code. I correct it and now NPE does not occur.\n\nBut with this test case no completion proposal are possible because the \ncompletion is on the member type Sample.InnerClass and this type does not exist.\n\nFixed.",
    "Doing a code completion in the Java Editor at line 36 with\n\"this.\" gives the following completions:\ninnerClassVar1\ninnerClassIVar1\ninnerMethod1(String innerArg1)\n\u003c\u003call the methods inherited from Object\u003e\u003e\n\nDoing it with the \"this\" variable selected in the variables view with \"this.\" \nentered in the detail pane we get no completions\n\nwhy is this different?",
    "In DisplayCompletionProcessor#getType you use IType#getType. This method can \ngive a handle on member type, but not local type and not anonymous type. In \nfact it is not possible to create a handle on local or anonymous.\n\n\nDisplayCompletionProcessor\n------------------------------------------------------\nprotected IType getType( ... ) throws DebugException {\n\n   ...\n\n   try {\n\n      ...\n\n      for (int i \u003d 1; i \u003c typeNames.length; i++) {\n         String innerTypeName\u003d typeNames[i];\n         try {\n            Integer.parseInt(innerTypeName);\n            continue; //loop over anonymous types\n         } catch (NumberFormatException e) {\n         }\n         type \u003d type.getType(innerTypeName);\n      }\n   } catch (JavaModelException e) {\n      throw new DebugException(e.getStatus());\n   }\n\t\t\n   return type;\t\n}\n------------------------------------------------------\nThe enclosing type of the completion is the local type Sample$1$InnerClass. But \nin this algorithm the result is a handle on member type Sample$InnerClass and \nthis member type does not exist. That\u0027s why there is no completion."
  ],
  "commentCreationDates": [
    "2002-04-02T22:08:34+02:00",
    "2002-04-03T11:54:33+02:00",
    "2002-04-03T22:02:04+02:00",
    "2002-04-03T22:06:00+02:00",
    "2002-04-04T10:32:46+02:00",
    "2002-04-08T21:40:37+02:00",
    "2002-04-09T11:20:10+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.codeassist.CompletionEngine.complete",
          "source": "CompletionEngine.java:605"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SourceType.codeComplete",
          "source": "SourceType.java:68"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.ui.display.DetailsCompletionProcessor.computeCompletionProposals",
          "source": "DetailsCompletionProcessor.java:64"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.ContentAssistant.computeCompletionProposals",
          "source": "ContentAssistant.java:1197"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.computeProposals",
          "source": "CompletionProposalPopup.java:103"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.access$3",
          "source": "CompletionProposalPopup.java:102"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup$1.run",
          "source": "CompletionProposalPopup.java:71"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:56"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.showProposals",
          "source": "CompletionProposalPopup.java:66"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.ContentAssistant$2.run",
          "source": "ContentAssistant.java:265"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:29"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:93"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:1397"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1211"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:755"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:738"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:777"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:319"
        },
        {
          "method": "EclipseRuntimeLauncher.main",
          "source": "EclipseRuntimeLauncher.java:14"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "12651",
      "date": "2002-04-02T22:08:34+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "12651",
  "bugId": "12651",
  "date": "2002-04-02T22:08:34+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}