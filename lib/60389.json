{
  "comments": [
    "Hi,\n\nproblem: internal compiler error when using the joinpoint of a method-execution \nwith more than 2 parameters.\n\nsituation: Within my project, I used a home made logging-aspect which logged \nevery single method in all of the classes when entering and when leaving this \nmethod.\nEverything compiled fine with the 1.1.1 compiler, but with the 1.2 compiler, \nsome internal compiler error occured.\nAfter some debugging, I was able to coin the problem in a very small test-case \n(which I will provide in attachment).\nIt seemed a very dangerous problem to me since the problem seems to occur \nwhenever the joinpoint is asked for a method with more than two parameters.\nI did check for before and after advice (both failing), but I didn\u0027t check for \nother advices nor did I check for other types of pointcuts besides the \nexecution-pointcut. I would expect however that this problem occurs in more \ncases than this simple test-case shows.\n\nI hope you could soon fix this problem, since the logging in my project is down \nuntil this error is fixed.\n\nbest regards, \nKoen",
    "Created an attachment (id\u003d10102)\ntest-case failing during compilation\n\nThis zip-file contains a POJO, an aspect interacting with this POJO and the\nbuild-file used for compiling this files (failing when run).\n",
    "additional remark: perhaps this bug could be analog to the bug 52813 (compiler \nerror).",
    "Sorry, I meant bug 51842 instead of 52813",
    "This needs to be fixed in 1.2rc2",
    "Thank you for the test case Koen. However, when put to use I could not recreate \nthe described problem with rc1. The compilation runs to completion and the \nresulting application can be successfully run. Investigated on both the Windows \nand Linux platforms. Details of the test environments :-\n\nWindows\n-------\nOperating system : Windows XP\nAspectJ          : 1.2 rc1\nAnt              : version 1.5.3\nJava             : Sun 1.4.1, IBM 1.4.1, Sun 1.3.1 (compile only)\n\nLinux\n-----\nOperating system : Linux (Red Hat 8.0)\nAspectJ          : 1.2 rc1\nAnt              : version 1.5.3\nJava             : Sun 1.4.1\n\nAre you using anything at a significantly different level to the above that \ncould account for the difference in behaviour ? In addition, can you download \nyour test case zip from bugzilla and see if the contents still fail for you in \nyour set up.  \n\nGeorge",
    "Hi,\n\n\nThe zip-file from the site still gives an error in my compilation.\nWhen removing the problem-line the compilation runs OK\n(this way, I know that it\u0027s not a fault in my build-file or aspectj/java-\ninstallation).\n\n\nDetails of my environment:\nOperating System: Windows XP\nAspectJ: 1.2 rc1\nAnt: version 1.5.4\nJava: Sun 1.4.2_04\n\n\nAfter the failing compilation, the aspect-file seems to be compiled, while the \nPOJO is not.\nI will add as attachment a zip-file containing the compiled aspect and the \ncommand-line input and output on my computer.\n\n\nbest regards,\nKoen\n",
    "Created an attachment (id\u003d10105)\nfailing output for the test-case\n\nthis is the output which shows the compilation-failure on my computer",
    "Hi,\n\nCan you try taking Ant out of this and perform the compilation on the command \nline using the ajc command ?\n\nDoes this work for you inside Eclipse ? \n\n  ",
    "When I try to compile at the command-line. I get the same exception.\nI\u0027ve command-line input and output below. You can also see which version of \naspectj I used.\nThe compilation using aspectj1.1.1 works OK, \nand (very strange) but the compilation also succeeded within eclipse 3.0M8\nwhich also uses the aspectj1.2 compiler.\n\nbest regards,\nKoen\n\nbelow: command-line input and output\n-------------------------------------\n\n\nC:\\work\\test\u003eajc -showversion -classpath C:\\aspectj1.2\\lib\\aspectjrt.jar Test.ja\nva;TestAspect.aj\nAspectJ Compiler 1.2rc1 built on Wednesday Apr 14, 2004 at 18:10:02 GMT\ntrouble in:\npublic class Test extends java.lang.Object:\n  private static final org.aspectj.lang.JoinPoint$StaticPart ajc$tjp_0\n  public void \u003cinit\u003e():\n                    ALOAD_0     // Test this   (line 4)\n                    INVOKESPECIAL java.lang.Object.\u003cinit\u003e ()V\n    constructor-execution(void Test.\u003cinit\u003e())\n    |               RETURN\n    constructor-execution(void Test.\u003cinit\u003e())\n  end public void \u003cinit\u003e()\n\n  public void test(String, String, String):\n    method-execution(void Test.test(java.lang.String, java.lang.String, java.lan\ng.String))\n    |               GETSTATIC java.lang.System.out Ljava/io/PrintStream;   (line\n 13)\n    |               LDC \"executing test\"\n    |               INVOKEVIRTUAL java.io.PrintStream.println (Ljava/lang/String\n;)V\n    |               RETURN   (line 14)\n    method-execution(void Test.test(java.lang.String, java.lang.String, java.lan\ng.String))\n  end public void test(String, String, String)\n\n  public static void main(String[]):\n                    NEW Test   (line 17)\n                    DUP\n                    INVOKESPECIAL Test.\u003cinit\u003e ()V\n                    LDC \"\"\n                    LDC \"\"\n                    LDC \"\"\n                    INVOKEVIRTUAL Test.test (Ljava/lang/String;Ljava/lang/String\n;Ljava/lang/String;)V\n                    RETURN   (line 18)\n  end public static void main(String[])\n\nend public class Test\nC:\\work\\test\\TestAspect.aj error Internal compiler error\njava.lang.NoSuchMethodError: org.apache.bcel.generic.InstructionFactory.createNe\nwArray(Lorg/apache/bcel/generic/Type;S)Lorg/apache/bcel/generic/Instruction;\n        at org.aspectj.weaver.bcel.BcelShadow.makeArgsObjectArray(BcelShadow.jav\na:1032)\n        at org.aspectj.weaver.bcel.BcelShadow.createThisJoinPoint(BcelShadow.jav\na:980)\n        at org.aspectj.weaver.bcel.BcelShadow.initializeThisJoinPoint(BcelShadow\n.java:890)\n        at org.aspectj.weaver.bcel.BcelShadow.prepareForMungers(BcelShadow.java:\n260)\n        at org.aspectj.weaver.Shadow.implement(Shadow.java:324)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.implement(BcelClassWeaver.jav\na:1139)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:35\n7)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:80\n)\n        at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:724)\n        at org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:6\n89)\n        at org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:615\n)\n        at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:563)\n        at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompiler\nAdapter.java:239)\n        at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(A\njCompilerAdapter.java:114)\n        at org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:376)\n\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilat\nion(AjBuildManager.java:600)\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuild\nManager.java:160)\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBu\nildManager.java:94)\n        at org.aspectj.ajdt.ajc.AjdtCommand.doCommand(AjdtCommand.java:102)\n        at org.aspectj.ajdt.ajc.AjdtCommand.runCommand(AjdtCommand.java:53)\n        at org.aspectj.tools.ajc.Main.run(Main.java:280)\n        at org.aspectj.tools.ajc.Main.runMain(Main.java:217)\n        at org.aspectj.tools.ajc.Main.main(Main.java:79)\n\n(no source information available)\nABORT\n\nException thrown from AspectJ 1.2rc1\n\nThis might be logged as a bug already -- find current bugs at\n  http://bugs.eclipse.org/bugs/buglist.cgi?product\u003dAspectJ\u0026component\u003dCompiler\n\nBugs for exceptions thrown have titles File:line from the top stack,\ne.g., \"SomeFile.java:243\"\n\nIf you don\u0027t find the exception below in a bug, please add a new bug\nat http://bugs.eclipse.org/bugs/enter_bug.cgi?product\u003dAspectJ\nTo make the bug a priority, please include a test program\nthat can reproduce this exception.\norg.apache.bcel.generic.InstructionFactory.createNewArray(Lorg/apache/bcel/gener\nic/Type;S)Lorg/apache/bcel/generic/Instruction;\norg.apache.bcel.generic.InstructionFactory.createNewArray(Lorg/apache/bcel/gener\nic/Type;S)Lorg/apache/bcel/generic/Instruction;\njava.lang.NoSuchMethodError: org.apache.bcel.generic.InstructionFactory.createNe\nwArray(Lorg/apache/bcel/generic/Type;S)Lorg/apache/bcel/generic/Instruction;\n        at org.aspectj.weaver.bcel.BcelShadow.makeArgsObjectArray(BcelShadow.jav\na:1032)\n        at org.aspectj.weaver.bcel.BcelShadow.createThisJoinPoint(BcelShadow.jav\na:980)\n        at org.aspectj.weaver.bcel.BcelShadow.initializeThisJoinPoint(BcelShadow\n.java:890)\n        at org.aspectj.weaver.bcel.BcelShadow.prepareForMungers(BcelShadow.java:\n260)\n        at org.aspectj.weaver.Shadow.implement(Shadow.java:324)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.implement(BcelClassWeaver.jav\na:1139)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:35\n7)\n        at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:80\n)\n        at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:724)\n        at org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:6\n89)\n        at org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:615\n)\n        at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:563)\n        at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompiler\nAdapter.java:239)\n        at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(A\njCompilerAdapter.java:114)\n        at org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:376)\n\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilat\nion(AjBuildManager.java:600)\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuild\nManager.java:160)\n        at org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBu\nildManager.java:94)\n        at org.aspectj.ajdt.ajc.AjdtCommand.doCommand(AjdtCommand.java:102)\n        at org.aspectj.ajdt.ajc.AjdtCommand.runCommand(AjdtCommand.java:53)\n        at org.aspectj.tools.ajc.Main.run(Main.java:280)\n        at org.aspectj.tools.ajc.Main.runMain(Main.java:217)\n        at org.aspectj.tools.ajc.Main.main(Main.java:79)\n\n\n1 fail|abort, 1 error\n\n",
    "This appears to be the same issue as bug 59921.  The problem is that a \ndifferent version of BCEL is being loaded - something is getting ahead of the \nvariant included in 1.2 aspectjtools.jar.  I have just recreated the problem \nby altering my classpath to include an old bcel.jar (from AJDT 1.1.4) and \nremoving the fork/forkclasspath in the build.xml attached in this bug.\n\nMy suggestion in the other bug was to add fork/forkclasspath to the build \nfile - but obviously that doesn\u0027t apply here, it is already being included.  \nThe important line is the java invocation from the output.  Here is Casiers\u0027:\n\n[iajc] forking [C:\\j2sdk1.4.2\\jre\\bin\\javaw.exe, -classpath, \n  C:\\aspectj1.2\\lib\\aspectjtools.jar, org.aspectj.tools.ajc.Main, -d,\n  C:\\work\\test, -verbose, -source, 1.4, -classpath, \n  C:\\aspectj1.2\\lib\\aspectjrt.jar;C:\\aspectj1.2\\lib\\aspectjtools.jar, \n  C:\\work\\test\\Test.java, C:\\work\\test\\TestAspect.aj]\n\nAnd here is mine (in the working case):\n\n[iajc] forking [C:\\jvms\\sun142_04\\jre\\bin\\javaw.exe, -classpath, \n  C:\\aspectj1.2-rc1\\lib\\aspectjtools.jar, org.aspectj.tools.ajc.Main, -d, \n  C:\\temp\\koen, -verbose, -source, 1.4, -classpath, \n  C:\\aspectj1.2-rc1\\lib\\aspectjrt.jar;\n  C:\\aspectj1.2-rc1\\lib\\aspectjtools.jar;C:\\aspectj1.2-rc1\\lib\\bcel.jar,\n  C:\\temp\\koen\\Test.java, C:\\temp\\koen\\TestAspect.aj]\n\nBoth look fine !\n\nThere seem to be only two possibilities:\n1) There is a bad version of BCEL inside Casiers install of aspectj1.2\n\\lib\\aspectjtools.jar file (unlikely!)\n2) There is another version of BCEL around on either the bootclasspath or \ninstalled as a standard extension for the JVM (in the jre\\lib\\ext directory).  \nI just tried copying my rogue bcel.jar from an old AJDT into jre\\lib\\ext and I \ncan now recreate the problem even including the fork.\n\nCan you possibly check option number (2) - it might have appeared in the \nlib/ext folder because of installing some other product in the system - do you \nhave anything other than \ndnsns.jar/ldapsec.jar/localedata.jar/sunjce_provider.jar in your jre/lib/ext \ndirectory?.  It might also be useful to see your environment settings too - do \nyou run the ant from command line?  If so, in the same DOS window can you \nrun \u0027set\u0027 to get the environment settings and append them in here.  If \npossible, it would also be nice to try a different version of the JVM.\n\nI\u0027ve downloaded Java 1.4.2_04 and ANT 1.5.4 to replicate your environment.\n",
    "Reducing pri/sev - looks like similar bug reports relating to having the wrong \nversion of BCEL around in the environment - waiting for more info ...",
    "Simplest way to verify if you have a misbehaving (from an AJ point of view) \nJVM is to go to the command line:\n\n1) Unset your CLASSPATH\nset CLASSPATH\u003d\n\n2) Attempt to find a BCEL class\njavap org.apache.bcel.generic.InstructionFactory\n\nThis should fail.  If it does not then you have a version of BCEL somewhere in \nthat JVM installation - and it will affect whether AspectJ can run.",
    "Can you confirm this bug is resolved now?  We have had several bugs reporting\nthis same problem, and every one has been due to a different version of BCEL\nbeing ahead of the aspectjtools.jar.  i think it is usually xalan.jar or some\nother XML related technology in the base JVM.\n\nAndy.",
    "99.99999999% sure its the bcel in the JVM.  Enhancement request bug 61374 should\nensure we don\u0027t get into this situation again.",
    "Fix released as part of AspectJ 1.2.1",
    "Working with version 1.2.1 is not giving the same exception\nagain. So it is certainly OK for me.\n\nThanks for helping me out,\nKoen"
  ],
  "commentCreationDates": [
    "2004-04-29T12:04:31+02:00",
    "2004-04-29T12:07:58+02:00",
    "2004-04-29T12:09:28+02:00",
    "2004-04-29T12:13:40+02:00",
    "2004-04-29T12:20:16+02:00",
    "2004-04-29T14:21:41+02:00",
    "2004-04-29T14:56:32+02:00",
    "2004-04-29T14:57:54+02:00",
    "2004-04-29T18:02:04+02:00",
    "2004-04-30T10:42:18+02:00",
    "2004-05-05T17:04:37+02:00",
    "2004-05-13T11:22:23+02:00",
    "2004-05-24T18:03:36+02:00",
    "2004-07-29T15:48:20+02:00",
    "2004-08-06T16:54:07+02:00",
    "2004-10-21T10:31:38+02:00",
    "2005-01-05T16:18:46+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoSuchMethodError",
      "message": "org.apache.bcel.generic.InstructionFactory.createNe wArray(Lorg/apache/bcel/generic/Type;S)Lorg/apache/bcel/generic/Instruction;",
      "elements": [
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.makeArgsObjectArray",
          "source": "BcelShadow.jav a:1032"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.createThisJoinPoint",
          "source": "BcelShadow.jav a:980"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.initializeThisJoinPoint",
          "source": "BcelShadow .java:890"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.prepareForMungers",
          "source": "BcelShadow.java: 260"
        },
        {
          "method": "org.aspectj.weaver.Shadow.implement",
          "source": "Shadow.java:324"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.implement",
          "source": "BcelClassWeaver.jav a:1139"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:35 7"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:80 "
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:724"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump",
          "source": "BcelWeaver.java:6 89"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify",
          "source": "BcelWeaver.java:615 "
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:563"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompiler Adapter.java:239"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "A jCompilerAdapter.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:376"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:600"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuild Manager.java:160"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild",
          "source": "AjBu ildManager.java:94"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.doCommand",
          "source": "AjdtCommand.java:102"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.runCommand",
          "source": "AjdtCommand.java:53"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.run",
          "source": "Main.java:280"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.runMain",
          "source": "Main.java:217"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.main",
          "source": "Main.java:79"
        }
      ],
      "number": 0,
      "commentIndex": 9,
      "bugId": "60389",
      "date": "2004-04-30T10:42:18+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.NoSuchMethodError",
      "message": "org.apache.bcel.generic.InstructionFactory.createNe wArray(Lorg/apache/bcel/generic/Type;S)Lorg/apache/bcel/generic/Instruction;",
      "elements": [
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.makeArgsObjectArray",
          "source": "BcelShadow.jav a:1032"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.createThisJoinPoint",
          "source": "BcelShadow.jav a:980"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.initializeThisJoinPoint",
          "source": "BcelShadow .java:890"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelShadow.prepareForMungers",
          "source": "BcelShadow.java: 260"
        },
        {
          "method": "org.aspectj.weaver.Shadow.implement",
          "source": "Shadow.java:324"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.implement",
          "source": "BcelClassWeaver.jav a:1139"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:35 7"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:80 "
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:724"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump",
          "source": "BcelWeaver.java:6 89"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify",
          "source": "BcelWeaver.java:615 "
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:563"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompiler Adapter.java:239"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "A jCompilerAdapter.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:376"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:600"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuild Manager.java:160"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild",
          "source": "AjBu ildManager.java:94"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.doCommand",
          "source": "AjdtCommand.java:102"
        },
        {
          "method": "org.aspectj.ajdt.ajc.AjdtCommand.runCommand",
          "source": "AjdtCommand.java:53"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.run",
          "source": "Main.java:280"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.runMain",
          "source": "Main.java:217"
        },
        {
          "method": "org.aspectj.tools.ajc.Main.main",
          "source": "Main.java:79"
        }
      ],
      "number": 1,
      "commentIndex": 9,
      "bugId": "60389",
      "date": "2004-04-30T10:42:18+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "60389",
  "bugId": "60389",
  "date": "2004-04-29T12:04:31+02:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}