{
  "comments": [
    "Created an attachment (id\u003d79189)\neclipse log file containing the complete exception stacktrace\n\nWhen using the \"Open Type\" dialog (CTRL+SHIFT+T) to open a class file from a class folder a ClassCastException occurs. The UI does not react to the request to open the type and an exception is logged:\n\njava.lang.ClassCastException: org.eclipse.core.internal.resources.Folder cannot be cast to org.eclipse.core.resources.IFile\n\tat org.eclipse.jdt.internal.core.ClassFile.buildStructure(ClassFile.java:87)\n\tat org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:229)",
    "What Eclipse build are you using ?",
    "Version: 3.3.0\nBuild id: I20070621-1340",
    "Looking at the code, I don\u0027t see how this can happen. Do you have detailed steps to reproduce this problem ? A small workspace reproducing the problem would be ideal.",
    "Created an attachment (id\u003d79211)\neclipse java project to reproduce the ClassCastException\n\nIn order to reproduce the ClassCastException do the following steps:\n1. create a new empty workspace\n2. unzip this attachment to your filesystem\n3. import the contents through File/Import/\"Existing Projects into Workspace\"\n4. open the \"Open Type\" dialog (CTRL-SHIFT-T) and open the type \"TestCCE\"\n-\u003e the logfile is written to your workspace, nothing else happens",
    "If you restart your workbench after importing the project the exception does not happen again, but the following error message is displayed in a dialog: \"Type \u0027TestCCE\u0027 could not be found in \u0027P2/lib2.jar\u0027. Make sure all workspaces and resources are refreshed.\"\n\nIn order to reproduce the ClassCastException again you have to create a new workspace and import the project into that workspace. ",
    "(In reply to comment #4)\nThanks for the test case Tobias. I cannot reproduce the ClassCastException but I\u0027m always getting the Type \"\u0027TestCCE\u0027 could not be found in \u0027P2/lib2.jar\u0027\" dialog.\n\nInvestigating...\n",
    "Note that in 3.4 M2, the problem doesn\u0027t exist any longer as it was fixed in bug 138184.",
    "However looking more at the code, I now found a path that can lead to this ClassCastException. I\u0027m writing a JUnit test to prove that.",
    "Actually it is possible to reproduce the ClassCastException consistently by following these steps:\n1. create a new empty workspace\n2. unzip the attachment from comment 4 to your filesystem\n3. import the contents through File/Import/\"Existing Projects into Workspace\"\n4. expand P2, then Referenced Libraries (but don\u0027t expand further)\n5. open the \"Open Type\" dialog (CTRL-SHIFT-T) and open the type \"TestCCE\"\n-\u003e the logfile is written to your workspace, nothing else happens\nEven if you restart and follow steps 4 then 5, then ClassCastException still occurs",
    "(In reply to comment #9)\nThis is using 3.3 of course.\n\n",
    "Created an attachment (id\u003d79221)\nProposed fix and regression test\n\n",
    "Fix and test released for 3.4M3 in HEAD.",
    "Pls backport to 3.3.x",
    "Created an attachment (id\u003d79284)\nProposed fix for 3.3 maintenance\n\nSince the 3.4 M3 fix is too complicated and too risky for a backporting, this fix takes a different approach: it ensures that a PackageFragmentRoot is created during \u0027search all type names\u0027 (and not a JarPackageFragmentRoot as it would do in 3.3).",
    "Created an attachment (id\u003d79376)\nProposed regression test for 3.3 maintenance\n\n",
    "Fix and test released for 3.3.2 in R3_3_maintenance",
    "Verified for 3.4M3 using I20071029-0010 build.",
    "Since there is no workaround, this fix needs to be included in 3.3.2. Philippe please approve."
  ],
  "commentCreationDates": [
    "2007-09-26T09:45:25+02:00",
    "2007-09-26T10:20:09+02:00",
    "2007-09-26T11:02:53+02:00",
    "2007-09-26T13:10:58+02:00",
    "2007-09-26T16:58:30+02:00",
    "2007-09-26T17:04:01+02:00",
    "2007-09-26T17:55:42+02:00",
    "2007-09-26T18:11:53+02:00",
    "2007-09-26T18:21:10+02:00",
    "2007-09-26T18:41:20+02:00",
    "2007-09-26T18:42:01+02:00",
    "2007-09-26T18:51:06+02:00",
    "2007-09-27T13:11:01+02:00",
    "2007-09-27T15:13:27+02:00",
    "2007-09-27T16:05:42+02:00",
    "2007-09-28T13:40:05+02:00",
    "2007-10-08T12:57:09+02:00",
    "2007-10-30T15:22:06+01:00",
    "2007-11-21T09:49:30+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.core.internal.resources.Folder cannot be cast to org.eclipse.core.resources.IFile",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.ClassFile.buildStructure",
          "source": "ClassFile.java:87"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.generateInfos",
          "source": "Openable.java:229"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "204652",
      "date": "2007-09-26T09:45:25+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "204652",
  "bugId": "204652",
  "date": "2007-09-26T09:45:25+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}