{
  "comments": [
    "SWTError (XPCOM error -2147467259) when using the SWT 3.3 Broswer widget on Linux with Mozilla 1.7.8\n\nWhen using the eclipse-SDK-I20070123-1715 driver, creaating a SWT Browser widget causes the following exception:\n\norg.eclipse.swt.SWTError: XPCOM error -2147467259\n\tat org.eclipse.swt.browser.Mozilla.error(Mozilla.java:1308)\n\tat org.eclipse.swt.browser.Mozilla.create(Mozilla.java:262)\n\tat org.eclipse.swt.browser.Browser.\u003cinit\u003e(Browser.java:99)\n\nJRE:\njava version \"1.5.0\"\nJava(TM) 2 Runtime Environment, Standard Edition (build pxi32dev-20061002a (SR3) )\nIBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 Linux x86-32 j9vmxi3223-20061001 (JIT enabled)\nJ9VM - 20060915_08260_lHdSMR\nJIT  - 20060908_1811_r8\nGC   - 20060906_AA)\nJCL  - 20061002\n\nOS:\nLinux paules 2.6.16.21-0.8-smp #1 SMP Mon Jul 3 18:25:39 UTC 2006 x86_64 x86_64 x86_64 GNU/Linux\n\nMozilla:\nMozilla 1.7.8\nMozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.7.8) Gecko/20050511\n\nAccording to the SWT FAQ, this configuration is supported.",
    "Must fix for 3.3.",
    "I think you have a 32-bit XULRunner install either on your 64-bit machine or on a network that your machine sees.  Am I correct?\n",
    "(In reply to comment #2)\n\u003e I think you have a 32-bit XULRunner install either on your 64-bit machine or on\n\u003e a network that your machine sees.  Am I correct?\n\nMost likely since Mozilla 1.7.8 from http://www.mozilla.org/releases is installed on this 64 bit machine and Mozilla only offers the one download (assuming it is 32 bit).",
    "Trying to use a 32-bit GRE would fail like this.  However given where the crash occurred it seems like it\u0027s finding a 1.8-based mozilla.  Can you try the following:\n\n- if you are unable to start eclipse then set environment variable MOZILLA_FIVE_HOME to /dev/null (or if you can start eclipse then ignore this step)\n- retrieve swt from cvs into your workspace and compile it for gtk as outlined in http://www.eclipse.org/swt/cvs.php\n- run the following snippet against the swt in your workspace:\n\npublic static void main(String[] args) {\n\tDisplay.DEBUG \u003d true;\n\tfinal Display display \u003d new Display();\n\tShell shell \u003d new Shell(display);\n\tshell.setBounds(10,10,200,200);\n\tBrowser browser \u003d new Browser(shell, SWT.NONE);\n\tbrowser.setBounds(10,10,150,150);\n\tbrowser.setUrl(\"google.ca\");\n\tshell.open();\n\twhile (!shell.isDisposed()) {\n\t\tif (!display.readAndDispatch()) display.sleep();\n\t}\n\tdisplay.dispose();\n}\n\n- a line should be spewed to your Console view, what is it?\n",
    "A couple of details to add to comment 4:\n- make sure to retrieve the org.eclipse.swt.gtk.linux.x86_64 fragment from cvs, not org.eclipse.swt.gtk.linux.x86\n- after renaming .classpath_gtk to .classpath you may also need to change its \u003cattributes\u003e line from\n\u003cattribute name\u003d\"org.eclipse.jdt.launching.CLASSPATH_ATTR_LIBRARY_PATH_ENTRY\" value\u003d\"org.eclipse.swt.gtk.linux.x86\"/\u003e to\n\u003cattribute name\u003d\"org.eclipse.jdt.launching.CLASSPATH_ATTR_LIBRARY_PATH_ENTRY\" value\u003d\"org.eclipse.swt.gtk.linux.x86_64\"/\u003e\n",
    "(In reply to comment #4)\n\nThanks Grant for your help.  \n\nAfter following your instructions, I get the following exception when extracting/using the org.eclipse.swt.gtk.linux.x86_64 plug-in:\n\nException in thread \"main\" java.lang.NoClassDefFoundError: org.eclipse.swt.widgets.Display (initialization failure)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:123)\n\tat org.eclipse.hyades.test.Test.main(Test.java:11)\nCaused by: java.lang.Throwable: java.lang.UnsatisfiedLinkError: no swt-gtk-3327 or swt-gtk in swt.library.path, java.libary.path or the jar file\n\tat org.eclipse.swt.internal.Library.loadLibrary(Library.java:219)\n\tat org.eclipse.swt.internal.Library.loadLibrary(Library.java:151)\n\tat org.eclipse.swt.internal.C.\u003cclinit\u003e(C.java:21)\n\tat java.lang.J9VMInternals.initializeImpl(Native Method)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:177)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:144)\n\tat org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63)\n\tat org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54)\n\tat org.eclipse.swt.widgets.Display.\u003cclinit\u003e(Display.java:128)\n\tat java.lang.J9VMInternals.initializeImpl(Native Method)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:177)\n\tat java.lang.Class.forNameImpl(Native Method)\n\tat java.lang.Class.forName(Class.java:127)\n\tat org.eclipse.swt.graphics.Device.\u003cclinit\u003e(Device.java:101)\n\tat java.lang.J9VMInternals.initializeImpl(Native Method)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:177)\n\tat org.eclipse.hyades.test.Test.main(Test.java:10)\n\nInterestingly, I beleive I get the desired output with the org.eclipse.swt.gtk.linux.x86 plug-in:\n\nXULRunner path: /usr/lib64/xulrunner-1.8.0.1/libxpcom.so\nException in thread \"main\" org.eclipse.swt.SWTError: XPCOM error -2147467259\n\tat org.eclipse.swt.browser.Mozilla.error(Mozilla.java:1212)\n\tat org.eclipse.swt.browser.Mozilla.create(Mozilla.java:236)\n\tat org.eclipse.swt.browser.Browser.\u003cinit\u003e(Browser.java:109)\n\tat org.eclipse.hyades.test.Test.main(Test.java:14)\n",
    "(In reply to comment #4)\n\u003e Trying to use a 32-bit GRE would fail like this.  \n\nThere is no IBM 1.5 64-bit JRE (only 1.3.1 and 1.4.2).",
    "(In reply to comment #4)\n\u003e However given where the crash\n\u003e occurred it seems like it\u0027s finding a 1.8-based mozilla.  \n\nThere is Firefox 1.5.0.4 installed on the machine:\n\nMozilla/5.0 (X11; U; Linux i686 (x86_64); en-US; rv:1.8.0.4) Gecko/20060527 SUSE/1.5.0.4-1.9 Firefox/1.5.0.4",
    "Sorry, mistakenly reassigned to default component owner.",
    "I see, so you\u0027re running:\n - 32-bit eclipse\n - with a 32-bit VM\n - on a 64-bit linux install\n - failing because the xulrunner dynamic lookup is finding a 64-bit XULRunner, which does not agree with the 32-ness of your eclipse + VM\n\nThis is the exact reverse (but basically the same) of what I\u0027d assumed and have seen happen here:\n - 64-bit eclipse\n - with a 64-bit VM\n - on a 64-bit linux install\n - failing because the xulrunner dynamic lookup is finding a 32-bit XULRunner, which does not agree with the 64-ness of the eclipse + VM\n\nI\u0027ve posted a question about this scenario on the mozilla embedding list, and the response from Benjamin S. is that the XULRunner dynamic lookup does not handle detection of a XULRunner with the wrong arch.  The only way I can think of handling this is to attempt to fall back to using mozilla if the XULRunner glue startup fails.\n\nAs a side note, there is an IBM 1.5 64-bit JRE available internally on JIM.\n",
    "(In reply to comment #10)\n\nInterestingly, the same OS/JRE/Mozilla configuration worked with Eclipse 3.2.1 and 3.2.2.",
    "re: comment 11\n\nWhen you run 32-bit eclipse 3.2.1 or 3.2.2 on your 64-bit machine, does the Welcome page appear white or greenish?\n",
    "(In reply to comment #10)\n\nAs expected, the Browser widget works with the following configuration: \n\n64 bit (EM64T) IBM JRE 1.5 SR4\n64 bit Linux Eclipse\n\nThat said, I would be interested to know what changed on the SWT side between 3.2.2 and 3.3 for this configuration.  Our users need to be able to run in a 32-bit mode on a 64-bit machine.",
    "(In reply to comment #12)\n\u003e re: comment 11\n\u003e \n\u003e When you run 32-bit eclipse 3.2.1 or 3.2.2 on your 64-bit machine, does the\n\u003e Welcome page appear white or greenish?\n\u003e \n\nGreenish in 3.2.2.",
    "fixed \u003e 0223\n\nWhen a XULRunner is detected, a glue test is attempted on it before loading\nswt\u0027s xulrunner library.  If the test fails then the behaviour falls back to\nthe classic mozilla detection and swt mozilla library.\n\n\u003e interested to know what changed on the SWT side between 3.2.2 and 3.3\n\nAs part of the mozilla everywhere work the mozilla implementation of the\nbrowser became cross-platform.  This included a change to detect a XULRunner\ninstall to use by statically linking XULRunner code that sniffs around at\nruntime, rather than the previous practice of requiring the user to set\nMOZILLA_FIVE_HOME and LD_LIBRARY_PATH.  The new approach is considered to be\nthe right one, and ensures that the correct xulrunner libraries are loaded. \nUnfortunately when detecting a XULRunner to use there\u0027s no way to specify an\narch, nor is there a way to say \"I don\u0027t like the first one you gave me so\nplease find me another one\", hence the test-and-fallback strategy.\n",
    "Verified in the N20070301-0010 Eclipse 3.3 build.\n\nThanks Grant for your help with this defect.",
    "Closing."
  ],
  "commentCreationDates": [
    "2007-02-16T01:06:57+01:00",
    "2007-02-16T15:17:21+01:00",
    "2007-02-20T20:23:19+01:00",
    "2007-02-20T21:53:40+01:00",
    "2007-02-20T22:33:27+01:00",
    "2007-02-21T01:18:22+01:00",
    "2007-02-23T14:08:10+01:00",
    "2007-02-23T14:10:06+01:00",
    "2007-02-23T14:11:00+01:00",
    "2007-02-23T14:11:40+01:00",
    "2007-02-23T14:34:37+01:00",
    "2007-02-23T16:29:39+01:00",
    "2007-02-23T16:38:39+01:00",
    "2007-02-23T16:44:35+01:00",
    "2007-02-23T17:40:41+01:00",
    "2007-02-23T19:32:35+01:00",
    "2007-03-02T02:34:50+01:00",
    "2007-03-02T02:34:59+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "XPCOM error -2147467259",
      "elements": [
        {
          "method": "org.eclipse.swt.browser.Mozilla.error",
          "source": "Mozilla.java:1308"
        },
        {
          "method": "org.eclipse.swt.browser.Mozilla.create",
          "source": "Mozilla.java:262"
        },
        {
          "method": "org.eclipse.swt.browser.Browser.\u003cinit\u003e",
          "source": "Browser.java:99"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "174395",
      "date": "2007-02-16T01:06:57+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "blocker"
    },
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org.eclipse.swt.widgets.Display (initialization failure)",
      "elements": [
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:123"
        },
        {
          "method": "org.eclipse.hyades.test.Test.main",
          "source": "Test.java:11"
        }
      ],
      "number": 1,
      "commentIndex": 6,
      "bugId": "174395",
      "date": "2007-02-23T14:08:10+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "blocker"
    },
    {
      "exceptionType": "java.lang.UnsatisfiedLinkError",
      "message": "no swt-gtk-3327 or swt-gtk in swt.library.path, java.libary.path or the jar file",
      "elements": [
        {
          "method": "org.eclipse.swt.internal.Library.loadLibrary",
          "source": "Library.java:219"
        },
        {
          "method": "org.eclipse.swt.internal.Library.loadLibrary",
          "source": "Library.java:151"
        },
        {
          "method": "org.eclipse.swt.internal.C.\u003cclinit\u003e",
          "source": "C.java:21"
        },
        {
          "method": "java.lang.J9VMInternals.initializeImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:177"
        },
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:144"
        },
        {
          "method": "org.eclipse.swt.internal.Converter.wcsToMbcs",
          "source": "Converter.java:63"
        },
        {
          "method": "org.eclipse.swt.internal.Converter.wcsToMbcs",
          "source": "Converter.java:54"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.\u003cclinit\u003e",
          "source": "Display.java:128"
        },
        {
          "method": "java.lang.J9VMInternals.initializeImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:177"
        },
        {
          "method": "java.lang.Class.forNameImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.Class.forName",
          "source": "Class.java:127"
        },
        {
          "method": "org.eclipse.swt.graphics.Device.\u003cclinit\u003e",
          "source": "Device.java:101"
        },
        {
          "method": "java.lang.J9VMInternals.initializeImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:177"
        },
        {
          "method": "org.eclipse.hyades.test.Test.main",
          "source": "Test.java:10"
        }
      ],
      "number": 2,
      "commentIndex": 6,
      "bugId": "174395",
      "date": "2007-02-23T14:08:10+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "blocker"
    },
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "XPCOM error -2147467259",
      "elements": [
        {
          "method": "org.eclipse.swt.browser.Mozilla.error",
          "source": "Mozilla.java:1212"
        },
        {
          "method": "org.eclipse.swt.browser.Mozilla.create",
          "source": "Mozilla.java:236"
        },
        {
          "method": "org.eclipse.swt.browser.Browser.\u003cinit\u003e",
          "source": "Browser.java:109"
        },
        {
          "method": "org.eclipse.hyades.test.Test.main",
          "source": "Test.java:14"
        }
      ],
      "number": 3,
      "commentIndex": 6,
      "bugId": "174395",
      "date": "2007-02-23T14:08:10+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "blocker"
    }
  ],
  "groupId": "174395",
  "bugId": "174395",
  "date": "2007-02-16T01:06:57+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "blocker"
}