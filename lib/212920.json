{
  "comments": [
    "+++ This bug was initially created as a clone of Bug #68066 +++\n\nI have a bundle with Bundle-Version: 3.3.2.qualifier in the manifest and qualifier\u003dnone in build.properties. According to the documentation, I would think that the output should be a bundle with version 3.3.2. However, I get exceptions during the build:\n\n[eclipse.buildScript] org.osgi.framework.BundleException: invalid format\n[eclipse.buildScript] \tat org.eclipse.osgi.internal.resolver.StateBuilder.createBundleDescription(StateBuilder.java:78)\n[eclipse.buildScript] \tat org.eclipse.osgi.internal.resolver.StateObjectFactoryImpl.createBundleDescription(StateObjectFactoryImpl.java:29)\n[eclipse.buildScript] \tat org.eclipse.pde.internal.build.site.PDEState.addBundle(PDEState.java:92)\n...\n\n(I added a print statement to get that exception printed out)\n\nCloser investigation reveals that OSGi barfs when constructing a BundleDescriptor (in StateBuilder.createBundleDescriptor). When the version string is parsed, new Version(String) throws an IllegalStateException because it finds \"3.3.2.\" as the version (quotes added). The culprit appears to be the following piece of code:\n\nQualifierReplacer.replaceQualifierInVersion:\n...\n\t\t\t//\t\t\tnewQualifier \u003d \u0027.\u0027 + newQualifier;\n\t\t} else if (replaceTag.equalsIgnoreCase(PROPERTY_NONE)) {\n\t\t\tnewQualifier \u003d \"\"; //$NON-NLS-1$\n\t\t} else {\n...\n\nAs you see, we end up with an empty string qualifier rather than no qualifier at all.\n\nThe fix is to strip off the entire qualifier component in this case only."
  ],
  "commentCreationDates": [
    "2007-12-13T19:22:33+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.osgi.framework.BundleException",
      "message": "invalid format [eclipse.buildScript]",
      "elements": [
        {
          "method": "org.eclipse.osgi.internal.resolver.StateBuilder.createBundleDescription",
          "source": "StateBuilder.java:78"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "212920",
      "date": "2007-12-13T19:22:33+01:00",
      "product": "PDE",
      "component": "Build",
      "severity": "normal"
    }
  ],
  "groupId": "212920",
  "bugId": "212920",
  "date": "2007-12-13T19:22:33+01:00",
  "product": "PDE",
  "component": "Build",
  "severity": "normal"
}