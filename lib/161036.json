{
  "comments": [
    "Breakout from Bug 148025\n\nAwaiting build ID\n\nBecause modify the code?Cbirt has some incorrect behaviours.When we refresh a\nTreeViewer?Cthe select TreeItem \u0027s parent will setExpanded and sent a selection\nevent, and the select TreeItem lost focus. I don\u0027t know why. But under eclipse\n3.2?Cit runs correct.\n\nI set \"new Exception().printStackTrace( );\" at the TreeItem class at\nsetExpanded method:        \n\njava.lang.Exception\n        at org.eclipse.swt.widgets.TreeItem.setExpanded(TreeItem.java:1156)\n        at\norg.eclipse.jface.viewers.TreeViewer.setExpanded(TreeViewer.java:504)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.updateChildren(AbstractTreeViewer.java:2521)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct(AbstractTreeViewer.java:1717)\n        at\norg.eclipse.jface.viewers.TreeViewer.internalRefreshStruct(TreeViewer.java:841)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct(AbstractTreeViewer.java:1724)\n        at\norg.eclipse.jface.viewers.TreeViewer.internalRefreshStruct(TreeViewer.java:841)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh(AbstractTreeViewer.java:1692)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh(AbstractTreeViewer.java:1648)\n        at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh(AbstractTreeViewer.java:1634)\n        at\norg.eclipse.jface.viewers.StructuredViewer$7.run(StructuredViewer.java:1391)\n        at\norg.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1326)\n        at\norg.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1389)\n        at\norg.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1348)\n        at\norg.eclipse.birt.report.designer.internal.ui.views.outline.DesignerOutlinePage$9.r\n\nBy the way , the TreeViewer\u0027s every TreeItem\u0027s getData() !\u003d null , so under\neclipse 3.2,it\u0027s not need setExpanded() always.But under eclipse 3.3?Cit\u0027s not.",
    "I don\u0027t understand what the problem is.  Chao, can you please explain the steps necessary, or attach a JFace snippet with which we can reproduce the problem?",
    "*** Bug 160996 has been marked as a duplicate of this bug. ***",
    "I am seeing a similar stack as the one listed here. The user isn\u0027t actually expanding/collapsing branches in the tree, the setExpanded(false) is being called because of a viewer refresh. Eventually, TreeItem.setExpanded() is called.\n\nWhat is the following code for in TreeItem.setExpanded()?\n\n...\nint hNewItem \u003d OS.SendMessage (hWnd, OS.TVM_GETNEXTITEM, OS_TVGN_CARET, 0);\nif (hNewItem !\u003d hOldItem) {\n  Event event \u003d new Event();\n  if (hNewItem !\u003d 0) {\n    event.item \u003d parent._getItem(hNewItem);\n    parent.hAnchor \u003d hNewItem;\n  }\n  parent.sendEvent(SWT.Selection,event);\n}\n\nThis code causes my selection listener to get called when the user never actually made a selection change. However, it appears that StructuredViewer.preservingSelection() is actually going to revert the selection back to what was originally selected before the refresh. But, in this case, it will not notify my selection listener that the selection changed back again. The tree is drawn with the selection changed back to the original, however.\n\nI would prefer that my selection listener is never called in this case because the net effect is that there is no change to the selection. However, it would be better if the viewer at least fires the second selection event.\n\nI am using eclipse 3.2.1.",
    "(In reply to comment #3)\n\nChris, the code in TreeItem.setExpanded is from SWT.  Could you please open a separate bug for your problem?  I don\u0027t think what you are seeing is related to this bug.",
    "Sorry, I thought my problem was similar.\n\nI will raise the bugzilla for the SWT team.",
    "Closing since we haven\u0027t heard back from Chao."
  ],
  "commentCreationDates": [
    "2006-10-16T13:53:16+02:00",
    "2006-10-16T14:45:08+02:00",
    "2006-10-19T20:15:10+02:00",
    "2007-03-01T18:47:58+01:00",
    "2007-03-01T18:52:24+01:00",
    "2007-03-01T21:09:02+01:00",
    "2007-06-19T23:01:26+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.Exception",
      "elements": [
        {
          "method": "org.eclipse.swt.widgets.TreeItem.setExpanded",
          "source": "TreeItem.java:1156"
        },
        {
          "method": "org.eclipse.jface.viewers.TreeViewer.setExpanded",
          "source": "TreeViewer.java:504"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren",
          "source": "AbstractTreeViewer.java:2521"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct",
          "source": "AbstractTreeViewer.java:1717"
        },
        {
          "method": "org.eclipse.jface.viewers.TreeViewer.internalRefreshStruct",
          "source": "TreeViewer.java:841"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct",
          "source": "AbstractTreeViewer.java:1724"
        },
        {
          "method": "org.eclipse.jface.viewers.TreeViewer.internalRefreshStruct",
          "source": "TreeViewer.java:841"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1692"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1648"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1634"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$7.run",
          "source": "StructuredViewer.java:1391"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.preservingSelection",
          "source": "StructuredViewer.java:1326"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.refresh",
          "source": "StructuredViewer.java:1389"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.refresh",
          "source": "StructuredViewer.java:1348"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "161036",
      "date": "2006-10-16T13:53:16+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "161036",
  "bugId": "161036",
  "date": "2006-10-16T13:53:16+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}