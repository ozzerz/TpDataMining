{
  "comments": [
    "Driver:  0408I + latest from HEAD for jst.j2ee\n\nI have a J2EE project CProj containing a module c1.\n\nIn our UpdateWebXMLCommand, we try to update web.xml with the code:\n\nWebApp webapp \u003d null;\nstructEdit \u003d StructureEdit.getStructureEditForRead(webProject);;\nWorkbenchComponent wbcs[] \u003d structEdit.getWorkbenchModules();\nwebEdit \u003d WebArtifactEdit.getWebArtifactEditForWrite(wbcs[0]);\nif (webEdit !\u003d null)\n   webapp \u003d (WebApp) webEdit.getDeploymentDescriptorRoot();\n\nHowever, we are getting the error:\n\norg.eclipse.emf.ecore.resource.Resource$IOWrappedException: Resource /c1 does \nnot exist.\n    \tat org.apache.xalan.serialize.SerializerToXML.flushWriter\n(SerializerToXML.java:1505)\n    \tat org.apache.xalan.serialize.SerializerToXML.endDocument\n(SerializerToXML.java:729)\n    \tat org.apache.xalan.transformer.TransformerIdentityImpl.endDocument\n(TransformerIdentityImpl.java:910)\n    \tat org.apache.xalan.transformer.TransformerIdentityImpl.transform\n(TransformerIdentityImpl.java:331)\n    \tat \norg.eclipse.wst.common.internal.emf.resource.EMF2DOMRenderer.serializeDocument\n(EMF2DOMRenderer.java:190)\n    \tat org.eclipse.wst.common.internal.emf.resource.EMF2DOMRenderer.doSave\n(EMF2DOMRenderer.java:89)\n    \tat \norg.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.doSave\n(TranslatorResourceImpl.java:164)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.save\n(ResourceImpl.java:888)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.save\n(ResourceImpl.java:808)\n    \tat \norg.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.save\n(ReferencedXMIResourceImpl.java:276)\n    \tat \norg.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.save\n(TranslatorResourceImpl.java:152)\n    \tat \norg.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.saveIfNec\nessary(ReferencedXMIResourceImpl.java:206)\n    \tat \norg.eclipse.jst.j2ee.web.modulecore.util.WebArtifactEdit.addWebAppIfNecessary\n(WebArtifactEdit.java:365)\n    \tat \norg.eclipse.jst.j2ee.web.modulecore.util.WebArtifactEdit.getDeploymentDescriptor\nRoot(WebArtifactEdit.java:282)\n    \tat \norg.eclipse.jst.ws.internal.axis.creation.ui.command.UpdateWEBXMLCommand.addServ\nlet(UpdateWEBXMLCommand.java:126)\n    \tat \norg.eclipse.jst.ws.internal.axis.creation.ui.command.UpdateWEBXMLCommand.execute\n(UpdateWEBXMLCommand.java:57)\n\nI stepped through the WebArtifactEdit.getDeploymentDescriptorRoot() code:\n\npublic EObject getDeploymentDescriptorRoot() {\nList contents \u003d getDeploymentDescriptorResource().getContents();\nif (contents.size() \u003e 0)\n   return (EObject) contents.get(0);\naddWebAppIfNecessary((WebAppResource)getDeploymentDescriptorResource());\nreturn (EObject) contents.get(0);\n}\n\nI found that \ngetDeploymentDescriptorResource() has the value:\n\n(org.eclipse.jst.j2ee.internal.webapplication.impl.WebAppResourceImpl) \norg.eclipse.jst.j2ee.internal.webapplication.impl.WebAppResourceImplplatform:\n/resource/c1/WebContent/WEB-INF/web.xml/WEB-INF/web.xml\n\nAs you can see, the value /WEB-INF/web.xml seems to be appended too many \ntimes.  That\u0027s why we were not able to get the contents of web.xml.\n\nPlease let us know if there are other alternatives to get a handle of web.xml \nin order to edit that file.",
    "With a new workspace, getDeploymentDescriptorResource() has the correct value \nof:\n\n/resource/c1/WebContent/WEB-INF/web.xml\n \nHowever, it starts having WEB-INF/web.xml appended again when I bring down the \nworkspace and open it again.\n",
    "Fixed PlatformURLModuleConnection was not normalizing the workbench uri properly. \n\nthe following was added: \n\n  IPath deployPath \u003d new Path(deployPathSegment.path());\n\t\t\tdeployPath \u003d deployPath.makeAbsolute();\nfor (int resourceIndex \u003d 0; resourceIndex \u003c resources.length; resourceIndex++) {\n\t\t\tif(resources.length \u003d\u003d 1) {\n\t\t\t\tWorkbenchComponent comp \u003d resources[0].getComponent();\n\t\t\t\tIProject project \u003d StructureEdit.getContainingProject(comp);\n\t\t\t\tif (resources[0].getRuntimePath().equals(deployPath))\n\t\t\t\t\treturn\nURI.createPlatformResourceURI(normalizeToWorkspaceRelative(project,resources[0].getSourcePath(),aModuleResourceDeployPath).toString());\n\t\t\t\treturn URI.createPlatformResourceURI(resources[0].getRuntimePath().toString());\n\n\n\n\nand \n\n\tprivate static URI normalizeToWorkspaceRelative(IProject project, IPath\nsourcePath, URI moduleResourceDeployPath) throws UnresolveableURIException {\n\t\tString projectName \u003d project.getName();\n\t\treturn URI.createURI(projectName + \u0027/\u0027 + sourcePath.toString());\n\t\n\t\n}\n\nverified with junits.",
    "fixed in latest integration, module url was not being normalized properly. ",
    "Verified.",
    "Changed Version field given new release numbering.\n"
  ],
  "commentCreationDates": [
    "2005-04-12T21:17:28+02:00",
    "2005-04-12T23:42:30+02:00",
    "2005-04-14T22:20:50+02:00",
    "2005-04-18T17:13:41+02:00",
    "2005-04-20T22:37:30+02:00",
    "2005-06-15T07:32:55+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.emf.ecore.resource.Resource$IOWrappedException",
      "message": "Resource /c1 does  not exist.",
      "elements": [
        {
          "method": "org.apache.xalan.serialize.SerializerToXML.flushWriter",
          "source": "SerializerToXML.java:1505"
        },
        {
          "method": "org.apache.xalan.serialize.SerializerToXML.endDocument",
          "source": "SerializerToXML.java:729"
        },
        {
          "method": "org.apache.xalan.transformer.TransformerIdentityImpl.endDocument",
          "source": "TransformerIdentityImpl.java:910"
        },
        {
          "method": "org.apache.xalan.transformer.TransformerIdentityImpl.transform",
          "source": "TransformerIdentityImpl.java:331"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.EMF2DOMRenderer.serializeDocument",
          "source": "EMF2DOMRenderer.java:190"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.EMF2DOMRenderer.doSave",
          "source": "EMF2DOMRenderer.java:89"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.doSave",
          "source": "TranslatorResourceImpl.java:164"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceImpl.save",
          "source": "ResourceImpl.java:888"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceImpl.save",
          "source": "ResourceImpl.java:808"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.save",
          "source": "ReferencedXMIResourceImpl.java:276"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.save",
          "source": "TranslatorResourceImpl.java:152"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.saveIfNecessary",
          "source": "ReferencedXMIResourceImpl.java:206"
        },
        {
          "method": "org.eclipse.jst.j2ee.web.modulecore.util.WebArtifactEdit.addWebAppIfNecessary",
          "source": "WebArtifactEdit.java:365"
        },
        {
          "method": "org.eclipse.jst.j2ee.web.modulecore.util.WebArtifactEdit.getDeploymentDescriptorRoot",
          "source": "WebArtifactEdit.java:282"
        },
        {
          "method": "org.eclipse.jst.ws.internal.axis.creation.ui.command.UpdateWEBXMLCommand.addServlet",
          "source": "UpdateWEBXMLCommand.java:126"
        },
        {
          "method": "org.eclipse.jst.ws.internal.axis.creation.ui.command.UpdateWEBXMLCommand.execute",
          "source": "UpdateWEBXMLCommand.java:57"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "91187",
      "date": "2005-04-12T21:17:28+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "major"
    }
  ],
  "groupId": "91187",
  "bugId": "91187",
  "date": "2005-04-12T21:17:28+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "major"
}