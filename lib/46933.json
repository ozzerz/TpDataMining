{
  "comments": [
    "I20031119 (M5 test pass)\n\n1. have this code:\n\npublic class Test {\n\t\n\tpublic void foobar() {\n\t\tclass Listener3 {\n\t\t\tprivate Test fTest;\n\t\t\t\n\t\t\tprivate Listener3() {\n\t\t\t\tfTest\u003d new Test();\n\t\t\t}\n\t\t\t\n\t\t\tpublic int bar() {\n\t\t\t\treturn foo();\n\t\t\t}\n\t\t\t\n\t\t\tpublic int foo() {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\t\n\t\t\tprivate String getProperty() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.addListener(new Listener3() {\n\t\t\tpublic int bar() {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\tpublic void addListener(Object o) {\n\t}\n\n}\n\n2. Select the type name (\u0027Test\u0027) of field fTest in the local type\n3. Choose Refactor-\u003eGeneralize Type\n-\u003e The dialog comes up, but then an exception is thrown, stack trace of the\ninner exception (inside a runnable):\n\njava.lang.NullPointerException\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java)\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java)\n\tat java.lang.NullPointerException.\u003cinit\u003e(NullPointerException.java:60)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.ChangeTypeWizard$ChangeTypeInputPage$ValidTypesTask.run(ChangeTypeWizard.java:173)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:583)\n\tat org.eclipse.jface.window.Window.open(Window.java:563)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate(RefactoringStarter.java:56)\n\tat org.eclipse.jdt.ui.actions.ChangeTypeAction.run(ChangeTypeAction.java:75)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:196)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:172)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:842)\n\tat\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:542)\n\tat\norg.eclipse.jface.action.ActionContributionItem.access$4(ActionContributionItem.java:494)\n\tat\norg.eclipse.jface.action.ActionContributionItem$6.handleEvent(ActionContributionItem.java)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1405)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1381)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:237)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:139)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:47)\n\tat\norg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:858)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:461)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:41)\n\tat java.lang.reflect.Method.invoke(Method.java:386)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:299)\n\tat org.eclipse.core.launcher.Main.run(Main.java:767)\n\tat org.eclipse.core.launcher.Main.main(Main.java:601)",
    "Frank, can you please investigate and provide a patch. Can you outline if this \ncan happen in other cases as well.",
    "Created an attachment (id\u003d6864)\npatch to prevent NPE\n\nThis will prevent the NPE. Instead, a message will appear\nthat the type of the declaration cannot be changed.",
    "Dirk,\n\nCan you please put the patch in and resolve to FIXED?\n\n  -Frank",
    "This is not critical for M5, compared to other bugs. Will put it in when M5 is \nshipped.",
    "Created an attachment (id\u003d7153)\npatch\n\nThis patch contains fixes for the following bugs:\n  46933, 46981, 46983, 46995, 47211, 47212, 47405, 47130, and 46993",
    "Created an attachment (id\u003d7154)\npatch for the tests (contains one added unit test for Generalize Type)\n\nOne additional test for Generalize Type",
    "Fixed for M6, but opened new PR to support locals as well."
  ],
  "commentCreationDates": [
    "2003-11-19T10:42:52+01:00",
    "2003-11-19T13:52:08+01:00",
    "2003-11-19T17:18:49+01:00",
    "2003-11-19T17:21:24+01:00",
    "2003-11-19T17:45:03+01:00",
    "2003-12-15T02:20:13+01:00",
    "2003-12-15T02:21:02+01:00",
    "2003-12-15T13:45:01+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java"
        },
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java"
        },
        {
          "method": "java.lang.NullPointerException.\u003cinit\u003e",
          "source": "NullPointerException.java:60"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.ChangeTypeWizard$ChangeTypeInputPage$ValidTypesTask.run",
          "source": "ChangeTypeWizard.java:173"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:583"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:563"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate",
          "source": "RefactoringStarter.java:56"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.ChangeTypeAction.run",
          "source": "ChangeTypeAction.java:75"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:196"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:172"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:842"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:542"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$4",
          "source": "ActionContributionItem.java:494"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$6.handleEvent",
          "source": "ActionContributionItem.java"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1405"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1381"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:237"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:139"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:47"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:858"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:461"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:79"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:41"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:386"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:299"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:767"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:601"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "46933",
      "date": "2003-11-19T10:42:52+01:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "46933",
  "bugId": "46933",
  "date": "2003-11-19T10:42:52+01:00",
  "product": "JDT",
  "component": "UI",
  "severity": "normal"
}