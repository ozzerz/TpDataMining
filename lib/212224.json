{
  "comments": [
    "The attached test case reproduces the case assuming that your target junit-workspace contains a project called \"TestProject\" that has a JDK defined in its build path.  Note that the test cases that try to resolve a valid type will succeed (testString, testInteger, testBoolean), whereas ones that try non-resolvable types (including the proper name of primitives) will fail due to an exception like the one below.\n\nThis problem is new in the 1204 build.  Prior to this build (last in use was 1127) the same test case that discovered the problem worked fine.\n\nNote that the choice of the resolving type affects the failure as the problem seems to occur due to the constructor for AbstractList$ListItr.  This causes a problem with some (somewhat questionable) code in BinaryTypeConverter.convert which assumes that the args and argTypes arrays for the constructor will have the same size.  I assume that the underlying problem is deeper, however it would also seem advisable that an assertion is made on the equal size of these two arrays.\n\nI have marked this as \"major\" since it will cause us loss of functionality in cases where we need to resolve types in the affected type hierarchies.\n\n\njava.lang.ArrayIndexOutOfBoundsException\nat org.eclipse.jdt.internal.core.BinaryTypeConverter.convert(BinaryTypeConverter.java:158)\nat org.eclipse.jdt.internal.core.BinaryTypeConverter.convert(BinaryTypeConverter.java:244)\nat org.eclipse.jdt.internal.core.BinaryTypeConverter.convert(BinaryTypeConverter.java:210)\nat org.eclipse.jdt.internal.core.BinaryTypeConverter.buildTypeDeclaration(BinaryTypeConverter.java:98)\nat org.eclipse.jdt.internal.codeassist.SelectionEngine.selectType(SelectionEngine.java:1135)\nat org.eclipse.jdt.internal.core.NamedMember.resolveType(NamedMember.java:292)\nat org.eclipse.jdt.internal.core.NamedMember.resolveType(NamedMember.java:245)\nat org.eclipse.jst.jsf.common.util.TypeUtil.resolveInParents(TypeUtil.java:368)\nat org.eclipse.jst.jsf.common.util.TypeUtil.resolveTypeRelative(TypeUtil.java:293)\nat org.eclipse.jst.jsf.common.util.TypeUtil.resolveType(TypeUtil.java:62)\nat org.eclipse.jst.jsf.common.util.JDTBeanProperty.getType(JDTBeanProperty.java:115)\nat org.eclipse.jst.jsf.common.util.JDTBeanProperty.isEnumType(JDTBeanProperty.java:132)\nat org.eclipse.jst.jsf.context.symbol.internal.impl.IJavaTypeDescriptor2Impl.getPropertiesInternal(IJavaTypeDescriptor2Impl.java:595)\nat org.eclipse.jst.jsf.context.symbol.internal.impl.IJavaTypeDescriptor2Impl.getBeanProperties(IJavaTypeDescriptor2Impl.java:268)\nat org.eclipse.jst.jsf.context.symbol.internal.impl.IBeanInstanceSymbolImpl.getProperties(IBeanInstanceSymbolImpl.java:84)\nat org.eclipse.jst.jsf.context.symbol.tests.ModelBaseTestCase.populatePropertyMap(ModelBaseTestCase.java:108)\nat org.eclipse.jst.jsf.context.symbol.tests.ModelBaseTestCase.setupBeanProperty(ModelBaseTestCase.java:102)\nat org.eclipse.jst.jsf.context.symbol.tests.TestTypeCoercion.setUp(TestTypeCoercion.java:58)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:354)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:206)\nat org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)\nat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\nat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:130)\nat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3312)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2985)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2381)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2345)\nat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2211)\nat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:473)\nat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:468)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\nat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\nat org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)\nat org.eclipse.test.UITestApplication.run(UITestApplication.java:60)\nat org.eclipse.test.UITestApplication.start(UITestApplication.java:210)\nat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:362)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:175)\nat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:561)\nat org.eclipse.equinox.launcher.Main.basicRun(Main.java:501)\nat org.eclipse.equinox.launcher.Main.run(Main.java:1239)\nat org.eclipse.equinox.launcher.Main.main(Main.java:1215)",
    "Created an attachment (id\u003d84698)\nReproduces the problem.\n\n",
    "The attached test case passes for me. All tests are green and the following is in the console:\n\nclass String [in String.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nclass String [in String.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nclass Integer [in Integer.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nclass Integer [in Integer.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nclass Boolean [in Boolean.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nclass Boolean [in Boolean.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\nnull\nnull\nnull\n\nDo you have more details on how to reproduce the problem?",
    "Ah, sorry, forgot to add that I am using JDK5.\n\nFrom the debugger, the toString() value for the methodDeclaration variable is \"com.sun.jdi.InvocationException occurred invoking method.\"  Don\u0027t know if this is important.\n\n(In reply to comment #2)\n\u003e The attached test case passes for me. All tests are green and the following is\n\u003e in the console:\n\u003e class String [in String.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e class String [in String.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e class Integer [in Integer.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e class Integer [in Integer.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e class Boolean [in Boolean.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e class Boolean [in Boolean.class [in java.lang [in D:\\jdk6\\jre\\lib\\rt.jar]]]\n\u003e null\n\u003e null\n\u003e null\n\u003e Do you have more details on how to reproduce the problem?\n\n",
    "The provided test case still passes for me with JDK5. All tests are green and the following is in the console:\n\nclass String [in String.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nclass String [in String.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nclass Integer [in Integer.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nclass Integer [in Integer.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nclass Boolean [in Boolean.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nclass Boolean [in Boolean.class [in java.lang [in D:\\jdk1.5.0\\jre\\lib\\rt.jar]]]\nnull\nnull\nnull\n\n1. What version of JDK5 are you using?\n2. The trace provided in comment 0 is for TestTypeCoercion. Can you please provide the trace for the TempTestCase (provided in comment 1)?\n3. The toString() value for the methodDeclaration variable being \"com.sun.jdi.InvocationException occurred invoking method.\" just means that there is an Exception in the toString(). This can be ignored.\n\n",
    "(In reply to comment #4)\n\u003e 1. What version of JDK5 are you using?\n\njava version \"1.5.0_06\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)\nJava HotSpot(TM) Client VM (build 1.5.0_06-b05, mixed mode, sharing)\n\nThis is on Windows XP, although the original failure happened on the WTP build server which is Linux.  I just upgraded to build 1.5.0_14-b03 and the same problem occurs.\n\n\u003e 2. The trace provided in comment 0 is for TestTypeCoercion. Can you please\n\u003e provide the trace for the TempTestCase (provided in comment 1)?\n\nPlease see attachment.",
    "Created an attachment (id\u003d84998)\nStack traces copied from JUnit test failures.\n\n",
    "(In reply to comment #5)\n\u003e (In reply to comment #4)\n\u003e \u003e 1. What version of JDK5 are you using?\n\u003e \n\u003e java version \"1.5.0_06\"\n\u003e Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)\n\u003e Java HotSpot(TM) Client VM (build 1.5.0_06-b05, mixed mode, sharing)\n\u003e \nUsing this same version, tests are still green for me. Are you using a pure Eclipse build or a modified version?",
    "\u003e Using this same version, tests are still green for me. Are you using a pure\n\u003e Eclipse build or a modified version?\n\nI downloaded eclipse-SDK-I20071204-1547-win32.zip based on the dependencies listed on the WTP downloads page: http://download.eclipse.org/webtools/committers/drops/R3.0/I-I20071207063230-20071207063230/\n\nI notice this zip is no longer available (I get a 404).  AFAIK, the platform has not been modified.  I have also attached my configuration on the newest attachment.",
    "Created an attachment (id\u003d85110)\nConfiguration dump\n\n",
    "It might depend on the setup of the project that contains the JUnit test. Can you please zip the project that contains the JUnit test from comment 1 and attach it to this bug.",
    "Created an attachment (id\u003d85306)\nJunit project that reproduces the problem\n\n"
  ],
  "commentCreationDates": [
    "2007-12-07T02:33:04+01:00",
    "2007-12-07T02:34:31+01:00",
    "2007-12-07T09:39:47+01:00",
    "2007-12-07T19:06:54+01:00",
    "2007-12-11T09:57:36+01:00",
    "2007-12-11T19:23:26+01:00",
    "2007-12-11T19:24:10+01:00",
    "2007-12-12T15:36:03+01:00",
    "2007-12-12T19:37:08+01:00",
    "2007-12-12T19:37:52+01:00",
    "2007-12-13T14:24:33+01:00",
    "2007-12-14T20:04:47+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.BinaryTypeConverter.convert",
          "source": "BinaryTypeConverter.java:158"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BinaryTypeConverter.convert",
          "source": "BinaryTypeConverter.java:244"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BinaryTypeConverter.convert",
          "source": "BinaryTypeConverter.java:210"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BinaryTypeConverter.buildTypeDeclaration",
          "source": "BinaryTypeConverter.java:98"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.SelectionEngine.selectType",
          "source": "SelectionEngine.java:1135"
        },
        {
          "method": "org.eclipse.jdt.internal.core.NamedMember.resolveType",
          "source": "NamedMember.java:292"
        },
        {
          "method": "org.eclipse.jdt.internal.core.NamedMember.resolveType",
          "source": "NamedMember.java:245"
        },
        {
          "method": "org.eclipse.jst.jsf.common.util.TypeUtil.resolveInParents",
          "source": "TypeUtil.java:368"
        },
        {
          "method": "org.eclipse.jst.jsf.common.util.TypeUtil.resolveTypeRelative",
          "source": "TypeUtil.java:293"
        },
        {
          "method": "org.eclipse.jst.jsf.common.util.TypeUtil.resolveType",
          "source": "TypeUtil.java:62"
        },
        {
          "method": "org.eclipse.jst.jsf.common.util.JDTBeanProperty.getType",
          "source": "JDTBeanProperty.java:115"
        },
        {
          "method": "org.eclipse.jst.jsf.common.util.JDTBeanProperty.isEnumType",
          "source": "JDTBeanProperty.java:132"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.internal.impl.IJavaTypeDescriptor2Impl.getPropertiesInternal",
          "source": "IJavaTypeDescriptor2Impl.java:595"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.internal.impl.IJavaTypeDescriptor2Impl.getBeanProperties",
          "source": "IJavaTypeDescriptor2Impl.java:268"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.internal.impl.IBeanInstanceSymbolImpl.getProperties",
          "source": "IBeanInstanceSymbolImpl.java:84"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.tests.ModelBaseTestCase.populatePropertyMap",
          "source": "ModelBaseTestCase.java:108"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.tests.ModelBaseTestCase.setupBeanProperty",
          "source": "ModelBaseTestCase.java:102"
        },
        {
          "method": "org.eclipse.jst.jsf.context.symbol.tests.TestTypeCoercion.setUp",
          "source": "TestTypeCoercion.java:58"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:354"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:206"
        },
        {
          "method": "org.eclipse.test.UITestApplication$3.run",
          "source": "UITestApplication.java:195"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:130"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3312"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2985"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2381"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2345"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2211"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:473"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:288"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:468"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.test.UITestApplication.runApplication",
          "source": "UITestApplication.java:138"
        },
        {
          "method": "org.eclipse.test.UITestApplication.run",
          "source": "UITestApplication.java:60"
        },
        {
          "method": "org.eclipse.test.UITestApplication.start",
          "source": "UITestApplication.java:210"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:193"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:362"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:175"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:561"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:501"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1239"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1215"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "212224",
      "date": "2007-12-07T02:33:04+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "212224",
  "bugId": "212224",
  "date": "2007-12-07T02:33:04+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}