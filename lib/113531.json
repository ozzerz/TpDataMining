{
  "comments": [
    "Eclipse 3.1.1\nAJDT:   org.eclipse.aspectj_1.2.1.20050624095428\n\nThe NPE seems to occur during an incremental compilation if there is an \noutstanding error from a previous incremental compilation\n\njava.lang.NullPointerException\nat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1015)\nat org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave\n(AjCompilerAdapter.java:300)\nat org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling\n(AjCompilerAdapter.java:178)\nat \norg.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspec\ntj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)\nat org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile\n(Compiler.java:367)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation\n(AjBuildManager.java:759)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild\n(AjBuildManager.java:249)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild\n(AjBuildManager.java:158)\nat org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:117)\nat org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run\n(AspectJBuildManager.java:191)\n\nNullPointerException thrown: null\n\n1. Create the attached project\n2. Swap the commented lines in SwtThreadSafetey and incrementally compile \n(save). You will get an error\n3. Create a new aspect in the default package",
    "Created an attachment (id\u003d28680)\nTest project\n",
    "Over the fence...",
    "This bug is a duplicate of bug 112529.\n\nI was able to reproduce the NPE with AJDT 1.3.0.20051003160848, however, not\nwith AJDT 1.3.0.20051019121930. The fix went into AspectJ on 20051014, so any\nbuilds available on the AJDT download page should contain the fix.\n\nThe fix is actually to improve the exception handling, so rather than throwing\nan NPE, throw a BCException with extra info. With the most recent AspectJ, the\nexception you now get is:\n\n!ENTRY org.eclipse.ajdt.ui 4 0 2005-10-25 11:40:16.883\n!MESSAGE BCException thrown: Can\u0027t find bcel delegate for\nui.views.ViewsThreadSafety type\u003dclass org.aspectj.weaver.ReferenceType\nwhen weaving aspects \nwhen weaving \nwhen incrementally building\nBuildConfig[C:\\eclipse_installations\\aspectj\\eclipse\\runtime-workspace-20050923-testcaseInvestigation\\.metadata\\.plugins\\org.eclipse.ajdt.core\\websterm.generated.lst]\n#Files\u003d3\n\n!STACK 0\norg.aspectj.weaver.BCException: Can\u0027t find bcel delegate for\nui.views.ViewsThreadSafety type\u003dclass org.aspectj.weaver.ReferenceType\nwhen weaving aspects \nwhen weaving \nwhen incrementally building\nBuildConfig[C:\\eclipse_installations\\aspectj\\eclipse\\runtime-workspace-20050923-testcaseInvestigation\\.metadata\\.plugins\\org.eclipse.ajdt.core\\websterm.generated.lst]\n#Files\u003d3\n\n\tat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1019)\n\tat\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:300)\n\tat\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:178)\n\tat\norg.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)\n\tat\norg.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:367)\n\tat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:759)\n\tat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:249)\n\tat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild(AjBuildManager.java:158)\n\tat org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:117)\n\tat\norg.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)\n\n",
    "Created an attachment (id\u003d28752)\npatch containing failing testcase\n\nApply the patch to the tests project.\n\nThis produces an exception of the form:\n\norg.aspectj.weaver.BCException: Can\u0027t find bcel delegate for pack1.A1\ntype\u003dclass org.aspectj.weaver.ReferenceType\nwhen weaving aspects \nwhen weaving \nwhen incrementally building\nBuildConfig[C:\\eclipse_installations\\ajdt_3_1_0_development\\eclipse\\workspace-bugs20050818\\.metadata\\.plugins\\org.eclipse.ajdt.core\\test.generated.lst]\n#Files\u003d3\n\n  at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1019)\n  at\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:300)\n\n  at\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:178)\n\n  at\norg.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)\n\n  at\norg.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:367)\n\n  at\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:759)\n\n  at\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:249)\n\n  at\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild(AjBuildManager.java:158)\n\n  at\norg.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:117)\n  at\norg.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)\n",
    "excellent work Helen !  I still need to puzzle through what it means tho :(",
    "I\u0027ve checked in the test patch from Helen.  Currently commented out in\nMultiProjectIncrementalTests",
    "Right.  fix checked in.  when the compile error occurs on the intermediate\ncompile we are left with a referencetype containing an eclipse source type\n(implementation of delegate) that records the errors - if there were no errors\nit would have become a bcel delegate which can be woven.  On the third compile\nwe get hold of the reference type and ask for its bcel delegate - this return\nNULL since it doesnt have one, it still has an eclipsesourcetype delegate. \nGiven that we can only have not transformed it into a bcel delegate if there was\nan error during compilation, I\u0027m allowing the weaving process to skip weaving\nthe type for which it cant find the bcel delegate.  this works fine ;)\n\nfix checked in.\n",
    "fix available."
  ],
  "commentCreationDates": [
    "2005-10-24T15:22:16+02:00",
    "2005-10-24T15:25:28+02:00",
    "2005-10-24T15:33:00+02:00",
    "2005-10-25T16:02:01+02:00",
    "2005-10-25T16:28:32+02:00",
    "2005-10-25T17:13:18+02:00",
    "2005-11-07T11:22:36+01:00",
    "2005-11-11T18:23:00+01:00",
    "2005-11-12T18:54:22+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:1015"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompilerAdapter.java:300"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "AjCompilerAdapter.java:178"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0",
          "source": "CompilerAdapter.aj:70"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:367"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:759"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:249"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild",
          "source": "AjBuildManager.java:158"
        },
        {
          "method": "org.aspectj.ajde.internal.CompilerAdapter.compile",
          "source": "CompilerAdapter.java:117"
        },
        {
          "method": "org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run",
          "source": "AspectJBuildManager.java:191"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "113531",
      "date": "2005-10-24T15:22:16+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    },
    {
      "exceptionType": "org.aspectj.weaver.BCException",
      "message": "Can\u0027t find bcel delegate for ui.views.ViewsThreadSafety type\u003dclass org.aspectj.weaver.ReferenceType when weaving aspects  when weaving  when incrementally building BuildConfig[C:\\eclipse_installations\\aspectj\\eclipse\\runtime-workspace-20050923-testcaseInvestigation\\.metadata\\.plugins\\org.eclipse.ajdt.core\\websterm.generated.lst] #Files\u003d3",
      "elements": [
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:1019"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompilerAdapter.java:300"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "AjCompilerAdapter.java:178"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0",
          "source": "CompilerAdapter.aj:70"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:367"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:759"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:249"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild",
          "source": "AjBuildManager.java:158"
        },
        {
          "method": "org.aspectj.ajde.internal.CompilerAdapter.compile",
          "source": "CompilerAdapter.java:117"
        },
        {
          "method": "org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run",
          "source": "AspectJBuildManager.java:191"
        }
      ],
      "number": 1,
      "commentIndex": 3,
      "bugId": "113531",
      "date": "2005-10-25T16:02:01+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    },
    {
      "exceptionType": "org.aspectj.weaver.BCException",
      "message": "Can\u0027t find bcel delegate for pack1.A1 type\u003dclass org.aspectj.weaver.ReferenceType when weaving aspects  when weaving  when incrementally building BuildConfig[C:\\eclipse_installations\\ajdt_3_1_0_development\\eclipse\\workspace-bugs20050818\\.metadata\\.plugins\\org.eclipse.ajdt.core\\test.generated.lst] #Files\u003d3",
      "elements": [
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:1019"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompilerAdapter.java:300"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "AjCompilerAdapter.java:178"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0",
          "source": "CompilerAdapter.aj:70"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:367"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:759"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:249"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild",
          "source": "AjBuildManager.java:158"
        },
        {
          "method": "org.aspectj.ajde.internal.CompilerAdapter.compile",
          "source": "CompilerAdapter.java:117"
        },
        {
          "method": "org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run",
          "source": "AspectJBuildManager.java:191"
        }
      ],
      "number": 2,
      "commentIndex": 4,
      "bugId": "113531",
      "date": "2005-10-25T16:28:32+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "113531",
  "bugId": "113531",
  "date": "2005-10-24T15:22:16+02:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}