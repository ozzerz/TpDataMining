{
  "comments": [
    "Build: Oct 13/2005 14:00\n\nEver since the introduction of IAC, the workbench pops up an error message (see\nattachement) about not finding dll files when the user creates a new adapter file.\n\nFollow the instructions below to reproduce this error:\n\n- Make sure that the Agent Controller\u0027s dll files are NOT in your system path\n- Create a simple project\n- Create an adapter file under the simple project\n\nNotice the error that pops up.",
    "Created an attachment (id\u003d28319)\nError message\n",
    "Which \"adapter\" file are you talking about?",
    "Hi Ali, is this still a problem?  If so, can you explain what adapter file is\nbeing created when the error occurs?",
    "I don\u0027t use any specific adapter file.  I get the message when I create any \nadapter file (i.e. File \u003e New \u003e Other \u003e Generic Log Adapter \u003e Generic Log \nAdapter File)\n\nThe problem still exists in an Oct 18/2005 driver.",
    "I have done some debugging of this problem.  Here are my findings:\n\n1) When a new adapter file is created, a builder runs that validates the \nadapter file by calling Adapter.validate().  This results in the update method \nfor each GLA component to be executed.  The default outputter component when a \nnew adapter file is created is the CBELogOutputter.  Its update method creates \na LoggingAgent object which results in the RemoteComponentSkeleton class being \nloaded.  RemoteComponentSkeleton class has the following static code block that \ntries to load the hcjbnd native DLL:\n\nstatic {\n\tboolean nativesLoadable \u003d false;\n\tSystem.out.println(\"RemoteComponentSkeleton: Try to load native dll \nhcjbnd.\");\n\ttry {\n\t\tSystem.loadLibrary(\"hcjbnd\");\n\t\tnativesLoadable \u003d true;\n\t} catch (Throwable e) {\n\t\tSystem.out.println(\"RemoteComponentSkeleton:  Could not load \nnative dll hcjbnd.  Exception is \" + e.toString());\n\t\te.printStackTrace();\n\t}\n\tnativesAvailable \u003d nativesLoadable;\n}\n\nI added the System.out.println() calls to debug this problem.  Here is the \noutput when starting eclipse from the command line with -console and using SUN \nJDK 1.4.2_08.\n\nRemoteComponentSkeleton: Try to load native dll hcjbnd.\nRemoteComponentSkeleton:  Could not load native dll hcjbnd.  Exception is java.l\nang.UnsatisfiedLinkError: F:\\TPTP-4.1-20051024_1501\\eclipse\\plugins\\org.eclipse.\nhyades.execution_4.1.0\\os\\win32\\x86\\hcjbnd.dll: Can\u0027t find dependent libraries\njava.lang.UnsatisfiedLinkError: F:\\TPTP-4.1-20051024_1501\\eclipse\\plugins\\org.ec\nlipse.hyades.execution_4.1.0\\os\\win32\\x86\\hcjbnd.dll: Can\u0027t find dependent libra\nries\n        at java.lang.ClassLoader$NativeLibrary.load(Native Method)\n        at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1586)\n        at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1495)\n        at java.lang.Runtime.loadLibrary0(Runtime.java:788)\n        at java.lang.System.loadLibrary(System.java:834)\n        at org.eclipse.hyades.internal.execution.remote.RemoteComponentSkeleton.\n\u003cclinit\u003e(RemoteComponentSkeleton.java:100)\n        at org.eclipse.hyades.logging.core.LoggingAgent.\u003cinit\u003e(LoggingAgent.java\n:92)\n        at org.eclipse.hyades.logging.adapter.outputters.CBELogOutputter.update(\nCBELogOutputter.java:262)\n        at org.eclipse.hyades.logging.adapter.impl.Component.update(Component.ja\nva:189)\n        at org.eclipse.hyades.logging.adapter.impl.Context.update(Context.java:4\n70)\n        at org.eclipse.hyades.logging.adapter.internal.util.Controller.prepareAd\napter(Controller.java:353)\n        at org.eclipse.hyades.logging.adapter.Adapter.validate(Adapter.java:107)\n\n        at org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.buildReso\nurce(Builder.java:114)\n        at org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.access$0(\nBuilder.java:88)\n        at org.eclipse.hyades.logging.adapter.ui.internal.util.Builder$MyBuildDe\nltaVisitor.visit(Builder.java:167)\n        at org.eclipse.core.internal.events.ResourceDelta.accept(ResourceDelta.j\nava:68)\n        at org.eclipse.core.internal.events.ResourceDelta.accept(ResourceDelta.j\nava:77)\n        at org.eclipse.core.internal.events.ResourceDelta.accept(ResourceDelta.j\nava:49)\n        at org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.increment\nalBuild(Builder.java:79)\n        at org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.build(Bui\nlder.java:57)\n        at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java\n:593)\n        at org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatfo\nrm.java:1044)\n        at org.eclipse.core.runtime.Platform.run(Platform.java:783)\n        at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager\n.java:168)\n        at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager\n.java:202)\n        at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java\n:231)\n        at org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatfo\nrm.java:1044)\n        at org.eclipse.core.runtime.Platform.run(Platform.java:783)\n        at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager\n.java:234)\n        at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildMan\nager.java:253)\n        at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java\n:282)\n        at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.ja\nva:139)\n        at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:2\n00)\n        at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)\n\nThe attached error window is displayed as a result of the System.loadLibrary\n(\"hcjbnd\"); call.\n\n2) This problem does not occur on the second attempt to create a new adapter \nfile because the RemoteComponentSkeleton class has already been loaded so the \nstatic code block will not be executed again.  It is only executed the first \ntime the class is loaded.\n\n3) This problem did not occur in previous versions of TPTP.  It is happening \nnow due to the introduction of IAC and the fact the hcjbnd.dll is being found \nin the IAC plugin location: plugins\\org.eclipse.hyades.execution_4.1.0\\os\\win32\n\\x86. This is accomplished by a builtin mechanism of the eclipse plugin class \nloaders.  In previous versions, hcjbnd.dll was not found, System.loadLibrary() \nwas throwing an UnsatisfiedLinkError, and the code was handling it.  In the \ncurrent version an UnsatisfiedLinkError is being thrown but Windows is \ndisplaying the attached error window as well, indicating a dependency of \nhcjbnd.dll cannot be found.\n\n4) Upon further investigation it was determined that the System.loadLibrary() \ncall loads the dll indicated by the parameter but relies on the Windows system \nto load the dependency dlls.  However, in this case Windows cannot find the \ndependency dll hcclco.dll in the system PATH.\n\n5) A workaround for this problem is to add the IAC native dll directory to the \nsystem PATH variable before starting the eclipse.  However, this is not a good \nsolution.  One goal of IAC is to make it transparent to the user.  So asking \nthe user to add something to his system path when creating an adapter file is \nunacceptable.\n",
    "The proposed fix is to change the static code block in RemoteComponentSkeleton \nto manually load all of the dependency dll\u0027s before loading hcjbnd.dll and thus \nremoving the dependency on the local system to load the dependency jar\u0027s.",
    "This is my take on this:\n\n- This is not a blocking defect since there is a workaround.  This should be\nfixed in i3.  Hence, targetting to 4.1i3.\n\n- Ideally, creating adapter file should not involve RAC DLLs.  If this ideal\nsolution cannot be contained in i3, we would go with what Dave suggested and\nload the DLLs manually in RemoteComponentSkeleton in the reverse order of\ndependency.",
    "Even if GLA is changed so a logging agent is not created when the adapter file \nis created, the same problem will occur if the user tries to run/test their \nadapter in the GLA editor. A logging agent will be created, resulting in an \nattempt to load the native agent framework dlls. So my proposed fix or another \nsolution must still be made to fix this problem.\n\nI will open a separate bugzilla to fix the GLA.",
    "Opened bugzilla 113707 to address the GLA run-time issue.  Did not link the two \ndefects because there is no dependency.  They can be fixed independently.",
    "Reducing severity since there is a workaround",
    "Fix checked in 10/31/2005\n\nFile affected:\nRemoteComponentSkeleton.java"
  ],
  "commentCreationDates": [
    "2005-10-16T19:12:21+02:00",
    "2005-10-16T19:12:56+02:00",
    "2005-10-21T16:52:59+02:00",
    "2005-10-25T13:41:51+02:00",
    "2005-10-25T15:41:52+02:00",
    "2005-10-25T21:18:30+02:00",
    "2005-10-25T21:21:02+02:00",
    "2005-10-25T22:09:06+02:00",
    "2005-10-25T22:25:59+02:00",
    "2005-10-25T23:18:26+02:00",
    "2005-10-28T16:40:52+02:00",
    "2005-10-31T20:57:21+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.UnsatisfiedLinkError",
      "message": "F:\\TPTP-4.1-20051024_1501\\eclipse\\plugins\\org.ec lipse.hyades.execution_4.1.0\\os\\win32\\x86\\hcjbnd.dll: Can\u0027t find dependent libra ries",
      "elements": [
        {
          "method": "java.lang.ClassLoader$NativeLibrary.load",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.loadLibrary0",
          "source": "ClassLoader.java:1586"
        },
        {
          "method": "java.lang.ClassLoader.loadLibrary",
          "source": "ClassLoader.java:1495"
        },
        {
          "method": "java.lang.Runtime.loadLibrary0",
          "source": "Runtime.java:788"
        },
        {
          "method": "java.lang.System.loadLibrary",
          "source": "System.java:834"
        },
        {
          "method": "org.eclipse.hyades.internal.execution.remote.RemoteComponentSkeleton.\u003cclinit\u003e",
          "source": "RemoteComponentSkeleton.java:100"
        },
        {
          "method": "org.eclipse.hyades.logging.core.LoggingAgent.\u003cinit\u003e",
          "source": "LoggingAgent.java :92"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.outputters.CBELogOutputter.update",
          "source": " CBELogOutputter.java:262"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.impl.Component.update",
          "source": "Component.ja va:189"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.impl.Context.update",
          "source": "Context.java:4 70"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.internal.util.Controller.prepareAdapter",
          "source": "Controller.java:353"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.Adapter.validate",
          "source": "Adapter.java:107"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.buildResource",
          "source": "Builder.java:114"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.access$0",
          "source": " Builder.java:88"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.ui.internal.util.Builder$MyBuildDeltaVisitor.visit",
          "source": "Builder.java:167"
        },
        {
          "method": "org.eclipse.core.internal.events.ResourceDelta.accept",
          "source": "ResourceDelta.j ava:68"
        },
        {
          "method": "org.eclipse.core.internal.events.ResourceDelta.accept",
          "source": "ResourceDelta.j ava:77"
        },
        {
          "method": "org.eclipse.core.internal.events.ResourceDelta.accept",
          "source": "ResourceDelta.j ava:49"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.incrementalBuild",
          "source": "Builder.java:79"
        },
        {
          "method": "org.eclipse.hyades.logging.adapter.ui.internal.util.Builder.build",
          "source": "Bui lder.java:57"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java :593"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatfo rm.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager .java:168"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager .java:202"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java :231"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatfo rm.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager .java:234"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "BuildMan ager.java:253"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java :282"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.doBuild",
          "source": "AutoBuildJob.ja va:139"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.run",
          "source": "AutoBuildJob.java:2 00"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 5,
      "bugId": "112749",
      "date": "2005-10-25T21:18:30+02:00",
      "product": "TPTP Profiling",
      "component": "Platform.Execution",
      "severity": "major"
    }
  ],
  "groupId": "112749",
  "bugId": "112749",
  "date": "2005-10-16T19:12:21+02:00",
  "product": "TPTP Profiling",
  "component": "Platform.Execution",
  "severity": "major"
}