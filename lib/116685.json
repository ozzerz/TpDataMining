{
  "comments": [
    "Prevents action contributions from being executed.  This exception was created \nusing a popupMenu objectContribution extension (using DTP with its sample \nconnection profile plug-in).\n\njava.lang.ClassCastException\n     at\norg.eclipse.ui.navigator.internal.NavigatorContentService$1.compare\n(NavigatorContentService.java:669)\n     at java.util.Arrays.mergeSort(Arrays.java:1278)\n     at java.util.Arrays.sort(Arrays.java:1219)\n     at\norg.eclipse.ui.navigator.internal.NavigatorContentService.extractDescriptorInsta\nnces(NavigatorContentService.java:640)\n     at\norg.eclipse.ui.navigator.internal.NavigatorContentService.extractDescriptorInsta\nnces(NavigatorContentService.java:617)\n     at\norg.eclipse.ui.navigator.internal.NavigatorContentService.findRelevantContentExt\nensions(NavigatorContentService.java:272)\n     at\norg.eclipse.ui.navigator.internal.NavigatorActionService.addContentDescriptorMen\nu(NavigatorActionService.java:194)\n     at\norg.eclipse.ui.navigator.internal.NavigatorActionService.fillContextMenu\n(NavigatorActionService.java:159)\n     at\norg.eclipse.ui.navigator.CommonNavigatorManager.fillContextMenu\n(CommonNavigatorManager.java:158)\n     at\norg.eclipse.ui.navigator.CommonNavigatorManager$1.menuAboutToShow\n(CommonNavigatorManager.java:177)\n     at\norg.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:285)\n     at\norg.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:372)\n     at\norg.eclipse.jface.action.MenuManager.access$0(MenuManager.java:369)\n     at\norg.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:386)\n     at\norg.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:117)\n     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:896)\n     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:920)\n     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:901)\n     at\norg.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:3451)\n     at org.eclipse.swt.widgets.Control.windowProc(Control.java:3168)\n     at\norg.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1538)\n     at org.eclipse.swt.widgets.Display.windowProc(Display.java:3908)\n     at org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)\n     at org.eclipse.swt.widgets.Menu._setVisible(Menu.java:225)\n     at org.eclipse.swt.widgets.Display.runPopups(Display.java:3262)\n     at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2850)\n     at\norg.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1774)\n     at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1738)\n     at\norg.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:376)\n     at\norg.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n     at\norg.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\n     at\norg.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:226)\n     at\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n     at\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:165)\n     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     at\nsun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n     at java.lang.reflect.Method.invoke(Method.java:324)\n     at org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\n     at org.eclipse.core.launcher.Main.basicRun(Main.java:282)\n     at org.eclipse.core.launcher.Main.run(Main.java:977)\n     at org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Here\u0027s a possible patch.  Simply used the comparator in conjunction with a \nTreeSet instead of a HashSet.  Removed the sort() operation that was acting on \nthe extensions list.\n\nIndex: src-\nnavigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file: /cvsroot/eclipse/org.eclipse.ui.navigator/src-\nnavigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java,v\nretrieving revision 1.1\ndiff -u -r1.1 NavigatorContentService.java\n--- src-navigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\t13 Nov 2005 22:46:46 -0000\t1.1\n+++ src-navigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\t15 Nov 2005 23:27:56 -0000\n@@ -21,6 +21,7 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Set;\n+import java.util.TreeSet;\n import java.util.WeakHashMap;\n \n import org.eclipse.core.runtime.ISafeRunnable;\n@@ -328,7 +329,7 @@\n \t}\n \n \tprivate Set filterDescriptors(Set contentDescriptors) {\n-\t\tSet result \u003d new HashSet();\n+\t\tSet result \u003d new TreeSet(EXTENSION_COMPARATOR);\n \t\tfor (Iterator contentDescriptorsItr \u003d \ncontentDescriptors.iterator(); contentDescriptorsItr.hasNext(); ) {\n \t\t\tNavigatorContentDescriptor descriptor \u003d \n(NavigatorContentDescriptor) contentDescriptorsItr.next(); \n \t\t\tif (!exclusions.contains(descriptor.getId()))\nIndex: src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file: /cvsroot/eclipse/org.eclipse.ui.navigator/src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java,v\nretrieving revision 1.3\ndiff -u -r1.3 NavigatorContentDescriptorRegistry.java\n--- src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\t13 Nov 2005 22:46:47 -0000\t1.3\n+++ src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\t15 Nov 2005 23:27:56 -0000\n@@ -17,6 +17,7 @@\n import java.util.Iterator;\n import java.util.Map;\n import java.util.Set;\n+import java.util.TreeSet;\n \n import org.eclipse.core.runtime.IConfigurationElement;\n import org.eclipse.jface.resource.ImageDescriptor;\n@@ -132,7 +133,7 @@\n \t * @return the best content descriptor for the given element.\n \t */\n \tpublic Set getEnabledContentDescriptors(IStructuredSelection \naStructuredSelection) {\n-\t\tSet descriptors \u003d new HashSet();\n+\t\tSet descriptors \u003d new TreeSet(EXTENSION_COMPARATOR);\n \n \t\t/* Find other ContentProviders which enable for this object */\n \t\tfor (Iterator contentDescriptorsItr \u003d contentDescriptors.values\n().iterator(); contentDescriptorsItr.hasNext();) {\n",
    "Disregard the previous patch.  It does not contain the change for removing the \nsort() invocation from extractDescriptorInstances().  Here\u0027s a working patch.\n\nIndex: src-\nnavigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file: /cvsroot/eclipse/org.eclipse.ui.navigator/src-\nnavigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java,v\nretrieving revision 1.1\ndiff -u -r1.1 NavigatorContentService.java\n--- src-navigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\t13 Nov 2005 22:46:46 -0000\t1.1\n+++ src-navigator/org/eclipse/ui/navigator/internal/NavigatorContentService.java\n\t16 Nov 2005 16:53:23 -0000\n@@ -11,7 +11,6 @@\n package org.eclipse.ui.navigator.internal;\n \n import java.util.ArrayList;\n-import java.util.Arrays;\n import java.util.Collection;\n import java.util.Collections;\n import java.util.Comparator;\n@@ -21,6 +20,7 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Set;\n+import java.util.TreeSet;\n import java.util.WeakHashMap;\n \n import org.eclipse.core.runtime.ISafeRunnable;\n@@ -328,7 +328,7 @@\n \t}\n \n \tprivate Set filterDescriptors(Set contentDescriptors) {\n-\t\tSet result \u003d new HashSet();\n+\t\tSet result \u003d new TreeSet(EXTENSION_COMPARATOR);\n \t\tfor (Iterator contentDescriptorsItr \u003d \ncontentDescriptors.iterator(); contentDescriptorsItr.hasNext(); ) {\n \t\t\tNavigatorContentDescriptor descriptor \u003d \n(NavigatorContentDescriptor) contentDescriptorsItr.next(); \n \t\t\tif (!exclusions.contains(descriptor.getId()))\n@@ -637,7 +637,6 @@\n \t\t\t}\n \t\t}\n \t\tNavigatorContentExtension[] extensions \u003d \n(NavigatorContentExtension[]) resultInstances.toArray(new \nNavigatorContentExtension[resultInstances.size()]);\n-\t\tArrays.sort(extensions, EXTENSION_COMPARATOR);\n \t\treturn extensions;\n \t}\n \nIndex: src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file: /cvsroot/eclipse/org.eclipse.ui.navigator/src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java,v\nretrieving revision 1.3\ndiff -u -r1.3 NavigatorContentDescriptorRegistry.java\n--- src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\t13 Nov 2005 22:46:47 -0000\t1.3\n+++ src-\nnavigator/org/eclipse/ui/navigator/internal/extensions/NavigatorContentDescripto\nrRegistry.java\t16 Nov 2005 16:53:23 -0000\n@@ -17,6 +17,7 @@\n import java.util.Iterator;\n import java.util.Map;\n import java.util.Set;\n+import java.util.TreeSet;\n \n import org.eclipse.core.runtime.IConfigurationElement;\n import org.eclipse.jface.resource.ImageDescriptor;\n@@ -132,7 +133,7 @@\n \t * @return the best content descriptor for the given element.\n \t */\n \tpublic Set getEnabledContentDescriptors(IStructuredSelection \naStructuredSelection) {\n-\t\tSet descriptors \u003d new HashSet();\n+\t\tSet descriptors \u003d new TreeSet(EXTENSION_COMPARATOR);\n \n \t\t/* Find other ContentProviders which enable for this object */\n \t\tfor (Iterator contentDescriptorsItr \u003d contentDescriptors.values\n().iterator(); contentDescriptorsItr.hasNext();) {\n",
    "\nFixed.",
    "\n\nThe context menu and its actions are working fine in the Experimental Resource Navigator, so they should be working in any DTP case as well. \n\nVerified in 20051213_0100."
  ],
  "commentCreationDates": [
    "2005-11-16T16:32:00+01:00",
    "2005-11-16T16:35:05+01:00",
    "2005-11-16T16:55:26+01:00",
    "2005-11-28T02:13:23+01:00",
    "2005-12-13T22:12:05+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "elements": [
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorContentService$1.compare",
          "source": "NavigatorContentService.java:669"
        },
        {
          "method": "java.util.Arrays.mergeSort",
          "source": "Arrays.java:1278"
        },
        {
          "method": "java.util.Arrays.sort",
          "source": "Arrays.java:1219"
        },
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorContentService.extractDescriptorInstances",
          "source": "NavigatorContentService.java:640"
        },
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorContentService.extractDescriptorInstances",
          "source": "NavigatorContentService.java:617"
        },
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorContentService.findRelevantContentExtensions",
          "source": "NavigatorContentService.java:272"
        },
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorActionService.addContentDescriptorMenu",
          "source": "NavigatorActionService.java:194"
        },
        {
          "method": "org.eclipse.ui.navigator.internal.NavigatorActionService.fillContextMenu",
          "source": "NavigatorActionService.java:159"
        },
        {
          "method": "org.eclipse.ui.navigator.CommonNavigatorManager.fillContextMenu",
          "source": "CommonNavigatorManager.java:158"
        },
        {
          "method": "org.eclipse.ui.navigator.CommonNavigatorManager$1.menuAboutToShow",
          "source": "CommonNavigatorManager.java:177"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.fireAboutToShow",
          "source": "MenuManager.java:285"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.handleAboutToShow",
          "source": "MenuManager.java:372"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.access$0",
          "source": "MenuManager.java:369"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager$2.menuShown",
          "source": "MenuManager.java:386"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:117"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:896"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:920"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:901"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP",
          "source": "Control.java:3451"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3168"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1538"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3908"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.TrackPopupMenu",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Menu._setVisible",
          "source": "Menu.java:225"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runPopups",
          "source": "Display.java:3262"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2850"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1774"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1738"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:376"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:165"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "116685",
      "date": "2005-11-16T16:32:00+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "116685",
  "bugId": "116685",
  "date": "2005-11-16T16:32:00+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}