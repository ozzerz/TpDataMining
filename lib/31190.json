{
  "comments": [
    "Bug entered as per advice from NE.\n\nWhile running the automated JUnit plugin tests for JDT UI for linux motif, the \nfollowing stack trace was in the log after an error dialog opened:\n\n\n!SESSION Feb 06, 2003 18:22:41.223 --------------------------------------------\n- \njava.fullversion\u003dJ2RE 1.3.1 IBM build cxia32131-20021102 (JIT enabled: jitc) \nBootLoader constants: OS\u003dlinux, ARCH\u003dx86, WS\u003dmotif, NL\u003den_US \nCommand-line arguments: -dev bin -data /builds/integration/I-I20030206-\n200302061700_test/eclipse-testing/test-eclipse/eclipse/jdt_folder \nformatter\u003dorg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter,\norg.eclipse.jdt.ui.tests.AutomatedSuite.xml -testPluginName \norg.eclipse.jdt.ui.tests -className org.eclipse.jdt.ui.tests.AutomatedSuite -\nnoupdate -os linux -ws motif -arch x86 -install file:/builds/integration/I-\nI20030206-200302061700_test/eclipse-testing/test-eclipse/eclipse/ \n!ENTRY org.eclipse.ui.workbench 4 2 Feb 06, 2003 18:22:41.224 \n!MESSAGE Problems occurred when invoking code from plug-\nin: \"org.eclipse.ui.workbench\". \n!STACK 0 \norg.eclipse.jface.util.Assert$AssertionFailedException: null argument; \n        at org.eclipse.jface.util.Assert.isNotNull(Assert.java(Inlined \nCompiled Code)) \n        at org.eclipse.jface.util.Assert.isNotNull(Assert.java(Inlined \nCompiled Code)) \n        at org.eclipse.jface.viewers.StructuredViewer.update\n(StructuredViewer.java(Compiled Code)) \n        at org.eclipse.jface.viewers.StructuredViewer.update\n(StructuredViewer.java(Compiled Code)) \n        at \norg.eclipse.jface.viewers.StructuredViewer.handleLabelProviderChanged\n(StructuredViewer.java(Compiled Code)) \n        at org.eclipse.jface.viewers.ContentViewer$1.labelProviderChanged\n(ContentViewer.java(Compiled Code)) \n        at org.eclipse.ui.internal.decorators.DecorationScheduler$1.run\n(DecorationScheduler.java(Compiled Code)) \n        at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages\n(Synchronizer.java(Compiled Code))",
    "The problem did not reoccur after rebooting the test machine.",
    "This looks like a race condition in DecorationScheduler.\nThe decorator thread calls pendingUpdate.add, but the asyncExec in decorated() \ndoes pendingUpdate.toArray(new Object[pendingUpdate.size()]);\nSince pendingUpdate is not synchronized, it\u0027s possible for ArrayList.add to be \nin the middle of its work when size() is called.  If it increments its size \nbefore adding the element, the element will be null.\n\nEither that or DecorationReference.getReference() returned a null.\nShould have asserts in its constructors to ensure this can\u0027t happen.\n\n\n",
    "pendingUpdate should have been a Collections.synchonizedList (just like the \nresultCache which is a Collections.synchonizedMap).\n\nWe have an explicit check for null values already in the DecorationScheduler\n(decorateWithText and decorateWithOverlays) so the DecorationReference would \nnever be given null values.\n\nI think all we need to do is to change the pendingUpdate list to a \nsynchonizedList - I will verify this with Nick today and release once we are \nallowed to again.",
    "Fixed in build \u003e20030310",
    "Marking as closed."
  ],
  "commentCreationDates": [
    "2003-02-07T01:38:34+01:00",
    "2003-02-07T01:42:10+01:00",
    "2003-02-07T02:23:13+01:00",
    "2003-02-07T13:47:25+01:00",
    "2003-02-10T15:41:55+01:00",
    "2005-05-10T20:54:03+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.jface.util.Assert$AssertionFailedException",
      "message": "null argument;",
      "elements": [
        {
          "method": "org.eclipse.jface.util.Assert.isNotNull",
          "source": "Assert.java(Inlined  Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.util.Assert.isNotNull",
          "source": "Assert.java(Inlined  Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.update",
          "source": "StructuredViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.update",
          "source": "StructuredViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.handleLabelProviderChanged",
          "source": "StructuredViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.ContentViewer$1.labelProviderChanged",
          "source": "ContentViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.DecorationScheduler$1.run",
          "source": "DecorationScheduler.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java(Compiled Code)"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "31190",
      "date": "2003-02-07T01:38:34+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "31190",
  "bugId": "31190",
  "date": "2003-02-07T01:38:34+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}