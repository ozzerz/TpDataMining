{
  "comments": [
    "Build 20020326\n\nThe implementation of DocumentAdapter#close() prevents it from ever being \nclosed (logic on null check against fDocument is wrong).\n\nTherefore, such buffers will leak in the JavaModel buffer manager.",
    "Another problem behind this one is that #close is nullifying the listeners \nslot, and therefore IBuffer#removeBufferChangedListener cannot be called\nfrom thereon by the infrastructure when noticing the buffer being closed (this \nis a recent change post 20020326).\n\njava.lang.NullPointerException\n\tat \norg.eclipse.jdt.internal.ui.javaeditor.DocumentAdapter.removeBufferChangedListen\ner(DocumentAdapter.java:167)\n\tat org.eclipse.jdt.internal.core.Openable.closeBuffer(Openable.java:83)\n\tat org.eclipse.jdt.internal.core.Openable.closing(Openable.java:91)\n\tat org.eclipse.jdt.internal.core.JavaElement.close(JavaElement.java:106)\n\tat org.eclipse.jdt.internal.core.WorkingCopy.destroy\n(WorkingCopy.java:80)\n\tat \norg.eclipse.jdt.internal.ui.javaeditor.CompilationUnitDocumentProvider.disposeEl\nementInfo(CompilationUnitDocumentProvider.java:224)\n\tat org.eclipse.ui.texteditor.AbstractDocumentProvider.disconnect\n(AbstractDocumentProvider.java:273)\n\tat org.eclipse.ui.texteditor.AbstractTextEditor.dispose\n(AbstractTextEditor.java:1422)\n\tat org.eclipse.jdt.internal.ui.javaeditor.CompilationUnitEditor.dispose\n(CompilationUnitEditor.java:933)\n\tat org.eclipse.ui.internal.WorkbenchPage.closeEditor\n(WorkbenchPage.java:422)\n\tat org.eclipse.ui.internal.EditorPane.doHide(EditorPane.java:76)\n\tat org.eclipse.ui.internal.EditorWorkbook$1.itemClosed\n(EditorWorkbook.java:122)\n\tat org.eclipse.swt.custom.CTabFolder.closeNotify(CTabFolder.java:303)\n\tat org.eclipse.swt.custom.CTabFolder.access$12(CTabFolder.java:293)\n\tat org.eclipse.swt.custom.CTabFolder$4.handleEvent(CTabFolder.java:424)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:75)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:637)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1420)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1208)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:722)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:705)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:777)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:319)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:14)\nUnhandled exception caught in event loop.\nReason:\njava.lang.NullPointerException",
    "Fixed bug in implementation of close. Don\u0027t set listeners list to null in order \nto allow post-close listener operations. This is different from the java doc of \nclose. Pls specify which methods can be called  after close and what happens if \none of the other methods is called. Moving to JDT core.",
    "Running with \"closable\" buffers, I see the following problem when hovering over \nidentifiers. The problem seems that the buffer has been closed, but the calling \ncode does not check this.  Rolling back the change for stability.\n\nThread [main] (Suspended (exception java.lang.NullPointerException))\n\torg.eclipse.jdt.internal.ui.javaeditor.DocumentAdapter.getLength() \nline: 233\n\torg.eclipse.jdt.internal.core.WorkingCopy\n(org.eclipse.jdt.internal.core.Openable).codeSelect\n(org.eclipse.jdt.internal.compiler.env.ICompilationUnit, int, int, \norg.eclipse.jdt.internal.codeassist.ISelectionRequestor) line: 132\n\torg.eclipse.jdt.internal.core.WorkingCopy\n(org.eclipse.jdt.internal.core.Openable).codeSelect\n(org.eclipse.jdt.internal.compiler.env.ICompilationUnit, int, int) line: 121\n\torg.eclipse.jdt.internal.core.WorkingCopy\n(org.eclipse.jdt.internal.core.CompilationUnit).codeSelect(int, int) line: 100\n\torg.eclipse.jdt.internal.ui.text.java.hover.JavaTypeHover.getHoverInfo\n(org.eclipse.jface.text.ITextViewer, org.eclipse.jface.text.IRegion) line: 93\n\torg.eclipse.jdt.internal.ui.text.java.hover.JavaTextHover.getHoverInfo\n(org.eclipse.jface.text.ITextViewer, org.eclipse.jface.text.IRegion) line: 300\n\torg.eclipse.jface.text.TextViewerHoverManager.computeInformation() \nline: 56\n\torg.eclipse.jface.text.TextViewerHoverManager\n(org.eclipse.jface.text.AbstractInformationControlManager).showInformation() \nline: 536\n\torg.eclipse.jface.text.AbstractHoverInformationControlManager$MouseTrack\ner.mouseHover(org.eclipse.swt.events.MouseEvent) line: 233\n\torg.eclipse.swt.widgets.TypedListener.handleEvent\n(org.eclipse.swt.widgets.Event) line: 207\n\torg.eclipse.swt.widgets.EventTable.sendEvent\n(org.eclipse.swt.widgets.Event) line: 75\n\torg.eclipse.swt.custom.StyledText\n(org.eclipse.swt.widgets.Widget).notifyListeners(int, \norg.eclipse.swt.widgets.Event) line: 637\n\torg.eclipse.swt.widgets.Display.runDeferredEvents() line: 1420\n\torg.eclipse.swt.widgets.Display.readAndDispatch() line: 1208\n\torg.eclipse.ui.internal.Workbench.runEventLoop() line: 755\n\torg.eclipse.ui.internal.Workbench.run(java.lang.Object) line: 738\n\torg.eclipse.core.internal.boot.InternalBootLoader.run(java.lang.String, \njava.net.URL, java.lang.String, java.lang.String[]) line: 777\n\torg.eclipse.core.boot.BootLoader.run(java.lang.String, java.net.URL, \njava.lang.String, java.lang.String[]) line: 319\n\tEclipseRuntimeLauncher.main(java.lang.String[]) line: 14\n",
    "How did this buffer get closed in the first place ?",
    "Kai, do you know why the buffer was closed?",
    "Didn\u0027t check.",
    "Do you plan to check?",
    "Moving to JDT/UI to get attention.",
    "Closing is done by the buffer manager of JCore.",
    "If the buffer doesn\u0027t have unsaved changes, then it is legite for it to be \nclosed  by the buffer management (when needing space).\n\nNote that we found an inconsistency in the buffer management which could have \nlead to requesting twice to close the same buffer. Please double check your \nbehavior with integration build 20020416 where we will have released this fix.\n\n",
    "We actually found an inconsistency in our buffer manager (could keep the buffer \nin, though it wanted to close it). From thereon, it would not have reopened the \nbuffer, but rather reused closed one thus factory did not get involved.\n\nFixed"
  ],
  "commentCreationDates": [
    "2002-03-27T15:47:02+01:00",
    "2002-03-27T16:06:20+01:00",
    "2002-04-02T14:03:23+02:00",
    "2002-04-02T14:24:26+02:00",
    "2002-04-02T18:15:43+02:00",
    "2002-04-05T14:11:56+02:00",
    "2002-04-05T14:20:27+02:00",
    "2002-04-05T14:40:07+02:00",
    "2002-04-08T12:47:03+02:00",
    "2002-04-11T10:01:42+02:00",
    "2002-04-15T18:34:36+02:00",
    "2002-04-17T17:28:09+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.ui.javaeditor.DocumentAdapter.removeBufferChangedListener",
          "source": "DocumentAdapter.java:167"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.closeBuffer",
          "source": "Openable.java:83"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.closing",
          "source": "Openable.java:91"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaElement.close",
          "source": "JavaElement.java:106"
        },
        {
          "method": "org.eclipse.jdt.internal.core.WorkingCopy.destroy",
          "source": "WorkingCopy.java:80"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.javaeditor.CompilationUnitDocumentProvider.disposeElementInfo",
          "source": "CompilationUnitDocumentProvider.java:224"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractDocumentProvider.disconnect",
          "source": "AbstractDocumentProvider.java:273"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.dispose",
          "source": "AbstractTextEditor.java:1422"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.javaeditor.CompilationUnitEditor.dispose",
          "source": "CompilationUnitEditor.java:933"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditor",
          "source": "WorkbenchPage.java:422"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.doHide",
          "source": "EditorPane.java:76"
        },
        {
          "method": "org.eclipse.ui.internal.EditorWorkbook$1.itemClosed",
          "source": "EditorWorkbook.java:122"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.closeNotify",
          "source": "CTabFolder.java:303"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.access$12",
          "source": "CTabFolder.java:293"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$4.handleEvent",
          "source": "CTabFolder.java:424"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:75"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:637"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1420"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1208"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:722"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:705"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:777"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:319"
        },
        {
          "method": "EclipseRuntimeLauncher.main",
          "source": "EclipseRuntimeLauncher.java:14"
        }
      ],
      "number": 0,
      "commentIndex": 1,
      "bugId": "12353",
      "date": "2002-03-27T16:06:20+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "12353",
  "bugId": "12353",
  "date": "2002-03-27T15:47:02+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}