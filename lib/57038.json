{
  "comments": [
    "o The XML Schema on which the SDO is based on defines an element with an \n(optional) \u003cxs:attribute name\u003d\"subordinates\" type\u003d\"xs:IDREFS\"/\u003e\no Setting the attribute via DataObject.setList(\"subordinates\", list) (where \nlist is an ArrayList containing a single String) works just fine (and the \ndumped SDO shows that the attribute has been added successfully)\no However, if change history logging (via DataGraph.getChangeSummary\n().beginLogging()) is turned on before the attribute is inserted, a NPE occurs:\n\njava.lang.NullPointerException\n\tat \norg.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertIDREFSBaseToString\n(XMLTypeFactoryImpl.java:1160)\n\tat \norg.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertToString\n(XMLTypeFactoryImpl.java:263)\n\tat \norg.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertIDREFSToString\n(XMLTypeFactoryImpl.java:1187)\n\tat \norg.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertToString\n(XMLTypeFactoryImpl.java:261)\n\tat org.eclipse.emf.ecore.util.EcoreUtil.convertToString\n(EcoreUtil.java:1989)\n\tat org.eclipse.emf.ecore.change.impl.FeatureChangeImpl.setValue\n(FeatureChangeImpl.java:411)\n\tat org.eclipse.emf.ecore.change.impl.FeatureChangeImpl.\u003cinit\u003e\n(FeatureChangeImpl.java:117)\n\tat org.eclipse.emf.ecore.sdo.impl.EChangeSummarySettingImpl.\u003cinit\u003e\n(EChangeSummarySettingImpl.java:76)\n\tat \norg.eclipse.emf.ecore.sdo.impl.SDOFactoryImpl.createEChangeSummarySetting\n(SDOFactoryImpl.java:183)\n\tat \norg.eclipse.emf.ecore.sdo.impl.EChangeSummaryImpl$SDOChangeRecorder.createFeatur\neChange(EChangeSummaryImpl.java:203)\n\tat org.eclipse.emf.ecore.change.util.ChangeRecorder.handleFeature\n(ChangeRecorder.java:212)\n\tat org.eclipse.emf.ecore.change.util.ChangeRecorder.notifyChanged\n(ChangeRecorder.java:158)\n\tat org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify\n(BasicNotifierImpl.java:225)\n\tat \norg.eclipse.emf.ecore.impl.EStructuralFeatureImpl$InternalSettingDelegateSingleD\nata.dynamicSet(EStructuralFeatureImpl.java:1786)\n\tat org.eclipse.emf.ecore.impl.BasicEObjectImpl.eDynamicSet\n(BasicEObjectImpl.java:519)\n\tat org.eclipse.emf.ecore.impl.BasicEObjectImpl.eSet\n(BasicEObjectImpl.java:503)\n\tat org.eclipse.emf.ecore.sdo.util.SDOUtil.set(SDOUtil.java:891)\n\tat org.eclipse.emf.ecore.sdo.util.SDOUtil.set(SDOUtil.java:110)\n\tat org.eclipse.emf.ecore.sdo.util.SDOUtil.setList(SDOUtil.java:296)\n\tat org.eclipse.emf.ecore.sdo.impl.EDataObjectImpl.setList\n(EDataObjectImpl.java:508)\n\tat test.ChangeHistory.main(ChangeHistory.java:30)\n\nThe reason seems to be that when an attribute isnt updated but _created_, the \nSDOChangeRecorder tries to create a FeatureChange for the old attribute value \n(which is null), but the XMLTypeFactory isnt prepared to convert a \u0027null\u0027 \nIDREFS attribute to a String. If the NPE is caught and the SDO is dumped \nafterwards, it shows that the attribute was inserted and even the \n\u003cchangeSummary\u003e is populated (I dont know if it carries the correct \ninformation, however)\n\nEMF Service Data Objects (SDO) \nVersion: 2.0.0\nBuild id: 200403250631",
    "Fixes have been commited to CVS.",
    "*** Bug 57149 has been marked as a duplicate of this bug. ***",
    "The fix is available in the I200404080557 build."
  ],
  "commentCreationDates": [
    "2004-04-01T15:18:17+02:00",
    "2004-04-01T19:03:59+02:00",
    "2004-04-02T00:21:41+02:00",
    "2004-04-08T13:34:28+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertIDREFSBaseToString",
          "source": "XMLTypeFactoryImpl.java:1160"
        },
        {
          "method": "org.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertToString",
          "source": "XMLTypeFactoryImpl.java:263"
        },
        {
          "method": "org.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertIDREFSToString",
          "source": "XMLTypeFactoryImpl.java:1187"
        },
        {
          "method": "org.eclipse.emf.ecore.xml.type.impl.XMLTypeFactoryImpl.convertToString",
          "source": "XMLTypeFactoryImpl.java:261"
        },
        {
          "method": "org.eclipse.emf.ecore.util.EcoreUtil.convertToString",
          "source": "EcoreUtil.java:1989"
        },
        {
          "method": "org.eclipse.emf.ecore.change.impl.FeatureChangeImpl.setValue",
          "source": "FeatureChangeImpl.java:411"
        },
        {
          "method": "org.eclipse.emf.ecore.change.impl.FeatureChangeImpl.\u003cinit\u003e",
          "source": "FeatureChangeImpl.java:117"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.impl.EChangeSummarySettingImpl.\u003cinit\u003e",
          "source": "EChangeSummarySettingImpl.java:76"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.impl.SDOFactoryImpl.createEChangeSummarySetting",
          "source": "SDOFactoryImpl.java:183"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.impl.EChangeSummaryImpl$SDOChangeRecorder.createFeatureChange",
          "source": "EChangeSummaryImpl.java:203"
        },
        {
          "method": "org.eclipse.emf.ecore.change.util.ChangeRecorder.handleFeature",
          "source": "ChangeRecorder.java:212"
        },
        {
          "method": "org.eclipse.emf.ecore.change.util.ChangeRecorder.notifyChanged",
          "source": "ChangeRecorder.java:158"
        },
        {
          "method": "org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify",
          "source": "BasicNotifierImpl.java:225"
        },
        {
          "method": "org.eclipse.emf.ecore.impl.EStructuralFeatureImpl$InternalSettingDelegateSingleData.dynamicSet",
          "source": "EStructuralFeatureImpl.java:1786"
        },
        {
          "method": "org.eclipse.emf.ecore.impl.BasicEObjectImpl.eDynamicSet",
          "source": "BasicEObjectImpl.java:519"
        },
        {
          "method": "org.eclipse.emf.ecore.impl.BasicEObjectImpl.eSet",
          "source": "BasicEObjectImpl.java:503"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.util.SDOUtil.set",
          "source": "SDOUtil.java:891"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.util.SDOUtil.set",
          "source": "SDOUtil.java:110"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.util.SDOUtil.setList",
          "source": "SDOUtil.java:296"
        },
        {
          "method": "org.eclipse.emf.ecore.sdo.impl.EDataObjectImpl.setList",
          "source": "EDataObjectImpl.java:508"
        },
        {
          "method": "test.ChangeHistory.main",
          "source": "ChangeHistory.java:30"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "57038",
      "date": "2004-04-01T15:18:17+02:00",
      "product": "EMF",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "57038",
  "bugId": "57038",
  "date": "2004-04-01T15:18:17+02:00",
  "product": "EMF",
  "component": "Core",
  "severity": "normal"
}