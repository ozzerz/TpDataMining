{
  "comments": [
    "I have my own editors.  In order to support the File -\u003e open file scenario where I\u0027m passed a FileStoreEditorInput object, I wrote my own implementation of IFile so that I could transform the FileStoreEditorInput to an IFile.  This way at some level all of the various inputs/selections of a file (File-\u003eopen file, double click in the navigator, or right-click -\u003e open with would use the same piece of code to display the file).  All these scenarios work, including File -\u003e open file, but in this scenario i get the following exception from the eclipse platform and I\u0027m not sure why...\n\nMy implementation of getAdapter on my implementaiton of IFile returns \"this\".\n\n!ENTRY org.eclipse.ui.workbench 4 2 2007-12-03 17:41:23.140\n!MESSAGE Problems occurred when invoking code from plug-in: \"org.eclipse.ui.workbench\".\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.core.internal.runtime.AdapterManager.getAdapter(AdapterManager.java:274)\n\tat org.eclipse.ui.actions.SelectionListenerAction.computeResources(SelectionListenerAction.java:143)\n\tat org.eclipse.ui.actions.SelectionListenerAction.getSelectedResources(SelectionListenerAction.java:227)\n\tat org.eclipse.ui.actions.BuildAction.getProjectsToBuild(BuildAction.java:151)\n\tat org.eclipse.ui.actions.BuildAction.updateSelection(BuildAction.java:300)\n\tat org.eclipse.ui.actions.BaseSelectionListenerAction.selectionChanged(BaseSelectionListenerAction.java:124)\n\tat org.eclipse.ui.actions.BuildAction.isEnabled(BuildAction.java:204)\n\tat org.eclipse.ui.actions.RetargetAction.setActionHandler(RetargetAction.java:272)\n\tat org.eclipse.ui.internal.ide.actions.RetargetActionWithDefault.setActionHandler(RetargetActionWithDefault.java:47)\n\tat org.eclipse.ui.actions.RetargetAction.partActivated(RetargetAction.java:154)\n\tat org.eclipse.ui.internal.PartListenerList$1.run(PartListenerList.java:72)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:857)\n\tat org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)\n\tat org.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:70)\n\tat org.eclipse.ui.internal.PartService.firePartActivated(PartService.java:73)\n\tat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:171)\n\tat org.eclipse.ui.internal.WWinPartService.updateActivePart(WWinPartService.java:124)\n\tat org.eclipse.ui.internal.WWinPartService.access$0(WWinPartService.java:115)\n\tat org.eclipse.ui.internal.WWinPartService$1.partDeactivated(WWinPartService.java:48)\n\tat org.eclipse.ui.internal.PartListenerList2$4.run(PartListenerList2.java:113)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:857)\n\tat org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:53)\n\tat org.eclipse.ui.internal.PartListenerList2.firePartDeactivated(PartListenerList2.java:111)\n\tat org.eclipse.ui.internal.PartService.firePartDeactivated(PartService.java:116)\n\tat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:165)\n\tat org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged(WorkbenchPagePartList.java:56)\n\tat org.eclipse.ui.internal.PartList.setActivePart(PartList.java:126)\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3402)\n\tat org.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:611)\n\tat org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2748)\n\tat org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2651)\n\tat org.eclipse.ui.internal.WorkbenchPage.access$13(WorkbenchPage.java:2643)\n\tat org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2595)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n\tat org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2590)\n\tat org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2574)\n\tat org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2557)\n\tat org.eclipse.ui.ide.IDE.openEditorOnFileStore(IDE.java:1090)\n\tat org.eclipse.ui.internal.ide.actions.OpenLocalFileAction.run(OpenLocalFileAction.java:105)\n\tat org.eclipse.ui.internal.ide.actions.OpenLocalFileAction.run(OpenLocalFileAction.java:75)\n\tat org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:256)\n\tat org.eclipse.ui.internal.WWinPluginAction.runWithEvent(WWinPluginAction.java:229)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:546)\n\tat org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:490)\n\tat org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:402)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3682)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3293)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\n\tat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n\tat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n\tat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)\n\tat org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)\n\tat org.eclipse.equinox.launcher.Main.run(Main.java:1173)\n\tat org.eclipse.equinox.launcher.Main.main(Main.java:1148)",
    "FYI: From the javadoc for IFile\n\n\u003cp\u003e\n * This interface is not intended to be implemented by clients.\n * \u003c/p\u003e\n",
    "The exception happens in the following code of AdapterManager:\n\n\tpublic Object getAdapter(Object adaptable, Class adapterType) {\n\t\tIAdapterFactory factory \u003d (IAdapterFactory) getFactories(adaptable.getClass()).get(adapterType.getName());\n\t\t....\n\t}\n\nThe getFactories() always returns non-null Map so exception is likely to be caused by one of the arguments passed into this methos (Object adaptable OR Class adapterType) being null.\n\n\nGoing up the stack: the call to getAdapter() is in SelectionListenerAction:\n\nResourceMapping mapping \u003d (ResourceMapping) adapterManager.getAdapter(next, ResourceMapping.class);\n\nWhich means that likely variable \"next\" was null.\n\n",
    "(In reply to comment #2)\n\n\u003e Going up the stack: the call to getAdapter() is in SelectionListenerAction:\n\u003e ResourceMapping mapping \u003d (ResourceMapping) adapterManager.getAdapter(next,\n\u003e ResourceMapping.class);\n\u003e Which means that likely variable \"next\" was null.\n\nYep, this s what I see in the debugger. next is null, next is populated from some variable called selection (which is empty in this case)\n\n(In reply to comment #1)\n\u003e FYI: From the javadoc for IFile\n\u003e \u003cp\u003e\n\u003e  * This interface is not intended to be implemented by clients.\n\u003e  * \u003c/p\u003e\n\n\nYikes I didn\u0027t see this.  The reason for me doing this is that we wrote the editors based on it using the IFile to load/save the current file in use.  Our Editor input is based on IFileEditorInput from which you call getFile returning IFile.  We ran into the case where File -\u003e Open File returned FileEditorStoreInput which has no ability to get an IFile - so hence I wrote a wrapper to encapsulate the FileEditorStoreInput as an IFile so we don\u0027t have to change the rest of the underlying code.  After saying all that, if there is a more proper way of handling FileEditorStoreInput or getting an IFile from FileEditorStoreInput please let me know :)",
    "Adding Dani as he can give the best advice on editor inputs.\n\nOleg I am not sure why you moved this back - AdapterManager is a core runtime component.",
    "The exception happens because IAdapterManager#getAdapter(Object adaptable, Class adapterType) gets a null \"adaptable\" argument. The null is not a valid argument.\n",
    "Should there be some null checks in the platform code to protect against this case?",
    "The best route is to not use your own IFile.\n\nIf you get an FileStoreEditorInput you can get back to the IFile using the URI.\n\nfor instance:\n\ngetFile(FileStoreEditorInput  myFile){\n\n   URI uri \u003d myFile.getURI();\n   if (uri \u003d\u003d null)\n      return null;\n   return EFS.getFileStore(uri);\n}\n\nand the store should give you what you need.\n\nI think you are getting the FileStoreEditorInput because you have a file that cannot be represented as an IFile.\n\nI\u0027ll add John as he is the EFS author.",
    "(In reply to comment #7)\n\u003e The best route is to not use your own IFile.\n\u003e If you get an FileStoreEditorInput you can get back to the IFile using the URI.\n\u003e for instance:\n\u003e getFile(FileStoreEditorInput  myFile){\n\u003e    URI uri \u003d myFile.getURI();\n\u003e    if (uri \u003d\u003d null)\n\u003e       return null;\n\u003e    return EFS.getFileStore(uri);\n\u003e }\n\u003e and the store should give you what you need.\n\nEFS.getFileStore returns an IFileStore, which unfortunately doesn\u0027t implement IFile or doesn\u0027t have any methods that returns an IFile.  I\u0027ll wait to hear from John on this one.\n\n\n\u003e I think you are getting the FileStoreEditorInput because you have a file that\n\u003e cannot be represented as an IFile.\n\u003e I\u0027ll add John as he is the EFS author.\n\n\nReason I\u0027m getting an FileStoreEditorInput is because I\u0027m opening a file using File -\u003e Open File and that file is outside the workspace (say on my desktop).   If I open a file thats already in my workspace then I get IFileEditorInput which is just fine to work with (it has a getFile() method tha gets me an IFile).",
    "IFile only represents files inside the workspace. You can\u0027t get an IFile for a file that is not in the workspace. Having said that, you shouldn\u0027t need an IFile in order to get your editor working. As far as I know, the editor framework can handle IFileStore/FileStoreEditorInput and doesn\u0027t need an IFile.",
    "\u003eAs far as I know, the editor\n\u003eframework can handle IFileStore/FileStoreEditorInput and doesn\u0027t need an IFile.\nIt does for textual editors. Not sure whether this is used here. If not you can make your editor to only work with FileStoreEditorInput but you cannot convert something outside the workspace into an IFile. Rather you convert an IFile to IFileStore if the file is in the workspace or use the local EFS support to get the IFileStore if it is outside.\n\n\n"
  ],
  "commentCreationDates": [
    "2007-12-04T07:10:24+01:00",
    "2007-12-04T14:18:07+01:00",
    "2007-12-04T14:46:42+01:00",
    "2007-12-04T14:59:02+01:00",
    "2007-12-04T21:24:37+01:00",
    "2007-12-04T21:52:14+01:00",
    "2007-12-04T22:33:47+01:00",
    "2007-12-05T13:12:17+01:00",
    "2007-12-05T14:31:01+01:00",
    "2007-12-05T14:43:12+01:00",
    "2007-12-05T16:20:35+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.core.internal.runtime.AdapterManager.getAdapter",
          "source": "AdapterManager.java:274"
        },
        {
          "method": "org.eclipse.ui.actions.SelectionListenerAction.computeResources",
          "source": "SelectionListenerAction.java:143"
        },
        {
          "method": "org.eclipse.ui.actions.SelectionListenerAction.getSelectedResources",
          "source": "SelectionListenerAction.java:227"
        },
        {
          "method": "org.eclipse.ui.actions.BuildAction.getProjectsToBuild",
          "source": "BuildAction.java:151"
        },
        {
          "method": "org.eclipse.ui.actions.BuildAction.updateSelection",
          "source": "BuildAction.java:300"
        },
        {
          "method": "org.eclipse.ui.actions.BaseSelectionListenerAction.selectionChanged",
          "source": "BaseSelectionListenerAction.java:124"
        },
        {
          "method": "org.eclipse.ui.actions.BuildAction.isEnabled",
          "source": "BuildAction.java:204"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction.setActionHandler",
          "source": "RetargetAction.java:272"
        },
        {
          "method": "org.eclipse.ui.internal.ide.actions.RetargetActionWithDefault.setActionHandler",
          "source": "RetargetActionWithDefault.java:47"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction.partActivated",
          "source": "RetargetAction.java:154"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$1.run",
          "source": "PartListenerList.java:72"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.fireEvent",
          "source": "PartListenerList.java:57"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartActivated",
          "source": "PartListenerList.java:70"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartActivated",
          "source": "PartService.java:73"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:171"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.updateActivePart",
          "source": "WWinPartService.java:124"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:115"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partDeactivated",
          "source": "WWinPartService.java:48"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$4.run",
          "source": "PartListenerList2.java:113"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.fireEvent",
          "source": "PartListenerList2.java:53"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartDeactivated",
          "source": "PartListenerList2.java:111"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartDeactivated",
          "source": "PartService.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:165"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged",
          "source": "WorkbenchPagePartList.java:56"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.setActivePart",
          "source": "PartList.java:126"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:3402"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.activate",
          "source": "WorkbenchPage.java:611"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched",
          "source": "WorkbenchPage.java:2748"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor",
          "source": "WorkbenchPage.java:2651"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.access$13",
          "source": "WorkbenchPage.java:2643"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage$10.run",
          "source": "WorkbenchPage.java:2595"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.openEditor",
          "source": "WorkbenchPage.java:2590"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.openEditor",
          "source": "WorkbenchPage.java:2574"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.openEditor",
          "source": "WorkbenchPage.java:2557"
        },
        {
          "method": "org.eclipse.ui.ide.IDE.openEditorOnFileStore",
          "source": "IDE.java:1090"
        },
        {
          "method": "org.eclipse.ui.internal.ide.actions.OpenLocalFileAction.run",
          "source": "OpenLocalFileAction.java:105"
        },
        {
          "method": "org.eclipse.ui.internal.ide.actions.OpenLocalFileAction.run",
          "source": "OpenLocalFileAction.java:75"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:256"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPluginAction.runWithEvent",
          "source": "WWinPluginAction.java:229"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:546"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:490"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:402"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3682"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3293"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:169"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:79"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:618"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:508"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:447"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1173"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1148"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "211840",
      "date": "2007-12-04T07:10:24+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "211840",
  "bugId": "211840",
  "date": "2007-12-04T07:10:24+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}