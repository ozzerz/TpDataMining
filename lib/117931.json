{
  "comments": [
    "Publishing an ear that contains a web and and ejb module (with an client jar) fails to assemble generating the following stack trace  (1.0M9)\n\nTested with WLS9, an JOnAS\n---\n\njava.util.zip.ZipException: duplicate entry: META-INF/\nat java.util.zip.ZipOutputStream.putNextEntry(Unknown Source)\nat org.eclipse.jst.server.generic.core.internal.publishers.ModulePackager.writeFolder(ModulePackager.java:90)\nat org.eclipse.jst.server.generic.core.internal.publishers.AbstractModuleAssembler.doPackModule(AbstractModuleAssembler.java:108)\nat org.eclipse.jst.server.generic.core.internal.publishers.AbstractModuleAssembler.packModule(AbstractModuleAssembler.java:70)\nat org.eclipse.jst.server.generic.core.internal.publishers.EarModuleAssembler.assemble(EarModuleAssembler.java:33)\nat org.eclipse.jst.server.generic.core.internal.publishers.AntPublisher.assembleModule(AntPublisher.java:103)\nat org.eclipse.jst.server.generic.core.internal.publishers.AntPublisher.publish(AntPublisher.java:90)\nat org.eclipse.jst.server.generic.core.internal.GenericServerBehaviour.publishModule(GenericServerBehaviour.java:90)\nat org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publishModule(ServerBehaviourDelegate.java:643)\nat org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publishModules(ServerBehaviourDelegate.java:698)\nat org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish(ServerBehaviourDelegate.java:588)\nat org.eclipse.wst.server.core.internal.Server.doPublish(Server.java:704)\nat org.eclipse.wst.server.core.internal.Server.publish(Server.java:693)\nat org.eclipse.wst.server.core.internal.PublishServerJob.run(PublishServerJob.java:145)\nat org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)",
    "Changing severeity to major.  Cannot test an era with two modules",
    "*** Bug 117729 has been marked as a duplicate of this bug. ***",
    "*** Bug 117662 has been marked as a duplicate of this bug. ***",
    "I have released a fix regarding directories in my part but it looks like this is just part of the problem. J2EEFlexProjDeployable.members() is returning the META-INF/MANIFEST.MF twice, I have experienced this with ejb modules and utility modules that has two source folders, but the problem occurs if there META-INF/MANIFEST.MF exists in the project. The workaround is to remove META-INF/MANIFEST.MF from the project.\n\nSending over to j2ee team.",
    "*** Bug 118221 has been marked as a duplicate of this bug. ***",
    "*** Bug 117904 has been marked as a duplicate of this bug. ***",
    "This is fixed for the 1130 WTP committer integration driver.  This was a regression in the deployable.\n\nTim,  I had to go ahead and make some changes to the getMembers() method you created on J2EEFlexProjDeployable.  For one, it was returning duplicates for module folders so I added a check to find the existing module folder before creating a new one.  Also, it was returning .java and .class files for EJB projects, so I added a filter for the .java\u0027s.  This should be able to go away in 1.5 when we switch the virtual comp API from using the src in the mapping to using the output in the map.\n\nThanks.",
    "John - Have you seen 117956 and 118357? We have to be careful because if the duplicate entries were due to bug 117956, then filtering out duplicates at this level could mean that if two source folders have the same folder name but different contents, the second source folder is ignored and never published.\n\nAlso, while a filter is a nice improvement shouldn\u0027t we just be publishing whatever is in the user\u0027s output folder? I almost think that if they have a single source/output folder for Java resources we should publish both .class and .java, and if they want to do it cleanly they can have separate source and output folders. After all, local testing with a single folder would be running against both regardless of what we publish.",
    "Hey Tim,\n\nYes, 117956 is related, but not always.  I fixed the 117956 by removing all source containers from the underlying folders returned from getResourceFolders() and relying on the java output for those folders.  However, the duplicate issue still exists in the sense that a user could have two folders called META-INF in seperate  folders which were mapped to \"/\" in the .components file.  It was this case where two seperate folders were being created.  So, the change I made did not do any filtering of content, it simply recovered the exisiting module folder and added its new children to the existing children.  This way we dont end up with two seperate META-INF folders with different or duplicate children.\n\nAlso, this fix for 117956 resolves the .java issue by ignoring source folders and only looking at output folders.\n\n118357 seems like a seperate issue.\n\nDoes that sound acceptable?  Feel free to grab a look at the code and try some examples.\n\nThanks.",
    "OK"
  ],
  "commentCreationDates": [
    "2005-11-24T17:38:55+01:00",
    "2005-11-24T17:39:59+01:00",
    "2005-11-24T19:46:01+01:00",
    "2005-11-26T15:32:30+01:00",
    "2005-11-26T16:08:22+01:00",
    "2005-11-28T13:32:30+01:00",
    "2005-11-28T13:32:53+01:00",
    "2005-11-29T19:22:08+01:00",
    "2005-11-29T19:37:51+01:00",
    "2005-11-29T20:21:06+01:00",
    "2006-06-20T15:36:55+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.util.zip.ZipException",
      "message": "duplicate entry: META-INF/",
      "elements": [
        {
          "method": "java.util.zip.ZipOutputStream.putNextEntry",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.ModulePackager.writeFolder",
          "source": "ModulePackager.java:90"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.AbstractModuleAssembler.doPackModule",
          "source": "AbstractModuleAssembler.java:108"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.AbstractModuleAssembler.packModule",
          "source": "AbstractModuleAssembler.java:70"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.EarModuleAssembler.assemble",
          "source": "EarModuleAssembler.java:33"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.AntPublisher.assembleModule",
          "source": "AntPublisher.java:103"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.publishers.AntPublisher.publish",
          "source": "AntPublisher.java:90"
        },
        {
          "method": "org.eclipse.jst.server.generic.core.internal.GenericServerBehaviour.publishModule",
          "source": "GenericServerBehaviour.java:90"
        },
        {
          "method": "org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publishModule",
          "source": "ServerBehaviourDelegate.java:643"
        },
        {
          "method": "org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publishModules",
          "source": "ServerBehaviourDelegate.java:698"
        },
        {
          "method": "org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish",
          "source": "ServerBehaviourDelegate.java:588"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.doPublish",
          "source": "Server.java:704"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.publish",
          "source": "Server.java:693"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.PublishServerJob.run",
          "source": "PublishServerJob.java:145"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "117931",
      "date": "2005-11-24T17:38:55+01:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "major"
    }
  ],
  "groupId": "117931",
  "bugId": "117931",
  "date": "2005-11-24T17:38:55+01:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "major"
}