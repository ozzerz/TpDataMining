{
  "comments": [
    "In latest code (0313), if a package fragment contains an empty file with the extension .java, we \nmight have a NPE when trying to move this package fragment. The guilty code is in \norg.eclipse.jdt.internal.core.CopyResourceElementsOperation.processPackageFragmentResource(org.eclipse.jdt.core.IPackageFragment, \norg.eclipse.jdt.core.IPackageFragmentRoot, java.lang.String)\n\nOn the line:\nString \ncuContents \u003d org.eclipse.jdt.internal.core.Util.normalizeCRs(domCU.getContents(), \nbufferContents);\n\nthere is no check to find out that domCU.getContents() can return null. If \nthe source file used to create the DOMCompilation unit is empty, getContents() will return null. \nWe simply need a null check in this case.",
    "Please produce a test case, and a fix.",
    "I added a new empty compilation unit creation in CreateCompilationUnitAndPackageTests. Then \nwithout the fix, I got this stack trace running the \nJavaModelTests.\nava.lang.NullPointerException\n\tat \norg.eclipse.jdt.internal.core.Util.normalizeCRs(Util.java:614)\n\tat \norg.eclipse.jdt.internal.core.CopyResourceElementsOperation.processPackageFragmentResource(CopyResourceElementsOperation.java:370)\n\tat \norg.eclipse.jdt.internal.core.CopyResourceElementsOperation.processElement(CopyResourceElementsOperation.java:285)\n\tat \norg.eclipse.jdt.internal.core.MultiOperation.processElements(MultiOperation.java:182)\n\tat \norg.eclipse.jdt.internal.core.CopyResourceElementsOperation.processElements(CopyResourceElementsOperation.java:299)\n\tat \norg.eclipse.jdt.internal.core.MultiOperation.executeOperation(MultiOperation.java:86)\n\tat \norg.eclipse.jdt.internal.core.JavaModelOperation.execute(JavaModelOperation.java:268)\n\tat \norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:476)\n\tat \norg.eclipse.core.internal.resources.Workspace.run(Workspace.java:1292)\n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.runOperation(JavaModelManager.java:1074)\n\tat \norg.eclipse.jdt.internal.core.JavaElement.runOperation(JavaElement.java:533)\n\tat \norg.eclipse.jdt.internal.core.JavaModel.rename(JavaModel.java:422)\n\tat \norg.eclipse.jdt.internal.core.PackageFragment.rename(PackageFragment.java:289)\n\tat \norg.eclipse.jdt.tests.core.RenameTests.testRenamePFWithSubPackages(RenameTests.java:661)\n\tat \nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat \nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat \nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat \njunit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n\tat \njunit.extensions.TestSetup$1.protect(TestSetup.java:19)\n\tat \njunit.extensions.TestSetup.run(TestSetup.java:23)\n\tat \njunit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n\tat \njunit.extensions.TestSetup$1.protect(TestSetup.java:19)\n\tat \njunit.extensions.TestSetup.run(TestSetup.java:23)\n\nThe fix simply consists in \nchecking the value of the domCU.getContents(). With the fix the NPE is gone.",
    "Fixed and released in HEAD.",
    "Fixed."
  ],
  "commentCreationDates": [
    "2002-03-13T18:22:46+01:00",
    "2002-03-14T10:44:20+01:00",
    "2002-03-16T00:40:13+01:00",
    "2002-03-16T00:48:12+01:00",
    "2002-03-16T00:48:21+01:00"
  ],
  "traces": [
    {
      "exceptionType": "ava.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.Util.normalizeCRs",
          "source": "Util.java:614"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CopyResourceElementsOperation.processPackageFragmentResource",
          "source": "CopyResourceElementsOperation.java:370"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CopyResourceElementsOperation.processElement",
          "source": "CopyResourceElementsOperation.java:285"
        },
        {
          "method": "org.eclipse.jdt.internal.core.MultiOperation.processElements",
          "source": "MultiOperation.java:182"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CopyResourceElementsOperation.processElements",
          "source": "CopyResourceElementsOperation.java:299"
        },
        {
          "method": "org.eclipse.jdt.internal.core.MultiOperation.executeOperation",
          "source": "MultiOperation.java:86"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.execute",
          "source": "JavaModelOperation.java:268"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:476"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1292"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.runOperation",
          "source": "JavaModelManager.java:1074"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaElement.runOperation",
          "source": "JavaElement.java:533"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModel.rename",
          "source": "JavaModel.java:422"
        },
        {
          "method": "org.eclipse.jdt.internal.core.PackageFragment.rename",
          "source": "PackageFragment.java:289"
        },
        {
          "method": "org.eclipse.jdt.tests.core.RenameTests.testRenamePFWithSubPackages",
          "source": "RenameTests.java:661"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:22"
        },
        {
          "method": "junit.extensions.TestSetup$1.protect",
          "source": "TestSetup.java:19"
        },
        {
          "method": "junit.extensions.TestSetup.run",
          "source": "TestSetup.java:23"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:22"
        },
        {
          "method": "junit.extensions.TestSetup$1.protect",
          "source": "TestSetup.java:19"
        },
        {
          "method": "junit.extensions.TestSetup.run",
          "source": "TestSetup.java:23"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "11285",
      "date": "2002-03-16T00:40:13+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "11285",
  "bugId": "11285",
  "date": "2002-03-13T18:22:46+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}