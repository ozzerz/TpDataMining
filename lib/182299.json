{
  "comments": [
    "Build ID: M20070212-1330\n\nSteps To Reproduce:\n1. generate an *.execution file containing an exception stacktrace which contains `\u003c\u0027 character.\n2. run tptp.publication ant task on the *.execution file (so far I\u0027ve tried this only with tptp.publication.service set to `org.eclipse.tptp.test.report.birt.publish-tabular-testsuites\u0027 )\n3. You should get an exception similar to the following:\nException in thread \"Thread-8\" java.lang.RuntimeException: org.xml.sax.SAXParseException: The content of elements must consist of well-formed character data or markup.\nat org.eclipse.birt.report.data.oda.xml.util.SaxParser.run(SaxParser.java:136)\nat java.lang.Thread.run(Thread.java:595)\nCaused by: org.xml.sax.SAXParseException: The content of elements must consist of well-formed character data or markup.\nat org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)\nat org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)\nat org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\nat org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\nat org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)\nat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\nat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\nat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\nat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\nat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\nat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\nat org.eclipse.birt.report.data.oda.xml.util.SaxParser.run(SaxParser.java:102)\n... 1 more\n\nMore information:\nIt seems that org.eclipse.tptp.test.report.birt.internal.TPFExecutionResultSerializer\ndoes not convert sensitive characters (`\u003c\u0027, `\u003e\u0027, `\"\u0027, `\u0026\u0027) into corresponding XML entities when generating inline text and/or attribute values.\n\nThe following patch solves the problem for me:\nIndex: src/org/eclipse/tptp/test/report/birt/internal/TPFExecutionResultSerializer.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file: /cvsroot/tptp/test/org.eclipse.tptp.test.report.birt/src/org/eclipse/tptp/test/report/birt/internal/TPFExecutionResultSerializer.java,v\nretrieving revision 1.6\ndiff -u -r1.6 TPFExecutionResultSerializer.java\n--- src/org/eclipse/tptp/test/report/birt/internal/TPFExecutionResultSerializer.java\t6 Mar 2007 18:08:34 -0000\t1.6\n+++ src/org/eclipse/tptp/test/report/birt/internal/TPFExecutionResultSerializer.java\t21 Mar 2007 17:22:37 -0000\n@@ -101,9 +101,9 @@\n        \t\t\t\tString message \u003d event.getText();\n        \t\t\t\tif (message !\u003d null){\n            \t\t\t\tbuffer.append(\"\u003ctext\u003e\"); //$NON-NLS-1$\n-           \t\t\t\tbuffer.append(event.getText());\n+           \t\t\t\tbuffer.append(getTextStr(message));\n            \t\t\t\tbuffer.append(\"\u003c/text\u003e\"); //$NON-NLS-1$\n-       \t\t\t\t}           \t\t\t\t\n+       \t\t\t\t}\n        \t\t\t\tbuffer.append(\"\u003c/verdictEvent\u003e\"); //$NON-NLS-1$\n        \t\t\t}\n    \t\t\t\telse if (verdictEvent instanceof TPFInvocationEvent)\n@@ -116,8 +116,24 @@\n    \t\t\t\t}\n             }\n \t}\t\n-\t\n+\n+\tprotected String getTextStr(String text){\n+\t\tif(text !\u003d null) {\n+\t\t\ttext \u003d text.replaceAll(\"\u0026\", \"\u0026amp;\");\n+\t\t\ttext \u003d text.replaceAll(\"\u003c\", \"\u0026lt;\");\n+\t\t\ttext \u003d text.replaceAll(\"\u003e\", \"\u0026gt;\");\n+\t\t} else\n+\t\t\ttext \u003d \"\";\n+\n+\t\treturn text;\n+\t}\n+\n \tprotected String getAttributeStr(String attr, String value){\n+\t\tif(value !\u003d null)\n+\t\t\tvalue \u003d value.replaceAll(\"\\\"\", \"\u0026quot;\");\n+\t\telse\n+\t\t\tvalue \u003d \"\";\n+\n \t\treturn attr +\"\u003d\\\"\"+value+\"\\\" \"; //$NON-NLS-1$ //$NON-NLS-2$\n \t}",
    "Reassign to Sheldon since he is the maintainer of the Birt Report component",
    "Sheldon, can you provide a sizing?",
    "Reviewed the patch and tested it. ",
    "Reporter: Please verify and close in preparation for shutting down the TPTP 4.4 release.  Thanks."
  ],
  "commentCreationDates": [
    "2007-04-13T12:54:22+02:00",
    "2007-04-13T14:25:47+02:00",
    "2007-04-16T18:17:36+02:00",
    "2007-04-16T19:09:43+02:00",
    "2007-06-02T20:52:04+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.xml.sax.SAXParseException",
      "message": "The content of elements must consist of well-formed character data or markup.",
      "elements": [
        {
          "method": "org.eclipse.birt.report.data.oda.xml.util.SaxParser.run",
          "source": "SaxParser.java:136"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:595"
        }
      ],
      "causedBy": {
        "exceptionType": "org.xml.sax.SAXParseException",
        "message": "The content of elements must consist of well-formed character data or markup.",
        "elements": [
          {
            "method": "org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.util.ErrorHandlerWrapper.fatalError",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.impl.XMLErrorReporter.reportError",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.impl.XMLErrorReporter.reportError",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.impl.XMLScanner.reportFatalError",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.parsers.XML11Configuration.parse",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.parsers.XML11Configuration.parse",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.parsers.XMLParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "org.apache.xerces.parsers.AbstractSAXParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "org.eclipse.birt.report.data.oda.xml.util.SaxParser.run",
            "source": "SaxParser.java:102"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 0,
      "bugId": "182299",
      "date": "2007-04-13T12:54:22+02:00",
      "product": "TPTP Testing",
      "component": "Test.UI.Reporting",
      "severity": "major"
    }
  ],
  "groupId": "182299",
  "bugId": "182299",
  "date": "2007-04-13T12:54:22+02:00",
  "product": "TPTP Testing",
  "component": "Test.UI.Reporting",
  "severity": "major"
}