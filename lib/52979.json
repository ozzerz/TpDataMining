{
  "comments": [
    "JDK 1.5 introduced some changes in some of the core classes. In particular \njava.lang.StringBuffer was given a superclass of \njava.lang.AbstractStringBuilder. Code compiled with the javasoft 1.5 compiler \ndoes run in earlier versions of the VM. If you build the classes using the \neclipse compiler, there seems to be a built in hook to the superclass. Thus \nthe classes won\u0027t run in earlier versions of the vm. A ClassNotFoundException \nfor java.lang.AbstractStringBuilder is thrown.",
    "Please provide steps to reproduce. Also to be a fair comparison, you should try \nto achieve the result with javac 1.4, as the Eclipse compiler you are using is \na 1.4 compiler (moving to 1.5, but not yet there).",
    "Install the latest 1.5 beta\nSet Eclipse to use the 1.5 JRE in the installed JREs\nALso set it to use the 1.4.2_02 jre (which 1.4 version shouldn\u0027t matter)\n\nCreate the following file in Eclipse\npublic class StringBufferTest\n{\n\t\n\tpublic static void main(String[] args)\n\t{\n\t\tStringBuffer a \u003d new StringBuffer();\n\t\ta.append(\"This is a test\");\n\t\tSystem.out.println(a.toString());\n\t\tSystem.exit(0);\n\t}\n}\nBuild and run it.\nNow switch the runtime VM to 1.4 in the run... dialog.\nRe run without rebuilding\nIt fails.\n\nBelow is the output of my sessions outside eclipse from this point on. As you \ncan see before rebuilding it fails. After rebuilding it works. Note that I did \nhave to use the -target 1.4 switch on the compiler but Eclipse doesn\u0027t have \nsuch a switch to my knowledge.\n\nC:\\eclipse\\workspace\\test\u003edir\n Volume in drive C is WXP\n Volume Serial Number is 08E8-C1C4\n\n Directory of C:\\eclipse\\workspace\\test\n\n02/24/2004  04:05 PM    \u003cDIR\u003e          .\n02/24/2004  04:05 PM    \u003cDIR\u003e          ..\n02/24/2004  03:57 PM               226 .classpath\n02/24/2004  03:57 PM               380 .project\n02/24/2004  04:05 PM               804 StringBufferTest.class\n02/24/2004  03:58 PM               552 StringBufferTest.java\n               4 File(s)          1,962 bytes\n               2 Dir(s)   1,767,754,752 bytes free\n\nC:\\eclipse\\workspace\\test\u003ejava -classpath . StringBufferTest\nThis is a test\n\nC:\\eclipse\\workspace\\test\u003ejava -version\njava version \"1.5.0-beta\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0-beta-b32c)\nJava HotSpot(TM) Client VM (build 1.5.0-beta-b32c, mixed mode)\n\nC:\\eclipse\\workspace\\test\u003e\"c:\\Program Files\\java\\j2re1.4.2_02\\bin\\java\" -\nclasspa\nth . StringBufferTest\nException in thread \"main\" java.lang.NoSuchMethodError: \njava.lang.StringBuffer.a\nppend(Ljava/lang/String;)Ljava/lang/AbstractStringBuilder;\n        at StringBufferTest.main(StringBufferTest.java:19)\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.5.0\\bin\\javac -classpath . \nStringBufferTest.ja\nva\n\nC:\\eclipse\\workspace\\test\u003ejava -classpath . StringBufferTest\nThis is a test\n\nC:\\eclipse\\workspace\\test\u003e\"c:\\Program Files\\java\\j2re1.4.2_02\\bin\\java\" -\nclasspa\nth . StringBufferTest\nException in thread \"main\" java.lang.UnsupportedClassVersionError: \nStringBufferT\nest (Unsupported major.minor version 49.0)\n        at java.lang.ClassLoader.defineClass0(Native Method)\n        at java.lang.ClassLoader.defineClass(Unknown Source)\n        at java.security.SecureClassLoader.defineClass(Unknown Source)\n        at java.net.URLClassLoader.defineClass(Unknown Source)\n        at java.net.URLClassLoader.access$100(Unknown Source)\n        at java.net.URLClassLoader$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.5.0\\bin\\javac -target 1.4 -classpath . \nStringB\nufferTest.java\n\nC:\\eclipse\\workspace\\test\u003e\"c:\\Program Files\\java\\j2re1.4.2_02\\bin\\java\" -\nclasspa\nth . StringBufferTest\nThis is a test\n\nC:\\eclipse\\workspace\\test\u003ejava -classpath . StringBufferTest\nThis is a test\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.4.2_02\\bin\\javac -classpath . \nStringBufferTest\n.java\nThe system cannot find the path specified.\n\nC:\\eclipse\\workspace\\test\u003ec:\\j2sdk1.4.2_02\\bin\\javac -classpath . \nStringBufferTe\nst.java\n\nC:\\eclipse\\workspace\\test\u003ejava -classpath . StringBufferTest\nThis is a test\n\nC:\\eclipse\\workspace\\test\u003e\"c:\\Program Files\\java\\j2re1.4.2_02\\bin\\java\" -\nclasspa\nth . StringBufferTest\nThis is a test\n",
    "Note that in your script, it shows that when using javac 1.4 you did compile \nagainst 1.4 libraries (by default).",
    "Yes, but when I compiled against 1.5, I ran against 1.4 libraries with no \nproblem (using the javasoft compiler)",
    "Understood, but your point was to use a 1.4 compiler to compile against JDK1.5 \nand then run against 1.4. \nJavac doesn\u0027t support it, as it refuses to compile against more recent \nlibraries.\n\nWe may still have an obvious issue leading us to misbehave, will investigate.\n",
    "I recompiled the classes, first with Eclipse and then with jdk 1.5. I dumped \nout each class and Eclipse has compiled in the return type differently.\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.5.0\\bin\\javap -classpath . -c \nStringBufferTest\nCompiled from \"StringBufferTest.java\"\npublic class StringBufferTest extends java.lang.Object{\npublic StringBufferTest();\n  Code:\n   0:   aload_0\n   1:   invokespecial   #9; //Method java/lang/Object.\"\u003cinit\u003e\":()V\n   4:   return\n\npublic static void main(java.lang.String[]);\n  Code:\n   0:   new     #17; //class java/lang/StringBuffer\n   3:   dup\n   4:   invokespecial   #18; //Method java/lang/StringBuffer.\"\u003cinit\u003e\":()V\n   7:   astore_1\n   8:   aload_1\n   9:   ldc     #20; //String This is a test\n   11:  invokevirtual   #24; //Method java/lang/StringBuffer.append:\n(Ljava/lang/\nString;)Ljava/lang/AbstractStringBuilder;\n   14:  pop\n   15:  getstatic       #30; //Field java/lang/System.out:Ljava/io/PrintStream;\n   18:  aload_1\n   19:  invokevirtual   #34; //Method java/lang/StringBuffer.toString:()\nLjava/la\nng/String;\n   22:  invokevirtual   #40; //Method java/io/PrintStream.println:\n(Ljava/lang/St\nring;)V\n   25:  iconst_0\n   26:  invokestatic    #44; //Method java/lang/System.exit:(I)V\n   29:  return\n\n}\n\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.5.0\\bin\\javac -target 1.4 -classpath . \nStringBufferTest.ja\nva\n\nC:\\eclipse\\workspace\\test\u003ec:\\jdk1.5.0\\bin\\javap -classpath . -c \nStringBufferTest\nCompiled from \"StringBufferTest.java\"\npublic class StringBufferTestextends java.lang.Object{\npublic StringBufferTest();\n  Code:\n   0:   aload_0\n   1:   invokespecial   #1; //Method java/lang/Object.\"\u003cinit\u003e\":()V\n   4:   return\n\npublic static void main(java.lang.String[]);\n  Code:\n   0:   new     #2; //class java/lang/StringBuffer\n   3:   dup\n   4:   invokespecial   #3; //Method java/lang/StringBuffer.\"\u003cinit\u003e\":()V\n   7:   astore_1\n   8:   aload_1\n   9:   ldc     #4; //String This is a test\n   11:  invokevirtual   #5; //Method java/lang/StringBuffer.append:\n(Ljava/lang/S\ntring;)Ljava/lang/StringBuffer;\n   14:  pop\n   15:  getstatic       #6; //Field java/lang/System.out:Ljava/io/PrintStream;\n   18:  aload_1\n   19:  invokevirtual   #7; //Method java/lang/StringBuffer.toString:()\nLjava/lan\ng/String;\n   22:  invokevirtual   #8; //Method java/io/PrintStream.println:\n(Ljava/lang/Str\ning;)V\n   25:  iconst_0\n   26:  invokestatic    #9; //Method java/lang/System.exit:(I)V\n   29:  return\n\n}\n",
    "Works fine now in latest, dup of bug 51353\n\n*** This bug has been marked as a duplicate of 51353 ***"
  ],
  "commentCreationDates": [
    "2004-02-24T20:28:17+01:00",
    "2004-02-24T20:54:53+01:00",
    "2004-02-24T21:26:32+01:00",
    "2004-02-25T08:01:36+01:00",
    "2004-02-25T14:25:36+01:00",
    "2004-02-25T14:30:37+01:00",
    "2004-02-25T14:44:07+01:00",
    "2004-03-08T23:27:49+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoSuchMethodError",
      "message": "java.lang.StringBuffer.a ppend(Ljava/lang/String;)Ljava/lang/AbstractStringBuilder;",
      "elements": [
        {
          "method": "StringBufferTest.main",
          "source": "StringBufferTest.java:19"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "52979",
      "duplicateId": "51353",
      "date": "2004-02-24T21:26:32+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.UnsupportedClassVersionError",
      "message": "StringBufferT est (Unsupported major.minor version 49.0)",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClass0",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.security.SecureClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader.access$100",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "java.net.URLClassLoader.findClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "sun.misc.Launcher$AppClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "52979",
      "duplicateId": "51353",
      "date": "2004-02-24T21:26:32+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "51353",
  "bugId": "52979",
  "duplicateId": "51353",
  "date": "2004-02-24T20:28:17+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}