{
  "comments": [
    "First, many thanks for the great software you created.\nThis is the first time I wrote a email to eclipse community and I am not quite \nclear that in what format I should write this mail. I apologize for the \ninconvenience.\n\nWell, the following is the description of the problem I met.\nI ran eclipse3 RC2 on the SUN JDK 1.4.2_04.\nThen I created 3 project with one as the main project and the other two for \nreference. Both 3 project use linked resource for the source folder and I added \nsome libraries to their build classpath using User Libraries.\n\nWhen build the projects, the 2 reference projects got built without errors but \nthe main project got an error saying \"Build Workspace (Error: an internal error \noccurred during: \"Build Workspace\".)\" and the build process stopped without all \nsource files compiled. The detail stacktrace contained not much information \nwhich says only \"java.lang.StackOverflowError\". Below is the log:\n****************** begin ******************\n!SESSION 6 18, 2004 14:11:09.321 -----------------------------------------------\neclipse.buildId\u003dI200406111814\njava.version\u003d1.4.2_04\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003dja_JP\n\n!ENTRY org.eclipse.core.runtime 4 2 6 18, 2004 14:11:09.321\n!MESSAGE An internal error occurred during: \"Building Workspace\".\n!STACK 0\njava.lang.StackOverflowError\n****************** end ******************\n\nAnd then I tried to ran eclipse3 RC2 on SUN JDK 1.5.0 beta2. This time I got a \ndifferent log which contain lots of detail messages. And it also seemed that \nthere were not only the problem I describe above, but also some problem when \neclipse tries to save the main project with the message \"Could not write \nmetadata for: /KelpJB_addinJBX.\". The log of the try on JDK1.5 is as follows:\n****************** end ******************\n!SESSION 6 18, 2004 14:12:06.447 -----------------------------------------------\neclipse.buildId\u003dI200406111814\njava.version\u003d1.5.0-beta2\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003dja_JP\n\n!ENTRY org.eclipse.core.runtime 4 2 6 18, 2004 14:12:06.447\n!MESSAGE An internal error occurred during: \"Building Workspace\".\n!STACK 0\njava.lang.StackOverflowError\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:147)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:149)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:155)\n    ************\n    I omitted 1018 lines here because they are just the repetition of the above\n    2 lines\n    ***********\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:149)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:155)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType\n(Scope.java:149)\n\n!ENTRY org.eclipse.ui.ide 4 4 6 18, 2004 14:12:15.822\n!MESSAGE Problems saving workspace\n\n!ENTRY org.eclipse.ui.ide 4 1 6 18, 2004 14:12:15.822\n!MESSAGE Problems occurred while trying to save the state of the workbench.\n!SUBENTRY 1 org.eclipse.core.resources 4 568 6 18, 2004 14:12:15.822\n!MESSAGE Could not write metadata for: /KelpJB_addinJBX.\n!STACK 0\njava.io.UTFDataFormatException: encoded string too long: 90168 bytes\n\tat java.io.DataOutputStream.writeUTF(DataOutputStream.java:345)\n\tat java.io.DataOutputStream.writeUTF(DataOutputStream.java:305)\n\tat org.eclipse.core.internal.resources.MarkerWriter.write\n(MarkerWriter.java:181)\n\tat org.eclipse.core.internal.resources.MarkerWriter.write\n(MarkerWriter.java:210)\n\tat org.eclipse.core.internal.resources.MarkerWriter.save\n(MarkerWriter.java:107)\n\tat org.eclipse.core.internal.resources.MarkerManager.save\n(MarkerManager.java:482)\n\tat org.eclipse.core.internal.resources.SaveManager$3.visitElement\n(SaveManager.java:1467)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:78)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration\n(ElementTreeIterator.java:82)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.iterate\n(ElementTreeIterator.java:123)\n\tat org.eclipse.core.internal.resources.SaveManager.visitAndSave\n(SaveManager.java:1491)\n\tat org.eclipse.core.internal.resources.SaveManager.visitAndSave\n(SaveManager.java:1527)\n\tat org.eclipse.core.internal.resources.SaveManager.save\n(SaveManager.java:1335)\n\tat org.eclipse.core.internal.resources.Workspace.save\n(Workspace.java:1707)\n\tat org.eclipse.ui.internal.ide.IDEWorkbenchAdvisor$5.run\n(IDEWorkbenchAdvisor.java:468)\n\tat org.eclipse.jface.operation.ModalContext$ModalContextThread.run\n(ModalContext.java:101)\n****************** end ******************\n\nThis is the problem I met and I hope you can fix it (if it really is a bug).\nThank you.\n\nA eclipse fan\nZhang.",
    "Could you attach a testcase reproducing this issue ?\nI am suspecting a very long sequence of message send or something like that.\n\nYou may increase the amount of memory allocated for execution stack using VM \nargs on command line \"-Xss256K\" (eclipse.exe -vmargs -Xss256k).\n\nBut still we should understand what caused this to occur.",
    "Dear Philippe Mulet,\n    Thank you for your quick reply. I tried just as you wrote but\nthere was no lucky and the problem remains.\n    Here is my command line to invoke eclipse:\nD:\\eclipse\\eclipse3RC2\\eclipse.exe -vm d:\\java\\j2sdk142\\bin\\javaw.exe -data\nd:\\eclipse\\eclipse3-workspace -vmargs -Xmx160m -Xss512k\n\n    Now I\u0027m trying to make a testcase you mentioned but have not much\nconfidence. I\u0027ll try my best.\n\nZhang",
    "Please do not modify target on bugs, this is dvpt team responsibility to do that...\nThanks",
    "Can you reproduce this issue on a 1.4 JDK ? Note that 1.5 JDKs are fairly \nunstable (these are just betas).",
    "Created an attachment (id\u003d12469)\nTestcase project for reproducing the error\n",
    "Dear JDT Core team members,\n    I think I got the procedure to reproduce the error on JDK 1.4.2. Please \nunzip the attached zip archive which contains the testcase project.\n\nHere is the procedure:\n(1) Use the following command line to start eclipse 3 RC2.(it\u0027s just what I \nused)\nD:\\eclipse\\eclipse3RC2\\eclipse.exe -vm d:\\java\\j2sdk142\\bin\\javaw.exe -data \ng:\\workspace -vmargs -Xmx160m -Xss512k\n\n(2) Open a clean(newly created) workspace.\n\n(3) Import the project from disk using \"Import | existing project into \nworkspace\".\n\n(4) Update the external jar entry \"jbuilder.jar\" in the project build path.\nPlease use the \"jbuilder.jar\" in JBuilder7 (it is in the bin folder under the \nproduct installation folder). A JBuilder7 trial version contains this file I \nbelieve. (of course the retail version also) Sorry for the inconvinience but I \ncannot provide the jar file. It\u0027s too big and I do not know if it\u0027s legal to \nprovide it.\n\n(5) Build the project and a dialog reporting the error will pop up.\nNote: I noticed that not only building the project, but saving the \nTestCase.java file or refreshing the project will also produce the similar \nerror. So this may be the JDT UI problem. I\u0027m not sure but if it\u0027s really a UI \nproblem, would you please report this problem to the JDT UI team?\n\nyours truly,\nZhang\n",
    "Proposed fix, replace the following line in faultInReceiverType:\n\nif (type instanceof BinaryTypeBinding \u0026\u0026 (type.tagBits \u0026 EndHierarchyCheck) \u003d\u003d \n0) {\n\nwith:\n\nif (type instanceof BinaryTypeBinding \u0026\u0026 (type.tagBits \u0026 BeginHierarchyCheck) \n\u003d\u003d 0) {\n  type.tagBits |\u003d BeginHierarchyCheck;\n",
    "Code change looks good. I cannot reproduce it from reporter\u0027s testcase, as \ncannot gain access to jbuilder.jar. \n\nHao - would it be possible to remove dependencies from jbuilder on your test \ncase, and produce a standalone testcase ? It looks like an infinite recursion \nis occurring in our compiler. Note that this would also induce the problem in \nUI or anywhere our compiler is invoked.",
    "Forgot to mention this is a regression introduced with fix for bug 61706",
    "It feels to me that the only situation where such a regression could occur is \na case where binaries would end up forming a cycle either in type hierarchy or \nenclosing type link. But both are forbidden in theory.",
    "In presence of cycles in binaries (assuming this would be the case here), I \ndon\u0027t think this behavior would have been a regression based on 2.1, since the \nstack overflow would then have occurred during reference recording as opposed \nto during faulting in of receiver type.",
    "Created an attachment (id\u003d12562)\nScope patch\n",
    "Created an attachment (id\u003d12563)\nJDT core tests patch\n",
    "Test case is a manually created cycle in binary superclass chain. ",
    "Actually, re: comment#11. The reference recording code in 2.1 was protected by \na guard ensuring only new types were considered. This was thus handling \npossible looping scenarii in a satisfactory manner. With our eager resolution, \nwe are now subject to stack overflow if such binaries come across in a way \nwhere they would not be involved in any supertype hierarchy (first occurrence \nis as a receiver type of some message send/field access).\n\nWill send reporter a patch to assess the fix. The fix itself is quite trivial, \nand given we are resilient everywhere else for corrupted binaries (in \nparticular cycling ones when resolving type hierarchies), we should consider \nit for 3.0 (as it is a regression from previous releases).\n\nThere is no workaround to avoid this issue, except than rebuilding offending \nlibraries. However, given some products seem to ship with such libraries, we \nshould behave.",
    "I\u0027m quite excited to report that the issue I encountered disappeared after I \napplied the patch (jdtcore.jar) philippe mulet (philippe_mulet@fr.ibm.com) sent \nto me.\nThe project just builds as is in eclipse 2.1.3. I don\u0027t know what detail \ninformation you interest in, so I don\u0027t know what I should tell you. Please \ntell me if any detail description is needed.",
    "Thanks for confirming this.",
    "Approved to be released into RC4",
    "Fix released for integration, with NegativeTest#test431",
    "Fixed for RC4.",
    "Released fix is correct."
  ],
  "commentCreationDates": [
    "2004-06-18T10:19:44+02:00",
    "2004-06-18T11:14:38+02:00",
    "2004-06-18T12:04:21+02:00",
    "2004-06-18T12:16:44+02:00",
    "2004-06-18T13:25:38+02:00",
    "2004-06-18T14:35:16+02:00",
    "2004-06-18T14:36:50+02:00",
    "2004-06-18T18:52:06+02:00",
    "2004-06-19T01:07:54+02:00",
    "2004-06-19T01:09:50+02:00",
    "2004-06-19T01:25:28+02:00",
    "2004-06-21T14:08:35+02:00",
    "2004-06-21T15:47:24+02:00",
    "2004-06-21T15:47:52+02:00",
    "2004-06-21T15:57:09+02:00",
    "2004-06-22T11:46:02+02:00",
    "2004-06-22T12:22:46+02:00",
    "2004-06-22T17:08:18+02:00",
    "2004-06-22T17:34:31+02:00",
    "2004-06-22T17:50:06+02:00",
    "2004-06-22T17:56:02+02:00",
    "2004-06-22T17:56:37+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.StackOverflowError",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType",
          "source": "Scope.java:147"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType",
          "source": "Scope.java:149"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.faultInReceiverType",
          "source": "Scope.java:155"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "67769",
      "date": "2004-06-18T10:19:44+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    },
    {
      "exceptionType": "java.io.UTFDataFormatException",
      "message": "encoded string too long: 90168 bytes",
      "elements": [
        {
          "method": "java.io.DataOutputStream.writeUTF",
          "source": "DataOutputStream.java:345"
        },
        {
          "method": "java.io.DataOutputStream.writeUTF",
          "source": "DataOutputStream.java:305"
        },
        {
          "method": "org.eclipse.core.internal.resources.MarkerWriter.write",
          "source": "MarkerWriter.java:181"
        },
        {
          "method": "org.eclipse.core.internal.resources.MarkerWriter.write",
          "source": "MarkerWriter.java:210"
        },
        {
          "method": "org.eclipse.core.internal.resources.MarkerWriter.save",
          "source": "MarkerWriter.java:107"
        },
        {
          "method": "org.eclipse.core.internal.resources.MarkerManager.save",
          "source": "MarkerManager.java:482"
        },
        {
          "method": "org.eclipse.core.internal.resources.SaveManager$3.visitElement",
          "source": "SaveManager.java:1467"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:78"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "ElementTreeIterator.java:82"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.iterate",
          "source": "ElementTreeIterator.java:123"
        },
        {
          "method": "org.eclipse.core.internal.resources.SaveManager.visitAndSave",
          "source": "SaveManager.java:1491"
        },
        {
          "method": "org.eclipse.core.internal.resources.SaveManager.visitAndSave",
          "source": "SaveManager.java:1527"
        },
        {
          "method": "org.eclipse.core.internal.resources.SaveManager.save",
          "source": "SaveManager.java:1335"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.save",
          "source": "Workspace.java:1707"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEWorkbenchAdvisor$5.run",
          "source": "IDEWorkbenchAdvisor.java:468"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.java:101"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "67769",
      "date": "2004-06-18T10:19:44+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "67769",
  "bugId": "67769",
  "date": "2004-06-18T10:19:44+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}