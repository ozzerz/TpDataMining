{
  "comments": [
    "If you are loading all osgi projects, runtime and update.configurator in the\nworkspace, the runtime-workbench no longer starts.\n\nThe problem seems to come from the method getBundlesToUninstall() which is not\nable to recognize that services, utils and runtime are bundles that should not\nget uninstalled.",
    "Pascal, what happens if we install a newer version of those bundles?\nShould we let the runtime take care of this?\ni.e. we just install the newer version of those plugins and the runtime will \nfigure out that whatever version gets installed during the current session \ntakes precedence over what\u0027s cached.",
    "If I revert to the tagged version of update.configurator the problem no longer\noccurs.  Here is the stack dump when it fails to start:\n\n!SESSION Mar 29, 2004 16:04:26.916 ---------------------------------------------\njava.fullversion\u003dJ2RE 1.4.1 IBM J9 build 20031212 (JIT enabled)\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_US\nCommand-line arguments: -keyring d:\\eclipse\\test\\.metadata\\.keyring\n!ENTRY org.eclipse.update.configurator Mar 29, 2004 16:04:26.916\n!MESSAGE Could not uninstall unused bundle\nreference:file:d:/1target/plugins/org.eclipse.update.configurator/\n!ENTRY org.eclipse.update.configurator Mar 29, 2004 16:04:28.994\n!MESSAGE Ignoring bundle at:\nreference:file:d:/eclipse/plugins/org.eclipse.update.configurator_3.0.0/\n!STACK 0\norg.osgi.framework.BundleException: A bundle with the unique ID and version is\nalready installed: org.eclipse.update.configurator 3.0.0\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java:59)\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java:73)\n\tat org.osgi.framework.BundleException.\u003cinit\u003e(BundleException.java:68)\n\tat\norg.eclipse.osgi.framework.internal.core.Framework.installWorkerPrivileged(Framework.java:727)\n\tat org.eclipse.osgi.framework.internal.core.Framework$1.run(Framework.java:612)\n\tat java.security.AccessController.doPrivileged(AccessController.java:189)\n\tat\norg.eclipse.osgi.framework.internal.core.Framework.installWorker(Framework.java:690)\n\tat\norg.eclipse.osgi.framework.internal.core.Framework.installBundle(Framework.java:607)\n\tat\norg.eclipse.osgi.framework.internal.core.BundleContext.installBundle(BundleContext.java:207)\n\tat\norg.eclipse.update.internal.configurator.ConfigurationActivator.installBundles(ConfigurationActivator.java:183)\n\tat\norg.eclipse.update.internal.configurator.ConfigurationActivator.start(ConfigurationActivator.java:88)\n\tat\norg.eclipse.osgi.framework.internal.core.BundleContext$1.run(BundleContext.java:992)\n\tat java.security.AccessController.doPrivileged(AccessController.java:189)\n\tat\norg.eclipse.osgi.framework.internal.core.BundleContext.startActivator(BundleContext.java:988)\n\tat\norg.eclipse.osgi.framework.internal.core.BundleContext.start(BundleContext.java:971)\n\tat\norg.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:412)\n\tat org.eclipse.osgi.framework.internal.core.Bundle.resume(Bundle.java:377)\n\tat\norg.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:971)\n\tat\norg.eclipse.osgi.framework.internal.core.StartLevelImpl.resumeBundles(StartLevelImpl.java:565)\n\tat\norg.eclipse.osgi.framework.internal.core.StartLevelImpl.incFWSL(StartLevelImpl.java:479)\n\tat\norg.eclipse.osgi.framework.internal.core.StartLevelImpl.doSetStartLevel(StartLevelImpl.java:269)\n\tat\norg.eclipse.osgi.framework.internal.core.StartLevelImpl.dispatchEvent(StartLevelImpl.java:439)\n\tat\norg.eclipse.osgi.framework.eventmgr.ListenerList.dispatchEvent(ListenerList.java:135)\n\tat\norg.eclipse.osgi.framework.eventmgr.EventThread$EventThreadItem.dispatchEvent(EventThread.java:59)\n\tat org.eclipse.osgi.framework.eventmgr.EventThread.run(EventThread.java:118)\n!ENTRY org.eclipse.osgi Mar 29, 2004 16:04:29.526\n!MESSAGE Startup error\n!STACK 1\njava.lang.IllegalStateException: Bundle\nreference:file:d:/1target/plugins/org.eclipse.osgi.util/ [2] is not active\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java:59)\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java:73)\n\tat\norg.eclipse.core.runtime.adaptor.EclipseStarter.ensureBundlesActive(EclipseStarter.java:271)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.startup(EclipseStarter.java:213)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:115)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:41)\n\tat java.lang.reflect.Method.invoke(Method.java:386)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:267)\n\tat org.eclipse.core.launcher.Main.run(Main.java:692)\n\tat org.eclipse.core.launcher.Main.main(Main.java:676)\n",
    "Letting the system discover them the next time is a possibility, and is \nprobably the easiest.\n\nIf the configurator was to uninstall then reinstall them, then it should makes \nsure that it puts them back to the state where they were (resolved / active, \netc. - note that this behavior is equivalent to an \"update\").\nDoing so would trigger the stop and restart of the configurator since it relies \non these bundles and therefore need to be refreshed to release the classes that \nit holds.\n\nAnyway I\u0027m wondering how in a real scenario, this can happen. Basically, is it \npossible, between the moment that the configurator starts and the \ngetBundlesToUninstall method runs, that some bundles get installed (by update)?",
    "The update configurator in head is not good for self hosting, as it has some \nchanges that PDE must still react to (I am waiting for Wassim to ok this). \nAs per John\u0027s comment, use the last versioned project (the one used for M8), \nthat would be a safer option.\n\nThere is no install of bundle in before the getBundlesToUninstall() is called. \nIt is later that the configurator decides what to install and to uninstall. \n\nIf the framework can handle this, I propose that the configurator will never \nuninstall bundles from the osgi.bundles list, but may install them from a \ndiffierent location (including a potentially newer version or the same \nversion). Notice that the configurator is starting as this is happening, so \nthis may create a big mess in the bundle states.",
    "John/Pascal, can you attach the platform.xml file used to launch the config?\n\nWassim, I noticed a difference in the platform.cfg and platform.xml: the .cfg \nlooks correct, while platform.xml appears incorrect. Here is my platform.xml \n(note that I was expecting a large list of plugins in the site, but there is \nnone, and the policy is USER-EXCLUDE):\n\n\n\u003cconfig version\u003d\"3.0\" date\u003d\"Tue Mar 30 11:26:54 EST 2004\" transient\u003d\"false\"\u003e\n\u003csite url\u003d\"platform:/base/\" enabled\u003d\"true\" updateable\u003d\"true\" policy\u003d\"USER-\nEXCLUDE\"\u003e\n\u003cfeature id\u003d\"org.eclipse.platform\" primary\u003d\"true\" version\u003d\"3.0.0\" \napplication\u003d\"org.eclipse.ui.ide.workbench\" \nurl\u003d\"features/org.eclipse.platform_3.0.0/\"/\u003e\n\u003cfeature id\u003d\"org.eclipse.platform.source\" version\u003d\"3.0.0\" \nurl\u003d\"features/org.eclipse.platform.source_3.0.0/\"/\u003e\n\u003cfeature id\u003d\"org.eclipse.jdt\" version\u003d\"3.0.0\" \nurl\u003d\"features/org.eclipse.jdt_3.0.0/\"/\u003e\n\u003cfeature id\u003d\"org.eclipse.jdt.source\" version\u003d\"3.0.0\" \nurl\u003d\"features/org.eclipse.jdt.source_3.0.0/\"/\u003e\n\u003cfeature id\u003d\"org.eclipse.pde\" version\u003d\"3.0.0\" \nurl\u003d\"features/org.eclipse.pde_3.0.0/\"/\u003e\n\u003cfeature id\u003d\"org.eclipse.sdk\" version\u003d\"3.0.0\" \nurl\u003d\"features/org.eclipse.sdk_3.0.0/\"/\u003e\n\u003c/site\u003e\n\u003c/config\u003e\n",
    "Pls ignore my last comment, I was using the nightly build, not M8. With M8 \nthings work fine.",
    "With the latest build I can no longer reproduce this problem.\nPlease re-open if you can reproduce it with today\u0027s build."
  ],
  "commentCreationDates": [
    "2004-03-29T21:56:55+02:00",
    "2004-03-29T22:03:08+02:00",
    "2004-03-29T22:09:37+02:00",
    "2004-03-29T22:13:43+02:00",
    "2004-03-29T23:13:47+02:00",
    "2004-03-30T17:44:35+02:00",
    "2004-03-30T17:57:12+02:00",
    "2004-04-12T18:53:36+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.osgi.framework.BundleException",
      "message": "A bundle with the unique ID and version is already installed: org.eclipse.update.configurator 3.0.0",
      "elements": [
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java:59"
        },
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java:73"
        },
        {
          "method": "org.osgi.framework.BundleException.\u003cinit\u003e",
          "source": "BundleException.java:68"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.installWorkerPrivileged",
          "source": "Framework.java:727"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework$1.run",
          "source": "Framework.java:612"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "AccessController.java:189"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.installWorker",
          "source": "Framework.java:690"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.installBundle",
          "source": "Framework.java:607"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContext.installBundle",
          "source": "BundleContext.java:207"
        },
        {
          "method": "org.eclipse.update.internal.configurator.ConfigurationActivator.installBundles",
          "source": "ConfigurationActivator.java:183"
        },
        {
          "method": "org.eclipse.update.internal.configurator.ConfigurationActivator.start",
          "source": "ConfigurationActivator.java:88"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContext$1.run",
          "source": "BundleContext.java:992"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "AccessController.java:189"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContext.startActivator",
          "source": "BundleContext.java:988"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContext.start",
          "source": "BundleContext.java:971"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.startWorker",
          "source": "BundleHost.java:412"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Bundle.resume",
          "source": "Bundle.java:377"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.resumeBundle",
          "source": "Framework.java:971"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelImpl.resumeBundles",
          "source": "StartLevelImpl.java:565"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelImpl.incFWSL",
          "source": "StartLevelImpl.java:479"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelImpl.doSetStartLevel",
          "source": "StartLevelImpl.java:269"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelImpl.dispatchEvent",
          "source": "StartLevelImpl.java:439"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.ListenerList.dispatchEvent",
          "source": "ListenerList.java:135"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventThread$EventThreadItem.dispatchEvent",
          "source": "EventThread.java:59"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventThread.run",
          "source": "EventThread.java:118"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "56643",
      "date": "2004-03-29T22:09:37+02:00",
      "product": "Platform",
      "component": "Update",
      "severity": "major"
    },
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "Bundle reference:file:d:/1target/plugins/org.eclipse.osgi.util/ [2] is not active",
      "elements": [
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java:59"
        },
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java:73"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.ensureBundlesActive",
          "source": "EclipseStarter.java:271"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.startup",
          "source": "EclipseStarter.java:213"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:115"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:79"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:41"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:386"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:267"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:692"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:676"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "56643",
      "date": "2004-03-29T22:09:37+02:00",
      "product": "Platform",
      "component": "Update",
      "severity": "major"
    }
  ],
  "groupId": "56643",
  "bugId": "56643",
  "date": "2004-03-29T21:56:55+02:00",
  "product": "Platform",
  "component": "Update",
  "severity": "major"
}