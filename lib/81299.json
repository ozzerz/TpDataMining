{
  "comments": [
    "turn off perspective switching.\ndebug a build file to a break point.\nmanually switch to debug perspective\n-\u003e process is terminated.",
    "opening or activating the variables view seems to be the problem. Even in the same perspective.",
    "I cannot reproduce with same or separate JRE builds.",
    "Still doing it for me. Just noticed the related entry in the log file:\nError Dec 15, 2004 15:44:17.728 Internal error processing remote response\njava.lang.ArrayIndexOutOfBoundsException: 263\n\tat org.eclipse.ant.internal.ui.debug.model.AntThread.newProperties(AntThread.java:320)\n\tat \norg.eclipse.ant.internal.ui.debug.model.RemoteAntDebugBuildListener.receiveMessage(RemoteAntDebu\ngBuildListener.java:91)\n\tat \norg.eclipse.ant.internal.ui.debug.model.RemoteAntDebugBuildListener$ReaderThread.run(RemoteAntDe\nbugBuildListener.java:58)\n\n",
    "Can you provide the test build file or is it all builds?\nSame or separate JRE?\n\nThe build will be terminated if an exception occurs (need to shut down the \nsockets etc). AntThread is receiving a message for new properties that does \nnot conform to what it is expecting. I don\u0027t know why?\n\nCan you debug what string you are getting passed into AntThread.newProperties \nand while the ArrayIndexOutOfBoundsException?\nIt appears you are getting a property with no value which should not be \npossible in Ant...",
    "the build file is simple:\n\u003cproject name\u003d\"project\" default\u003d\"default\"\u003e\n\t\u003ctarget name\u003d\"default\"\u003e\n\t\t\u003cecho\u003eHello World\u003c/echo\u003e \u003c!-- breakpoint on this line --\u003e\n\t\u003c/target\u003e\n\u003c/project\u003e\n\n\nThe string is:\nprop,17,java.runtime.name,48,Java(TM) 2 Runtime Environment, Standard \nEdition,21,sun.boot.library.path,68,/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/\nLibraries,15,java.vm.version,8,1.4.2-38,25,awt.nativeDoubleBuffering,4,true,15,ant.library.dir,55,/\nUsers/kevinbarnes/Eclipse/workspace/org.apache.ant/\nlib,14,gopherProxySet,5,false,11,ant.version,49,Apache Ant version 1.6.2 compiled on July \n16 2004,16,ant.java.version,3,1.4,14,java.vm.vendor,22,\"Apple Computer, \nInc.\",15,java.vendor.url,17,http://apple.com/,14,path.separator,1,:,12,java.vm.name,26,Java \nHotSpot(TM) Client \nVM,17,file.encoding.pkg,6,sun.io,12,user.country,2,CA,18,sun.os.patch.level,7,unknown,26,java.vm.sp\necification.name,34,Java Virtual Machine Specification,8,user.dir,52,/Users/kevinbarnes/Eclipse/\nruntime-workspace/Testing,20,java.runtime.version,14,1.4.2_05\n-141.3,20,java.awt.graphicsenv,30,apple.awt.CGraphicsEnvironment,7,basedir,52,/Users/kevinbarnes/\nEclipse/runtime-workspace/Testing,16,ant.file.project,62,/Users/kevinbarnes/Eclipse/runtime-\nworkspace/Testing/build.xml,18,java.endorsed.dirs,76,/System/Library/Frameworks/\nJavaVM.framework/Versions/1.4.2/Home/lib/endorsed,7,os.arch,3,ppc,14,java.io.tmpdir,4,/\ntmp,28,java.vm.specification.vendor,21,Sun Microsystems Inc.,7,os.name,8,Mac OS X,8,ant.home,51,/\nUsers/kevinbarnes/Eclipse/workspace/\norg.apache.ant,19,sun.java2d.fontpath,0,,16,ant.project.name,7,project,17,java.library.path,92,/Users/\nkevinbarnes/Eclipse/I20041214-2000/plugins/org.eclipse.swt.carbon_3.1.0/os/macosx/\nppc,20,eclipse.connect.port,5,52242,23,java.specification.name,31,Java Platform API \nSpecification,18,java.class.version,4,48.0,34,java.util.prefs.PreferencesFactory,40,java.util.prefs.MacOSX\nPreferencesFactory,10,os.version,6,10.3.6,8,ant.file,62,/Users/kevinbarnes/Eclipse/runtime-\nworkspace/Testing/build.xml,9,user.home,18,/Users/\nkevinbarnes,38,org.eclipse.ant.ui.ATTR_ANT_PROCESS_ID,13,1103148304384,13,user.timezone,0,,19,j\nava.awt.printerjob,21,apple.awt.CPrinterJob,13,file.encoding,8,MacRoman,26,java.specification.version,\n3,1.4,28,eclipse.connect.request_port,5,52243,15,java.class.path,2386,/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-\nantlr.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-apache-bcel.jar:/Users/\nkevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-apache-bsf.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-apache-log4j.jar:/Users/kevinbarnes/Eclipse/workspace/\norg.apache.ant/lib/ant-apache-oro.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-\napache-regexp.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-apache-resolver.jar:\n/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-commons-logging.jar:/Users/\nkevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-commons-net.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-icontract.jar:/Users/kevinbarnes/Eclipse/workspace/\norg.apache.ant/lib/ant-jai.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-\njavamail.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-jdepend.jar:/Users/\nkevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-jmf.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-jsch.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/\nant-junit.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-launcher.jar:/Users/\nkevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-netrexx.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-nodeps.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/\nlib/ant-starteam.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-stylebook.jar:/\nUsers/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-swing.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-trax.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/\nant-vaj.jar:/Users/kevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-weblogic.jar:/Users/\nkevinbarnes/Eclipse/workspace/org.apache.ant/lib/ant-xalan1.jar:/Users/kevinbarnes/Eclipse/\nworkspace/org.apache.ant/lib/ant-xslp.jar:/Users/kevinbarnes/Eclipse/workspace/\norg.eclipse.ant.tests.ui/lib/antUITestsSupport.jar:/Users/kevinbarnes/Eclipse/workspace/\norg.eclipse.ant.ui/lib/remoteAnt.jar:/Users/kevinbarnes/Eclipse/I20041214-2000/plugins/\norg.eclipse.swt.carbon_3.1.0/ws/carbon/swt-pi.jar:/Users/kevinbarnes/Eclipse/I20041214-2000/\nplugins/org.eclipse.swt.carbon_3.1.0/ws/carbon/\nswt.jar,9,user.name,11,kevinbarnes,29,java.vm.specification.version,3,1.0,9,java.home,63,/System/\nLibrary/Frameworks/JavaVM.framework/Versions/1.4.2/\nHome,19,sun.arch.data.model,2,32,13,user.language,2,en,25,java.specification.vendor,21,Sun \nMicrosystems Inc.,11,awt.toolkit,18,apple.awt.CToolkit,12,java.vm.info,10,mixed \nmode,12,java.version,8,1.4.2_05,13,java.ext.dirs,128,/Library/Java/Extensions:/System/Library/Java/\nExtensions:/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/Home/lib/\next,19,sun.boot.class.path,540,/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/\nClasses/classes.jar:/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/Classes/ui.jar:/\nSystem/Library/Frameworks/JavaVM.framework/Versions/1.4.2/Classes/laf.jar:/System/Library/\nFrameworks/JavaVM.framework/Versions/1.4.2/Classes/sunrsasign.jar:/System/Library/Frameworks/\nJavaVM.framework/Versions/1.4.2/Classes/jsse.jar:/System/Library/Frameworks/JavaVM.framework/\nVersions/1.4.2/Classes/jce.jar:/System/Library/Frameworks/JavaVM.framework/Versions/1.4.2/\nClasses/charsets.jar,11,java.vendor,20,Apple Computer, Inc.,14,file.separator,1,/\n,19,java.vendor.url.bug,32,http://developer.apple.com/java/\n,23,sun.io.unicode.encoding,10,UnicodeBig,14,sun.cpu.endian,3,big,11,mrj.version,5,141.3,15,sun.cpu\n.isalist,0,,",
    "separate VM. default config (ie Debug As/Ant Build)",
    "Specific to the Mac. Needs more investigation",
    "Kevin my suspision is that a line.separator is included in one of the property \nvalues. I have a hack in RemoteAntDebugBuildLogger to not marshal the \nline.separator property. I found sending the line.separator across created \nsimilar problems. \nDo you know of a way around this unpleasantry?",
    "I don\u0027t believe line.separator is the problem. It looks to me like String.split is not doing what we expect \nit to do in this case. Run the following main():\n\n    public static void main(String[] args) {\n        String tester \u003d \"sun.cpu.isalist,0,,\";\n        String[] strings \u003d tester.split(\",\");\n        System.out.println(strings.length);\n        for (int i \u003d 0; i \u003c strings.length; i++) {\n            System.out.println(strings[i]);\n        }\n    }\n\nYou\u0027ll see strings.length \u003d 2\nand the strings returned are \"sun.cpu.isalist\" and \"0\"\n\nFrom looking at the code in newProperties() it looks like we were expected strings.length \u003d 3 and an \nadditional empty string object to be returned. This causes the index out of bounds, and that exception \nis caught in RemoteAntDebugBuildListener (line 65) which causes a shutdown().",
    "Thanks Kevin.\nI will log the line.separator issue in bug 81418 (so I don\u0027t forget the hack) \nand alter the code to handle 0 length string in AntThread",
    "Test case to fail on windows:\n\u003cproject name\u003d\"project\" default\u003d\"default\"\u003e\n\t\u003ctarget name\u003d\"default\"\u003e\n                \u003cproperty name\u003d\"Hello World\" value\u003d\"\" /\u003e\n\t\t\u003cecho\u003eHello World\u003c/echo\u003e \u003c!-- breakpoint on this line --\u003e\n\t\u003c/target\u003e\n\u003c/project\u003e\n",
    "Haven\u0027t thoroughly tested it, but I believe you could replace your call to String.split() with the following \ncustom method:\n\n    private static String[] split(String string, String regex) {\n        Pattern pattern \u003d Pattern.compile(regex);\n        Matcher matcher \u003d pattern.matcher(string);\n        ArrayList list \u003d new ArrayList();\n        int start \u003d 0;\n        while (matcher.find()) {\n                list.add(string.substring(start, matcher.end() - 1));\n                start \u003d matcher.end();\n        }\n\n        return (String[]) list.toArray(new String[list.size()]);\n    }",
    "I believe I can handle this case. It is only when the empty String is at the \nend of the String that is split...happens to be the case for the Mac \nproperties...there are Windows properties that have the empty String but these \nare not at the end of the \"list\".\n\nChanges to AntThread.\nSmall change to RemoteAntDebugBuildLogger to strip off trailing delimiter just \nto be pretty and save some bytes across the pipe :-)",
    "Please verify Kevin.",
    "To make fail on Windows, set the breakpoint on the property setting line of \nthe test file in comment #11\nHave the variables view visible. \nStep over.",
    "verified"
  ],
  "commentCreationDates": [
    "2004-12-15T19:47:05+01:00",
    "2004-12-15T19:50:21+01:00",
    "2004-12-15T21:12:44+01:00",
    "2004-12-15T21:45:10+01:00",
    "2004-12-15T21:50:36+01:00",
    "2004-12-15T22:06:47+01:00",
    "2004-12-15T22:09:12+01:00",
    "2004-12-15T22:48:37+01:00",
    "2004-12-16T14:43:31+01:00",
    "2004-12-16T16:04:38+01:00",
    "2004-12-16T16:28:06+01:00",
    "2004-12-16T16:35:23+01:00",
    "2004-12-16T16:48:04+01:00",
    "2004-12-16T16:56:47+01:00",
    "2004-12-16T16:57:03+01:00",
    "2004-12-16T16:58:49+01:00",
    "2004-12-16T17:11:15+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "263",
      "elements": [
        {
          "method": "org.eclipse.ant.internal.ui.debug.model.AntThread.newProperties",
          "source": "AntThread.java:320"
        },
        {
          "method": "org.eclipse.ant.internal.ui.debug.model.RemoteAntDebugBuildListener.receiveMessage",
          "source": "RemoteAntDebu gBuildListener.java:91"
        },
        {
          "method": "org.eclipse.ant.internal.ui.debug.model.RemoteAntDebugBuildListener$ReaderThread.run",
          "source": "RemoteAntDe bugBuildListener.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 3,
      "bugId": "81299",
      "date": "2004-12-15T21:45:10+01:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    }
  ],
  "groupId": "81299",
  "bugId": "81299",
  "date": "2004-12-15T19:47:05+01:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "normal"
}