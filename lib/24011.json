{
  "comments": [
    "We are running with a VCM provider that does not support project rename. \nOure MoveProject hook sets an error status and returns true.  Rather than \nreporting our message as from the navigator view JDT reports an unexpected \ninternal error with the option to undo/abort.   The message is problem \nencountered while moving resources.   Our own message appears only in the pde \nerror log.  As the status \"Project Move/Rename not Supported\"\n\nWe then get an assertion error from within the refactoring code.   \n\nIs it possible to avoid the Internal error.  I would not expact an error as we \nhave followed the movedelete hook semantics.\n\nStack traces below of internal error and subsequent assertion error - from \ninitial tracing it id due to a null getNewElement() return value.\n\n\n\nInternal error message\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\norg.eclipse.core.internal.resources.ResourceException: Problems encountered \nwhile moving resources.\n\tat org.eclipse.core.internal.resources.Resource.move(Resource.java:843)\n\tat org.eclipse.core.internal.resources.Project.move(Project.java:566)\n\tat \norg.eclipse.jdt.internal.corext.refactoring.changes.RenameJavaProjectChange.doRe\nname(RenameJavaProjectChange.java:83)\n\tat \norg.eclipse.jdt.internal.corext.refactoring.AbstractJavaElementRenameChange.perf\norm(AbstractJavaElementRenameChange.java:67)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation$1.execute\n(PerformChangeOperation.java:146)\n\tat org.eclipse.ui.actions.WorkspaceModifyOperation$1.run\n(WorkspaceModifyOperation.java:64)\n\tat org.eclipse.core.internal.resources.Workspace.run\n(Workspace.java:1361)\n\tat org.eclipse.ui.actions.WorkspaceModifyOperation.run\n(WorkspaceModifyOperation.java:78)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation.executeChange\n(PerformChangeOperation.java:151)\n\tat org.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation.run\n(PerformChangeOperation.java:125)\n\tat org.eclipse.jface.operation.ModalContext.runInCurrentThread\n(ModalContext.java:299)\n\tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:249)\n\tat org.eclipse.jface.dialogs.ProgressMonitorDialog.run\n(ProgressMonitorDialog.java:335)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.PerformRefactoringUtil.performRe\nfactoring(PerformRefactoringUtil.java:72)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate\n(RefactoringStarter.java:120)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.\nrename(RefactoringSupportFactory.java:79)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run\n(RenameJavaElementAction.java:52)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run\n(RenameJavaElementAction.java:41)\n\tat org.eclipse.jdt.ui.actions.RenameAction.run(RenameAction.java:104)\n\tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun\n(SelectionDispatchAction.java:197)\n\tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.run\n(SelectionDispatchAction.java:175)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:749)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection\n(ActionContributionItem.java:407)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent\n(ActionContributionItem.java:361)\n\tat org.eclipse.jface.action.ActionContributionItem.access$0\n(ActionContributionItem.java:352)\n\tat \norg.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent\n(ActionContributionItem.java:47)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:77)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:827)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1529)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1291)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1160)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:775)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:432)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:24)\n\nfinal error\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\norg.eclipse.jface.util.Assert$AssertionFailedException: null argument;\n\tat org.eclipse.jface.util.Assert.isNotNull(Assert.java:133)\n\tat org.eclipse.jface.util.Assert.isNotNull(Assert.java:110)\n\tat org.eclipse.jface.viewers.StructuredSelection.\u003cinit\u003e\n(StructuredSelection.java:54)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.\nselectAndReveal(RefactoringSupportFactory.java:121)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.\nrename(RefactoringSupportFactory.java:82)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run\n(RenameJavaElementAction.java:52)\n\tat \norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run\n(RenameJavaElementAction.java:41)\n\tat org.eclipse.jdt.ui.actions.RenameAction.run(RenameAction.java:104)\n\tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun\n(SelectionDispatchAction.java:197)\n\tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.run\n(SelectionDispatchAction.java:175)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:749)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection\n(ActionContributionItem.java:407)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent\n(ActionContributionItem.java:361)\n\tat org.eclipse.jface.action.ActionContributionItem.access$0\n(ActionContributionItem.java:352)\n\tat \norg.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent\n(ActionContributionItem.java:47)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:77)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:827)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1529)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1291)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1160)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:775)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:432)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:24)",
    "\u003eOure MoveProject hook sets an error status and returns true\n\ni\u0027m not sure what we should call to detect that project renaming is not supported.\ndo you know?\n",
    "The documentation for IMoveDeleteHook and the example  at \nhttp://dev.eclipse.org/viewcvs/index.cgi/%7Echeckout%7E/platform-core-\nhome/downloads/examples/movedeletehook/MoveDeleteHookExample1.java indicate \nthat returning true from the hook is the mechanism to indicate that the hook \nhas taken responsibility for the move delete operation.   Prior to returning \ntrue we call tree.failed with an appropriate status indicating that we do not \nsupport this operation.   This should apply to all hooked move/delete \noperations and not specifically the moveProject.    It works in the base \nEclipse resource navigator -  the error status and appropriate message is \ndisplayed to the user - but as reported in this bug use of this mechanism in \nJDT causes the unexpected error message and finally an assertion error in the  \nJDT code as far as I can tell.  ",
    "don\u0027t want to promise anything here but will have a look for m5",
    "asking core for advice on what to call to know if project renaming is supported\n",
    "We do not have an explicit method that you can call to determine whether or not \nproject renaming is supported. (since it is dependant on the team provider\u0027s \nimplementation)\n\nThe basic algorithm for move (and delete) is:\n\nif (!hook.move) then\n  defaultMove\nif (hook called failed()) then\n  throw new ResourceException(status that hook provided)\n",
    "DJ, so there\u0027s no query we could run _before_ we actually go and try renaming \nthe project?",
    "There\u0027s nothing at the Core level since we have no knownledge about the team \nproviders and what they allow/disallow.\n\nAdding MV to CC. Does Team have any API that would help out here?",
    "No, there is no Team API for such a thing. I also don\u0027t think that it would be \nall that helpful as it would complicate how any plugin/tool would do a project \nmove. It would seem to me that catching and dealing with an exception \nindicating that the move failed should be adequate. Is it not?",
    "Our expectation would be that the status we passed in the tree.failed call  in \nour hook would be reported to the user and no operation would be attempted.   \nWe would not expect that our status would only be written to the log and there \nwould be a subsequent assertion error.  As indicated earlier, renaming a \nproject from the resource perspective where the same tree.failed and true \nreturn is made works as expected.",
    "without queries, everything has to be implemented in the ui level\nwe cannot check up front if the action can be added to the menu or not,\nif we want to batch changes, then we cannot do it because we learn  to late \nthat something is not possible (and it was from the beginning, and something \nknew it, but there was not way to ask)\n\nthrowing exceptions and making the ui catch them, sort the useful ones from not \nuseful ones is an incorrect approach, imo.\n\nfor an instance of a similar problem in core see bug 6998",
    "I improved the refactoring UI so that it shows the status passed in the core \nexception in the dialog as well.\n\nRefactoring can only show the exception as an \"after the fact\" problem. The \nreporter requested to show an error message before executing the refactoring. \nBut this is only possible with additional suppport from core team plugin \n(support comparable to validateEdit/validateSave in core resources).\n\nRenaming a project in the JDT UI land does more than renaming it on the file \nsystem. It also fixed build path entries/project dependencies. So without \nadditional API the operation might fail in the middle.\n\nMoving to team.",
    "I want to understand what\u0027s required from Team in having this bug moved to us.\n\nWe don\u0027t have API for saying that move\u0027s aren\u0027t allowed.  Its an interesting \nidea worthy of discussion but obviously post 2.1.\n\nIf I understand this bug correctly:  The primary issue was the error  \nconstructed in the move/delete hook wasn\u0027t being shown to the user, and now it \nis thanks to Dirk\u0027s fix.  Bryan, is this sufficient for you for 2.1?  If yes, \nthen we can either close this bug and open a new one about the API request, or \nrename this one and move post 2.1.\n\nIf there is something Team needs to do for 2.1, please clarify.",
    "Based on the informtion, the display of the status to the user should be \nsufficient.   The original issue was that calling tree.failed as documented to \nveto the move in the move/delete hook when under JDT refactoring resulted in an \nerror dialog without our status information and a subsequent null pointer \nexception.   ",
    "This bug has not been touched for 2 years. Closing as WONTFIX. Please reopen if \nyou feel this is still an important issue."
  ],
  "commentCreationDates": [
    "2002-09-24T13:06:42+02:00",
    "2002-12-18T11:37:16+01:00",
    "2002-12-18T13:00:57+01:00",
    "2002-12-20T16:53:39+01:00",
    "2003-01-28T12:01:41+01:00",
    "2003-01-28T15:33:22+01:00",
    "2003-02-03T17:02:58+01:00",
    "2003-02-03T17:17:15+01:00",
    "2003-02-03T20:17:31+01:00",
    "2003-02-04T09:48:52+01:00",
    "2003-02-04T17:43:26+01:00",
    "2003-02-18T16:46:39+01:00",
    "2003-02-18T19:23:13+01:00",
    "2003-02-19T10:57:54+01:00",
    "2005-05-06T23:18:59+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.core.internal.resources.ResourceException",
      "message": "Problems encountered  while moving resources.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.resources.Resource.move",
          "source": "Resource.java:843"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.move",
          "source": "Project.java:566"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.changes.RenameJavaProjectChange.doRename",
          "source": "RenameJavaProjectChange.java:83"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.AbstractJavaElementRenameChange.perform",
          "source": "AbstractJavaElementRenameChange.java:67"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation$1.execute",
          "source": "PerformChangeOperation.java:146"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceModifyOperation$1.run",
          "source": "WorkspaceModifyOperation.java:64"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1361"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceModifyOperation.run",
          "source": "WorkspaceModifyOperation.java:78"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation.executeChange",
          "source": "PerformChangeOperation.java:151"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.PerformChangeOperation.run",
          "source": "PerformChangeOperation.java:125"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.runInCurrentThread",
          "source": "ModalContext.java:299"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:249"
        },
        {
          "method": "org.eclipse.jface.dialogs.ProgressMonitorDialog.run",
          "source": "ProgressMonitorDialog.java:335"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.PerformRefactoringUtil.performRefactoring",
          "source": "PerformRefactoringUtil.java:72"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate",
          "source": "RefactoringStarter.java:120"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.rename",
          "source": "RefactoringSupportFactory.java:79"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:52"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:41"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.RenameAction.run",
          "source": "RenameAction.java:104"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:197"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:175"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:749"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:407"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent",
          "source": "ActionContributionItem.java:361"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$0",
          "source": "ActionContributionItem.java:352"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent",
          "source": "ActionContributionItem.java:47"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:827"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1529"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1291"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1177"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1160"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:775"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:432"
        },
        {
          "method": "EclipseRuntimeLauncher.main",
          "source": "EclipseRuntimeLauncher.java:24"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "24011",
      "date": "2002-09-24T13:06:42+02:00",
      "product": "Platform",
      "component": "Team",
      "severity": "enhancement"
    },
    {
      "exceptionType": "org.eclipse.jface.util.Assert$AssertionFailedException",
      "message": "null argument;",
      "elements": [
        {
          "method": "org.eclipse.jface.util.Assert.isNotNull",
          "source": "Assert.java:133"
        },
        {
          "method": "org.eclipse.jface.util.Assert.isNotNull",
          "source": "Assert.java:110"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredSelection.\u003cinit\u003e",
          "source": "StructuredSelection.java:54"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.selectAndReveal",
          "source": "RefactoringSupportFactory.java:121"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.RefactoringSupportFactory$RenameSupport.rename",
          "source": "RefactoringSupportFactory.java:82"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:52"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:41"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.RenameAction.run",
          "source": "RenameAction.java:104"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:197"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:175"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:749"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:407"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent",
          "source": "ActionContributionItem.java:361"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$0",
          "source": "ActionContributionItem.java:352"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent",
          "source": "ActionContributionItem.java:47"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:827"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1529"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1291"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1177"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1160"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:775"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:432"
        },
        {
          "method": "EclipseRuntimeLauncher.main",
          "source": "EclipseRuntimeLauncher.java:24"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "24011",
      "date": "2002-09-24T13:06:42+02:00",
      "product": "Platform",
      "component": "Team",
      "severity": "enhancement"
    }
  ],
  "groupId": "24011",
  "bugId": "24011",
  "date": "2002-09-24T13:06:42+02:00",
  "product": "Platform",
  "component": "Team",
  "severity": "enhancement"
}