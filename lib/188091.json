{
  "comments": [
    "When I start an RCP the app fails and the following errors get written in the .log\n!ENTRY org.eclipse.osgi 4 0 2007-05-21 12:20:35.531\n!MESSAGE Application error\n!STACK 1\norg.eclipse.swt.SWTError: No more handles\n \tat org.eclipse.swt.SWT.error(SWT.java:3573)\n \tat org.eclipse.swt.SWT.error(SWT.java:3465)\n \tat org.eclipse.swt.SWT.error(SWT.java:3436) \nand many more\nI found out that if I remove the line \nPlatform.endSplash();\nthe problem stops",
    "C Apostolou:  what does the rest of that stack trace look like?\n\nAndrew, any ideas?  Has the new splash wrapper been tested on 2k?",
    "Without further information we cannot proceed.",
    "(In reply to comment #2)\n\u003e Without further information we cannot proceed.\n\u003e \nok here you are, sorry about the delay\nand yes I work on XP\n\n!SESSION 2007-05-23 20:45:49.328 -----------------------------------------------\neclipse.buildId\u003dunknown\njava.version\u003d1.6.0_01\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003del_GR\nFramework arguments:  -product gr.apeirotan.planNET.product\nCommand-line arguments:  -product gr.apeirotan.planNET.product -data E:\\workspace/../runtime-planNET -dev file:E:/workspace/.metadata/.plugins/org.eclipse.pde.core/planNET/dev.properties -os win32 -ws win32 -arch x86 -clean -debug\n\n!ENTRY org.eclipse.osgi 4 0 2007-05-23 20:45:53.578\n!MESSAGE Application error\n!STACK 1\norg.eclipse.swt.SWTError: No more handles\n   at org.eclipse.swt.SWT.error(SWT.java:3573)\n   at org.eclipse.swt.SWT.error(SWT.java:3465)\n   at org.eclipse.swt.SWT.error(SWT.java:3436)\n   at org.eclipse.swt.widgets.Widget.error(Widget.java:432)\n   at org.eclipse.swt.widgets.Control.createHandle(Control.java:602)\n   at org.eclipse.swt.widgets.Composite.createHandle(Composite.java:235)\n   at org.eclipse.swt.widgets.Control.createWidget(Control.java:618)\n   at org.eclipse.swt.widgets.Scrollable.createWidget(Scrollable.java:131)\n   at org.eclipse.swt.widgets.Control.\u003cinit\u003e(Control.java:97)\n   at org.eclipse.swt.widgets.Scrollable.\u003cinit\u003e(Scrollable.java:72)\n   at org.eclipse.swt.widgets.Composite.\u003cinit\u003e(Composite.java:93)\n   at org.eclipse.ui.splash.BasicSplashHandler.getBundleProgressMonitor(BasicSplashHandler.java:159)\n   at org.eclipse.ui.splash.BasicSplashHandler.getContent(BasicSplashHandler.java:265)\n   at org.eclipse.ui.internal.splash.EclipseSplashHandler.init(EclipseSplashHandler.java:84)\n   at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:595)\n   at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n   at org.eclipse.ui.internal.Workbench.createSplashWrapper(Workbench.java:611)\n   at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2248)\n   at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n   at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n   at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n   at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n   at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n   at gr.apeirotan.planNET.Application.start(Application.java:142)\n   at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\n   at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n   at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n   at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n   at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n   at java.lang.reflect.Method.invoke(Unknown Source)\n   at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:497)\n   at org.eclipse.equinox.launcher.Main.basicRun(Main.java:436)\n   at org.eclipse.equinox.launcher.Main.run(Main.java:1162)\n   at org.eclipse.equinox.launcher.Main.main(Main.java:1137)",
    "And you say removing Platform.endSplash makes this better?  End splash is called after the events of this trace... were you calling it yourself?",
    "yes I call it my self and when I call it I get this trace.\n\n",
    "When do you call it?  Why are you calling it?  Is the default behavior not sufficient for your application?",
    "I suspect he is calling Platform.endSplash too early.  This ends up calling IApplicationContext.applicationRunning and tearing down the splash screen.\n\nThe Workbench is not initialized yet and continues to try and place SWT widgets in the splash which no longer exists.\n\nDefaultStartupMonitor.applicationRunning does the actual splash tear down  If we have anything to do, it is to remove the org.eclipse.equinox.launcher.splash.handle system property when we take down the splash so that the workbench does not try to put anything in it.",
    "*** Bug 196411 has been marked as a duplicate of this bug. ***",
    "Andrew, can we look into the fix you suggested for 3.4 and maybe even 3.3.1?",
    "fix will be trivial",
    "I call Platform.endSplash() on both platform Linux (glibc version 6.x) and Windows, both of them face this problem but window could not run after facing this bug. I call this function because I face problem listing bellow:\n 1. Run my application.\n 2. Close the splash when login dialog show.\nBut I could not close the splash. I solve this problem using my way, in this way I get the splash shell and set visible is false, this way run well on Linux but In window It throws StackOverflowException. I show the code to get the splash shell:\n\nString splashHandle \u003d System.getProperty(\"org.eclipse.equinox.launcher.splash.handle\"); //$NON-NLS-1$\n\t\t\tif (splashShell \u003d\u003d null) {\n\t\t\t\t\t// look for the 32 bit internal_new shell method\n\t\t\t\t\ttry {\n\t\t\t\t\t\tMethod method \u003d Shell.class\n\t\t\t\t\t\t\t\t.getMethod(\n\t\t\t\t\t\t\t\t\t\t\"internal_new\", new Class[] { Display.class, int.class }); //$NON-NLS-1$\n\t\t\t\t\t\t// we\u0027re on a 32 bit platform so invoke it with splash\n\t\t\t\t\t\t// handle as an int\n\t\t\t\t\t\tsplashShell \u003d (Shell) method.invoke(null, new Object[] {\n\t\t\t\t\t\t\t\tdisplay, new Integer(splashHandle) });\n\t\t\t\t\t} catch (NoSuchMethodException e) {\n\t\t\t\t\t\t// look for the 64 bit internal_new shell method\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tMethod method \u003d Shell.class\n\t\t\t\t\t\t\t\t\t.getMethod(\n\t\t\t\t\t\t\t\t\t\t\t\"internal_new\", new Class[] { Display.class, long.class }); //$NON-NLS-1$\n\n\t\t\t\t\t\t\t// we\u0027re on a 64 bit platform so invoke it with a long\n\t\t\t\t\t\t\tsplashShell \u003d (Shell) method.invoke(null,\n\t\t\t\t\t\t\t\t\tnew Object[] { display,\n\t\t\t\t\t\t\t\t\t\t\tnew Long(splashHandle) });\n\t\t\t\t\t\t} catch (NoSuchMethodException e2) {\n\t\t\t\t\t\t\t// cant find either method - don\u0027t do anything.\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\nI don\u0027t know why, please show me the way to solved this problem.\nNote: This bug occur when using Windows XP.\n ",
    "Created an attachment (id\u003d74095)\npatch\n\n\n",
    "Platform.endSplash() is the preferred way to take down the splash screen.\n\nTo work around the org.eclipse.swt.SWTError: No more handles problem, remove the splash.handle from the system properties after taking down the splash:\nSystem.getProperties().remove(\"org.eclipse.equinox.launcher.splash.handle\")\nWhich will prevent the workbench from trying to do the splash screen later.",
    "Done in HEAD and 3.3.1.  \n\nPlease open a new bug for the StackOverflowException mentioned in comment #11 and attach a stack trace.",
    "*** Bug 197691 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2007-05-21T15:33:53+02:00",
    "2007-05-22T18:02:14+02:00",
    "2007-06-05T20:16:56+02:00",
    "2007-06-19T06:54:03+02:00",
    "2007-06-19T12:39:22+02:00",
    "2007-06-19T15:24:26+02:00",
    "2007-06-19T15:46:33+02:00",
    "2007-06-19T15:53:46+02:00",
    "2007-07-17T18:27:41+02:00",
    "2007-07-17T18:28:20+02:00",
    "2007-07-17T18:54:36+02:00",
    "2007-07-18T07:30:01+02:00",
    "2007-07-18T23:28:03+02:00",
    "2007-07-18T23:43:29+02:00",
    "2007-07-23T17:35:49+02:00",
    "2007-07-24T21:38:01+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "No more handles",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3573"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3465"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3436"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "188091",
      "date": "2007-05-21T15:33:53+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    },
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "No more handles",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3573"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3465"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3436"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.error",
          "source": "Widget.java:432"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.createHandle",
          "source": "Control.java:602"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.createHandle",
          "source": "Composite.java:235"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.createWidget",
          "source": "Control.java:618"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.createWidget",
          "source": "Scrollable.java:131"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.\u003cinit\u003e",
          "source": "Control.java:97"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.\u003cinit\u003e",
          "source": "Scrollable.java:72"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.\u003cinit\u003e",
          "source": "Composite.java:93"
        },
        {
          "method": "org.eclipse.ui.splash.BasicSplashHandler.getBundleProgressMonitor",
          "source": "BasicSplashHandler.java:159"
        },
        {
          "method": "org.eclipse.ui.splash.BasicSplashHandler.getContent",
          "source": "BasicSplashHandler.java:265"
        },
        {
          "method": "org.eclipse.ui.internal.splash.EclipseSplashHandler.init",
          "source": "EclipseSplashHandler.java:84"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$5.run",
          "source": "Workbench.java:595"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createSplashWrapper",
          "source": "Workbench.java:611"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2248"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "gr.apeirotan.planNET.Application.start",
          "source": "Application.java:142"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:497"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:436"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1162"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1137"
        }
      ],
      "number": 1,
      "commentIndex": 3,
      "bugId": "188091",
      "date": "2007-06-19T06:54:03+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    }
  ],
  "groupId": "188091",
  "bugId": "188091",
  "date": "2007-05-21T15:33:53+02:00",
  "product": "Equinox",
  "component": "Framework",
  "severity": "normal"
}