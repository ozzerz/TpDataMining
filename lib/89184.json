{
  "comments": [
    "Version: 3.1.0\nBuild id: I20050322-1757\n\nThis is partly related to bug 88941.  After attempting to override a method from\nan abstract class eclipse hangs when you try to shut it down.  I have attached\nthe thread dump, but i can\u0027t see a deadlock (perhaps i am blind).  It sort of\nlooks like the \"System Bundle Shutdown\" thread can\u0027t shutdown because the\ndisplay has shutdown and isn\u0027t processing messages anymore.\n\nThis is the exception you get during shutdown:\njava.lang.NullPointerException\nat org.eclipse.swt.widgets.Tree.releaseWidget(Tree.java:1423)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:582)\nat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:587)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:582)\nat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:587)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:582)\nat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:587)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:582)\nat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:587)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:582)\nat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:587)\nat org.eclipse.swt.widgets.Canvas.releaseWidget(Canvas.java:118)\nat org.eclipse.swt.widgets.Decorations.releaseWidget(Decorations.java:714)\nat org.eclipse.swt.widgets.Shell.releaseWidget(Shell.java:860)\nat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:719)\nat org.eclipse.swt.widgets.Shell.releaseShells(Shell.java:854)\nat org.eclipse.swt.widgets.Shell.releaseWidget(Shell.java:859)\nat org.eclipse.swt.widgets.Widget.dispose(Widget.java:380)\nat org.eclipse.swt.widgets.Decorations.dispose(Decorations.java:373)\nat org.eclipse.swt.widgets.Shell.dispose(Shell.java:492)\nat org.eclipse.swt.widgets.Display.release(Display.java:2575)\nat org.eclipse.swt.graphics.Device.dispose(Device.java:243)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:118)\nat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:228)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:338)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:151)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:268)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:260)\nat org.eclipse.core.launcher.Main.run(Main.java:887)\nat org.eclipse.core.launcher.Main.main(Main.java:871)\n\n\n\n\nFull thread dump Java HotSpot(TM) Client VM (1.4.2-b28 mixed mode):\n\n\"System Bundle Shutdown\" prio\u003d7 tid\u003d0x04fedd90 nid\u003d0x4b0 in Object.wait()\n[442f000..442fd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:164)\n        - locked \u003c0x103f3170\u003e (a org.eclipse.swt.widgets.RunnableLock)\n        at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:28)\n        at org.eclipse.swt.widgets.Display.syncExec(Display.java:3219)\n        at\norg.eclipse.ui.internal.AbstractWorkingSetManager.firePropertyChange(AbstractWorkingSetManager.java:282)\n        at\norg.eclipse.ui.internal.AbstractWorkingSetManager.internalAddWorkingSet(AbstractWorkingSetManager.java:154)\n        at\norg.eclipse.ui.internal.AbstractWorkingSetManager.restoreWorkingSetState(AbstractWorkingSetManager.java:338)\n        at\norg.eclipse.ui.internal.WorkingSetManager.restoreState(WorkingSetManager.java:107)\n        at\norg.eclipse.ui.internal.WorkbenchPlugin.getWorkingSetManager(WorkbenchPlugin.java:442)\n        - locked \u003c0x11640be0\u003e (a org.eclipse.ui.internal.WorkbenchPlugin)\n        at\norg.eclipse.ui.internal.Workbench.getWorkingSetManager(Workbench.java:807)\n        at\norg.eclipse.debug.internal.ui.views.breakpoints.BreakpointSetOrganizer.dispose(BreakpointSetOrganizer.java:76)\n        at\norg.eclipse.debug.internal.ui.views.breakpoints.BreakpointOrganizerExtension.dispose(BreakpointOrganizerExtension.java:158)\n        at\norg.eclipse.debug.internal.ui.views.breakpoints.BreakpointOrganizerManager.shutdown(BreakpointOrganizerManager.java:152)\n        at org.eclipse.debug.internal.ui.DebugUIPlugin.stop(DebugUIPlugin.java:347)\n        at\norg.eclipse.osgi.framework.internal.core.BundleContextImpl$3.run(BundleContextImpl.java:1035)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at\norg.eclipse.osgi.framework.internal.core.BundleContextImpl.stop(BundleContextImpl.java:1031)\n        at\norg.eclipse.osgi.framework.internal.core.BundleHost.stopWorker(BundleHost.java:405)\n        at\norg.eclipse.osgi.framework.internal.core.AbstractBundle.stop(AbstractBundle.java:410)\n        at\norg.eclipse.core.runtime.adaptor.BundleStopper.basicStopBundles(BundleStopper.java:73)\n        at\norg.eclipse.core.runtime.adaptor.BundleStopper.stopBundles(BundleStopper.java:62)\n        at\norg.eclipse.core.runtime.adaptor.EclipseAdaptor.frameworkStopping(EclipseAdaptor.java:698)\n        at\norg.eclipse.osgi.framework.internal.core.Framework.shutdown(Framework.java:486)\n        - locked \u003c0x115fa710\u003e (a org.eclipse.osgi.framework.internal.core.Framework)\n        at\norg.eclipse.osgi.framework.internal.core.SystemBundle$1.run(SystemBundle.java:171)\n        at java.lang.Thread.run(Unknown Source)\n\n\"Worker-123\" prio\u003d5 tid\u003d0x04d6cc38 nid\u003d0x6ec in Object.wait() [877f000..877fd94]\n\n        at java.lang.Object.wait(Native Method)\n        at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:168)\n        - locked \u003c0x11640a98\u003e (a org.eclipse.core.internal.jobs.WorkerPool)\n        at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:200)\n        at org.eclipse.core.internal.jobs.Worker.run(Worker.java:60)\n\n\"Worker-98\" prio\u003d5 tid\u003d0x05c548b0 nid\u003d0x30c in Object.wait() [5acf000..5acfd94]\n        at java.lang.Object.wait(Native Method)\n        at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:168)\n        - locked \u003c0x11640a98\u003e (a org.eclipse.core.internal.jobs.WorkerPool)\n        at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:200)\n        at org.eclipse.core.internal.jobs.Worker.run(Worker.java:60)\n\n\"Java indexing\" daemon prio\u003d4 tid\u003d0x038efd20 nid\u003d0x698 in Object.wait()\n[43bf000..43bfd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at\norg.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:345)\n        - locked \u003c0x11841a00\u003e (a\norg.eclipse.jdt.internal.core.search.indexing.IndexManager)\n        at java.lang.Thread.run(Unknown Source)\n\n\"Reference Cleaner: 1\" prio\u003d7 tid\u003d0x03291658 nid\u003d0xfc in Object.wait()\n[37cf000..37cfd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        - locked \u003c0x118365e0\u003e (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        at\norg.eclipse.jface.resource.ImageCache$ReferenceCleanerThread.run(ImageCache.java:426)\n\n\"Start Level Event Dispatcher\" daemon prio\u003d5 tid\u003d0x02fc95f8 nid\u003d0x458 in\nObject.wait() [342f000..342fd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at\norg.eclipse.osgi.framework.eventmgr.EventThread.getNextEvent(EventThread.java:162)\n        - locked \u003c0x115fe838\u003e (a org.eclipse.osgi.framework.eventmgr.EventThread)\n        at org.eclipse.osgi.framework.eventmgr.EventThread.run(EventThread.java:100)\n\n\"Framework Event Dispatcher\" daemon prio\u003d5 tid\u003d0x02fc0d08 nid\u003d0x1a8 in\nObject.wait() [33ef000..33efd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at\norg.eclipse.osgi.framework.eventmgr.EventThread.getNextEvent(EventThread.java:162)\n        - locked \u003c0x115fff18\u003e (a org.eclipse.osgi.framework.eventmgr.EventThread)\n        at org.eclipse.osgi.framework.eventmgr.EventThread.run(EventThread.java:100)\n\n\"State Data Manager\" daemon prio\u003d5 tid\u003d0x02fb88f0 nid\u003d0x3f0 waiting on condition\n[33af000..33afd94]\n        at java.lang.Thread.sleep(Native Method)\n        at\norg.eclipse.osgi.internal.resolver.StateManager.run(StateManager.java:187)\n        at java.lang.Thread.run(Unknown Source)\n\n\"Signal Dispatcher\" daemon prio\u003d10 tid\u003d0x0003e140 nid\u003d0x154 waiting on condition\n[0..0]\n\n\"Finalizer\" daemon prio\u003d9 tid\u003d0x009bc770 nid\u003d0x614 in Object.wait()\n[2e1f000..2e1fd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        - locked \u003c0x113fce08\u003e (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(Unknown Source)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Unknown Source)\n\n\"Reference Handler\" daemon prio\u003d10 tid\u003d0x009bb340 nid\u003d0x660 in Object.wait()\n[2ddf000..2ddfd94]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at java.lang.ref.Reference$ReferenceHandler.run(Unknown Source)\n        - locked \u003c0x1149ebc8\u003e (a java.lang.ref.Reference$Lock)\n\n\"main\" prio\u003d7 tid\u003d0x00035d88 nid\u003d0x398 in Object.wait() [7f000..7fc40]\n        at java.lang.Object.wait(Native Method)\n        at java.lang.Object.wait(Unknown Source)\n        at org.eclipse.core.runtime.adaptor.Semaphore.acquire(Semaphore.java:33)\n\n        - locked \u003c0x10138808\u003e (a org.eclipse.core.runtime.adaptor.Semaphore)\n        at\norg.eclipse.core.runtime.adaptor.EclipseStarter.stopSystemBundle(EclipseStarter.java:996)\n        at\norg.eclipse.core.runtime.adaptor.EclipseStarter.shutdown(EclipseStarter.java:365)\n        at\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:166)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at org.eclipse.core.launcher.Main.invokeFramework(Main.java:268)\n        at org.eclipse.core.launcher.Main.basicRun(Main.java:260)\n        at org.eclipse.core.launcher.Main.run(Main.java:887)\n        at org.eclipse.core.launcher.Main.main(Main.java:871)\n\n\"VM Thread\" prio\u003d5 tid\u003d0x009ba170 nid\u003d0x588 runnable\n\n\"VM Periodic Task Thread\" prio\u003d10 tid\u003d0x02b5c498 nid\u003d0x284 waiting on condition\n\n\"Suspend Checker Thread\" prio\u003d10 tid\u003d0x0003d7f8 nid\u003d0x58c runnable",
    "It looks to me as if the BreakpointOrganizerManager is accessing the workbench after it\u0027s alreaedy been \nshut down.  The working set manager is being restored in the Bundle shutdown thread.",
    "fixed in BreakpointSetOrganizer and WorkingSetBreakpointOrganizer. Both classes now hold on to \nWorkingSetManager so that they don\u0027t have to get it during shutdown.\n",
    "Darin, please verify",
    "Verified code changes.\n\nCCing Jeff as this looks more like a shutdown problem to me. The Debug UI \nshould be shutdown before the workbench, in which case we should still be able \nto reference it.",
    "I think Kim\u0027s comment 1 is related to closing the workbench/terminating the\napplication (when SWT-related clean-up is done), as opposed to having the\nworkbench plug-in stopped (when models kept by the workbench are cleaned up).",
    "Actually, please disregard my comment above. You just worked around bug 71382."
  ],
  "commentCreationDates": [
    "2005-03-27T09:55:30+02:00",
    "2005-03-30T20:35:35+02:00",
    "2005-04-11T20:27:39+02:00",
    "2005-04-11T20:28:05+02:00",
    "2005-04-15T22:22:21+02:00",
    "2005-04-18T16:55:25+02:00",
    "2005-04-18T16:59:01+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.swt.widgets.Tree.releaseWidget",
          "source": "Tree.java:1423"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:582"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:587"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:582"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:587"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:582"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:587"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:582"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:587"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:582"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:587"
        },
        {
          "method": "org.eclipse.swt.widgets.Canvas.releaseWidget",
          "source": "Canvas.java:118"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.releaseWidget",
          "source": "Decorations.java:714"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.releaseWidget",
          "source": "Shell.java:860"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:719"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.releaseShells",
          "source": "Shell.java:854"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.releaseWidget",
          "source": "Shell.java:859"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.dispose",
          "source": "Widget.java:380"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.dispose",
          "source": "Decorations.java:373"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.dispose",
          "source": "Shell.java:492"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.release",
          "source": "Display.java:2575"
        },
        {
          "method": "org.eclipse.swt.graphics.Device.dispose",
          "source": "Device.java:243"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:118"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:228"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:338"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:151"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:268"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:260"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:887"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:871"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "89184",
      "date": "2005-03-27T09:55:30+02:00",
      "product": "Platform",
      "component": "Debug",
      "severity": "normal"
    }
  ],
  "groupId": "89184",
  "bugId": "89184",
  "date": "2005-03-27T09:55:30+02:00",
  "product": "Platform",
  "component": "Debug",
  "severity": "normal"
}