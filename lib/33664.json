{
  "comments": [
    "The nightly build tests which run under a 131 IBM vm did not run on Linux or \nWindows.  The following stack trace is in the log:\n\n!SESSION Mar 03, 2003 09:34:22.641 --------------------------------------------\n-\njava.fullversion\u003dJ2RE 1.3.1 IBM Windows 32 build cn131-20021102 (JIT enabled: \njitc)\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_US\nCommand-line arguments: -os win32 -ws win32 -arch x86 -install \nfile:C:/eclipseTesting/N-N20030302-200303020010_test/eclipse-testing/test-\neclipse/eclipse/\n!ENTRY org.eclipse.ant.core 4 1 Mar 03, 2003 09:34:22.641\n!MESSAGE Class org/xml/sax/Parser violates loader constraints:  definition \nmismatch between parent and child loaders\n!STACK 0\njava.lang.LinkageError: Class org/xml/sax/Parser violates loader constraints:  \ndefinition mismatch between parent and child loaders\n\tat org.apache.tools.ant.util.JAXPUtils.getParser(JAXPUtils.java:130)\n\tat org.apache.tools.ant.helper.ProjectHelperImpl.parse\n(ProjectHelperImpl.java:134)\n\tat org.apache.tools.ant.ProjectHelper.configureProject\n(ProjectHelper.java:117)\n\tat org.eclipse.ant.internal.core.ant.InternalAntRunner.parseBuildFile\n(InternalAntRunner.java:285)\n\tat org.eclipse.ant.internal.core.ant.InternalAntRunner.getTargets\n(InternalAntRunner.java:307)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat org.eclipse.ant.core.AntRunner.getAvailableTargets\n(AntRunner.java:204)\n\tat org.eclipse.ui.externaltools.internal.ant.model.AntUtil.getTargets\n(AntUtil.java:143)\n\tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntTargetsTab.ge\ntTargets(AntTargetsTab.java:232)\n\tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntTargetsTab.in\nitializeFrom(AntTargetsTab.java:297)\n\tat \norg.eclipse.debug.ui.AbstractLaunchConfigurationTabGroup.initializeFrom\n(AbstractLaunchConfigurationTabGroup.java:78)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupV\niewer.displayTabs(LaunchConfigurationTabGroupViewer.java:484)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupV\niewer.inputChanged(LaunchConfigurationTabGroupViewer.java:444)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupV\niewer.setInput(LaunchConfigurationTabGroupViewer.java:424)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationDialog.in\nitializeContent(LaunchConfigurationDialog.java:69)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.c\nreateContents(LaunchConfigurationsDialog.java:340)\n\tat org.eclipse.jface.window.Window.create(Window.java:296)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.c\nreate(LaunchConfigurationsDialog.java:1825)\n\tat org.eclipse.jface.window.Window.open(Window.java:546)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.o\npen(LaunchConfigurationsDialog.java:463)\n\tat \norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationPropertie\nsDialog.open(LaunchConfigurationPropertiesDialog.java:252)\n\tat org.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialog\n(DebugUITools.java:423)\n\tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchShortcu\nt.launch(AntLaunchShortcut.java:141)\n\tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchShortcu\nt.launch(AntLaunchShortcut.java:104)\n\tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntRunActionDele\ngate.run(AntRunActionDelegate.java:34)\n\tat org.eclipse.ui.actions.ActionDelegate.runWithEvent\n(ActionDelegate.java:71)\n\tat org.eclipse.ui.internal.PluginAction.runWithEvent\n(PluginAction.java:240)\n\tat \norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection\n(ActionContributionItem.java:456)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent\n(ActionContributionItem.java:403)\n\tat org.eclipse.jface.action.ActionContributionItem.access$0\n(ActionContributionItem.java:397)\n\tat \norg.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent\n(ActionContributionItem.java:72)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java\n(Inlined Compiled Code))\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java(Inlined \nCompiled Code))\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java\n(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java\n(Compiled Code))\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java\n(Compiled Code))\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1251)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:845)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:461)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:247)\n\tat org.eclipse.core.launcher.Main.run(Main.java:703)\n\tat org.eclipse.core.launcher.Main.main(Main.java:539)\n\nThis problem does not occur with a 1.4 level vm.",
    "This happened in builds over the weekend, N20030301-03.",
    "I can reproduce running on the latest plugins.\nRun Ant... on a build file gives you the error.",
    "This started with the fix for bug 33117.\nThe root of the problem here is the org.eclipse.tests adding xalan.jar to the \nruntime classpath of the AntClassLoader using the extraClasspathEntries \nextension point. This results in a mixed bag of xerces and xalan classes being \nloaded (the Parser class for example).\n\nI propose that org.eclipse.tests remove xalan.jar as an extraClasspathEntry in \nthe plugin.xml and then properly configure the genHtml target to make use of \nthe style task (set the classpath for the style task to point to xalan.jar?)",
    "Suggested modifications are in place for builds \u003e 200303032300.  Test build ran \nsuccessfully.",
    "We have a workaround so it is no longer a blocker...demoting to major.",
    "One solution for this would be to add a Xalan fragment for Xerces.  This would \nmake the Xalan function available and eliminate all duplicate XML-related \nclasses.\n\nPascal will create the fragment and pass it to the Releng team to try out.\n",
    "Another solution is to change the ordering of the AntClassLoader: load from the \nplugins first and then load from the URLs.",
    "The fragment approach did not solve the problem of the \"style\" task.\nRunning the task we got an error saying that a class required by the task is \nnot found.\n\nAfter talking with Darin, it seems that the pb may directy comes from the task \nitself that could do some weird stuff with the classloader.",
    "If you go for the solution described in comment #7, then you should consider \nsorting the plugins on their prerequisite order.\n\nTo do so, we could reuse the code in pde.build that do the sorting of plugins.\nFor more detail see \n   FeatureBuildScriptGenerator::generateAllPluginsTarget(...)\n\nand also\n   Utils.computePrerequisiteOrder\n",
    "I have reordered as per comment #7 and have copied the WAD of code from Utils \netc (whew!). Seems happy.\n\nThe interesting side effect is that I had to add code in the AntClassLoader to \nhandle working in dev mode. Otherwise since some ant support classes are on the \nbuild path for our projects (and not runtime) the classes would get loaded by \nthe wrong classloader (plugin classloader instead of the AntClassLoader).\nAny comments on this?",
    "comments other than \"bummer\"? :-)  \n\nIdeally people would use multiple output dirs for their projects and have the \nant tasks compile into a separate place.  Not sure how you would handle that.  \nBasically what is needed is a way of describing a Jar and relating it to a Java \nouptut folder.  Then you could use that in computing what to put on what part \nof the classpath.  I seem to remember some discussion of htis in JDT but don\u0027t \nremember what happened.\n\nso, is the code you had to add really ugly or is it tolerable?\n\n",
    "The code is not too bad. I use BootLoader.isDevelopmentMode and then package \nprefixes to disallow the plugin classloaders from loading the problem classes. \nIn \"normal\" mode it adds no cost. \nLikely another readme/doc entry for self-hosting as others will be affected as \nwell.",
    "I had to rename the packages in our test suite so that when self-hosting \ntesting we can distinguish the packages to get the classes loaded by the \ncorrect classloader.",
    "Pascal, can you send me the xerces fragment that contains xalan?",
    "The test mechanism now works in Nightly build N20030306 with xalan.jar added \nto the Ant classpath through the org.eclipse.ant.core.extraClasspathEntries \nextension point using a 1.3 vm.  I will revert our test mechanism for the next \nintegration build unless you have any objections.",
    "No objections. I would run it before the integration build to test.",
    "Changes are working for the build team.\nDarin could you please verify the code changes in AntClassLoader and \nAntCorePreferences.",
    "Verified."
  ],
  "commentCreationDates": [
    "2003-03-03T14:56:01+01:00",
    "2003-03-03T14:58:09+01:00",
    "2003-03-03T16:29:53+01:00",
    "2003-03-03T21:06:30+01:00",
    "2003-03-04T04:01:48+01:00",
    "2003-03-04T12:55:23+01:00",
    "2003-03-04T15:43:18+01:00",
    "2003-03-04T15:56:06+01:00",
    "2003-03-04T17:09:49+01:00",
    "2003-03-04T17:16:21+01:00",
    "2003-03-04T22:45:36+01:00",
    "2003-03-04T23:06:40+01:00",
    "2003-03-04T23:16:14+01:00",
    "2003-03-05T15:45:24+01:00",
    "2003-03-05T17:55:20+01:00",
    "2003-03-06T14:39:37+01:00",
    "2003-03-06T15:28:18+01:00",
    "2003-03-06T22:25:19+01:00",
    "2003-03-07T02:02:01+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.LinkageError",
      "message": "Class org/xml/sax/Parser violates loader constraints:   definition mismatch between parent and child loaders",
      "elements": [
        {
          "method": "org.apache.tools.ant.util.JAXPUtils.getParser",
          "source": "JAXPUtils.java:130"
        },
        {
          "method": "org.apache.tools.ant.helper.ProjectHelperImpl.parse",
          "source": "ProjectHelperImpl.java:134"
        },
        {
          "method": "org.apache.tools.ant.ProjectHelper.configureProject",
          "source": "ProjectHelper.java:117"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.InternalAntRunner.parseBuildFile",
          "source": "InternalAntRunner.java:285"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.InternalAntRunner.getTargets",
          "source": "InternalAntRunner.java:307"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.ant.core.AntRunner.getAvailableTargets",
          "source": "AntRunner.java:204"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.model.AntUtil.getTargets",
          "source": "AntUtil.java:143"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntTargetsTab.getTargets",
          "source": "AntTargetsTab.java:232"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntTargetsTab.initializeFrom",
          "source": "AntTargetsTab.java:297"
        },
        {
          "method": "org.eclipse.debug.ui.AbstractLaunchConfigurationTabGroup.initializeFrom",
          "source": "AbstractLaunchConfigurationTabGroup.java:78"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupViewer.displayTabs",
          "source": "LaunchConfigurationTabGroupViewer.java:484"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupViewer.inputChanged",
          "source": "LaunchConfigurationTabGroupViewer.java:444"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationTabGroupViewer.setInput",
          "source": "LaunchConfigurationTabGroupViewer.java:424"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationDialog.initializeContent",
          "source": "LaunchConfigurationDialog.java:69"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.createContents",
          "source": "LaunchConfigurationsDialog.java:340"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:296"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.create",
          "source": "LaunchConfigurationsDialog.java:1825"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:546"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.open",
          "source": "LaunchConfigurationsDialog.java:463"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationPropertiesDialog.open",
          "source": "LaunchConfigurationPropertiesDialog.java:252"
        },
        {
          "method": "org.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialog",
          "source": "DebugUITools.java:423"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchShortcut.launch",
          "source": "AntLaunchShortcut.java:141"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchShortcut.launch",
          "source": "AntLaunchShortcut.java:104"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntRunActionDelegate.run",
          "source": "AntRunActionDelegate.java:34"
        },
        {
          "method": "org.eclipse.ui.actions.ActionDelegate.runWithEvent",
          "source": "ActionDelegate.java:71"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:240"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:456"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent",
          "source": "ActionContributionItem.java:403"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$0",
          "source": "ActionContributionItem.java:397"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent",
          "source": "ActionContributionItem.java:72"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java (Inlined Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java(Inlined  Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java (Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java (Compiled Code)"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java (Compiled Code)"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1251"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:845"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:461"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:247"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:703"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:539"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "33664",
      "date": "2003-03-03T14:56:01+01:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "major"
    }
  ],
  "groupId": "33664",
  "bugId": "33664",
  "date": "2003-03-03T14:56:01+01:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "major"
}