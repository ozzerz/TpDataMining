{
  "comments": [
    "Hardware Environment:\n\nSoftware Environment:\n\nBuild:\n\n\nSteps to Reproduce:\n1. Import WAS SDB\n2. Select SDB, choose \"Convert to IBM Rules\", preserve XPath rules\n\nActual Results:\n\nThe following exception is logged in the error log.\n\nExpected Results:\n\nAdditional Information:\n\norg.eclipse.tptp.platform.provisional.fastxpath.compiler.CodeGenerationError: \n7139,7139:Syntax error, insert \") Statement\" to complete IfStatement\nat \norg.eclipse.tptp.platform.provisional.fastxpath.compiler.EclipseCompiler.genera\nteClass(EclipseCompiler.java:128)\nat \norg.eclipse.tptp.platform.provisional.jre14.fastxpath.compiler.CompilerHelper.b\nuildCompiledExpression(CompilerHelper.java:150)\nat \norg.eclipse.tptp.platform.provisional.jre14.fastxpath.FastXPathEngine.getExpres\nsionJavaSource(FastXPathEngine.java:190)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlTransformer.transformXpathToAC\nTL(ActlTransformer.java:47)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.ConvertXpathToACTL\n(ActlConverter.java:274)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTEventSelect\nor(ActlConverter.java:213)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTFilterRule\n(ActlConverter.java:149)\nat com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTRule\n(ActlConverter.java:130)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertAndAppen\ndXpathToAct(ActlConverterUtils.java:698)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathsTo\nAct(ActlConverterUtils.java:175)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathToA\nctRule(ActlConverterUtils.java:128)\nat com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convert\n(ActlConverterUtils.java:108)\nat com.ibm.etools.ac.act.editor.compiler.ConvertAction$ConvertJob.run\n(ConvertAction.java:141)\nat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)\n\n\n------- Additional Comment #1 From Malcom Zung 2006-05-30 15:02 EST -------\n\nThis exception also appears in the log:\n\njava.lang.StringIndexOutOfBoundsException\nat java.lang.StringBuffer.substring(StringBuffer.java:900)\nat \norg.eclipse.tptp.platform.provisional.fastxpath.compiler.CompilerPostProcessor.\nprocessLoops(CompilerPostProcessor.java:363)\nat \norg.eclipse.tptp.platform.provisional.fastxpath.compiler.CompilerPostProcessor.\npostCompileProcess(CompilerPostProcessor.java:78)\nat \norg.eclipse.tptp.platform.provisional.jre14.fastxpath.FastXPathEngine.getExpres\nsionJavaSource(FastXPathEngine.java:185)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlTransformer.transformXpathToAC\nTL(ActlTransformer.java:47)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.ConvertXpathToACTL\n(ActlConverter.java:274)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTEventSelect\nor(ActlConverter.java:213)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTFilterRule\n(ActlConverter.java:149)\nat com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTRule\n(ActlConverter.java:130)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertAndAppen\ndXpathToAct(ActlConverterUtils.java:698)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathsTo\nAct(ActlConverterUtils.java:175)\nat \ncom.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathToA\nctRule(ActlConverterUtils.java:128)\nat com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convert\n(ActlConverterUtils.java:108)\nat com.ibm.etools.ac.act.editor.compiler.ConvertAction$ConvertJob.run\n(ConvertAction.java:141)\nat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)\n\n\n------- Additional Comment #2 From Malcom Zung 2006-05-30 15:05 EST -------\n\nBuild: AC-4.2.0-200605301341",
    "The stack trace comes from an IBM tool.\nTo validate that this is a TPTP problem I need a scenario which is using only the TPTP code to reproduce the problem. Please reopen and attach such scenario\nThis will also help exclude the  IBM implementation as the one responsible for generating the exception",
    "Following xpath exprestions cause \norg.eclipse.tptp.platform.provisional.fastxpath.compiler.CodeGenerationError \nexception.\n\nUse following call in fastXpath \nString javaCode \u003d FastXPathAPI.getFastXPathEngine().getExpressionJavaSource\n(XPATHExpression, cbe, true, null,null,new CompilerPostProcessor(null, null)\n\n1\u003e\n/CommonBaseEvent [contains(@msg, \u0027SRVE0014E: Uncaught service() exception root \ncause\u0027) and contains(@msg, \u0027java.lang.IllegalStateException: ERROR: Cannot set \nheader. Response already committed.\u0027)]\n\n2\u003e\n/CommonBaseEvent [contains(@msg, \u0027SRVE0020E:\u0026quot;\u0027) and contains(@msg, \u0027JSP \n1.1 Processor\u0027) and contains(@msg, \u0027class: org/apache/jasper/compiler/JspUtil, \nmethod: parseXMLDoc signature: \n(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;)\nLorg/w3c/dom/Document;) Incompatible object argument for function call\u0026quot;: \ncom.ibm.servlet.engine.webapp.WebAppErrorReport: (class: \norg/apache/jasper/compiler/JspUtil, method: parseXMLDoc signature: \n(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;)\nLorg/w3c/dom/Document;) Incompatible object argument for function call\u0027) and \ncontains(@msg, \u0027javax.servlet.ServletException.\u0026lt;init\u0026gt;\u0027) and contains\n(@msg, \u0027com.ibm.websphere.servlet.error.ServletErrorReport.\u0026lt;init\u0026gt;\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppErrorReport.\u0026lt;init\u0026gt;\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppDispatcherResponse.sendError\u0027) and \ncontains(@msg, \u0027org.apache.jasper.runtime.JspServlet.unknownException\u0027) and \ncontains(@msg, \u0027org.apache.jasper.runtime.JspServlet.service\u0027) and contains\n(@msg, \u0027javax.servlet.http.HttpServlet.service\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.StrictServletInstance.doService\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.StrictLifecycleServlet._service\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.IdleServletState.service\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.StrictLifecycleServlet.service\u0027) \nand contains(@msg, \u0027com.ibm.servlet.engine.webapp.ServletInstance.service\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.ValidServletReferenceState.dispatch\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.ServletInstanceReference.dispatch\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.handleWebAppDispa\ntch\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.dispatch\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.forward\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.srt.WebAppInvoker.handleInvocationHook\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.invocation.CachedInvocation.handleInvocation\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.invocation.CacheableInvocationContext.invoke\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.srp.ServletRequestProcessor.dispatchByURI\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.OSEListenerDispatcher.service\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.SQEventListenerImp$ServiceRunnable.r\nun\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.SQEventListenerImp.notifySQEvent\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQEventSource.notifyEven\nt\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQWrapperEventSource$Sel\nectRunnable.notifyService\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQWrapperEventSource$Sel\nectRunnable.run\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.outofproc.OutOfProcThread$CtlRunnabl\ne.run\u0027) and contains(@msg, \u0027java.lang.Thread.run\u0027)]",
    "Eugene, this is something for you to handle; it would be good if you can take a look at this prior to Marius\u0027s leave",
    "*** Bug 147883 has been marked as a duplicate of this bug. ***",
    "Following xpath exprestions cause \norg.eclipse.tptp.platform.provisional.fastxpath.compiler.CodeGenerationError \nexception.\n\nUse following call in fastXpath \nString javaCode \u003d FastXPathAPI.getFastXPathEngine().getExpressionJavaSource\n(XPATHExpression, cbe, true, null,null,new CompilerPostProcessor(null, null)\n\n1\u003e\n/CommonBaseEvent [contains(@msg, \u0027SRVE0014E: Uncaught service() exception root \ncause\u0027) and contains(@msg, \u0027java.lang.IllegalStateException: ERROR: Cannot set \nheader. Response already committed.\u0027)]\n\n2\u003e\n/CommonBaseEvent [contains(@msg, \u0027SRVE0020E:\u0026quot;\u0027) and contains(@msg, \u0027JSP \n1.1 Processor\u0027) and contains(@msg, \u0027class: org/apache/jasper/compiler/JspUtil, \nmethod: parseXMLDoc signature: \n(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;)\nLorg/w3c/dom/Document;) Incompatible object argument for function call\u0026quot;: \ncom.ibm.servlet.engine.webapp.WebAppErrorReport: (class: \norg/apache/jasper/compiler/JspUtil, method: parseXMLDoc signature: \n(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;)\nLorg/w3c/dom/Document;) Incompatible object argument for function call\u0027) and \ncontains(@msg, \u0027javax.servlet.ServletException.\u0026lt;init\u0026gt;\u0027) and contains\n(@msg, \u0027com.ibm.websphere.servlet.error.ServletErrorReport.\u0026lt;init\u0026gt;\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppErrorReport.\u0026lt;init\u0026gt;\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppDispatcherResponse.sendError\u0027) and \ncontains(@msg, \u0027org.apache.jasper.runtime.JspServlet.unknownException\u0027) and \ncontains(@msg, \u0027org.apache.jasper.runtime.JspServlet.service\u0027) and contains\n(@msg, \u0027javax.servlet.http.HttpServlet.service\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.StrictServletInstance.doService\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.StrictLifecycleServlet._service\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.IdleServletState.service\u0027) and \ncontains(@msg, \u0027com.ibm.servlet.engine.webapp.StrictLifecycleServlet.service\u0027) \nand contains(@msg, \u0027com.ibm.servlet.engine.webapp.ServletInstance.service\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.ValidServletReferenceState.dispatch\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.ServletInstanceReference.dispatch\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.handleWebAppDispa\ntch\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.dispatch\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.webapp.WebAppRequestDispatcher.forward\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.srt.WebAppInvoker.handleInvocationHook\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.invocation.CachedInvocation.handleInvocation\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.invocation.CacheableInvocationContext.invoke\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.srp.ServletRequestProcessor.dispatchByURI\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.OSEListenerDispatcher.service\u0027) and \ncontains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.SQEventListenerImp$ServiceRunnable.r\nun\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.SQEventListenerImp.notifySQEvent\u0027) \nand contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQEventSource.notifyEven\nt\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQWrapperEventSource$Sel\nectRunnable.notifyService\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.serverqueue.SQWrapperEventSource$Sel\nectRunnable.run\u0027) and contains\n(@msg, \u0027com.ibm.servlet.engine.oselistener.outofproc.OutOfProcThread$CtlRunnabl\ne.run\u0027) and contains(@msg, \u0027java.lang.Thread.run\u0027)]",
    "When user supplied message contains open or close parenthesis, the parentheses are mistakenly considered when CompilerPostProcessor try to balance the parenthesese of the generated code. Same problem happens in predicates processing.",
    "Created an attachment (id\u003d47586)\npatch\n\n",
    "Patch committed.",
    "Verified with TPTP-4.2.1-200609010912.",
    "Closing issue"
  ],
  "commentCreationDates": [
    "2006-05-30T22:36:45+02:00",
    "2006-05-31T03:04:36+02:00",
    "2006-06-08T16:53:25+02:00",
    "2006-06-08T17:04:54+02:00",
    "2006-06-20T17:49:24+02:00",
    "2006-06-20T17:50:36+02:00",
    "2006-08-09T00:44:48+02:00",
    "2006-08-09T00:45:18+02:00",
    "2006-08-23T20:57:22+02:00",
    "2006-09-07T16:07:39+02:00",
    "2006-09-15T23:09:30+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.tptp.platform.provisional.fastxpath.compiler.CodeGenerationError",
      "message": "7139,7139:Syntax error, insert \") Statement\" to complete IfStatement",
      "elements": [
        {
          "method": "org.eclipse.tptp.platform.provisional.fastxpath.compiler.EclipseCompiler.generateClass",
          "source": "EclipseCompiler.java:128"
        },
        {
          "method": "org.eclipse.tptp.platform.provisional.jre14.fastxpath.compiler.CompilerHelper.buildCompiledExpression",
          "source": "CompilerHelper.java:150"
        },
        {
          "method": "org.eclipse.tptp.platform.provisional.jre14.fastxpath.FastXPathEngine.getExpressionJavaSource",
          "source": "FastXPathEngine.java:190"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlTransformer.transformXpathToACTL",
          "source": "ActlTransformer.java:47"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.ConvertXpathToACTL",
          "source": "ActlConverter.java:274"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTEventSelector",
          "source": "ActlConverter.java:213"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTFilterRule",
          "source": "ActlConverter.java:149"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTRule",
          "source": "ActlConverter.java:130"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertAndAppendXpathToAct",
          "source": "ActlConverterUtils.java:698"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathsToAct",
          "source": "ActlConverterUtils.java:175"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathToActRule",
          "source": "ActlConverterUtils.java:128"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convert",
          "source": "ActlConverterUtils.java:108"
        },
        {
          "method": "com.ibm.etools.ac.act.editor.compiler.ConvertAction$ConvertJob.run",
          "source": "ConvertAction.java:141"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "144545",
      "date": "2006-05-30T22:36:45+02:00",
      "product": "TPTP Profiling",
      "component": "Platform.Model",
      "severity": "major"
    },
    {
      "exceptionType": "java.lang.StringIndexOutOfBoundsException",
      "elements": [
        {
          "method": "java.lang.StringBuffer.substring",
          "source": "StringBuffer.java:900"
        },
        {
          "method": "org.eclipse.tptp.platform.provisional.fastxpath.compiler.CompilerPostProcessor.processLoops",
          "source": "CompilerPostProcessor.java:363"
        },
        {
          "method": "org.eclipse.tptp.platform.provisional.fastxpath.compiler.CompilerPostProcessor.postCompileProcess",
          "source": "CompilerPostProcessor.java:78"
        },
        {
          "method": "org.eclipse.tptp.platform.provisional.jre14.fastxpath.FastXPathEngine.getExpressionJavaSource",
          "source": "FastXPathEngine.java:185"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlTransformer.transformXpathToACTL",
          "source": "ActlTransformer.java:47"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.ConvertXpathToACTL",
          "source": "ActlConverter.java:274"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTEventSelector",
          "source": "ActlConverter.java:213"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTFilterRule",
          "source": "ActlConverter.java:149"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverter.createACTRule",
          "source": "ActlConverter.java:130"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertAndAppendXpathToAct",
          "source": "ActlConverterUtils.java:698"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathsToAct",
          "source": "ActlConverterUtils.java:175"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convertXpathToActRule",
          "source": "ActlConverterUtils.java:128"
        },
        {
          "method": "com.ibm.etools.ac.act.symptom.rule.converter.ActlConverterUtils.convert",
          "source": "ActlConverterUtils.java:108"
        },
        {
          "method": "com.ibm.etools.ac.act.editor.compiler.ConvertAction$ConvertJob.run",
          "source": "ConvertAction.java:141"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "144545",
      "date": "2006-05-30T22:36:45+02:00",
      "product": "TPTP Profiling",
      "component": "Platform.Model",
      "severity": "major"
    }
  ],
  "groupId": "144545",
  "bugId": "144545",
  "date": "2006-05-30T22:36:45+02:00",
  "product": "TPTP Profiling",
  "component": "Platform.Model",
  "severity": "major"
}