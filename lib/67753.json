{
  "comments": [
    "I200406172000, GTK+ 2.4.1, KDE 3.2.2, Linux 2.6.4. \n \nSometimes, when I have been running a self-hosted session and I shutdown, I get \nthe following output on the console.  It seems like the AllTypesCache is trying \nto load classes after the class loader has decided that it will no longer be \ndoing that.  The problem has happened a couple of times in the past two to \nthree hours, but does not happen all the time.  It is likely a race/timing \nproblem. \n \n \nAn exception occurred while writing to the platform log: \njava.lang.NullPointerException \n\tat \norg.eclipse.core.runtime.adaptor.EclipseLog.write(EclipseLog.java:378) \n\tat \norg.eclipse.core.runtime.adaptor.EclipseLog.writeStack(EclipseLog.java:368) \n\tat \norg.eclipse.core.runtime.adaptor.EclipseLog.writeLog(EclipseLog.java:332) \n\tat org.eclipse.core.runtime.adaptor.EclipseLog.log(EclipseLog.java:203) \n\tat \norg.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor(EclipseClassLoader.java:148) \n\tat \norg.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass(EclipseClassLoader.java:62) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:371) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:402) \n\tat \norg.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass(AbstractClassLoader.java:93) \n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:236) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.loadClass(BundleLoader.java:307) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleHost.loadClass(BundleHost.java:336) \n\tat \norg.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass(AbstractBundle.java:1313) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:131) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:124) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:113) \n\tat \norg.eclipse.jdt.core.JavaCore.getClasspathContainerInitializer(JavaCore.java:1223) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1245) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:1226) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:833) \n\tat \norg.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1184) \n\tat \norg.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1888) \n\tat \norg.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1798) \n\tat \norg.eclipse.jdt.internal.core.search.JavaSearchScope.add(JavaSearchScope.java:78) \n\tat \norg.eclipse.jdt.internal.core.search.JavaWorkspaceScope.initialize(JavaWorkspaceScope.java:80) \n\tat \norg.eclipse.jdt.internal.core.search.JavaSearchScope.\u003cinit\u003e(JavaSearchScope.java:52) \n\tat \norg.eclipse.jdt.internal.core.search.JavaWorkspaceScope.\u003cinit\u003e(JavaWorkspaceScope.java:31) \n\tat \norg.eclipse.jdt.core.search.SearchEngine.createWorkspaceScope(SearchEngine.java:423) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache.search(AllTypesCache.java:531) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.doSearchTypes(AllTypesCache.java:197) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.run(AllTypesCache.java:166) \nLogging to the console instead. \n \n!ENTRY org.eclipse.osgi Jun 17, 2004 19:44:51.181 \n!MESSAGE The class \"org.eclipse.jdt.internal.launching.JREContainerInitializer\" \ncannot be loaded because the system is shutting down and the plug-in \n\"org.eclipse.jdt.launching\" has already been stopped. \n!STACK 0 \njava.lang.ClassNotFoundException: The class \n\"org.eclipse.jdt.internal.launching.JREContainerInitializer\" cannot be loaded \nbecause the system is shutting down and the plug-in \"org.eclipse.jdt.launching\" \nhas already been stopped. \n\tat \norg.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor(EclipseClassLoader.java:147) \n\tat \norg.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass(EclipseClassLoader.java:62) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:371) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:402) \n\tat \norg.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass(AbstractClassLoader.java:93) \n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:236) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.loadClass(BundleLoader.java:307) \n\tat \norg.eclipse.osgi.framework.internal.core.BundleHost.loadClass(BundleHost.java:336) \n\tat \norg.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass(AbstractBundle.java:1313) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:131) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:124) \n\tat \norg.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:113) \n\tat \norg.eclipse.jdt.core.JavaCore.getClasspathContainerInitializer(JavaCore.java:1223) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1245) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:1226) \n\tat \norg.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:833) \n\tat \norg.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1184) \n\tat \norg.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1888) \n\tat \norg.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1798) \n\tat \norg.eclipse.jdt.internal.core.search.JavaSearchScope.add(JavaSearchScope.java:78) \n\tat \norg.eclipse.jdt.internal.core.search.JavaWorkspaceScope.initialize(JavaWorkspaceScope.java:80) \n\tat \norg.eclipse.jdt.internal.core.search.JavaSearchScope.\u003cinit\u003e(JavaSearchScope.java:52) \n\tat \norg.eclipse.jdt.internal.core.search.JavaWorkspaceScope.\u003cinit\u003e(JavaWorkspaceScope.java:31) \n\tat \norg.eclipse.jdt.core.search.SearchEngine.createWorkspaceScope(SearchEngine.java:423) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache.search(AllTypesCache.java:531) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.doSearchTypes(AllTypesCache.java:197) \n\tat \norg.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.run(AllTypesCache.java:166)",
    "AllTypesCache should not run after shutdown(), or shutdown() should wait for \nAllTypesCache to finish.\n\nMoving to JDT UI for comments.",
    "Results from investigating into the problem:\n\n- on shutdown, JDT/UI joins with the AllTypesChange using a join(1000)\n- so it might happen that the AllTypeCache thread is still running \n  although JDT/UI finish the shutdown.\n\nHowever, even if JDT/UI would wait until the AllTypeChange has finished, this \nsituation can occur since JDT/UI can\u0027t avoid that upper level plug-ins are \nshutdown.  In the specific example it would help since JDT/UI requires \norg.eclipse.jdt.launching.\n\nBut consider a scenario where the classpath container initializer is \ncontributed by a plug-in not required by JDT/UI. This is the case for the PDE \ncontainer we are using. In this scenario PDE is already stpped but JDT/Core \nstill wants to make upcalls into PDE. \n\nCCing Philippe since one solution would be to protect the class path container \ninitialization against this.",
    "Douglas,\n\ndoes this happen when you shutdown Eclipse right after you started it ? \n\nPhilippe,\n\ncan you comment on how the class path initalization works. I always thought \nthat they are only initialized once and this tyically happens very \"early\" \nsince the All types cache gets populated after the workbench is active after a \ncertain delay.",
    "Container gets initialized on demand. If nobody asks, then it could occur that \nfirst opportunity is during shutdown. We could add protection when \ninstantiating extensions, but I believe this is rather a platform bug.\n\nDup of bug 64134",
    "Dirk: I\u0027m not sure, but this is possible.  The next time it happens, I will try \nto let you know how long it was after start-up. ",
    "Philippe, \n\nwhen core runtime throws an CoreException in this scenario on shutdown will \nthis cause any harm to the JavaModel on shutdown. E.g. loss of data. As far as \nI can interpret it it shouldn\u0027t.\n\n",
    "It will traverse us, but we should be left consistent. Note that we deal \nnormally with situations where CoreException are occurring.",
    "Given that this will not cause any harm to the workspace (except the exception \nin the log) and we haven\u0027t seen this (can from our stand point only happen if \nyou startup and shutdown without having class path containers initialized) I \nopt to do nothing here for 3.0.",
    "*** Bug 67681 has been marked as a duplicate of this bug. ***",
    "*** Bug 75657 has been marked as a duplicate of this bug. ***",
    "Fixed by removing the all types cache."
  ],
  "commentCreationDates": [
    "2004-06-18T02:12:23+02:00",
    "2004-06-18T11:36:32+02:00",
    "2004-06-18T12:46:08+02:00",
    "2004-06-18T12:51:26+02:00",
    "2004-06-18T13:15:47+02:00",
    "2004-06-18T13:20:55+02:00",
    "2004-06-18T17:42:27+02:00",
    "2004-06-18T17:56:50+02:00",
    "2004-06-18T18:56:42+02:00",
    "2004-06-24T17:54:09+02:00",
    "2004-11-03T21:44:39+01:00",
    "2005-04-26T01:15:49+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseLog.write",
          "source": "EclipseLog.java:378"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseLog.writeStack",
          "source": "EclipseLog.java:368"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseLog.writeLog",
          "source": "EclipseLog.java:332"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseLog.log",
          "source": "EclipseLog.java:203"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor",
          "source": "EclipseClassLoader.java:148"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass",
          "source": "EclipseClassLoader.java:62"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:371"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:402"
        },
        {
          "method": "org.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass",
          "source": "AbstractClassLoader.java:93"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:236"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.loadClass",
          "source": "BundleLoader.java:307"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.loadClass",
          "source": "BundleHost.java:336"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass",
          "source": "AbstractBundle.java:1313"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:131"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:124"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:113"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainerInitializer",
          "source": "JavaCore.java:1223"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:1245"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers",
          "source": "JavaModelManager.java:1226"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:833"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1184"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1888"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1798"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchScope.add",
          "source": "JavaSearchScope.java:78"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaWorkspaceScope.initialize",
          "source": "JavaWorkspaceScope.java:80"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchScope.\u003cinit\u003e",
          "source": "JavaSearchScope.java:52"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaWorkspaceScope.\u003cinit\u003e",
          "source": "JavaWorkspaceScope.java:31"
        },
        {
          "method": "org.eclipse.jdt.core.search.SearchEngine.createWorkspaceScope",
          "source": "SearchEngine.java:423"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache.search",
          "source": "AllTypesCache.java:531"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.doSearchTypes",
          "source": "AllTypesCache.java:197"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.run",
          "source": "AllTypesCache.java:166"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "67753",
      "date": "2004-06-18T02:12:23+02:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ClassNotFoundException",
      "message": "The class  \"org.eclipse.jdt.internal.launching.JREContainerInitializer\" cannot be loaded  because the system is shutting down and the plug-in \"org.eclipse.jdt.launching\"  has already been stopped.",
      "elements": [
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor",
          "source": "EclipseClassLoader.java:147"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass",
          "source": "EclipseClassLoader.java:62"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:371"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:402"
        },
        {
          "method": "org.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass",
          "source": "AbstractClassLoader.java:93"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:236"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.loadClass",
          "source": "BundleLoader.java:307"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.loadClass",
          "source": "BundleHost.java:336"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass",
          "source": "AbstractBundle.java:1313"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:131"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:124"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:113"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainerInitializer",
          "source": "JavaCore.java:1223"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:1245"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers",
          "source": "JavaModelManager.java:1226"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:833"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1184"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1888"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1798"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchScope.add",
          "source": "JavaSearchScope.java:78"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaWorkspaceScope.initialize",
          "source": "JavaWorkspaceScope.java:80"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchScope.\u003cinit\u003e",
          "source": "JavaSearchScope.java:52"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaWorkspaceScope.\u003cinit\u003e",
          "source": "JavaWorkspaceScope.java:31"
        },
        {
          "method": "org.eclipse.jdt.core.search.SearchEngine.createWorkspaceScope",
          "source": "SearchEngine.java:423"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache.search",
          "source": "AllTypesCache.java:531"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.doSearchTypes",
          "source": "AllTypesCache.java:197"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.AllTypesCache$TypeCacher.run",
          "source": "AllTypesCache.java:166"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "67753",
      "date": "2004-06-18T02:12:23+02:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "67753",
  "bugId": "67753",
  "date": "2004-06-18T02:12:23+02:00",
  "product": "JDT",
  "component": "UI",
  "severity": "normal"
}