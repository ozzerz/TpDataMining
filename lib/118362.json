{
  "comments": [
    "SWT-win32, N20051127-0010\n\n- Run the testcase below\n- Expected result: both text lines are visible\n- Actual result: the first line is scrolled out of view\n- Does not happen in v3138-v3214\n\n---\n\nimport org.eclipse.swt.*;\nimport org.eclipse.swt.custom.*;\nimport org.eclipse.swt.layout.*;\nimport org.eclipse.swt.widgets.*;\n\npublic class StyledTextSelectAllTest {\n  public static void main(String[] args) {\n    Display display \u003d new Display();\n    \n    Shell shell \u003d new Shell(display);\n    shell.setLayout(new FillLayout());\n    \n    StyledText text \u003d new StyledText(\n      shell,\n      SWT.WRAP | SWT.MULTI | SWT.V_SCROLL);\n    text.setText(\"First line\\r\\nSecond line\");\n    text.selectAll();\n    \n    shell.setSize(200, 200);\n    shell.open();\n    \n    while (!shell.isDisposed()) {\n      if (!display.readAndDispatch()) {\n        display.sleep();\n      }\n    }\n    \n    display.dispose();\n  }\n}",
    "I could fix this easily by calling getVerticalScrollOffset() right after the line \"verticalScrollOffset \u003d -1;\", this will cause the verticallScrollOffset to be updated at that time. The problem here is performance, this can be very slow. We were trying to do this expensive work during the idle loop. The problem is that some calls (claimBottomFreeSpace() in this case) wont work till idle is finished.\n\nI go on vacation in one day I don\u0027t think I will have time to fix this, i\u0027m sorry.",
    "Note that it\u0027s not just a visual problem. If you run the testcase and then\nstart typing something, you\u0027ll get the following exception:\n\nException in thread \"main\" java.lang.IllegalArgumentException: Argument not valid\n\tat org.eclipse.swt.SWT.error(SWT.java:3246)\n\tat org.eclipse.swt.SWT.error(SWT.java:3185)\n\tat org.eclipse.swt.SWT.error(SWT.java:3156)\n\tat org.eclipse.swt.custom.DefaultContent.error(DefaultContent.java:670)\n\tat org.eclipse.swt.custom.DefaultContent.getLine(DefaultContent.java:478)\n\tat org.eclipse.swt.custom.StyledTextRenderer.getTextLayout(StyledTextRenderer.java:643)\n\tat org.eclipse.swt.custom.StyledTextRenderer.getTextLayout(StyledTextRenderer.java:607)\n\tat org.eclipse.swt.custom.StyledTextRenderer.calculate(StyledTextRenderer.java:197)\n\tat org.eclipse.swt.custom.StyledTextRenderer.getLineHeight(StyledTextRenderer.java:473)\n\tat org.eclipse.swt.custom.StyledText.getLineIndex(StyledText.java:3638)\n\tat org.eclipse.swt.custom.StyledText.handlePaint(StyledText.java:5195)\n\tat org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4804)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:906)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:930)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:915)\n\tat org.eclipse.swt.widgets.Composite.WM_PAINT(Composite.java:1208)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3234)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:3919)\n\tat org.eclipse.swt.internal.win32.OS.RedrawWindow(Native Method)\n\tat org.eclipse.swt.widgets.Control.update(Control.java:3054)\n\tat org.eclipse.swt.widgets.Control.update(Control.java:3044)\n\tat org.eclipse.swt.custom.StyledText.handleTextChanged(StyledText.java:5297)\n\tat org.eclipse.swt.custom.StyledText$6.textChanged(StyledText.java:4777)\n\tat org.eclipse.swt.custom.StyledTextListener.handleEvent(StyledTextListener.java:65)\n\tat org.eclipse.swt.custom.DefaultContent.sendTextEvent(DefaultContent.java:794)\n\tat org.eclipse.swt.custom.DefaultContent.replaceTextRange(DefaultContent.java:787)\n\tat org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:5748)\n\tat org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:6434)\n\tat org.eclipse.swt.custom.StyledText.doDelete(StyledText.java:2154)\n\tat org.eclipse.swt.custom.StyledText.invokeAction(StyledText.java:5637)\n\tat org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5036)\n\tat org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:5058)\n\tat org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4798)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:906)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:930)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:915)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:943)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:939)\n\tat org.eclipse.swt.widgets.Widget.wmKeyDown(Widget.java:1539)\n\tat org.eclipse.swt.widgets.Control.WM_KEYDOWN(Control.java:3501)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3210)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:3919)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1705)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2859)\n\nAnyway, happy vacation!",
    "you are right, topindex and other internal fields are have wrong values.\nI guess I\u0027m forced the release that one line (that will cause resizing of large files slow) till I have a better solution.\n",
    "fixed in head \u003e 20051130.\n\nI\u0027m going on vacantion tomorow and I can\u0027t change the code very much at this point. The current fix is good but I\u0027m not sure if fixes all the cases. When I return I\u0027ll improve this."
  ],
  "commentCreationDates": [
    "2005-11-29T05:02:00+01:00",
    "2005-11-29T22:46:35+01:00",
    "2005-11-29T22:54:51+01:00",
    "2005-11-29T22:59:41+01:00",
    "2005-11-30T22:31:43+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Argument not valid",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3246"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3185"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3156"
        },
        {
          "method": "org.eclipse.swt.custom.DefaultContent.error",
          "source": "DefaultContent.java:670"
        },
        {
          "method": "org.eclipse.swt.custom.DefaultContent.getLine",
          "source": "DefaultContent.java:478"
        },
        {
          "method": "org.eclipse.swt.custom.StyledTextRenderer.getTextLayout",
          "source": "StyledTextRenderer.java:643"
        },
        {
          "method": "org.eclipse.swt.custom.StyledTextRenderer.getTextLayout",
          "source": "StyledTextRenderer.java:607"
        },
        {
          "method": "org.eclipse.swt.custom.StyledTextRenderer.calculate",
          "source": "StyledTextRenderer.java:197"
        },
        {
          "method": "org.eclipse.swt.custom.StyledTextRenderer.getLineHeight",
          "source": "StyledTextRenderer.java:473"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.getLineIndex",
          "source": "StyledText.java:3638"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handlePaint",
          "source": "StyledText.java:5195"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$7.handleEvent",
          "source": "StyledText.java:4804"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:906"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:930"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:915"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_PAINT",
          "source": "Composite.java:1208"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3234"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3919"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.RedrawWindow",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.update",
          "source": "Control.java:3054"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.update",
          "source": "Control.java:3044"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleTextChanged",
          "source": "StyledText.java:5297"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$6.textChanged",
          "source": "StyledText.java:4777"
        },
        {
          "method": "org.eclipse.swt.custom.StyledTextListener.handleEvent",
          "source": "StyledTextListener.java:65"
        },
        {
          "method": "org.eclipse.swt.custom.DefaultContent.sendTextEvent",
          "source": "DefaultContent.java:794"
        },
        {
          "method": "org.eclipse.swt.custom.DefaultContent.replaceTextRange",
          "source": "DefaultContent.java:787"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.modifyContent",
          "source": "StyledText.java:5748"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.sendKeyEvent",
          "source": "StyledText.java:6434"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.doDelete",
          "source": "StyledText.java:2154"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.invokeAction",
          "source": "StyledText.java:5637"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKey",
          "source": "StyledText.java:5036"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKeyDown",
          "source": "StyledText.java:5058"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$7.handleEvent",
          "source": "StyledText.java:4798"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:906"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:930"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:915"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:943"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:939"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.wmKeyDown",
          "source": "Widget.java:1539"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_KEYDOWN",
          "source": "Control.java:3501"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3210"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3919"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1705"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2859"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "118362",
      "date": "2005-11-29T22:54:51+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "118362",
  "bugId": "118362",
  "date": "2005-11-29T05:02:00+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}