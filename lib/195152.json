{
  "comments": [
    "N20070702-0010\n\nStep: try to open Keys preference page\n\n!ENTRY org.eclipse.jface 4 2 2007-07-02 17:45:10.046\n!MESSAGE Problems occurred when invoking code from plug-in: \"org.eclipse.jface\".\n!STACK 0\njava.lang.NullPointerException\n        at org.eclipse.ui.internal.keys.NewKeysPreferencePage$17.updateControl(NewKeysPreferencePage.java:1679)\n        at org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater$1.run(ControlUpdater.java:106)\n        at org.eclipse.core.databinding.observable.ObservableTracker.runAndMonitor(ObservableTracker.java:102)\n        at org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater.updateIfNecessary(ControlUpdater.java:130)\n        at org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater.\u003cinit\u003e(ControlUpdater.java:125)\n        at org.eclipse.ui.internal.keys.NewKeysPreferencePage$17.\u003cinit\u003e(NewKeysPreferencePage.java:1677)\n        at org.eclipse.ui.internal.keys.NewKeysPreferencePage.createTreeControls(NewKeysPreferencePage.java:1677)\n        at org.eclipse.ui.internal.keys.NewKeysPreferencePage.createContents(NewKeysPreferencePage.java:1274)\n        at org.eclipse.jface.preference.PreferencePage.createControl(PreferencePage.java:235)\n        at org.eclipse.jface.preference.PreferenceDialog.createPageControl(PreferenceDialog.java:1456)\n        at org.eclipse.jface.preference.PreferenceDialog$13.run(PreferenceDialog.java:1213)\n        at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n        at org.eclipse.core.runtime.Platform.run(Platform.java:857)\n        at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:46)\n        at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:193)\n        at org.eclipse.jface.preference.PreferenceDialog.showPage(PreferenceDialog.java:1207)\n        at org.eclipse.ui.internal.dialogs.FilteredPreferenceDialog.showPage(FilteredPreferenceDialog.java:433)\n        at org.eclipse.jface.preference.PreferenceDialog$9.selectionChanged(PreferenceDialog.java:698)\n        at org.eclipse.jface.viewers.StructuredViewer$3.run(StructuredViewer.java:842)\n        at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n        at org.eclipse.core.runtime.Platform.run(Platform.java:857)\n        at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:46)\n        at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:193)\n        at org.eclipse.jface.viewers.StructuredViewer.firePostSelectionChanged(StructuredViewer.java:840)\n        at org.eclipse.jface.viewers.StructuredViewer.handlePostSelect(StructuredViewer.java:1153)\n        at org.eclipse.jface.viewers.StructuredViewer$5.widgetSelected(StructuredViewer.java:1178)\n        at org.eclipse.jface.util.OpenStrategy.firePostSelectionEvent(OpenStrategy.java:250)\n        at org.eclipse.jface.util.OpenStrategy.access$4(OpenStrategy.java:244)\n        at org.eclipse.jface.util.OpenStrategy$3.run(OpenStrategy.java:418)\n        at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n        at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n        at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3658)\n        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3295)\n        at org.eclipse.jface.window.Window.runEventLoop(Window.java:825)\n        at org.eclipse.jface.window.Window.open(Window.java:801)\n        at org.eclipse.ui.internal.OpenPreferencesAction.run(OpenPreferencesAction.java:65)\n        at org.eclipse.jface.action.Action.runWithEvent(Action.java:498)\n        at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:545)\n        at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:490)\n        at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:402)\n        at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n        at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\n        at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3681)\n        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3292)\n        at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\n        at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\n        at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n        at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n        at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n        at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n        at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n        at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n        at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:504)\n        at org.eclipse.equinox.launcher.Main.basicRun(Main.java:443)\n        at org.eclipse.equinox.launcher.Main.run(Main.java:1169)\n        at org.eclipse.equinox.launcher.Main.main(Main.java:1144)",
    "Boris, I think this happens due to the change in ControlUpdater 1.11.\n\nThe constructor of ControlUpdater now calls updateIfNecessary(), which eventually calls the abstract method updateControl(). Unfortunately, the synthetic field val$selection of the anonymous ControlUpdater has not been initialized yet at that point in time, because bytecode \u003c\u003d 1.3 does not allow initializing fields in the subclass before the superclass constructor has been executed (see also bug 164497 comment 3 for an explanation).\n\nThe morale of the story: Minimize initialization code in the constructor and NEVER call a non-private instance method of the \u0027this\u0027 under construction. If you really need to execute updateIfNecessary(), then you should do that only after the object has been created (e.g. in a connect(Control) method that takes the argument currently passed to the constructor).\n\n\nFWIW: Here\u0027s a standalone version of the problem (runs fine if compiled with .class file compatibility \u003e\u003d 1.4, NPE if compiled with \u003c\u003d 1.3):\n\npublic class Client {\n\tpublic static void main(String[] args) {\n\t\tfinal StringBuffer selection\u003d new StringBuffer(\"Hello\");\n\t\t\n\t\tnew ControlUpdater() {\n\t\t\tprotected void updateControl() {\n\t\t\t\tObject selectedObject \u003d selection.toString();\n\t\t\t\tSystem.out.println(selectedObject);\n\t\t\t}\n\t\t};\n\t}\n}\n\nabstract class ControlUpdater {\n\n\tprivate Runnable updateRunnable \u003d new Runnable() {\n\t\tpublic void run() {\n\t\t\tupdateControl();\n\t\t}\n\t};\n\t\n\tpublic ControlUpdater() {\n\t\tupdateRunnable.run();\n\t}\n\n\tprotected abstract void updateControl();\n}",
    "Boris is away this week (as am I :-)\n\nIf this is serious, we could revert ControlUpdater to 1.10 until Boris can have a look.\n\nBradley, could you have a quick look and see if that will kill anything else?\n\nPW\n",
    "\u003e Boris is away this week (as am I :-)\n\u003e \n\u003e If this is serious, we could revert ControlUpdater to 1.10 until Boris can have\n\u003e a look.\n\nThanks for looking into it. The Keys preference page works again for me when I revert ControlUpdater to 1.10, so I can give my +1 for this change.",
    "Unless I hear different from Bradley or Boris, I\u0027ll revert it to 1.10 contents for tonight\u0027s nightly build.\n\nPW\n",
    "Reverting to 1.10 is fine.",
    "Revert to 1.10 released into HEAD \u003e20070705\nPW\n",
    "in HEAD\nPW\n"
  ],
  "commentCreationDates": [
    "2007-07-02T17:47:12+02:00",
    "2007-07-05T13:15:42+02:00",
    "2007-07-05T14:11:57+02:00",
    "2007-07-05T15:20:16+02:00",
    "2007-07-05T15:31:27+02:00",
    "2007-07-05T20:50:38+02:00",
    "2007-07-06T00:46:53+02:00",
    "2007-07-11T16:39:53+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.keys.NewKeysPreferencePage$17.updateControl",
          "source": "NewKeysPreferencePage.java:1679"
        },
        {
          "method": "org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater$1.run",
          "source": "ControlUpdater.java:106"
        },
        {
          "method": "org.eclipse.core.databinding.observable.ObservableTracker.runAndMonitor",
          "source": "ObservableTracker.java:102"
        },
        {
          "method": "org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater.updateIfNecessary",
          "source": "ControlUpdater.java:130"
        },
        {
          "method": "org.eclipse.jface.internal.databinding.provisional.swt.ControlUpdater.\u003cinit\u003e",
          "source": "ControlUpdater.java:125"
        },
        {
          "method": "org.eclipse.ui.internal.keys.NewKeysPreferencePage$17.\u003cinit\u003e",
          "source": "NewKeysPreferencePage.java:1677"
        },
        {
          "method": "org.eclipse.ui.internal.keys.NewKeysPreferencePage.createTreeControls",
          "source": "NewKeysPreferencePage.java:1677"
        },
        {
          "method": "org.eclipse.ui.internal.keys.NewKeysPreferencePage.createContents",
          "source": "NewKeysPreferencePage.java:1274"
        },
        {
          "method": "org.eclipse.jface.preference.PreferencePage.createControl",
          "source": "PreferencePage.java:235"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.createPageControl",
          "source": "PreferenceDialog.java:1456"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$13.run",
          "source": "PreferenceDialog.java:1213"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.JFaceUtil$1.run",
          "source": "JFaceUtil.java:46"
        },
        {
          "method": "org.eclipse.jface.util.SafeRunnable.run",
          "source": "SafeRunnable.java:193"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.showPage",
          "source": "PreferenceDialog.java:1207"
        },
        {
          "method": "org.eclipse.ui.internal.dialogs.FilteredPreferenceDialog.showPage",
          "source": "FilteredPreferenceDialog.java:433"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$9.selectionChanged",
          "source": "PreferenceDialog.java:698"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$3.run",
          "source": "StructuredViewer.java:842"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.JFaceUtil$1.run",
          "source": "JFaceUtil.java:46"
        },
        {
          "method": "org.eclipse.jface.util.SafeRunnable.run",
          "source": "SafeRunnable.java:193"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.firePostSelectionChanged",
          "source": "StructuredViewer.java:840"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.handlePostSelect",
          "source": "StructuredViewer.java:1153"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$5.widgetSelected",
          "source": "StructuredViewer.java:1178"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy.firePostSelectionEvent",
          "source": "OpenStrategy.java:250"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy.access$4",
          "source": "OpenStrategy.java:244"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy$3.run",
          "source": "OpenStrategy.java:418"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3658"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3295"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:825"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:801"
        },
        {
          "method": "org.eclipse.ui.internal.OpenPreferencesAction.run",
          "source": "OpenPreferencesAction.java:65"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:498"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:545"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:490"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:402"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3681"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3292"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:504"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:443"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1169"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1144"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "195152",
      "date": "2007-07-02T17:47:12+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "blocker"
    }
  ],
  "groupId": "195152",
  "bugId": "195152",
  "date": "2007-07-02T17:47:12+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "blocker"
}