{
  "comments": [
    "Latest cheetah from CVS. NullPointerException when a subclass of a generic type\nuses protected member field of its parent. This NPE makes java editor unusable\n(i.e. cannot save the source). Yet another reason to resolve bug 68586 ;-)\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\npackage test.cheetah;\npublic class G\u003cE\u003e {\n    protected Object o;\n}\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\npackage test.cheetah;\npublic class NG extends G {\n    public boolean test() {\n        return o \u003d\u003d null;\n    }\n}\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nCompiling the second of the two classes results in\n\n!ENTRY org.eclipse.core.runtime 4 2 Jun 30, 2004 08:48:46.830\n!MESSAGE Problems occurred when invoking code from plug-in:\n\"org.eclipse.core.runtime\".\n!STACK 0\njava.lang.NullPointerException\n\tat\norg.eclipse.jdt.internal.compiler.codegen.CodeStream.generateConstant(CodeStream.java:1385)\n\tat\norg.eclipse.jdt.internal.compiler.ast.SingleNameReference.generateCode(SingleNameReference.java:304)\n\tat\norg.eclipse.jdt.internal.compiler.ast.EqualExpression.generateOptimizedNonBooleanEqual(EqualExpression.java:401)\n\tat\norg.eclipse.jdt.internal.compiler.ast.EqualExpression.generateOptimizedBoolean(EqualExpression.java:275)\n\tat\norg.eclipse.jdt.internal.compiler.ast.EqualExpression.generateCode(EqualExpression.java:232)\n\tat\norg.eclipse.jdt.internal.compiler.ast.ReturnStatement.generateCode(ReturnStatement.java:116)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode(AbstractMethodDeclaration.java:214)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode(AbstractMethodDeclaration.java:161)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode(TypeDeclaration.java:555)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode(TypeDeclaration.java:609)\n\tat\norg.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.generateCode(CompilationUnitDeclaration.java:180)\n\tat org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:514)\n\tat org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:335)\n\tat\norg.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:209)\n\tat\norg.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:159)\n\tat\norg.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:49)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:212)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:135)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:564)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:747)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:157)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:249)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:229)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:747)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:232)\n\tat\norg.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:268)\n\tat org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:297)\n\tat org.eclipse.core.internal.resources.Workspace.build(Workspace.java:198)\n\tat org.eclipse.ui.actions.GlobalBuildAction$1.run(GlobalBuildAction.java:182)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:66)\n\n\nPS: as a positive side effect of this bug I had to encapsulate all protected\nvariables :-)",
    "Fixed in HEAD. Constant propagation did not handle correctly duality of \nParameterizedFieldBinding and original FieldBinding.\n\nAdded regression test: GenericTypeTest#test216.",
    "Compiling the same code now results in ClassCastException\n\n!ENTRY org.eclipse.jdt.core 4 4 Jul 01, 2004 21:44:21.322\n!MESSAGE Exception occurred during problem detection: \n!STACK 0\njava.lang.ClassCastException\n\tat\norg.eclipse.jdt.internal.compiler.ast.FieldReference.getConstantFor(FieldReference.java:352)\n\tat\norg.eclipse.jdt.internal.compiler.ast.SingleNameReference.checkFieldAccess(SingleNameReference.java:163)\n\tat\norg.eclipse.jdt.internal.compiler.ast.SingleNameReference.resolveType(SingleNameReference.java:647)\n\tat\norg.eclipse.jdt.internal.compiler.ast.EqualExpression.resolveType(EqualExpression.java:504)\n\tat\norg.eclipse.jdt.internal.compiler.ast.ReturnStatement.resolve(ReturnStatement.java:214)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolveStatements(AbstractMethodDeclaration.java:395)\n\tat\norg.eclipse.jdt.internal.compiler.ast.MethodDeclaration.resolveStatements(MethodDeclaration.java:134)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolve(AbstractMethodDeclaration.java:373)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:920)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:969)\n\tat\norg.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.resolve(CompilationUnitDeclaration.java:280)\n\tat org.eclipse.jdt.internal.compiler.Compiler.resolve(Compiler.java:564)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnitProblemFinder.process(CompilationUnitProblemFinder.java:176)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:146)\n\tat org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:183)\n\tat org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:572)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:971)\n\tat\norg.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:58)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:700)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:739)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1097)\n\tat\norg.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:88)\n\tat\norg.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:129)\n\tat\norg.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:86)\n\tat\norg.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:96)\n\tat org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:75)\n\tat org.eclipse.jdt.internal.ui.text.JavaReconciler.process(JavaReconciler.java:315)\n\tat\norg.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:204)",
    "Igor - are you sure you took the proper fix from HEAD ? Can no longer \nreproduce, and regression test is passing.",
    "Just checked that my org.eclipse.jdt.core is in sync with HEAD and yet I am\ngetting the ClassCastException. I have two workspaces -- one for cheetah itself\nand another for jdk1.5 based development -- and start latter from former. I\u0027ll\ntry to run the regression tests later today or tomorrow to see if I can\nreproduce the problem.",
    "FieldReference#getConstantFor cannot handle bindings to final members of\nparametrized classes. At around line 352 it assumes that all\nbinding.declaringClass are instanced of SourceTypeBinding which is not the case\nfor parametrized types because ParameterizedTypeBinding is not subclass of\nSourceTypeBinding. Here is a slightly modified version of my original example\nthat demostrates the problem (the only difference from original is \"final\"\nqualifier of member \"o\").\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\npackage test.cheetah;\npublic class G\u003cE\u003e {\n    protected final Object o;\n}\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\npackage test.cheetah;\npublic class NG extends G {\n    public boolean test() {\n        return o \u003d\u003d null;\n    }\n}\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\n\nPS: am I right that a field has to be both final and static to be a constant?\nWhy can\u0027t you use \"!binding.isFinal() || !binding.isStatic()\" condition instead\nof \"!binding.isFinal()\" at line 334?",
    "Constant fields do not need to be static.\n\nI had indeed missed handling the final scenario.\nAdded support and regression test GenericTypeTest#test224."
  ],
  "commentCreationDates": [
    "2004-06-30T14:59:51+02:00",
    "2004-07-01T17:17:28+02:00",
    "2004-07-02T03:52:31+02:00",
    "2004-07-03T16:21:10+02:00",
    "2004-07-03T18:42:52+02:00",
    "2004-07-05T15:24:40+02:00",
    "2004-07-05T18:57:10+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.codegen.CodeStream.generateConstant",
          "source": "CodeStream.java:1385"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.SingleNameReference.generateCode",
          "source": "SingleNameReference.java:304"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.EqualExpression.generateOptimizedNonBooleanEqual",
          "source": "EqualExpression.java:401"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.EqualExpression.generateOptimizedBoolean",
          "source": "EqualExpression.java:275"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.EqualExpression.generateCode",
          "source": "EqualExpression.java:232"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.ReturnStatement.generateCode",
          "source": "ReturnStatement.java:116"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode",
          "source": "AbstractMethodDeclaration.java:214"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode",
          "source": "AbstractMethodDeclaration.java:161"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode",
          "source": "TypeDeclaration.java:555"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode",
          "source": "TypeDeclaration.java:609"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.generateCode",
          "source": "CompilationUnitDeclaration.java:180"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.process",
          "source": "Compiler.java:514"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:335"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile",
          "source": "AbstractImageBuilder.java:209"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile",
          "source": "AbstractImageBuilder.java:159"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build",
          "source": "BatchImageBuilder.java:49"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll",
          "source": "JavaBuilder.java:212"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.build",
          "source": "JavaBuilder.java:135"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:564"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:157"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:249"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:202"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:229"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:232"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "BuildManager.java:268"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:297"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.build",
          "source": "Workspace.java:198"
        },
        {
          "method": "org.eclipse.ui.actions.GlobalBuildAction$1.run",
          "source": "GlobalBuildAction.java:182"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:66"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "68998",
      "date": "2004-06-30T14:59:51+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ClassCastException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.FieldReference.getConstantFor",
          "source": "FieldReference.java:352"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.SingleNameReference.checkFieldAccess",
          "source": "SingleNameReference.java:163"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.SingleNameReference.resolveType",
          "source": "SingleNameReference.java:647"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.EqualExpression.resolveType",
          "source": "EqualExpression.java:504"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.ReturnStatement.resolve",
          "source": "ReturnStatement.java:214"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolveStatements",
          "source": "AbstractMethodDeclaration.java:395"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.MethodDeclaration.resolveStatements",
          "source": "MethodDeclaration.java:134"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolve",
          "source": "AbstractMethodDeclaration.java:373"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve",
          "source": "TypeDeclaration.java:920"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve",
          "source": "TypeDeclaration.java:969"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.resolve",
          "source": "CompilationUnitDeclaration.java:280"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.resolve",
          "source": "Compiler.java:564"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnitProblemFinder.process",
          "source": "CompilationUnitProblemFinder.java:176"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.buildStructure",
          "source": "CompilationUnit.java:146"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.generateInfos",
          "source": "Openable.java:183"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaElement.openWhenClosed",
          "source": "JavaElement.java:572"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent",
          "source": "CompilationUnit.java:971"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation",
          "source": "ReconcileWorkingCopyOperation.java:58"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:700"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:739"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.reconcile",
          "source": "CompilationUnit.java:1097"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:88"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:129"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.CompositeReconcilingStrategy.reconcile",
          "source": "CompositeReconcilingStrategy.java:86"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile",
          "source": "JavaCompositeReconcilingStrategy.java:96"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.MonoReconciler.process",
          "source": "MonoReconciler.java:75"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.JavaReconciler.process",
          "source": "JavaReconciler.java:315"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run",
          "source": "AbstractReconciler.java:204"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "68998",
      "date": "2004-07-02T03:52:31+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "68998",
  "bugId": "68998",
  "date": "2004-06-30T14:59:51+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}