{
  "comments": [
    "3.1 RC1\n\nI don\u0027t have any steps to reproduce the problem. I just found this exception in\nthe log file. I was checking out some resources from CVS at this time. But I\u0027m\npretty sure that the Package Explore wasn\u0027t open in the CVS perspective.\n\n!ENTRY org.eclipse.ui 4 4 2005-06-08 15:10:14.334\n!MESSAGE Unhandled event loop exception\n\n!ENTRY org.eclipse.ui 4 0 2005-06-08 15:10:14.334\n!MESSAGE Widget is disposed\n!STACK 0\norg.eclipse.swt.SWTException: Widget is disposed\n    at org.eclipse.swt.SWT.error(SWT.java:2940)\n    at org.eclipse.swt.SWT.error(SWT.java:2863)\n    at org.eclipse.swt.SWT.error(SWT.java:2834)\n    at org.eclipse.swt.widgets.Widget.error(Widget.java:395)\n    at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:297)\n    at org.eclipse.swt.widgets.Widget.getData(Widget.java:448)\n    at\norg.eclipse.jface.viewers.AbstractTreeViewer.updateChildren(AbstractTreeViewer.java:1764)\n    at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct(AbstractTreeViewer.java:1268)\n    at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh(AbstractTreeViewer.java:1245)\n    at\norg.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh(AbstractTreeViewer.java:1201)\n    at\norg.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$PackageExplorerProblemTreeViewer.internalRefresh(PackageExplorerPart.java:492)\n    at org.eclipse.jface.viewers.StructuredViewer$8.run(StructuredViewer.java:1291)\n    at\norg.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1201)\n    at\norg.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$PackageExplorerProblemTreeViewer.preservingSelection(PackageExplorerPart.java:598)\n    at\norg.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1289)\n    at\norg.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$3.run(PackageExplorerContentProvider.java:615)\n    at\norg.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$7.run(PackageExplorerContentProvider.java:659)\n    at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n    at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n    at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2906)\n    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2565)\n    at org.eclipse.jface.window.Window.runEventLoop(Window.java:809)\n    at org.eclipse.jface.window.Window.open(Window.java:787)\n    at\norg.eclipse.team.internal.ccvs.ui.actions.CheckoutAsAction.execute(CheckoutAsAction.java:31)\n    at org.eclipse.team.internal.ccvs.ui.actions.CVSAction.run(CVSAction.java:117)\n    at org.eclipse.ui.actions.ActionDelegate.runWithEvent(ActionDelegate.java:70)\n    at org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:236)\n    at\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:538)\n    at\norg.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n    at\norg.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:844)\n    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2929)\n    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2562)\n    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1694)\n    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1658)\n    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:366)\n    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n    at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n    at\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\n    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:375)\n    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:162)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n    at org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n    at org.eclipse.core.launcher.Main.run(Main.java:973)\n    at org.eclipse.core.launcher.Main.main(Main.java:948)\n\n!ENTRY org.eclipse.core.resources 2 1 2005-06-08 15:10:14.365\n!MESSAGE Skipping builder org.antlr.eclipse.core.antlrbuilder for project\nnet.sourceforge.clearcase. Either the builder is missing from the install, or it\nbelongs to a project nature that is missing or disabled.",
    "Gunnar, any steps to reproduce. And an additional question: was the package\nexplorer open when the exception occurred or was it closed ?",
    "No, sorry. I just found this in the log, while I was investigating another issue\nin the CVS component. I was in the CVS perspective and the Package Explorer\nwasn\u0027t open there. But it was opend in the Java perspective. There was no popup\ndialog, thus I didn\u0027t realize this error in the UI.",
    "Given that this happened while the package explorer was open points more to a\nJFace viewer problem (accessing an already disposed item) then to a problem in\nthe package explorer.\n\nHowever without any hint how and when this happens hard to fix. Setting to\nRemind and CCing Nick to get a opinion from JFace.",
    "It\u0027s always possible for a widget to be disposed between the time an asyncExec\ngets queued and the time it\u0027s run.\nPackageExplorerContentProvider.postRunnable\u0027s trackedRunnable should check that\nthe widget hasn\u0027t been disposed before running r.\nRecommend checking other occurrences of asyncExec in JDT.\n",
    "Nick, as gunnar pointed out the package explorer was still open when the\nexception happened. So the exception can\u0027t come from a already disposed package\nexplorer.\n\nFurthermore, the check you mention is already in. The tracked runnable posted in\npostRunnable typically look like this (for example for the refresh it is)\n\nnew Runnable() {\n\tpublic void run() {\n\t\tControl ctrl\u003d fViewer.getControl();\n\t\tif (ctrl !\u003d null \u0026\u0026 !ctrl.isDisposed()) {\n\t\t\tfor (Iterator iter\u003d toRefresh.iterator(); iter.hasNext();) {\n\t\t\t\tfViewer.refresh(iter.next(), updateLabels);\n\t\t\t}\n\t\t}\n\t}\n}",
    "Sorry, I missed that check.  So it does look like one of the items is disposed,\nnot the tree itself.\n\nThe strange thing is that it already successfully iterated over the same items\n(also using getData()) just prior to that loop in\nAbstractTreeViewer.updateChildren (see line 1764 of rev 1.65 of AbstractTreeViewer).\n\nThere are calls to equals, mapElement and disassociate (plus some calls directly\non the item), but none of these should dispose the item.  Is this still true in\nthe various overrides for the PE?\n",
    "I looked over the code and we don\u0027t dispose any items in the overridden methods.\n\nGunnar, can you comment on whether your top level elements in the package\nexplorer are working sets or projects ?",
    "The top-level elements were projects. But a working set was active at this time."
  ],
  "commentCreationDates": [
    "2005-06-08T15:34:11+02:00",
    "2005-06-08T22:20:18+02:00",
    "2005-06-09T07:29:22+02:00",
    "2005-06-09T09:18:37+02:00",
    "2005-06-09T16:02:12+02:00",
    "2005-06-09T16:54:05+02:00",
    "2005-06-09T17:25:24+02:00",
    "2005-06-09T18:34:35+02:00",
    "2005-06-09T19:52:56+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Widget is disposed",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2940"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2863"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2834"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.error",
          "source": "Widget.java:395"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.checkWidget",
          "source": "Widget.java:297"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.getData",
          "source": "Widget.java:448"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren",
          "source": "AbstractTreeViewer.java:1764"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct",
          "source": "AbstractTreeViewer.java:1268"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1245"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1201"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$PackageExplorerProblemTreeViewer.internalRefresh",
          "source": "PackageExplorerPart.java:492"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$8.run",
          "source": "StructuredViewer.java:1291"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.preservingSelection",
          "source": "StructuredViewer.java:1201"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$PackageExplorerProblemTreeViewer.preservingSelection",
          "source": "PackageExplorerPart.java:598"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.refresh",
          "source": "StructuredViewer.java:1289"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$3.run",
          "source": "PackageExplorerContentProvider.java:615"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$7.run",
          "source": "PackageExplorerContentProvider.java:659"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:118"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:2906"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2565"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:809"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:787"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.CheckoutAsAction.execute",
          "source": "CheckoutAsAction.java:31"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.CVSAction.run",
          "source": "CVSAction.java:117"
        },
        {
          "method": "org.eclipse.ui.actions.ActionDelegate.runWithEvent",
          "source": "ActionDelegate.java:70"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:236"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:538"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:400"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:844"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2929"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2562"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1694"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1658"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:366"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:375"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:162"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "98929",
      "date": "2005-06-08T15:34:11+02:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "98929",
  "bugId": "98929",
  "date": "2005-06-08T15:34:11+02:00",
  "product": "JDT",
  "component": "UI",
  "severity": "normal"
}