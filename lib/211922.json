{
  "comments": [
    "A bundle pool will not be properly loaded as such when the artifact repository manager first loads it.\nSteps to reproduce:\n- using the admin ui install eclipse into a profile where you set the bundle pool \n- run the admin ui on another p2 area, create another profile and set the bundle pool to be the same as the previous one. The configuration will fail with an exception similar to that one:\n\nlocation\u003dfile:/notnfs/overholt/p2/bundlepool/plugins/org.eclipse.cvs.source_1.0.100.v20070824-7C79Do9EI99hBQEZ.jar\njava.util.zip.ZipException: error in opening zip file\n        at java.util.zip.ZipFile.open(Native Method)\n        at java.util.zip.ZipFile.\u003cinit\u003e(ZipFile.java:131)\n        at java.util.jar.JarFile.\u003cinit\u003e(JarFile.java:150)\n        at java.util.jar.JarFile.\u003cinit\u003e(JarFile.java:87)\n        at sun.net.www.protocol.jar.URLJarFile.\u003cinit\u003e(URLJarFile.java:90)\n        at sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:66)\n        at sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:71)\n        at sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:122)\n        at sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:89)\n        at java.net.JarURLConnection.getManifest(JarURLConnection.java:235)\n        at org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getOSGiManifest(Utils.java:241)\n        at org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getManifestMainAttributes(Utils.java:228)\n        at org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getClausesManifestMainAttributes(Utils.java:224)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.getSystemBundleFromBundleInfos(EquinoxBundlesState.java:142)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.getSystemBundleFromBundleInfos(EquinoxBundlesState.java:155)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.composeNewState(EquinoxBundlesState.java:307)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.\u003cinit\u003e(EquinoxBundlesState.java:280)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxManipulatorImpl.getBundlesState(EquinoxManipulatorImpl.java:144)\n        at org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxManipulatorImpl.save(EquinoxManipulatorImpl.java:372)\n        at org.eclipse.equinox.internal.p2.touchpoint.eclipse.LazyManipulator.save(LazyManipulator.java:73)\n        at org.eclipse.equinox.internal.p2.touchpoint.eclipse.EclipseTouchpoint.completePhase(EclipseTouchpoint.java:97)\n        at org.eclipse.equinox.p2.engine.Phase.postPerform(Phase.java:177)\n        at org.eclipse.equinox.p2.engine.Phase.perform(Phase.java:99)\n        at org.eclipse.equinox.p2.engine.Phase.perform(Phase.java:58)\n        at org.eclipse.equinox.p2.engine.PhaseSet.perform(PhaseSet.java:38)",
    "The problem here is when we\u0027re re-loading a pre-existing artifact repo and we\u0027re getting the type of the repo wrong. This is occurring because we\u0027re overlaoding artifacts.xml to be a SimpleArtifactRepository or a BundlePool.\n\nWe have a few alternatives here to determine the type of the repo. For now \nI\u0027ll make a change so that we use bundlepool.xml for BundlePool as this is probably the easiest way.\n",
    "FIXED in HEAD.\n\nTrying the bundlepool.xml route I ran into a few problems that forced further modification to SimpleArtifactRepository and the way it saves files. This was starting to get very brittle and so I decided to just move the folder and reference support directly into SimpleArtifactRepository.\n\nAdmittedly we\u0027ll have to stop adding features to this class however for the moment this seemed the least disruptive and probably the easiest way. This means that BundlePool and BundlePoolFactory have been removed along with the extension entry. I\u0027ve tagged with v20071204-prefoldersupport if we want to revisit this later."
  ],
  "commentCreationDates": [
    "2007-12-04T20:56:31+01:00",
    "2007-12-04T21:18:24+01:00",
    "2007-12-05T04:39:51+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.util.zip.ZipException",
      "message": "error in opening zip file",
      "elements": [
        {
          "method": "java.util.zip.ZipFile.open",
          "source": "Native Method"
        },
        {
          "method": "java.util.zip.ZipFile.\u003cinit\u003e",
          "source": "ZipFile.java:131"
        },
        {
          "method": "java.util.jar.JarFile.\u003cinit\u003e",
          "source": "JarFile.java:150"
        },
        {
          "method": "java.util.jar.JarFile.\u003cinit\u003e",
          "source": "JarFile.java:87"
        },
        {
          "method": "sun.net.www.protocol.jar.URLJarFile.\u003cinit\u003e",
          "source": "URLJarFile.java:90"
        },
        {
          "method": "sun.net.www.protocol.jar.URLJarFile.getJarFile",
          "source": "URLJarFile.java:66"
        },
        {
          "method": "sun.net.www.protocol.jar.JarFileFactory.get",
          "source": "JarFileFactory.java:71"
        },
        {
          "method": "sun.net.www.protocol.jar.JarURLConnection.connect",
          "source": "JarURLConnection.java:122"
        },
        {
          "method": "sun.net.www.protocol.jar.JarURLConnection.getJarFile",
          "source": "JarURLConnection.java:89"
        },
        {
          "method": "java.net.JarURLConnection.getManifest",
          "source": "JarURLConnection.java:235"
        },
        {
          "method": "org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getOSGiManifest",
          "source": "Utils.java:241"
        },
        {
          "method": "org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getManifestMainAttributes",
          "source": "Utils.java:228"
        },
        {
          "method": "org.eclipse.equinox.internal.frameworkadmin.utils.Utils.getClausesManifestMainAttributes",
          "source": "Utils.java:224"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.getSystemBundleFromBundleInfos",
          "source": "EquinoxBundlesState.java:142"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.getSystemBundleFromBundleInfos",
          "source": "EquinoxBundlesState.java:155"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.composeNewState",
          "source": "EquinoxBundlesState.java:307"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxBundlesState.\u003cinit\u003e",
          "source": "EquinoxBundlesState.java:280"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxManipulatorImpl.getBundlesState",
          "source": "EquinoxManipulatorImpl.java:144"
        },
        {
          "method": "org.eclipse.equinox.frameworkadmin.equinox.internal.EquinoxManipulatorImpl.save",
          "source": "EquinoxManipulatorImpl.java:372"
        },
        {
          "method": "org.eclipse.equinox.internal.p2.touchpoint.eclipse.LazyManipulator.save",
          "source": "LazyManipulator.java:73"
        },
        {
          "method": "org.eclipse.equinox.internal.p2.touchpoint.eclipse.EclipseTouchpoint.completePhase",
          "source": "EclipseTouchpoint.java:97"
        },
        {
          "method": "org.eclipse.equinox.p2.engine.Phase.postPerform",
          "source": "Phase.java:177"
        },
        {
          "method": "org.eclipse.equinox.p2.engine.Phase.perform",
          "source": "Phase.java:99"
        },
        {
          "method": "org.eclipse.equinox.p2.engine.Phase.perform",
          "source": "Phase.java:58"
        },
        {
          "method": "org.eclipse.equinox.p2.engine.PhaseSet.perform",
          "source": "PhaseSet.java:38"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "211922",
      "date": "2007-12-04T20:56:31+01:00",
      "product": "Equinox",
      "component": "Incubator",
      "severity": "blocker"
    }
  ],
  "groupId": "211922",
  "bugId": "211922",
  "date": "2007-12-04T20:56:31+01:00",
  "product": "Equinox",
  "component": "Incubator",
  "severity": "blocker"
}