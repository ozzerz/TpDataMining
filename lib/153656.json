{
  "comments": [
    "Using BIRT 2.1, scripting failures during the open() and fetch() methods of a scripted data source result in a PDF with a table header, but no data.  The reports are being created using the REAPI IRunAndRenderTask.  I expect an EngineException to be thrown, as there is no possibility of having a useful report when there are scripting errors.\n\nFrom looking at the logfile, I can see that a BirtException is thrown (see partial stacktrace below).  It must be getting caught and squelched somewhere.\n\nThe problem can be recreated by assigning a variable to null in open() method, and trying to access it in fetch().  In preview mode, scripting errors are visible when using HTML, but the PDF rendering issue occurs during a PDF preview as well.  \n\nLOG FILE entry:\n-----------------\n\nAug 11, 2006 3:41:46 PM org.eclipse.birt.report.engine.script.internal.DtEScriptExecutor handleJS\nWARNING: A BIRT exception occurred: Error evaluating Javascript expression. Script engine error: TypeError: Cannot call method \"hasNext\" of null (DataSet[Gics Hierarchy Data Set].__bm_FETCH#2)\n Script source: DataSet[Gics Hierarchy Data Set].__bm_FETCH, line: 1, text:\n__bm_FETCH(). See next exception for more information.\nError evaluating Javascript expression. Script engine error: TypeError: Cannot call method \"hasNext\" of null (DataSet[Gics Hierarchy Data Set].__bm_FETCH#2)\n Script source: DataSet[Gics Hierarchy Data Set].__bm_FETCH, line: 1, text:\n__bm_FETCH()\norg.eclipse.birt.data.engine.core.DataException: A BIRT exception occurred: Error evaluating Javascript expression. Script engine error: TypeError: Cannot call method \"hasNext\" of null (DataSet[Gics Hierarchy Data Set].__bm_FETCH#2)\n Script source: DataSet[Gics Hierarchy Data Set].__bm_FETCH, line: 1, text:\n__bm_FETCH(). See next exception for more information.\nError evaluating Javascript expression. Script engine error: TypeError: Cannot call method \"hasNext\" of null (DataSet[Gics Hierarchy Data Set].__bm_FETCH#2)\n Script source: DataSet[Gics Hierarchy Data Set].__bm_FETCH, line: 1, text:\n__bm_FETCH()\n\tat org.eclipse.birt.data.engine.core.DataException.wrap(DataException.java:114)\n\tat org.eclipse.birt.data.engine.script.ScriptEvalUtil.evaluateJSAsExpr(ScriptEvalUtil.java:552)\n\tat org.eclipse.birt.data.engine.script.JSMethodRunner.runScript(JSMethodRunner.java:79)\n\tat org.eclipse.birt.report.engine.script.internal.DtEScriptExecutor.handleJS(DtEScriptExecutor.java:71)\n\tat org.eclipse.birt.report.engine.script.internal.DataSetScriptExecutor.handleJS(DataSetScriptExecutor.java:159)\n\tat org.eclipse.birt.report.engine.script.internal.ScriptDataSetScriptExecutor.handleFetch(ScriptDataSetScriptExecutor.java:100)\n\tat org.eclipse.birt.data.engine.impl.ScriptDataSetRuntime.fetch(ScriptDataSetRuntime.java:84)\n\tat org.eclipse.birt.data.engine.impl.PreparedScriptDSQuery$ScriptDSQueryExecutor$CustomDataSet.fetch(PreparedScriptDSQuery.java:240)\n\tat org.eclipse.birt.data.engine.executor.cache.OdiAdapter.fetch(OdiAdapter.java:148)\n\tat org.eclipse.birt.data.engine.executor.cache.RowResultSet.next(RowResultSet.java:91)\n\tat org.eclipse.birt.data.engine.executor.cache.ExpandableRowResultSet.next(ExpandableRowResultSet.java:62)\n\tat org.eclipse.birt.data.engine.executor.cache.SmartCache.populateData(SmartCache.java:262)\n\tat org.eclipse.birt.data.engine.executor.cache.SmartCache.initInstance(SmartCache.java:102)\n\tat org.eclipse.birt.data.engine.executor.cache.SmartCache.\u003cinit\u003e(SmartCache.java:145)\n\tat org.eclipse.birt.data.engine.executor.transform.SinglePassRowProcessor.initOdiResultSet(SinglePassRowProcessor.java:107)\n\tat org.eclipse.birt.data.engine.executor.transform.SinglePassRowProcessor.pass(SinglePassRowProcessor.java:61)\n\tat org.eclipse.birt.data.engine.executor.transform.MultiPassRowProcessor.pass(MultiPassRowProcessor.java:93)\n\tat org.eclipse.birt.data.engine.executor.transform.ResultSetPopulator.populateResultSet(ResultSetPopulator.java:206)\n\tat org.eclipse.birt.data.engine.executor.transform.CachedResultSet.\u003cinit\u003e(CachedResultSet.java:120)\n\tat org.eclipse.birt.data.engine.executor.CandidateQuery.execute(CandidateQuery.java:88)\n\tat org.eclipse.birt.data.engine.impl.PreparedScriptDSQuery$ScriptDSQueryExecutor.executeOdiQuery(PreparedScriptDSQuery.java:206)\n\tat org.eclipse.birt.data.engine.impl.QueryExecutor.execute(QueryExecutor.java:695)\n\tat org.eclipse.birt.data.engine.impl.ServiceForQueryResults.executeQuery(ServiceForQueryResults.java:152)\n\tat org.eclipse.birt.data.engine.impl.QueryResults.getResultIterator(QueryResults.java:158)\n\tat org.eclipse.birt.report.engine.data.dte.DteResultSet.\u003cinit\u003e(DteResultSet.java:79)\n\tat org.eclipse.birt.report.engine.data.dte.DteDataEngine.doExecuteQuery(DteDataEngine.java:113)\n\tat org.eclipse.birt.report.engine.data.dte.AbstractDataEngine.execute(AbstractDataEngine.java:208)\n\tat org.eclipse.birt.report.engine.executor.ExecutionContext.executeQuery(ExecutionContext.java:1541)\n\tat org.eclipse.birt.report.engine.executor.QueryItemExecutor.executeQuery(QueryItemExecutor.java:62)\n\tat org.eclipse.birt.report.engine.executor.TableItemExecutor.execute(TableItemExecutor.java:74)\n\tat org.eclipse.birt.report.engine.internal.executor.l18n.LocalizedReportItemExecutor.execute(LocalizedReportItemExecutor.java:35)\n\tat org.eclipse.birt.report.engine.layout.content.BlockStackingExecutor.getNextChild(BlockStackingExecutor.java:47)\n\tat org.eclipse.birt.report.engine.layout.pdf.PDFBlockStackingLM.traverseChildren(PDFBlockStackingLM.java:72)\n\tat org.eclipse.birt.report.engine.layout.pdf.PDFStackingLM.layoutChildren(PDFStackingLM.java:130)\n\tat org.eclipse.birt.report.engine.layout.pdf.PDFPageLM.layout(PDFPageLM.java:198)\n\tat org.eclipse.birt.report.engine.layout.pdf.PDFReportLayoutEngine.layoutReport(PDFReportLayoutEngine.java:55)\n\tat org.eclipse.birt.report.engine.layout.pdf.PDFReportLayoutEngine.layout(PDFReportLayoutEngine.java:68)\n\tat org.eclipse.birt.report.engine.api.impl.RunAndRenderTask.run(RunAndRenderTask.java:187)",
    "In birt html view the error is shown at the bottom of the page. There is also engine API to get the report execution status and errors happened during the execution.\n\nAssign to Wei to check see if this case (scripting failure in open() and fetch() ) is handled correctly.  Maybe these scripting errors should be treated as fatal error and report execution should be stopped?\n\nHow about add an option to all engine tasks to \"stop on any errors\", in which case exectuion is stopped on any exception, the page and content stream will be removed, the rptdocument will only contain the execution status and the error messages?",
    "I did not realize the scripting errors were exposed through the task API.  This is an acceptable workaround for me.  If you decide that scripting errors should not treated as fatal, consider adding a section on error handling to the online Engine API integration guide.  This would help bring awareness about error conditions that may need to be handled by the developer, but aren\u0027t advertised through checked exceptions.\n\nThanks for the quick response.",
    "The error message has been outputed to the context. The user can get the error messages through getError().\n\nAs there has an SCR about the error status, set it to duplicate.\n\n*** This bug has been marked as a duplicate of 147145 ***"
  ],
  "commentCreationDates": [
    "2006-08-11T23:17:20+02:00",
    "2006-08-12T02:56:31+02:00",
    "2006-08-16T20:35:46+02:00",
    "2006-08-22T10:50:19+02:00"
  ],
  "traces": [
    {
      "exceptionType": "TypeError",
      "message": "Cannot call method \"hasNext\" of null (DataSet[Gics Hierarchy Data Set].__bm_FETCH#2)  Script source: DataSet[Gics Hierarchy Data Set].__bm_FETCH, line: 1, text: __bm_FETCH()",
      "elements": [
        {
          "method": "org.eclipse.birt.data.engine.core.DataException.wrap",
          "source": "DataException.java:114"
        },
        {
          "method": "org.eclipse.birt.data.engine.script.ScriptEvalUtil.evaluateJSAsExpr",
          "source": "ScriptEvalUtil.java:552"
        },
        {
          "method": "org.eclipse.birt.data.engine.script.JSMethodRunner.runScript",
          "source": "JSMethodRunner.java:79"
        },
        {
          "method": "org.eclipse.birt.report.engine.script.internal.DtEScriptExecutor.handleJS",
          "source": "DtEScriptExecutor.java:71"
        },
        {
          "method": "org.eclipse.birt.report.engine.script.internal.DataSetScriptExecutor.handleJS",
          "source": "DataSetScriptExecutor.java:159"
        },
        {
          "method": "org.eclipse.birt.report.engine.script.internal.ScriptDataSetScriptExecutor.handleFetch",
          "source": "ScriptDataSetScriptExecutor.java:100"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.ScriptDataSetRuntime.fetch",
          "source": "ScriptDataSetRuntime.java:84"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.PreparedScriptDSQuery$ScriptDSQueryExecutor$CustomDataSet.fetch",
          "source": "PreparedScriptDSQuery.java:240"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.OdiAdapter.fetch",
          "source": "OdiAdapter.java:148"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.RowResultSet.next",
          "source": "RowResultSet.java:91"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.ExpandableRowResultSet.next",
          "source": "ExpandableRowResultSet.java:62"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.SmartCache.populateData",
          "source": "SmartCache.java:262"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.SmartCache.initInstance",
          "source": "SmartCache.java:102"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.cache.SmartCache.\u003cinit\u003e",
          "source": "SmartCache.java:145"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.transform.SinglePassRowProcessor.initOdiResultSet",
          "source": "SinglePassRowProcessor.java:107"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.transform.SinglePassRowProcessor.pass",
          "source": "SinglePassRowProcessor.java:61"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.transform.MultiPassRowProcessor.pass",
          "source": "MultiPassRowProcessor.java:93"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.transform.ResultSetPopulator.populateResultSet",
          "source": "ResultSetPopulator.java:206"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.transform.CachedResultSet.\u003cinit\u003e",
          "source": "CachedResultSet.java:120"
        },
        {
          "method": "org.eclipse.birt.data.engine.executor.CandidateQuery.execute",
          "source": "CandidateQuery.java:88"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.PreparedScriptDSQuery$ScriptDSQueryExecutor.executeOdiQuery",
          "source": "PreparedScriptDSQuery.java:206"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.QueryExecutor.execute",
          "source": "QueryExecutor.java:695"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.ServiceForQueryResults.executeQuery",
          "source": "ServiceForQueryResults.java:152"
        },
        {
          "method": "org.eclipse.birt.data.engine.impl.QueryResults.getResultIterator",
          "source": "QueryResults.java:158"
        },
        {
          "method": "org.eclipse.birt.report.engine.data.dte.DteResultSet.\u003cinit\u003e",
          "source": "DteResultSet.java:79"
        },
        {
          "method": "org.eclipse.birt.report.engine.data.dte.DteDataEngine.doExecuteQuery",
          "source": "DteDataEngine.java:113"
        },
        {
          "method": "org.eclipse.birt.report.engine.data.dte.AbstractDataEngine.execute",
          "source": "AbstractDataEngine.java:208"
        },
        {
          "method": "org.eclipse.birt.report.engine.executor.ExecutionContext.executeQuery",
          "source": "ExecutionContext.java:1541"
        },
        {
          "method": "org.eclipse.birt.report.engine.executor.QueryItemExecutor.executeQuery",
          "source": "QueryItemExecutor.java:62"
        },
        {
          "method": "org.eclipse.birt.report.engine.executor.TableItemExecutor.execute",
          "source": "TableItemExecutor.java:74"
        },
        {
          "method": "org.eclipse.birt.report.engine.internal.executor.l18n.LocalizedReportItemExecutor.execute",
          "source": "LocalizedReportItemExecutor.java:35"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.content.BlockStackingExecutor.getNextChild",
          "source": "BlockStackingExecutor.java:47"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.pdf.PDFBlockStackingLM.traverseChildren",
          "source": "PDFBlockStackingLM.java:72"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.pdf.PDFStackingLM.layoutChildren",
          "source": "PDFStackingLM.java:130"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.pdf.PDFPageLM.layout",
          "source": "PDFPageLM.java:198"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.pdf.PDFReportLayoutEngine.layoutReport",
          "source": "PDFReportLayoutEngine.java:55"
        },
        {
          "method": "org.eclipse.birt.report.engine.layout.pdf.PDFReportLayoutEngine.layout",
          "source": "PDFReportLayoutEngine.java:68"
        },
        {
          "method": "org.eclipse.birt.report.engine.api.impl.RunAndRenderTask.run",
          "source": "RunAndRenderTask.java:187"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "153656",
      "duplicateId": "147145",
      "date": "2006-08-11T23:17:20+02:00",
      "product": "BIRT",
      "component": "Report Engine",
      "severity": "normal"
    }
  ],
  "groupId": "147145",
  "bugId": "153656",
  "duplicateId": "147145",
  "date": "2006-08-11T23:17:20+02:00",
  "product": "BIRT",
  "component": "Report Engine",
  "severity": "normal"
}