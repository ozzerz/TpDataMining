{
  "comments": [
    "When a log file contains control characters such as x01, the GLA Outputter \ngenerates invalid XML for the CommonBaseEvents that include these control \ncharacters.  The resulting XML cannot be loaded into the model during a log \nimport operation.  Exceptions like the following are printed to the console \nwhen the eclipse workbench is started with -console option.\n\nThread[ModalContext,6,main] - org.xml.sax.SAXParseException: An invalid XML \ncharacter (Unicode: 0x1) was found in the value of attribute \"msg\" and element \nis \"CommonBaseEvent\".\n\tat org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException\n(Unknown Source)\n\tat org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)\n\tat org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\n\tat org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\n\tat org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)\n\tat org.apache.xerces.impl.XMLScanner.scanAttributeValue(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanAttribute\n(Unknown Source)\n\tat \norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanStartElement(Unknown \nSource)\n\tat \norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.\ndispatch(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument\n(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat javax.xml.parsers.SAXParser.parse(Unknown Source)\n\tat org.eclipse.hyades.loaders.util.SAXFragmentHandler.parse\n(SAXFragmentHandler.java)\n\tat org.eclipse.hyades.loaders.util.SAXFragmentHandler$1.run\n(SAXFragmentHandler.java)\n\n\nI have traced this problem down to the Outputter calling utility methods to \nconvert the CBE to XML which eventually call the \nEventFormatter.toCanonicalXMLString() method which results in some of the \nstring values being normalized with the \norg.eclipse.hyades.logging.core.XMLUtility.normalize() method.\n\nXMLUtility.normalize() contains code to handle UTF-32 characters and 0x0001 is \na part of a valid UTF-32 character.  But it is not valid UTF-8 character which \nthe loader expects when it parses the XML.\n\nHere is the code in normalize to handle UTF-32 characters:\n\n            else if ((character \u003e\u003d 0x0001) \u0026\u0026 (character \u003c\u003d 0x0010) \u0026\u0026 \n((counter + 1) \u003c stringLength)) {\n\n                normalizedString.append(character);\n\n                normalizedString.append(string.charAt(++counter));\n            }\n\nOne solution is to comment this code out.  The XML 1.0 Specification does not \nexplicitly say that UTF-32 is supported.",
    "Targetting this to 3.3 because the problem affects only a small percentage of \nlog files but the change to fix this requires a full regression test of log \nparsing.",
    "assign by request from Dave",
    "Paul, can you please fix XMLUtility.normalize method.",
    "Since the XML v1.0 specification does not explicitly support the UTF-32 \nencoding, removed UTF-32 support from normalization API.\n\nThe following code has been checked-in to Hyades and TPTP HEAD on January 28, \n2004:\n\n-XmlUtility.java\n-XmlUtilityTest.java"
  ],
  "commentCreationDates": [
    "2004-12-17T06:37:51+01:00",
    "2004-12-20T17:31:07+01:00",
    "2004-12-20T17:35:31+01:00",
    "2005-01-05T20:13:12+01:00",
    "2005-01-28T22:05:13+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.xml.sax.SAXParseException",
      "message": "An invalid XML  character (Unicode: 0x1) was found in the value of attribute \"msg\" and element  is \"CommonBaseEvent\".",
      "elements": [
        {
          "method": "org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.util.ErrorHandlerWrapper.fatalError",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLErrorReporter.reportError",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLErrorReporter.reportError",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLScanner.reportFatalError",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLScanner.scanAttributeValue",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanAttribute",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanStartElement",
          "source": "Unknown  Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.parsers.XML11Configuration.parse",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.parsers.XML11Configuration.parse",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.parsers.XMLParser.parse",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.parsers.AbstractSAXParser.parse",
          "source": "Unknown Source"
        },
        {
          "method": "javax.xml.parsers.SAXParser.parse",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.hyades.loaders.util.SAXFragmentHandler.parse",
          "source": "SAXFragmentHandler.java"
        },
        {
          "method": "org.eclipse.hyades.loaders.util.SAXFragmentHandler$1.run",
          "source": "SAXFragmentHandler.java"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "81490",
      "date": "2004-12-17T06:37:51+01:00",
      "product": "Hyades",
      "component": "Exec.logging",
      "severity": "normal"
    }
  ],
  "groupId": "81490",
  "bugId": "81490",
  "date": "2004-12-17T06:37:51+01:00",
  "product": "Hyades",
  "component": "Exec.logging",
  "severity": "normal"
}