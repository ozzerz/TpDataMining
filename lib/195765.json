{
  "comments": [
    "Build ID: I20070621-1340\n\nSteps To Reproduce:\n1. Download the JSP Examples Bundle found at: http://www.eclipse.org/equinox/server/jsp_support.php. Optionally create a project to run a JSP according to instructions described on the above link.\n2. Add an explicitly dependency to org.apache.log4j (either as Import-Package or Require-Bundle)\n3. Run the JSP example\n\n\nMore information:\nThe JSP Examples Bundle (found at http://www.eclipse.org/equinox/server/jsp_support.php) works fine without changes, but when I try to add a dependency to org.apache.log4j (either as Import-Package or Require-Bundle) the error below throws out.\n\norg.apache.commons.logging.LogConfigurationException: \norg.apache.commons.logging.LogConfigurationException: No suitable Log \nconstructor [Ljava.lang.Class;@ff2413 for \norg.apache.commons.logging.impl.Log4JLogger (Caused by \njava.lang.NoClassDefFoundError: org/apache/log4j/Category) (Caused by \norg.apache.commons.logging.LogConfigurationException: No suitable Log \nconstructor [Ljava.lang.Class;@ff2413 for \norg.apache.commons.logging.impl.Log4JLogger (Caused by \njava.lang.NoClassDefFoundError: org/apache/log4j/Category))\nat \norg.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:543)\nat \norg.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:235)\nat \norg.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:209)\nat org.apache.commons.logging.LogFactory.getLog(LogFactory.java:351)\nat \norg.apache.jasper.EmbeddedServletOptions.\u003cinit\u003e(EmbeddedServletOptions.java:43)\nat org.apache.jasper.servlet.JspServlet.init(JspServlet.java:97)\nat org.eclipse.equinox.jsp.jasper.JspServlet.init(JspServlet.java:81)\nat \norg.eclipse.equinox.http.helper.ContextPathServletAdaptor.init(ContextPathServletAdaptor.java:31)\nat \norg.eclipse.equinox.http.servlet.internal.ServletRegistration.init(ServletRegistration.java:64)\nat \norg.eclipse.equinox.http.servlet.internal.ProxyServlet.registerServlet(ProxyServlet.java:140)\nat \norg.eclipse.equinox.http.servlet.internal.HttpServiceImpl.registerServlet(HttpServiceImpl.java:50)\nat \norg.eclipse.equinox.jsp.examples.Activator$HttpServiceTracker.addingService(Activator.java:48)\nat \norg.osgi.util.tracker.ServiceTracker$Tracked.trackAdding(ServiceTracker.java:1064)\nat \norg.osgi.util.tracker.ServiceTracker$Tracked.trackInitialServices(ServiceTracker.java:926)\nat org.osgi.util.tracker.ServiceTracker.open(ServiceTracker.java:330)\nat org.osgi.util.tracker.ServiceTracker.open(ServiceTracker.java:274)\nat org.eclipse.equinox.jsp.examples.Activator.start(Activator.java:26)\nat \norg.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:999)\nat java.security.AccessController.doPrivileged(Native Method)\nat \norg.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:993)\nat \norg.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:974)\nat \norg.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:346)\nat \norg.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:350)\nat \norg.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1118)\nat \norg.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:634)\nat \norg.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:508)\nat \norg.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:282)\nat \norg.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:468)\nat \norg.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:195)\nat \norg.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:297)\nCaused by: org.apache.commons.logging.LogConfigurationException: No suitable \nLog constructor [Ljava.lang.Class;@ff2413 for \norg.apache.commons.logging.impl.Log4JLogger (Caused by \njava.lang.NoClassDefFoundError: org/apache/log4j/Category)\nat \norg.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor(LogFactoryImpl.java:413)\nat \norg.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:529)\n... 29 more\nCaused by: java.lang.NoClassDefFoundError: org/apache/log4j/Category\nat java.lang.Class.getDeclaredConstructors0(Native Method)\nat java.lang.Class.privateGetDeclaredConstructors(Unknown Source)\nat java.lang.Class.getConstructor0(Unknown Source)\nat java.lang.Class.getConstructor(Unknown Source)\nat \norg.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor(LogFactoryImpl.java:410)\n... 30 more",
    "Moving comments from the newsgroup...\n\nThe problem here is that your use of log4j in your jsp is being leaked via \nthe context class loader into the jasper implementations use of commons \nlogging.\nThe commons logging discovery process will find log4j on the CCL but not in \nit\u0027s own class hierarchy and will then run into problems.\n\nI can think of two workarounds:\n1) Remove your direct dependency on log4j from your jsp bundle and instead \nmove it to another bundle you can call from your jsp.\n2) If you\u0027re in full control of your platform add a fragment to the \ncommons.logging bundle that imports log4j\n3) Take a look at SLF4J and jcl-over-slf4j and create bundles to replace the \ncommons.logging bundle."
  ],
  "commentCreationDates": [
    "2007-07-08T16:41:55+02:00",
    "2007-07-08T16:45:52+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org/apache/log4j/Category))",
      "elements": [
        {
          "method": "org.apache.commons.logging.impl.LogFactoryImpl.newInstance",
          "source": "LogFactoryImpl.java:543"
        },
        {
          "method": "org.apache.commons.logging.impl.LogFactoryImpl.getInstance",
          "source": "LogFactoryImpl.java:235"
        },
        {
          "method": "org.apache.commons.logging.impl.LogFactoryImpl.getInstance",
          "source": "LogFactoryImpl.java:209"
        },
        {
          "method": "org.apache.commons.logging.LogFactory.getLog",
          "source": "LogFactory.java:351"
        },
        {
          "method": "org.apache.jasper.EmbeddedServletOptions.\u003cinit\u003e",
          "source": "EmbeddedServletOptions.java:43"
        },
        {
          "method": "org.apache.jasper.servlet.JspServlet.init",
          "source": "JspServlet.java:97"
        },
        {
          "method": "org.eclipse.equinox.jsp.jasper.JspServlet.init",
          "source": "JspServlet.java:81"
        },
        {
          "method": "org.eclipse.equinox.http.helper.ContextPathServletAdaptor.init",
          "source": "ContextPathServletAdaptor.java:31"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.ServletRegistration.init",
          "source": "ServletRegistration.java:64"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.ProxyServlet.registerServlet",
          "source": "ProxyServlet.java:140"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.HttpServiceImpl.registerServlet",
          "source": "HttpServiceImpl.java:50"
        },
        {
          "method": "org.eclipse.equinox.jsp.examples.Activator$HttpServiceTracker.addingService",
          "source": "Activator.java:48"
        },
        {
          "method": "org.osgi.util.tracker.ServiceTracker$Tracked.trackAdding",
          "source": "ServiceTracker.java:1064"
        },
        {
          "method": "org.osgi.util.tracker.ServiceTracker$Tracked.trackInitialServices",
          "source": "ServiceTracker.java:926"
        },
        {
          "method": "org.osgi.util.tracker.ServiceTracker.open",
          "source": "ServiceTracker.java:330"
        },
        {
          "method": "org.osgi.util.tracker.ServiceTracker.open",
          "source": "ServiceTracker.java:274"
        },
        {
          "method": "org.eclipse.equinox.jsp.examples.Activator.start",
          "source": "Activator.java:26"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run",
          "source": "BundleContextImpl.java:999"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator",
          "source": "BundleContextImpl.java:993"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.start",
          "source": "BundleContextImpl.java:974"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.startWorker",
          "source": "BundleHost.java:346"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.resume",
          "source": "AbstractBundle.java:350"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.resumeBundle",
          "source": "Framework.java:1118"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles",
          "source": "StartLevelManager.java:634"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL",
          "source": "StartLevelManager.java:508"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel",
          "source": "StartLevelManager.java:282"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent",
          "source": "StartLevelManager.java:468"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent",
          "source": "EventManager.java:195"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run",
          "source": "EventManager.java:297"
        }
      ],
      "causedBy": {
        "exceptionType": "java.lang.NoClassDefFoundError",
        "message": "org/apache/log4j/Category)",
        "elements": [
          {
            "method": "org.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor",
            "source": "LogFactoryImpl.java:413"
          },
          {
            "method": "org.apache.commons.logging.impl.LogFactoryImpl.newInstance",
            "source": "LogFactoryImpl.java:529"
          }
        ],
        "causedBy": {
          "exceptionType": "java.lang.NoClassDefFoundError",
          "message": "org/apache/log4j/Category",
          "elements": [
            {
              "method": "java.lang.Class.getDeclaredConstructors0",
              "source": "Native Method"
            },
            {
              "method": "java.lang.Class.privateGetDeclaredConstructors",
              "source": "Unknown Source"
            },
            {
              "method": "java.lang.Class.getConstructor0",
              "source": "Unknown Source"
            },
            {
              "method": "java.lang.Class.getConstructor",
              "source": "Unknown Source"
            },
            {
              "method": "org.apache.commons.logging.impl.LogFactoryImpl.getLogConstructor",
              "source": "LogFactoryImpl.java:410"
            }
          ],
          "number": 0,
          "commentIndex": 0
        },
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 0,
      "bugId": "195765",
      "date": "2007-07-08T16:41:55+02:00",
      "product": "Equinox",
      "component": "Bundles",
      "severity": "normal"
    }
  ],
  "groupId": "195765",
  "bugId": "195765",
  "date": "2007-07-08T16:41:55+02:00",
  "product": "Equinox",
  "component": "Bundles",
  "severity": "normal"
}