{
  "comments": [
    "Build ID: I20070625-1500\n\nSteps To Reproduce:\n1. Create a custom eclipse editor for file extension: \"abc\"\n2. override addPages() method and pop up a message box with an OK button.\n3. Open this editor for a file called \"foo.abc\".\n4. Do not click on the OK button.\n5. In your application, also have a background job which opens and closes editors periodically for other files (e.g. a.txt, b.txt, c.txt, etc...)\n6. You will get this exception in the error log.\n\nThe error message scares our customers even though nothing \"bad\" seems to have happened.\n\nThe steps are a representation of what our application is doing.\n\n\nMore information:\njava.lang.RuntimeException: WARNING: Blocked recursive attempt to close part com.fnfr.svt.editors.sessionprofile.editor.SessionProfileEditor while still in the middle of activating it\nat org.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:1238)\nat org.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:1358)\nat org.eclipse.ui.internal.EditorPane.doHide(EditorPane.java:61)\nat org.eclipse.ui.internal.PartStack.close(PartStack.java:543)\nat org.eclipse.ui.internal.EditorStack.close(EditorStack.java:206)\nat org.eclipse.ui.internal.PartStack$1.close(PartStack.java:122)\nat org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:81)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:267)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:276)\nat org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1(DefaultTabFolder.java:1)\nat org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed(DefaultTabFolder.java:67)\nat org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners(PaneFolder.java:596)\nat org.eclipse.ui.internal.presentations.PaneFolder$3.close(PaneFolder.java:189)\nat org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:2159)\nat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:320)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3682)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3293)\nat org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\nat org.eclipse.jface.window.Window.open(Window.java:796)\nat org.eclipse.jface.dialogs.MessageDialog.openQuestion(MessageDialog.java:371)\nat com.fnfr.svt.ui.common.editors.FanfareFormEditor.promptForExternalFileReload(FanfareFormEditor.java:1927)\nat com.fnfr.svt.ui.common.editors.FanfareFormEditor.access$8(FanfareFormEditor.java:1926)\nat com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.sanityCheck(FanfareFormEditor.java:1889)\nat com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.handleActivation(FanfareFormEditor.java:1858)\nat com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.partActivated(FanfareFormEditor.java:1832)\nat org.eclipse.ui.internal.PartListenerList$1.run(PartListenerList.java:72)\nat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\nat org.eclipse.core.runtime.Platform.run(Platform.java:857)\nat org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)\nat org.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:70)\nat org.eclipse.ui.internal.PartService.firePartActivated(PartService.java:73)\nat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:171)\nat org.eclipse.ui.internal.WWinPartService.updateActivePart(WWinPartService.java:124)\nat org.eclipse.ui.internal.WWinPartService.access$0(WWinPartService.java:115)\nat org.eclipse.ui.internal.WWinPartService$1.partDeactivated(WWinPartService.java:48)\nat org.eclipse.ui.internal.PartListenerList2$4.run(PartListenerList2.java:113)\nat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\nat org.eclipse.core.runtime.Platform.run(Platform.java:857)\nat org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:53)\nat org.eclipse.ui.internal.PartListenerList2.firePartDeactivated(PartListenerList2.java:111)\nat org.eclipse.ui.internal.PartService.firePartDeactivated(PartService.java:116)\nat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:165)\nat org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged(WorkbenchPagePartList.java:56)\nat org.eclipse.ui.internal.PartList.setActivePart(PartList.java:126)\nat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3384)\nat org.eclipse.ui.internal.WorkbenchPage.requestActivation(WorkbenchPage.java:2928)\nat org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:265)\nat org.eclipse.ui.internal.EditorPane.requestActivation(EditorPane.java:98)\nat org.eclipse.ui.internal.presentations.PresentablePart.setFocus(PresentablePart.java:191)\nat org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:92)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:267)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:272)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown(AbstractTabFolder.java:342)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown(AbstractTabFolder.java:79)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:178)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3682)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3293)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\nat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\nat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\nat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\nat com.fnfr.svt.rcp.Application.runWorkbench(Application.java:136)\nat com.fnfr.svt.rcp.Application.start(Application.java:124)\nat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:504)\nat org.eclipse.equinox.launcher.Main.basicRun(Main.java:443)\nat org.eclipse.equinox.launcher.Main.run(Main.java:1169)",
    "FYI, looks like the case is caught when the part being closed is also being activated, clearly a case we don\u0027t think is supposed to be happen.\n\nPawan, the job that\u0027s opening and closing editors, is it sync\u0027d in the UI thread?",
    "(In reply to comment #1)\n\u003e FYI, looks like the case is caught when the part being closed is also being\n\u003e activated, clearly a case we don\u0027t think is supposed to be happen.\n\u003e \n\u003e Pawan, the job that\u0027s opening and closing editors, is it sync\u0027d in the UI\n\u003e thread?\n\u003e \n\nA message dialog will spin the event loop and process other requests on the UI thread.\n\nThat being said, we don\u0027t support switching the target part of an activation/deactivation while in the middle of one.\n\nYou need to complete one before you can do another.  Either push your open/close into a UIJob/display.asyncExec(*) to run later or complete activation of your editor and then open your message dialog.\n\nPW\n",
    "All the other tasks which are opening and closing other editors are Eclipse UIJobs. But opening message box dialog starts processing the UIJobs. I think the \"tabbed\" group manager which keeps track of editor tabs needs to be resilient of the fact that other editors may be opening and closing programmatically while this particular one is opening.\n\nEven if we do not create a message box, Eclipse editor code itself does a busy while loading documents (I do not remember the exact call) which causes UIJobs to be processed. In a complex system, you cannot \"control\" what UIJobs are waiting to be processed.\n\n",
    "(In reply to comment #3)\n\u003e Even if we do not create a message box, Eclipse editor code itself does a busy\n\u003e while loading documents (I do not remember the exact call) which causes UIJobs\n\u003e to be processed. In a complex system, you cannot \"control\" what UIJobs are\n\u003e waiting to be processed.\n\nThe system is resilient (it does not crash).  But anything that is causing a part activation/deactivation while in part activation is disallowed by design ... we generate an error message to let developers know so that they can analyze their design and take steps to prevent it.\n\nPW\n"
  ],
  "commentCreationDates": [
    "2007-10-27T08:06:11+02:00",
    "2007-10-29T19:28:49+01:00",
    "2007-10-29T19:45:22+01:00",
    "2007-10-30T01:07:58+01:00",
    "2007-10-30T01:14:05+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.RuntimeException",
      "message": "WARNING: Blocked recursive attempt to close part com.fnfr.svt.editors.sessionprofile.editor.SessionProfileEditor while still in the middle of activating it",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditors",
          "source": "WorkbenchPage.java:1238"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditor",
          "source": "WorkbenchPage.java:1358"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.doHide",
          "source": "EditorPane.java:61"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:543"
        },
        {
          "method": "org.eclipse.ui.internal.EditorStack.close",
          "source": "EditorStack.java:206"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack$1.close",
          "source": "PartStack.java:122"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:81"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:276"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1",
          "source": "DefaultTabFolder.java:1"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed",
          "source": "DefaultTabFolder.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners",
          "source": "PaneFolder.java:596"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder$3.close",
          "source": "PaneFolder.java:189"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouse",
          "source": "CTabFolder.java:2159"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:320"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3682"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3293"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:820"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:796"
        },
        {
          "method": "org.eclipse.jface.dialogs.MessageDialog.openQuestion",
          "source": "MessageDialog.java:371"
        },
        {
          "method": "com.fnfr.svt.ui.common.editors.FanfareFormEditor.promptForExternalFileReload",
          "source": "FanfareFormEditor.java:1927"
        },
        {
          "method": "com.fnfr.svt.ui.common.editors.FanfareFormEditor.access$8",
          "source": "FanfareFormEditor.java:1926"
        },
        {
          "method": "com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.sanityCheck",
          "source": "FanfareFormEditor.java:1889"
        },
        {
          "method": "com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.handleActivation",
          "source": "FanfareFormEditor.java:1858"
        },
        {
          "method": "com.fnfr.svt.ui.common.editors.FanfareFormEditor$ActivationListener.partActivated",
          "source": "FanfareFormEditor.java:1832"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$1.run",
          "source": "PartListenerList.java:72"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.fireEvent",
          "source": "PartListenerList.java:57"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartActivated",
          "source": "PartListenerList.java:70"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartActivated",
          "source": "PartService.java:73"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:171"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.updateActivePart",
          "source": "WWinPartService.java:124"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:115"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partDeactivated",
          "source": "WWinPartService.java:48"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$4.run",
          "source": "PartListenerList2.java:113"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:857"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.fireEvent",
          "source": "PartListenerList2.java:53"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartDeactivated",
          "source": "PartListenerList2.java:111"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartDeactivated",
          "source": "PartService.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:165"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged",
          "source": "WorkbenchPagePartList.java:56"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.setActivePart",
          "source": "PartList.java:126"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:3384"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.requestActivation",
          "source": "WorkbenchPage.java:2928"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.requestActivation",
          "source": "PartPane.java:265"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.requestActivation",
          "source": "EditorPane.java:98"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PresentablePart.setFocus",
          "source": "PresentablePart.java:191"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:92"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:272"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown",
          "source": "AbstractTabFolder.java:342"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown",
          "source": "AbstractTabFolder.java:79"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:178"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3682"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3293"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "com.fnfr.svt.rcp.Application.runWorkbench",
          "source": "Application.java:136"
        },
        {
          "method": "com.fnfr.svt.rcp.Application.start",
          "source": "Application.java:124"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:504"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:443"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1169"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "207658",
      "date": "2007-10-27T08:06:11+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "207658",
  "bugId": "207658",
  "date": "2007-10-27T08:06:11+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}