{
  "comments": [
    "When compiling in 1.6 mode, if several units have been retrieved through accept(ICompilationUnit) in the compiler, the processAnnotations loop is boggus.\nIt is using this.unitsToProcess.length for the top value instead of this.totalUnits.\nThe consequence is:\njava.lang.NullPointerException\n\tat org.eclipse.jdt.internal.compiler.Compiler.processAnnotations(Compiler.java:659)\n\tat org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:374)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.performCompilation(Main.java:3411)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1565)\n\tat org.eclipse.jdt.core.tools.compiler.Compile.main(Compile.java:94)\n\nThis should be backported to 3.3.2.",
    "Created an attachment (id\u003d82968)\nProposed fix\n\n",
    "Moving to JDT/Core as the loop in located in the Compiler itself.",
    "Created an attachment (id\u003d82983)\nProposed fix\n\n",
    "Released for 3.4M4.\nWalter, please verify. Thank you.\n\nThe last patch also includes the regression test.\n\nPhilippe, I think this is worth being backported to 3.3.2 since it is causing a bad NPE.",
    "Created an attachment (id\u003d82985)\nProposed fix\n\nI forgot to include the corresponding change in the EclipseFileManager located in compiler.apt in the last patch.",
    "With the patch, all tests pass and manual testing of the product, including file generation with both Java 5 and Java 6 processors active, appears to work correctly.  I am +1 for putting this into 3.3.2.\n\nOne very small comment: It would be nice to rename the \"iterable\" variable in EclipseFileManager to something more descriptive, like \"oldClasspath\".  \n\nFurther discussion:\n\nThis bug is very closely related to bug 203454; the fix is in the same algorithm.  Perhaps this code is tricky because it is trying to maintain a complex data structure, without a layer of abstraction?  I think the data structure here is functionally equivalent to a linked list.  Even if the existing array implementation is necessary for speed and/or size, perhaps the code should be refactored to abstract the data structure into a separate class, that would be easier to understand, test, and maintain.",
    "This is a complement for bug 203454. I missed it when fixing bug 203454.\nThe steps to get it are not exactly the same.",
    "*** Bug 207944 has been marked as a duplicate of this bug. ***",
    "Philippe,\n\n+1 for 3.3.2?\nThe export test case from bug 207944 could be used to verify it.\n\nI would not backport the regression test from HEAD since it implies many changes in the apt tests.\nThe fix itself is a one line change.",
    "+1 for 3.3.2",
    "Verified for 3.4M4.",
    "The request for 3.3.2 is due to the following reasons:\n- NPE is thrown\n- fix is trivial and implies no risk\n- this can occur as soon as compiling the first compilation unit requests more units through the accept method. If the number of requested units is lower than the unitsToProcess size, the NPE will occur.\n- it is not easy for the user to find out what is going on.",
    "Reopen for 3.3.2 release.",
    "Released for 3.3.2.\nThe regression tests is not backported as it implies too many changes for 3.3.2 in the test suite.\nThe test case in bug 207944 should be used to verify it.\n"
  ],
  "commentCreationDates": [
    "2007-11-15T15:29:43+01:00",
    "2007-11-15T15:30:32+01:00",
    "2007-11-15T15:32:00+01:00",
    "2007-11-15T17:42:08+01:00",
    "2007-11-15T17:45:36+01:00",
    "2007-11-15T17:48:32+01:00",
    "2007-11-15T18:37:42+01:00",
    "2007-11-15T18:50:23+01:00",
    "2007-12-05T20:09:21+01:00",
    "2007-12-05T20:11:18+01:00",
    "2007-12-06T10:13:28+01:00",
    "2007-12-11T15:21:33+01:00",
    "2007-12-11T15:29:12+01:00",
    "2007-12-12T14:45:12+01:00",
    "2007-12-12T14:46:51+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.processAnnotations",
          "source": "Compiler.java:659"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:374"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.performCompilation",
          "source": "Main.java:3411"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:1565"
        },
        {
          "method": "org.eclipse.jdt.core.tools.compiler.Compile.main",
          "source": "Compile.java:94"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "209961",
      "date": "2007-11-15T15:29:43+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "critical"
    }
  ],
  "groupId": "209961",
  "bugId": "209961",
  "date": "2007-11-15T15:29:43+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "critical"
}