{
  "comments": [
    "2000418\n\nI got the following while stepping (I think on a step into), step had worked \nfor about 20 steps.\nI had expanded the top node in the variables view.\nI have seen this problem occur several times.\n\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren\n(AbstractTreeViewer.java(Compiled Code))\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java(Compiled Code))\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java:823)\n\tat org.eclipse.jface.viewers.StructuredViewer$1.run\n(StructuredViewer.java:676)\n\tat org.eclipse.jface.viewers.StructuredViewer.preservingSelection\n(StructuredViewer.java:616)\n\tat org.eclipse.jface.viewers.StructuredViewer.refresh\n(StructuredViewer.java:674)\n\tat org.eclipse.jface.viewers.StructuredViewer.refresh\n(StructuredViewer.java:636)\n\tat org.eclipse.debug.internal.ui.views.VariablesViewer.refresh\n(VariablesViewer.java:62)\n\tat \norg.eclipse.debug.internal.ui.views.AbstractDebugEventHandler.refresh\n(AbstractDebugEventHandler.java:115)\n\tat \norg.eclipse.debug.internal.ui.views.VariablesViewEventHandler.doHandleDebugEven\nts(VariablesViewEventHandler.java:36)\n\tat org.eclipse.debug.internal.ui.views.AbstractDebugEventHandler$1.run\n(AbstractDebugEventHandler.java:49)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java(Compiled \nCode))\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages\n(Synchronizer.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java\n(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java\n(Compiled Code))\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java(Compiled \nCode))\n\tat org.eclipse.jface.window.Window.open(Window.java:525)\n\tat org.eclipse.ui.internal.ExceptionHandler.openQuestion\n(ExceptionHandler.java:190)\n\tat org.eclipse.ui.internal.ExceptionHandler.openQuestionDialog\n(ExceptionHandler.java:157)\n\tat org.eclipse.ui.internal.ExceptionHandler.handleException\n(ExceptionHandler.java:69)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java(Compiled \nCode))\n\tat org.eclipse.jface.window.Window.open(Window.java:525)\n\tat org.eclipse.jface.dialogs.MessageDialog.openError\n(MessageDialog.java:318)\n\tat org.eclipse.ui.internal.SafeRunnableAdapter.handleException\n(SafeRunnableAdapter.java:37)\n\tat \norg.eclipse.ui.internal.AbstractPartSelectionTracker$1.handleException\n(AbstractPartSelectionTracker.java:94)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.handleException\n(InternalPlatform.java:409)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java(Compiled Code))\n\tat org.eclipse.core.runtime.Platform.run(Platform.java(Compiled Code))\n\tat org.eclipse.ui.internal.AbstractPartSelectionTracker.fireSelection\n(AbstractPartSelectionTracker.java:89)\n\tat org.eclipse.ui.internal.PagePartSelectionTracker.selectionChanged\n(PagePartSelectionTracker.java:100)\n\tat org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java\n(Compiled Code))\n\tat org.eclipse.jface.viewers.StructuredViewer.updateSelection\n(StructuredViewer.java:1064)\n\tat org.eclipse.jface.viewers.StructuredViewer.handleInvalidSelection\n(StructuredViewer.java:480)\n\tat org.eclipse.jface.viewers.StructuredViewer.preservingSelection\n(StructuredViewer.java:628)\n\tat org.eclipse.jface.viewers.StructuredViewer.refresh\n(StructuredViewer.java:674)\n\tat org.eclipse.debug.internal.ui.views.LaunchViewer.refresh\n(LaunchViewer.java:62)\n\tat org.eclipse.debug.internal.ui.views.LaunchView.autoExpand\n(LaunchView.java:636)\n\tat \norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleSuspendThrea\ndEvent(LaunchViewEventHandler.java:221)\n\tat \norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleSuspendEvent\n(LaunchViewEventHandler.java:176)\n\tat \norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleDebugEvents\n(LaunchViewEventHandler.java:96)\n\tat org.eclipse.debug.internal.ui.views.AbstractDebugEventHandler$1.run\n(AbstractDebugEventHandler.java:49)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java(Compiled \nCode))\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages\n(Synchronizer.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java\n(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java\n(Compiled Code))\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java\n(Compiled Code))\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:816)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:643)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:319)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:16)",
    "The stack trace is not complete - do you have rest? (i.e. the exception is not \nshown)",
    "oops\n\n*** Stack trace of contained exception ***\njava.lang.NullPointerException\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren\n(AbstractTreeViewer.java(Compiled Code))\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java(Compiled Code))\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java:823)\n...\n\nI find it quite easy to trigger.\nI\u0027m running a target as my dev (I run with the latest ui code).\nI thought perhaps I had not imported some plugin but everything I need seems \nto be there.\n",
    "The required plug-ins for java debugging (some often miss \"jdt.debug.ui\")\n\norg.eclipse.debug.core\norg.eclipse.debug.ui\norg.eclipse.jdt.debug\norg.eclipse.jdt.debug.ui\norg.eclipse.jdt.launching\norg.eclipse.jdt.ui\n\n",
    "However, since you are running your target as your dev, could you run in debug \nmode and stop at the exception to see what is null? (no line numbers in the \nstack trace)",
    "I have all the plugins\n\nHere is the complete set I have imported, the last three are from the head \nstream:\n\norg.apache.lucene\norg.apache.xerces\norg.eclipse.ant.core\norg.eclipse.compare\norg.eclipse.core.boot\norg.eclipse.core.resources\norg.eclipse.core.runtime\norg.eclipse.debug.core\norg.eclipse.debug.ui\norg.eclipse.help\norg.eclipse.jdt.core\norg.eclipse.jdt.debug\norg.eclipse.jdt.debug.ui\norg.eclipse.jdt.launching\norg.eclipse.jdt.ui\norg.eclipse.sdk\norg.eclipse.search\norg.eclipse.swt\norg.eclipse.team.core\norg.eclipse.team.cvs.core\norg.eclipse.team.cvs.ssh\norg.eclipse.team.cvs.ui\norg.eclipse.team.ui\norg.eclipse.ui\norg.eclipse.ui.examples.propertysheet\norg.eclipse.ui.examples.readmetool\n\n1) Place breakpoint on first line of RetargetAction.partActivated\n2) When the breakpoint is hit, expand the first item in the variables list\n3) Step over until you reach the last line of the method\n4) Step into\n5) Step return \u003e NPE\n\nHere is the stack I got when I caught the exception\nVariablesView.setViewerInput is being passed an empty selection\n\nIt occurred on the line \n\ttvItem.hItem \u003d item.handle;\nitem was null\n\norg.eclipse.swt.widgets.Tree.wmNotifyChild(int, int) line: 1609\norg.eclipse.swt.custom.SashForm(org.eclipse.swt.widgets.Control).WM_NOTIFY\n(int, int) line: 3590\norg.eclipse.swt.custom.SashForm(org.eclipse.swt.widgets.Composite).WM_NOTIFY\n(int, int) line: 555\norg.eclipse.swt.custom.SashForm(org.eclipse.swt.widgets.Control).windowProc\n(int, int, int) line: 2699\norg.eclipse.swt.widgets.Display.windowProc(int, int, int, int) line: 1817\norg.eclipse.swt.internal.win32.OS.CallWindowProcW(int, int, int, int, int) \nline: not available [native method]\norg.eclipse.swt.internal.win32.OS.CallWindowProc(int, int, int, int, int) \nline: 1145\norg.eclipse.swt.widgets.Tree.callWindowProc(int, int, int) line: 147\norg.eclipse.swt.widgets.Tree(org.eclipse.swt.widgets.Control).windowProc(int, \nint, int) line: 2726\norg.eclipse.swt.widgets.Display.windowProc(int, int, int, int) line: 1817\norg.eclipse.swt.internal.win32.OS.SendMessageW(int, int, int, int) line: not \navailable [native method]\norg.eclipse.swt.internal.win32.OS.SendMessage(int, int, int, int) line: 1681\norg.eclipse.swt.widgets.Tree(org.eclipse.swt.widgets.Control).setRedraw\n(boolean) line: 2119\norg.eclipse.swt.widgets.Tree.setRedraw(boolean) line: 889\norg.eclipse.jface.viewers.AbstractTreeViewer$4.run() line: 661\norg.eclipse.debug.internal.ui.views.VariablesViewer\n(org.eclipse.jface.viewers.StructuredViewer).preservingSelection\n(java.lang.Runnable) line: 616\norg.eclipse.debug.internal.ui.views.VariablesViewer\n(org.eclipse.jface.viewers.AbstractTreeViewer).inputChanged(java.lang.Object, \njava.lang.Object) line: 650\norg.eclipse.debug.internal.ui.views.VariablesViewer\n(org.eclipse.jface.viewers.ContentViewer).setInput(java.lang.Object) line: 234\norg.eclipse.debug.internal.ui.views.VariablesViewer\n(org.eclipse.jface.viewers.StructuredViewer).setInput(java.lang.Object) line: \n785\norg.eclipse.debug.internal.ui.views.VariablesView.setViewerInput\n(org.eclipse.jface.viewers.IStructuredSelection) line: 237\norg.eclipse.debug.internal.ui.views.VariablesView.selectionChanged\n(org.eclipse.ui.IWorkbenchPart, org.eclipse.jface.viewers.ISelection) line: 824\norg.eclipse.ui.internal.AbstractPartSelectionTracker$1.run() line: 91\norg.eclipse.core.internal.runtime.InternalPlatform.run\n(org.eclipse.core.runtime.ISafeRunnable) line: 782\norg.eclipse.core.runtime.Platform.run(org.eclipse.core.runtime.ISafeRunnable) \nline: 411\norg.eclipse.ui.internal.PagePartSelectionTracker\n(org.eclipse.ui.internal.AbstractPartSelectionTracker).fireSelection\n(org.eclipse.ui.IWorkbenchPart, org.eclipse.jface.viewers.ISelection) line: 89\norg.eclipse.ui.internal.PagePartSelectionTracker.selectionChanged\n(org.eclipse.jface.viewers.SelectionChangedEvent) line: 100\norg.eclipse.debug.internal.ui.views.LaunchViewer\n(org.eclipse.jface.viewers.Viewer).fireSelectionChanged\n(org.eclipse.jface.viewers.SelectionChangedEvent) line: 147\norg.eclipse.debug.internal.ui.views.LaunchViewer\n(org.eclipse.jface.viewers.StructuredViewer).updateSelection\n(org.eclipse.jface.viewers.ISelection) line: 1064\norg.eclipse.debug.internal.ui.views.LaunchViewer\n(org.eclipse.jface.viewers.StructuredViewer).handleInvalidSelection\n(org.eclipse.jface.viewers.ISelection, org.eclipse.jface.viewers.ISelection) \nline: 480\norg.eclipse.debug.internal.ui.views.LaunchViewer\n(org.eclipse.jface.viewers.StructuredViewer).preservingSelection\n(java.lang.Runnable) line: 628\norg.eclipse.debug.internal.ui.views.LaunchViewer\n(org.eclipse.jface.viewers.StructuredViewer).refresh(java.lang.Object) line: \n674\norg.eclipse.debug.internal.ui.views.LaunchViewer.refresh(java.lang.Object) \nline: 62\norg.eclipse.debug.internal.ui.views.LaunchView.autoExpand(java.lang.Object, \nboolean, boolean) line: 636\norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleSuspendThrea\ndEvent(org.eclipse.debug.core.model.IThread) line: 221\norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleSuspendEvent\n(java.lang.Object, org.eclipse.debug.core.DebugEvent) line: 176\norg.eclipse.debug.internal.ui.views.LaunchViewEventHandler.doHandleDebugEvents\n(org.eclipse.debug.core.DebugEvent[]) line: 96\norg.eclipse.debug.internal.ui.views.AbstractDebugEventHandler$1.run() line: 49\norg.eclipse.swt.widgets.RunnableLock.run() line: 29\norg.eclipse.ui.internal.UISynchronizer\n(org.eclipse.swt.widgets.Synchronizer).runAsyncMessages() line: 93\norg.eclipse.swt.widgets.Display.runAsyncMessages() line: 1389\norg.eclipse.swt.widgets.Display.readAndDispatch() line: 1211\norg.eclipse.ui.internal.Workbench.runEventLoop() line: 833\norg.eclipse.ui.internal.Workbench.run(java.lang.Object) line: 816\norg.eclipse.core.internal.boot.InternalBootLoader.run(java.lang.String, \njava.net.URL, java.lang.String, java.lang.String[], java.lang.Runnable) line: \n643\norg.eclipse.core.boot.BootLoader.run(java.lang.String, java.net.URL, \njava.lang.String, java.lang.String[]) line: 319\nEclipseRuntimeLauncher.main(java.lang.String[]) line: 16\n",
    "Moving to SWT.",
    "Moving to SWT for comment/investigation. Does not appear to be debug doing \nanything unusual.",
    "It looks like application code is just handing in a null somewhere it \nshouldn\u0027t. That is, the exception seems to be happening in jface code. I\u0027m not \nsure why this would be an SWT problem.\n",
    "The stack dump from 2002-04-19 17:24 indicates a NPE on a null item in \nwmNotifyChild after calling setRedraw(false).  JFace isn\u0027t passing in any \nobjects in this case.\nMoving back to SWT.",
    "It appears the problem only occurs after the variables view has updated itself \nduring stepping.\nIf you follow the instructions above to repeat the case but only expand \"this\" \nafter making the first step-over, the problem does not happen.\nWith \"this\" expanded, the first step causes the node labeled \"activePart\" to \nupdate, it is colored red and now has children indicated by the \"+\".\nPerhaps this update is leaving the tree in an incorrect state.",
    "import org.eclipse.swt.SWT;\nimport org.eclipse.swt.widgets.*;\n\n\n/* simplest code that show the problem, describled on PR n# 14249  */\npublic class TreeTest {\n  public static void main(String[] args) {\n    Display display \u003d new Display(); \t\t\n    Shell shell \u003d new Shell (display);\n    shell.setBounds(30, 30, 300, 300);\n    shell.open();\n    Tree tree \u003d new Tree( shell, SWT.MULTI | SWT.BORDER );\n    tree.setBounds( 20, 20, 200, 200);\n    for (int i \u003d 0; i \u003c 4; i++) {\n      TreeItem item \u003d new TreeItem( tree, 0);\n      item.setText(\"Item\");\n    }\n    tree.getItems()[1].setForeground( display.getSystemColor(SWT.COLOR_RED));\n    tree.dispose(); //NPE\n\t\n    while (! shell.isDisposed() )\n      if ( !display.readAndDispatch() )\n        display.sleep();\n\t\t\n    display.dispose();\n  }\n}\n",
    "Fixed \u003e 20020423"
  ],
  "commentCreationDates": [
    "2002-04-19T20:29:15+02:00",
    "2002-04-19T21:26:05+02:00",
    "2002-04-19T21:43:25+02:00",
    "2002-04-19T22:27:50+02:00",
    "2002-04-19T22:29:13+02:00",
    "2002-04-19T23:24:13+02:00",
    "2002-04-20T15:43:19+02:00",
    "2002-04-20T15:44:14+02:00",
    "2002-04-22T15:55:54+02:00",
    "2002-04-23T06:45:45+02:00",
    "2002-04-23T22:27:15+02:00",
    "2002-04-24T01:28:55+02:00",
    "2002-04-24T04:19:54+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren",
          "source": "AbstractTreeViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:823"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "14249",
      "date": "2002-04-19T21:43:25+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "14249",
  "bugId": "14249",
  "date": "2002-04-19T20:29:15+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}