{
  "comments": [
    "Using build I20070807-0010.\n\nCreate a simple Java project with some Java files in it. Then select this project and hit Ctrl+H. Select the \u0027File Search\u0027 tab, enter \u0027*.java\u0027 as File name pattern,  choose the \u0027Selected resources\u0027 scope and hit \u0027Search\u0027 button...\n\nMany NPE occurs and the Search View becomes unusable:\njava.lang.NullPointerException\nat org.eclipse.search.internal.ui.text.ColoredString.append(ColoredString.java:94)\nat org.eclipse.search.internal.ui.text.ColoredString.\u003cinit\u003e(ColoredString.java:58)\nat org.eclipse.search.internal.ui.text.ColoredString.\u003cinit\u003e(ColoredString.java:53)\nat org.eclipse.search.internal.ui.text.FileLabelProvider.getRichTextLabel(FileLabelProvider.java:74)\nat org.eclipse.search.internal.ui.text.DecoratingFileSearchLabelProvider.getRichTextLabel(DecoratingFileSearchLabelProvider.java:31)\nat org.eclipse.search.internal.ui.text.ColoredViewersManager$ManagedViewer.getColoredLabelForView(ColoredViewersManager.java:213)\nat org.eclipse.search.internal.ui.text.ColoredViewersManager$ManagedViewer.access$0(ColoredViewersManager.java:203)\nat org.eclipse.search.internal.ui.text.ColoredViewersManager$1.getColoredLabel(ColoredViewersManager.java:159)\nat org.eclipse.search.internal.ui.text.OwnerDrawSupport.performPaint(OwnerDrawSupport.java:87)\nat org.eclipse.search.internal.ui.text.OwnerDrawSupport.handleEvent(OwnerDrawSupport.java:71)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:962)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:947)\nat org.eclipse.swt.widgets.Tree.CDDS_ITEMPOSTPAINT(Tree.java:858)\nat org.eclipse.swt.widgets.Tree.wmNotifyChild(Tree.java:6880)\nat org.eclipse.swt.widgets.Control.wmNotify(Control.java:4579)\nat org.eclipse.swt.widgets.Composite.wmNotify(Composite.java:1585)\nat org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:4216)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3724)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:4377)\nat org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method)\nat org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2197)\nat org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:1541)\nat org.eclipse.swt.widgets.Tree.WM_PAINT(Tree.java:6277)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3725)\nat org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5365)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:4390)\nat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2283)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3317)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\nat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\nat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\nat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\nat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\nat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)\nat org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)\nat org.eclipse.equinox.launcher.Main.run(Main.java:1173)\nat org.eclipse.equinox.launcher.Main.main(Main.java:1148)\n\nSet as critical due to the fact that a basic functionality does no longer work and let the Search view in a awful dummy state...",
    "Note that this problem already occurred in 3.3",
    "Let me investigate...",
    "\u003eNote that this problem already occurred in 3.3\nI don\u0027t think so.",
    "(In reply to comment #3)\n\u003e \u003eNote that this problem already occurred in 3.3\n\u003e I don\u0027t think so.\n\u003e \nOoops, sorry, I made a test in a 3.3 maintenance workspace, but forgot that I launched it using a 3.4 build... :-(\n\nSo, I verified with a \"real\" 3.3 build and you\u0027re right, this issue does not occur with it.\n\nSorry for the confusion\n",
    "It\u0027s not just the NPE. There\u0027s also an additional useless element with an empty label underneath each file match.",
    "I have a patch ready but this seems to break navigation (see TreeViewerNavigator).\nNeed to take a closer look.\n\nQuick hack is to make the NPE go away and leave the useless item in for M1.",
    "Fixed in HEAD.\nAvailable in builds \u003e I20070808-0800.\n\nMartin, this needs to go into 3.3.1. Please review the fix and backport to 3.3.1.",
    "Ah: the fix removes the empty nodes and fixes the navigation.",
    "Created an attachment (id\u003d75688)\nFix\n\n",
    "The Fix in HEAD breaks navigation in the text search case / tree layout.\n\nThe Next/Previous actions now first step through all matches while the selection stays on the file, and then step through the individual matches (children of the file) again.",
    "Created an attachment (id\u003d75701)\nFix on fix\n\nMarkus please verify this. I\u0027ve put that into the next I-build. It looks as the original solution in I20070807-0010 never considers filters.",
    "Fix on fix looks good.",
    "Created an attachment (id\u003d75728)\nComplete Fix\n\nMartin, you should also verify that filters are honored correctly by the FileSearchPage.getDisplay* methods. The version you released for getDisplayedMatchCount for example never calls super (but it does for the other getDisplay* method. I wonder whether that\u0027s OK (can filters be contributed?).\n\nIf Text/File search has no filters then the FileSearchPage.getDisplay* methods can  probaly made simpler as they are now in my patch.",
    "Verified for 3.4 M1 in I20070808-1800.",
    "Thanks Dani. I updated the fix and now also the filter issues work (if we decide to add a filter :-))\n\u003e 20070813\n\nThe line matches was a 3.4 only change, 3.3.1 not touched."
  ],
  "commentCreationDates": [
    "2007-08-08T13:02:54+02:00",
    "2007-08-08T13:06:12+02:00",
    "2007-08-08T14:15:46+02:00",
    "2007-08-08T14:34:45+02:00",
    "2007-08-08T15:11:49+02:00",
    "2007-08-08T17:21:07+02:00",
    "2007-08-08T18:05:23+02:00",
    "2007-08-08T18:34:44+02:00",
    "2007-08-08T18:35:16+02:00",
    "2007-08-08T18:36:54+02:00",
    "2007-08-08T19:46:41+02:00",
    "2007-08-08T21:02:55+02:00",
    "2007-08-08T21:42:43+02:00",
    "2007-08-09T08:48:34+02:00",
    "2007-08-09T08:50:44+02:00",
    "2007-08-13T18:56:55+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredString.append",
          "source": "ColoredString.java:94"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredString.\u003cinit\u003e",
          "source": "ColoredString.java:58"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredString.\u003cinit\u003e",
          "source": "ColoredString.java:53"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.FileLabelProvider.getRichTextLabel",
          "source": "FileLabelProvider.java:74"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.DecoratingFileSearchLabelProvider.getRichTextLabel",
          "source": "DecoratingFileSearchLabelProvider.java:31"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredViewersManager$ManagedViewer.getColoredLabelForView",
          "source": "ColoredViewersManager.java:213"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredViewersManager$ManagedViewer.access$0",
          "source": "ColoredViewersManager.java:203"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ColoredViewersManager$1.getColoredLabel",
          "source": "ColoredViewersManager.java:159"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.OwnerDrawSupport.performPaint",
          "source": "OwnerDrawSupport.java:87"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.OwnerDrawSupport.handleEvent",
          "source": "OwnerDrawSupport.java:71"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:962"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:947"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.CDDS_ITEMPOSTPAINT",
          "source": "Tree.java:858"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.wmNotifyChild",
          "source": "Tree.java:6880"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.wmNotify",
          "source": "Control.java:4579"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.wmNotify",
          "source": "Composite.java:1585"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_NOTIFY",
          "source": "Control.java:4216"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3724"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4377"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProc",
          "source": "OS.java:2197"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.callWindowProc",
          "source": "Tree.java:1541"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.WM_PAINT",
          "source": "Tree.java:6277"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3725"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.windowProc",
          "source": "Tree.java:5365"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4390"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:2283"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3317"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:169"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:508"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:447"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1173"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1148"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "199236",
      "date": "2007-08-08T13:02:54+02:00",
      "product": "Platform",
      "component": "Search",
      "severity": "critical"
    }
  ],
  "groupId": "199236",
  "bugId": "199236",
  "date": "2007-08-08T13:02:54+02:00",
  "product": "Platform",
  "component": "Search",
  "severity": "critical"
}