{
  "comments": [
    "1. enable large log support, in derby network mode\n2. import the apache access log attached\n3. create a time based correlation with the log\n4. in the command window where you start the derby server, ArrayIndexOutOfBoundsException will be thrown\n\nif the log is big, the batch could be too large to be handled by derby.",
    "Created an attachment (id\u003d49635)\nzipped apache access log\n\n",
    "\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d messages shown in the command window \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nij\u003e D:\\Derby\\db-derby-10.1.2.1-bin\\frameworks\\NetworkServer\\bin\u003estartNetworkServ\ner.bat\nC:\\\"Program Files\"\\Java\\j2re1.4.2_06\\bin\\java\nServer is ready to accept connections on port 1527.\nConnection number: 1.\nConnection number: 2.\n262137\njava.lang.ArrayIndexOutOfBoundsException: 262137\n        at org.apache.derby.impl.drda.DDMWriter.startDdm(Unknown Source)\n        at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARD(Unknown Source\n)\n        at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARDs(Unknown Sourc\ne)\n        at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARDs(Unknown Sourc\ne)\n        at org.apache.derby.impl.drda.DRDAConnThread.checkWarning(Unknown Source\n)\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(Unknown Sour\nce)\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Sou\nrce)\n        at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\nagentThread[DRDAConnThread_2,5,main]\njava.lang.ArrayIndexOutOfBoundsException\n        at java.lang.System.arraycopy(Native Method)\n        at org.apache.derby.impl.drda.DDMWriter.ensureLength(Unknown Source)\n        at org.apache.derby.impl.drda.DDMWriter.beginDss(Unknown Source)\n        at org.apache.derby.impl.drda.DDMWriter.createDssReply(Unknown Source)\n        at org.apache.derby.impl.drda.DRDAProtocolException.write(Unknown Source\n)\n        at org.apache.derby.impl.drda.DRDAConnThread.sendUnexpectedException(Unk\nnown Source)\n        at org.apache.derby.impl.drda.DRDAConnThread.handleException(Unknown Sou\nrce)\n        at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\n\n",
    "\u003d\u003d CloudscapeTimeBasedCorrelationCommand.java code snippet \u003d\u003d\n\n\tpublic int insertCorrelationEntrys() throws Exception{\n\t\t\n\t\tResultSet rs \u003d getCorrelationResultSet();\n\t\tint corrId \u003d getCorrelationContainerID();\n\t\tPreparedStatement ps \u003d helper.createPreparedStatement(\"INSERT INTO \\\"CorrelationEntry\\\" (\\\"id\\\",\\\"p_p\\\",\\\"correlationContainer\\\",\\\"key\\\") VALUES (?,\u0027\"+corrId+\"/\u0027,\"+corrId+\",?)\");\n\t\tint id\u003dcorrId+1;\n\t\twhile(rs.next())\n\t\t{\n\t\t\tps.setInt(1,id++);\n\t\t\tps.setInt(2,rs.getInt(1));\n\t\t\tps.addBatch();\n\t\t}\n\t\trs.getStatement().close();\n\t\trs.close();\n\t\thelper.executeBatchedPreparedStatement(ps);         \n\t\tps.close();\n\t\treturn id;\n\t}\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nif there are too many correlation entried created, the batch will be very large, executeBatchedPreparedStatement will throw this exception.",
    "Jane, I was able to import your log file without any problems. I used Derby network mode.",
    "import worked fine for me as well. I got the exception when i was creating a time based correlation with the log. ",
    "http://www.archivum.info/derby-dev@db.apache.org/2006-03/msg01624.html\n\n(DERBY-428) NetworkClient PreparedStatement.executeBatch() hangs if batch is too large (ArrayIndexOutOfBoundsException in Network Server) is fixed in 10.2.0.0",
    "Jane, this is marked as normal severity, so I am assuming this is not being requested for 4.2.1.\nIt does not seem like a regression.",
    "Hi Harm, it has nothing to do with TPTP code. It\u0027s a known Derby defect and they \u0027ve fixed it in Derby 10.2.0.0. The targe release date of Derby 10.2.0.0 is Sept. 19 (http://wiki.apache.org/db-derby/TenTwoRelease). \nThere is no request for TPTP 4.2.1 yet. But Eric may want a readme item. I will update the status of this defect once he makes decision.",
    "Please documnent this problem.",
    "TPTP doesn\u0027t support Derby version 10.1; technically TPTP supports Cloudscape instead of Derby. (It should really be the other way around since Derby is open source and Cloudscape is a productization of the open source Derby, but that\u0027s a discussion for another time.) I would have added the readme entry anyway except that the latest version that TPTP supports is version 10.0. I think that it would confuse users to put a readme in for something that TPTP doesn\u0027t support.\n\nYou can see what databases are supported here: http://help.eclipse.org/help32/topic/org.eclipse.tptp.platform.doc.user/tasks/tlglogpref.html\n\nBecause TPTP doesn\u0027t support version 10.1, I recommend that Harm return this defect as INVALID unless Jane can reproduce this problem on a version 10.0 driver. Jane, I suggest that you open an enhancement to have TPTP support version 10.1 or 10.2 instead of 10.0. \n\n",
    "i see. I will get a 10.0 driver and see if i can still get the problem or not.",
    "I think support for a new level of Derby should be opened and tracked in bugzilla",
    "I installed Cloudscape 10.0 and tested yesterday, but ran into some problems. I got a few error messages when executing the script to create the database. And then import failed, which may be caused by the first problem. \n\nAlex is helping investigate.",
    "I opened bugzilla 156892 to change the support from Cloudscape to Derby.\n\nJane, rather than you spending any more time trying to reproduce this on Cloudscape, what I\u0027ll do is add a README stating that although Derby 10.1.2.1 is not officially supported by TPTP, a TPTP user tried to use it and reported a problem etc. If you could open the bugzilla requesting support of Derby 10.2 (or whatever version it is that you need) when you have the chance, that would be great.\n\n",
    "That sounds good. \n\nI opened the following defect to request support for Derby 10.2,\nhttps://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d157084.",
    "Added http://www.eclipse.org/tptp/home/downloads/releasenotes/releasenotes4_2_0.html#3_LL_1\n\n",
    "Verified. Closing the defect"
  ],
  "commentCreationDates": [
    "2006-09-07T19:31:22+02:00",
    "2006-09-07T19:34:37+02:00",
    "2006-09-07T19:41:43+02:00",
    "2006-09-07T19:46:52+02:00",
    "2006-09-07T20:42:34+02:00",
    "2006-09-07T20:45:21+02:00",
    "2006-09-08T22:30:30+02:00",
    "2006-09-08T22:40:46+02:00",
    "2006-09-08T23:15:45+02:00",
    "2006-09-11T16:35:05+02:00",
    "2006-09-11T17:10:04+02:00",
    "2006-09-11T17:27:19+02:00",
    "2006-09-12T16:16:04+02:00",
    "2006-09-12T17:13:36+02:00",
    "2006-09-12T21:03:12+02:00",
    "2006-09-12T21:15:43+02:00",
    "2006-09-12T21:29:16+02:00",
    "2006-09-29T23:06:06+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "262137",
      "elements": [
        {
          "method": "org.apache.derby.impl.drda.DDMWriter.startDdm",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARD",
          "source": "Unknown Source "
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARDs",
          "source": "Unknown Sourc e"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARDs",
          "source": "Unknown Sourc e"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.checkWarning",
          "source": "Unknown Source "
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT",
          "source": "Unknown Sour ce"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.processCommands",
          "source": "Unknown Sou rce"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.run",
          "source": "Unknown Source"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "156559",
      "date": "2006-09-07T19:41:43+02:00",
      "product": "TPTP Profiling",
      "component": "Platform.Model",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "java.lang.System.arraycopy",
          "source": "Native Method"
        },
        {
          "method": "org.apache.derby.impl.drda.DDMWriter.ensureLength",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.derby.impl.drda.DDMWriter.beginDss",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.derby.impl.drda.DDMWriter.createDssReply",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAProtocolException.write",
          "source": "Unknown Source "
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.sendUnexpectedException",
          "source": "Unk nown Source"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.handleException",
          "source": "Unknown Sou rce"
        },
        {
          "method": "org.apache.derby.impl.drda.DRDAConnThread.run",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "156559",
      "date": "2006-09-07T19:41:43+02:00",
      "product": "TPTP Profiling",
      "component": "Platform.Model",
      "severity": "normal"
    }
  ],
  "groupId": "156559",
  "bugId": "156559",
  "date": "2006-09-07T19:31:22+02:00",
  "product": "TPTP Profiling",
  "component": "Platform.Model",
  "severity": "normal"
}