{
  "comments": [
    "AJDT version: 1.3.1 (20060214104738)\nAspectJ version: 1.5.1.20060131132251\n\nNot very sure of the reason and couldn\u0027t reproduce on a smaller code base.\n\nThe compiler crashes on incremental compilation, but never when I do full \"clean\" build. Here is the stack trace:\njava.lang.NullPointerException\nat org.aspectj.org.eclipse.jdt.internal.compiler.lookup.MethodBinding.getAnnotationTagBits(MethodBinding.java:447)\nat org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.doDeclareAnnotations(AjLookupEnvironment.java:754)\nat org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.weaveInterTypeDeclarations(AjLookupEnvironment.java:571)\nat org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.weaveInterTypeDeclarations(AjLookupEnvironment.java:498)\nat org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.doPendingWeaves(AjLookupEnvironment.java:365)\nat org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.completeTypeBindings(AjLookupEnvironment.java:179)\nat org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.beginToCompile(Compiler.java:301)\nat org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:315)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:824)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:258)\nat org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild(AjBuildManager.java:164)\nat org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:117)\nat org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)\n\nNullPointerException thrown: null",
    "Line 769 in the latest version of AjLookupEnvironment I think.\n\nCan I ask which file you are incrementally compiling ramnivas?  I assume it is not the file containing the declare - but is it a file affected by the declare or not?",
    "nevermind, recreated.",
    "Sometimes I amaze even myself.  I went home yesterday wondering if we could ever fix this (i.e. do the right thing - stopping the NPE is of course straightforward).  This morning I\u0027ve fixed it.  The problem is to do with retrieving the annotation for the declare @type.  We NPE because we try and retrieve it off a binary type binding and eclipse binary type bindings dont know about annotations.  We have a binary type binding because it is an incremental compile so the \u0027supporting\u0027 types required by the one source file we are building come in as binary type bindings rather than as source type bindings.  What we have to do is access the annotations on the binary type binding through bcel, then construct a minimal eclipse annotation containing the type of the annotation and stick it onto the matched type.\n\nI\u0027ve put a few comments in the code about other bugs lurking but this was so serious I wanted to get the fix for the original discovered problem out asap.",
    "fix available."
  ],
  "commentCreationDates": [
    "2006-02-20T14:53:35+01:00",
    "2006-02-20T15:14:40+01:00",
    "2006-02-20T15:20:00+01:00",
    "2006-02-21T10:55:57+01:00",
    "2006-02-21T12:05:01+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.lookup.MethodBinding.getAnnotationTagBits",
          "source": "MethodBinding.java:447"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.doDeclareAnnotations",
          "source": "AjLookupEnvironment.java:754"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.weaveInterTypeDeclarations",
          "source": "AjLookupEnvironment.java:571"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.weaveInterTypeDeclarations",
          "source": "AjLookupEnvironment.java:498"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.doPendingWeaves",
          "source": "AjLookupEnvironment.java:365"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.lookup.AjLookupEnvironment.completeTypeBindings",
          "source": "AjLookupEnvironment.java:179"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.beginToCompile",
          "source": "Compiler.java:301"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:315"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:824"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:258"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild",
          "source": "AjBuildManager.java:164"
        },
        {
          "method": "org.aspectj.ajde.internal.CompilerAdapter.compile",
          "source": "CompilerAdapter.java:117"
        },
        {
          "method": "org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run",
          "source": "AspectJBuildManager.java:191"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "128655",
      "date": "2006-02-20T14:53:35+01:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "major"
    }
  ],
  "groupId": "128655",
  "bugId": "128655",
  "date": "2006-02-20T14:53:35+01:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "major"
}