{
  "comments": [
    "In certain cases, getImportingBundles seems to run into a NPE -\u003e\n\njava.lang.NullPointerException\nat org.eclipse.osgi.framework.internal.core.BundleLoader.initialize\n(BundleLoader.java:134)\nat org.eclipse.osgi.framework.internal.core.BundleLoader.\u003cinit\u003e\n(BundleLoader.java:119)\nat org.eclipse.osgi.framework.internal.core.BundleHost.getBundleLoader\n(BundleHost.java:632)\nat \norg.eclipse.osgi.framework.internal.core.ExportedPackageImpl.getImportingBundles\n(ExportedPackageImpl.java:54)\nat aQute.eclipse.osgi.ui.OSGiView.getImportedPackages(OSGiView.java:123)\nat aQute.eclipse.osgi.ui.BundleHolder.getChildren(BundleHolder.java:81)\nat aQute.eclipse.osgi.ui.BundleHolder.hasChildren(BundleHolder.java:63)\nat aQute.lib.swt.HolderContentProvider.hasChildren\n(HolderContentProvider.java:55)\nat org.eclipse.jface.viewers.AbstractTreeViewer.isExpandable\n(AbstractTreeViewer.java:1190)\nat org.eclipse.jface.viewers.AbstractTreeViewer.updatePlus\n(AbstractTreeViewer.java:1652)\nat org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren\n(AbstractTreeViewer.java:1599)\nat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct\n(AbstractTreeViewer.java:1091)\nat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java:1068)\nat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java:1033)\nat org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh\n(AbstractTreeViewer.java:1020)\nat org.eclipse.jface.viewers.StructuredViewer$7.run(StructuredViewer.java:964)\nat org.eclipse.jface.viewers.StructuredViewer.preservingSelection\n(StructuredViewer.java:901)\nat org.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:962)\nat org.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:921)\nat aQute.eclipse.osgi.ui.OSGiView$3.run(OSGiView.java:306)\nat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\nat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:106)\nat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2760)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2445)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1443)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1414)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:271)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:144)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:102)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:335)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:273)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:129)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:185)\nat org.eclipse.core.launcher.Main.run(Main.java:704)\nat org.eclipse.core.launcher.Main.main(Main.java:688)\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nThe code that runs into problems ...\n\n\tstatic Vector getImportedPackages(Bundle bundle) {\n\t\tPackageAdmin admin \u003d Activator.getPackageAdmin();\n\t\tif (admin !\u003d null) {\n\t\t\tImage image \u003d OSGiView.getImageResource(IMG_IMPORTED);\n\t\t\tExportedPackage[] exported \u003d admin.getExportedPackages\n(null);\n\t\t\tif (exported !\u003d null) {\n\t\t\t\tVector v \u003d new Vector();\n\t\t\t\tfor (int i \u003d 0; i \u003c exported.length; i++) {\n\t\t\t\t\tBundle[] bundles \u003d exported\n[i].getImportingBundles();\n\t\t\t\t\tfor (int j \u003d 0; bundles !\u003d null \u0026\u0026 j \u003c \nbundles.length; j++) {\n\t\t\t\t\t\tif (bundles[j].equals(bundle)) \nv.add(new PackageHolder(\n\t\t\t\t\t\t\t\tfalse, image, \nexported[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn v;\n\t\t\t}\n\t\t}\n\t\treturn new Vector();\n\t}",
    "Peter, Does the bundle which exports the ExportedPackage you are accessing \nhappen to be uninstalled?",
    "Response from Peter:\n\nYup, the bundle could be uninstalled. This is hard to prevent in many\ncases.\n\nKind regards,\n\n   Peter Kriens\n\n---------------------------------------------------------------------\n\nI would not suggest preventing this :)\nI\u0027m trying to figure out how to reproduce this.  I can see how a NPE could \noccur if the bundle was uninstalled in the middle of your loop.  But the only \nway that could happen is if another thread was doing the uninstall at the same \ntime you are in your loop.  Can you tell me if this is what happens when you \nrun into this situation?\n\nThanks\n\nTom",
    "It could happen in another thread. The program shows the status of the \nframework in a plugin. Updates to the UI must be done in the UI thread so in \nthe mean time all kinds of other shit could happen.",
    "This code has changed signficantly.  Please reopen of you can reproduce on the \nlatest builds."
  ],
  "commentCreationDates": [
    "2004-11-15T17:13:05+01:00",
    "2004-11-15T22:27:04+01:00",
    "2004-11-16T14:35:57+01:00",
    "2004-11-17T07:14:19+01:00",
    "2005-04-08T23:45:20+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.initialize",
          "source": "BundleLoader.java:134"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.\u003cinit\u003e",
          "source": "BundleLoader.java:119"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.getBundleLoader",
          "source": "BundleHost.java:632"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.ExportedPackageImpl.getImportingBundles",
          "source": "ExportedPackageImpl.java:54"
        },
        {
          "method": "aQute.eclipse.osgi.ui.OSGiView.getImportedPackages",
          "source": "OSGiView.java:123"
        },
        {
          "method": "aQute.eclipse.osgi.ui.BundleHolder.getChildren",
          "source": "BundleHolder.java:81"
        },
        {
          "method": "aQute.eclipse.osgi.ui.BundleHolder.hasChildren",
          "source": "BundleHolder.java:63"
        },
        {
          "method": "aQute.lib.swt.HolderContentProvider.hasChildren",
          "source": "HolderContentProvider.java:55"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.isExpandable",
          "source": "AbstractTreeViewer.java:1190"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.updatePlus",
          "source": "AbstractTreeViewer.java:1652"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.updateChildren",
          "source": "AbstractTreeViewer.java:1599"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefreshStruct",
          "source": "AbstractTreeViewer.java:1091"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1068"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1033"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.internalRefresh",
          "source": "AbstractTreeViewer.java:1020"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$7.run",
          "source": "StructuredViewer.java:964"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.preservingSelection",
          "source": "StructuredViewer.java:901"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.refresh",
          "source": "StructuredViewer.java:962"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.refresh",
          "source": "StructuredViewer.java:921"
        },
        {
          "method": "aQute.eclipse.osgi.ui.OSGiView$3.run",
          "source": "OSGiView.java:306"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:106"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:2760"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2445"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1443"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1414"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:271"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:144"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:102"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:335"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:273"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:129"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:185"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:704"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:688"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "78630",
      "date": "2004-11-15T17:13:05+01:00",
      "product": "Platform",
      "component": "Runtime",
      "severity": "normal"
    }
  ],
  "groupId": "78630",
  "bugId": "78630",
  "date": "2004-11-15T17:13:05+01:00",
  "product": "Platform",
  "component": "Runtime",
  "severity": "normal"
}