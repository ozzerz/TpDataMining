{
  "comments": [
    "I am seeing ConcurrentModificationExceptions from calls to the JDT. These look to result from attempts to modify the same hash set on different threads. The first attempt occurs on a builder thread. The second attempt occurs during an indexing job running on a background thread. My team owns this indexing code. The call stacks for both exceptions are attached below.\n\nThe call stacks shows ConcurrentModificationException being thrown from two theads, both as a result of JavaModel.getTarget() calling HashSet.add(). The indexing thread calls the Java model public API IJavaElement.getCorrespondingResource(), which eventually leads to a call to JavaModel.getTarget(). Perhaps access to the hash set needs to be synchronized.\n\nError stack trace:\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n!ENTRY org.eclipse.core.runtime 4 2 Nov 22, 2005 00:40:16.640\n!MESSAGE Problems occurred when invoking code from plug-in: \"org.eclipse.core.runtime\".\n!STACK 0\njava.util.ConcurrentModificationException: concurrent access to HashMap attempted by Thread[Worker-9,5,main]\n\tat java.util.HashMap.onEntry(HashMap.java:211)\n\tat java.util.HashMap.transfer(HashMap.java:554)\n\tat java.util.HashMap.resize(HashMap.java:541)\n\tat java.util.HashMap.addEntry(HashMap.java:901)\n\tat java.util.HashMap.put(HashMap.java:474)\n\tat java.util.HashSet.add(HashSet.java:206)\n\tat org.eclipse.jdt.internal.core.JavaModel.getTarget(Unknown Source)\n\tat org.eclipse.jdt.internal.core.ClasspathEntry.validateClasspathEntry(Unknown Source)\n\tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(Unknown Source)\n\tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(Unknown Source)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers(Unknown Source)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers(Unknown Source)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers(Unknown Source)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged(Unknown Source)\n\tat org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged(Unknown Source)\n\tat org.eclipse.core.internal.events.NotificationManager$2.run(Unknown Source)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run(Unknown Source)\n\tat org.eclipse.core.runtime.Platform.run(Unknown Source)\n\tat org.eclipse.core.internal.events.NotificationManager.notify(Unknown Source)\n\tat org.eclipse.core.internal.events.NotificationManager.broadcastChanges(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.broadcastChanges(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.aboutToBuild(Unknown Source)\n\tat org.eclipse.core.internal.resources.Project.build(Unknown Source)\n\tat com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.cleanProject(Unknown Source)\n\tat com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.cleanProjects(Unknown Source)\n\tat com.ibm.etools.ejb.operations.EJBClientJarCreationOperation.cleanProjects(Unknown Source)\n\tat com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.doDispose(Unknown Source)\n\tat com.ibm.etools.ejb.operations.EJBClientJarCreationOperation.doDispose(Unknown Source)\n\tat com.ibm.wtp.emf.workbench.operation.EditModelOperation.dispose(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation.doRun(Unknown Source)\n\tat com.ibm.etools.ejb.operations.EJBProjectCreationOperation.createClientJar(Unknown Source)\n\tat com.ibm.etools.ejb.operations.EJBProjectCreationOperation.execute(Unknown Source)\n\tat com.ibm.ws.sca.rd.style.operations.SCAEJBProjectCreationOperation.execute(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation.doRun(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation$1.run(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.run(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.run(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation.run(Unknown Source)\n\tat com.ibm.wtp.common.operation.ComposedOperation.execute(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation.doRun(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation$1.run(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.run(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.run(Unknown Source)\n\tat com.ibm.wtp.common.operation.WTPOperation.run(Unknown Source)\n\tat com.ibm.ws.sca.rd.style.util.SCAEnvironment$3.run(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.run(Unknown Source)\n\tat com.ibm.ws.sca.rd.style.util.SCAEnvironment.getDefaultEJBModuleProject(Unknown Source)\n\tat com.ibm.ws.sca.rapiddeploy.operations.ext.FreeFormJ2EEProjectFactoryImpl.createEJBDeploymentProject(Unknown Source)\n\tat com.ibm.ws.sca.deploy.component.j2ee.ComponentJ2EEDeploymentBuilder.start(Unknown Source)\n\tat com.ibm.ws.sca.deploy.builder.util.BaseIncrementalProjectBuilder.build(Unknown Source)\n\tat com.ibm.ws.sca.deploy.builder.util.BaseIncrementalProjectBuilder.build(Unknown Source)\n\tat com.ibm.ws.sca.rapiddeploy.commands.BaseCommandAdapter.execute(Unknown Source)\n\tat com.ibm.ws.sca.rapiddeploy.commands.ComponentJ2EEDeploymentBuilderCommand.execute(Unknown Source)\n\tat com.ibm.ws.rd.command.CommandVisitAdapter.doVisit(Unknown Source)\n\tat com.ibm.ws.rd.command.CommandVisitAdapter.visit(Unknown Source)\n\tat org.eclipse.core.internal.resources.Resource$2.visit(Unknown Source)\n\tat org.eclipse.core.internal.resources.Resource$1.visitElement(Unknown Source)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(Unknown Source)\n\tat org.eclipse.core.internal.watson.ElementTreeIterator.iterate(Unknown Source)\n\tat org.eclipse.core.internal.resources.Resource.accept(Unknown Source)\n\tat org.eclipse.core.internal.resources.Resource.accept(Unknown Source)\n\tat org.eclipse.core.internal.resources.Resource.accept(Unknown Source)\n\tat com.ibm.wbit.project.builder.CompositeCommand.doResourceOrResourceDeltaVisit(Unknown Source)\n\tat com.ibm.wbit.project.builder.CompositeCommand.execute(Unknown Source)\n\tat com.ibm.wbit.project.builder.CommandBuilder.build(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(Unknown Source)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run(Unknown Source)\n\tat org.eclipse.core.runtime.Platform.run(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(Unknown Source)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run(Unknown Source)\n\tat org.eclipse.core.runtime.Platform.run(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuildLoop(Unknown Source)\n\tat org.eclipse.core.internal.events.BuildManager.build(Unknown Source)\n\tat org.eclipse.core.internal.resources.Workspace.build(Unknown Source)\n\tat org.eclipse.ui.actions.GlobalBuildAction$1.run(Unknown Source)\n\tat org.eclipse.core.internal.jobs.Worker.run(Unknown Source)\n\n!ENTRY org.eclipse.core.runtime 4 2 Nov 22, 2005 00:40:16.828\n!MESSAGE An internal error occurred during: \"Adding to the WebSphere Integration Developer index\".\n!STACK 0\njava.util.ConcurrentModificationException: concurrent access to HashMap attempted by Thread[Worker-10 - Adding to WID index,5,main]\n\tat java.util.HashMap.onExit(HashMap.java:223)\n\tat java.util.HashMap.transfer(HashMap.java:558)\n\tat java.util.HashMap.resize(HashMap.java:541)\n\tat java.util.HashMap.addEntry(HashMap.java:901)\n\tat java.util.HashMap.put(HashMap.java:474)\n\tat java.util.HashSet.add(HashSet.java:206)\n\tat org.eclipse.jdt.internal.core.JavaModel.getTarget(Unknown Source)\n\tat org.eclipse.jdt.internal.core.JarPackageFragmentRoot.resourceExists(Unknown Source)\n\tat org.eclipse.jdt.internal.core.Openable.exists(Unknown Source)\n\tat org.eclipse.jdt.internal.core.PackageFragmentRoot.exists(Unknown Source)\n\tat org.eclipse.jdt.internal.core.JarPackageFragmentRoot.getUnderlyingResource(Unknown Source)\n\tat org.eclipse.jdt.internal.core.Openable.getCorrespondingResource(Unknown Source)\n\tat com.ibm.wbit.index.internal.ResourceUtils.isOutputResource(Unknown Source)\n\tat com.ibm.wbit.index.internal.IndexExtensionManager.createIndexEntry(Unknown Source)\n\tat com.ibm.wbit.index.jobs.internal.AddFilesJob.execute(Unknown Source)\n\tat com.ibm.wbit.index.jobs.internal.AbstractIndexingJob.run(Unknown Source)\n\tat org.eclipse.core.internal.jobs.Worker.run(Unknown Source)",
    "\n\n*** This bug has been marked as a duplicate of 114571 ***"
  ],
  "commentCreationDates": [
    "2005-11-29T16:50:59+01:00",
    "2005-11-30T10:37:57+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.util.ConcurrentModificationException",
      "message": "concurrent access to HashMap attempted by Thread[Worker-9,5,main]",
      "elements": [
        {
          "method": "java.util.HashMap.onEntry",
          "source": "HashMap.java:211"
        },
        {
          "method": "java.util.HashMap.transfer",
          "source": "HashMap.java:554"
        },
        {
          "method": "java.util.HashMap.resize",
          "source": "HashMap.java:541"
        },
        {
          "method": "java.util.HashMap.addEntry",
          "source": "HashMap.java:901"
        },
        {
          "method": "java.util.HashMap.put",
          "source": "HashMap.java:474"
        },
        {
          "method": "java.util.HashSet.add",
          "source": "HashSet.java:206"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModel.getTarget",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ClasspathEntry.validateClasspathEntry",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.updateClasspathMarkers",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager$2.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.notify",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.broadcastChanges",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.broadcastChanges",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.aboutToBuild",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.build",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.cleanProject",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.cleanProjects",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.EJBClientJarCreationOperation.cleanProjects",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.AbstractEJBClientJAROperation.doDispose",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.EJBClientJarCreationOperation.doDispose",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.emf.workbench.operation.EditModelOperation.dispose",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation.doRun",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.EJBProjectCreationOperation.createClientJar",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.etools.ejb.operations.EJBProjectCreationOperation.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rd.style.operations.SCAEJBProjectCreationOperation.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation.doRun",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation.run",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.ComposedOperation.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation.doRun",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wtp.common.operation.WTPOperation.run",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rd.style.util.SCAEnvironment$3.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rd.style.util.SCAEnvironment.getDefaultEJBModuleProject",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rapiddeploy.operations.ext.FreeFormJ2EEProjectFactoryImpl.createEJBDeploymentProject",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.deploy.component.j2ee.ComponentJ2EEDeploymentBuilder.start",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.deploy.builder.util.BaseIncrementalProjectBuilder.build",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.deploy.builder.util.BaseIncrementalProjectBuilder.build",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rapiddeploy.commands.BaseCommandAdapter.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.sca.rapiddeploy.commands.ComponentJ2EEDeploymentBuilderCommand.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.rd.command.CommandVisitAdapter.doVisit",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.ws.rd.command.CommandVisitAdapter.visit",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource$2.visit",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource$1.visitElement",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.doIteration",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.watson.ElementTreeIterator.iterate",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource.accept",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource.accept",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource.accept",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.project.builder.CompositeCommand.doResourceOrResourceDeltaVisit",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.project.builder.CompositeCommand.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.project.builder.CommandBuilder.build",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.build",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.ui.actions.GlobalBuildAction$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Unknown Source"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "118444",
      "duplicateId": "114571",
      "date": "2005-11-29T16:50:59+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    },
    {
      "exceptionType": "java.util.ConcurrentModificationException",
      "message": "concurrent access to HashMap attempted by Thread[Worker-10 - Adding to WID index,5,main]",
      "elements": [
        {
          "method": "java.util.HashMap.onExit",
          "source": "HashMap.java:223"
        },
        {
          "method": "java.util.HashMap.transfer",
          "source": "HashMap.java:558"
        },
        {
          "method": "java.util.HashMap.resize",
          "source": "HashMap.java:541"
        },
        {
          "method": "java.util.HashMap.addEntry",
          "source": "HashMap.java:901"
        },
        {
          "method": "java.util.HashMap.put",
          "source": "HashMap.java:474"
        },
        {
          "method": "java.util.HashSet.add",
          "source": "HashSet.java:206"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModel.getTarget",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JarPackageFragmentRoot.resourceExists",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.exists",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.PackageFragmentRoot.exists",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JarPackageFragmentRoot.getUnderlyingResource",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.getCorrespondingResource",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.index.internal.ResourceUtils.isOutputResource",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.index.internal.IndexExtensionManager.createIndexEntry",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.index.jobs.internal.AddFilesJob.execute",
          "source": "Unknown Source"
        },
        {
          "method": "com.ibm.wbit.index.jobs.internal.AbstractIndexingJob.run",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "118444",
      "duplicateId": "114571",
      "date": "2005-11-29T16:50:59+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "114571",
  "bugId": "118444",
  "duplicateId": "114571",
  "date": "2005-11-29T16:50:59+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}