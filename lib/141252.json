{
  "comments": [
    "3.2RC3\n\nI recently observed that our regression tests were not performing in 1.6 mode (they reverted to 1.5 compliance). When fixing this, AutoboxingTest#test109 failed.\n\njunit.framework.AssertionFailedError: Unexpected target error running resulting class file for X.java:\njava.lang.ClassFormatError: Illegal class name \"\" in class file X\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:465)\n\tat \n\tat junit.framework.Assert.fail(Assert.java:47)\n\tat junit.framework.Assert.assertTrue(Assert.java:20)\n\tat org.eclipse.jdt.core.tests.compiler.regression.AbstractRegressionTest.runConformTest(AbstractRegressionTest.java:445)\n\tat org.eclipse.jdt.core.tests.compiler.regression.AbstractRegressionTest.runConformTest(AbstractRegressionTest.java:317)\n\tat org.eclipse.jdt.core.tests.compiler.regression.AutoBoxingTest.test109(AutoBoxingTest.java:3261)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:589)\n\tat junit.framework.TestCase.runTest(TestCase.java:154)\n\tat junit.framework.TestCase.runBare(TestCase.java:127)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:118)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n\tat junit.extensions.TestDecorator.run(TestDecorator.java:28)\n\tat org.eclipse.jdt.core.tests.util.CompilerTestSetup.run(CompilerTestSetup.java:48)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:128)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:457)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:670)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)\n\tat org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:589)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\n\tat org.eclipse.core.launcher.Main.run(Main.java:977)\n\tat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Testcase:\npublic class X {\n\tpublic static void main(String[] args) {\n\t\tint foo \u003d 0;\n\t\tString bar \u003d \"zero\";\n\t\tSystem.out.println((foo !\u003d 0) ? foo : bar);\n\t}\n}",
    "GenericTypeTest#test0894,0896 and 0897 exhibit the same issue.",
    "Problem is located in StackMapTable attribute:\n\nWe produce:\n      Stack map table: number of frames 2\n        [pc: 19, full, stack: {PrintStream}, locals: {String[], int, String}]\n        [pc: 20, full, stack: {PrintStream, }, locals: {String[], int, }]\n\nInstead of:\n      Stack map table: number of frames 2\n        [pc: 19, full, stack: {PrintStream}, locals: {String[], int, String}]\n        [pc: 20, full, stack: {PrintStream, Serializable}, locals: {String[], int, String}]\n\nNote that I had to change the disassembler to be resilient to empty names.",
    "Created an attachment (id\u003d41095)\nPatch for disassembler (to make it more resilient)\n\nThis isn\u0027t the fix to the problem, but a way for the disassembler tool to avoid crashing when such badness occurs.",
    "I suspect some mishandling of intersection types.",
    "Created an attachment (id\u003d41100)\nProposed patch\n\nAllows computing a constant pool from a wildcard \u0026 intersection type (by inferring it from its erasure).\n\nThis makes the scenario work, and is consistent with other definitions of constantPoolName, now in the past it was assumed that no wildcard/intersection type would ever need to be computed a constantpool name, which is false due to StackMapTable attribute requiring these.\n\nSo this is a safe fix.",
    "Created an attachment (id\u003d41102)\nRegression test\n\nEnsure we have a test showing the included constant pool name for an intersection type (other tests are not disassembling)",
    "Created an attachment (id\u003d41118)\nBetter patch\n\nThis version of the patch is also improving the erasure for the intersection type from Object to Comparable (more precise type).",
    "Added StackMapAttributeTest#_test008\nWill queue the fix for 3.2.1, as there are more issues to address with intersection types, and we should address them all at once.\n(i.e. erasure change is exposing bug 141330)",
    "Released for 3.2.1 integration.",
    "Released for 3.3 M1 while merging TARGET_321 in HEAD\n",
    "Verified for 3.3 M1 using build I20060807-2000.",
    "Verified for 3.2.1 using build M20060908-1655"
  ],
  "commentCreationDates": [
    "2006-05-11T11:39:08+02:00",
    "2006-05-11T11:40:15+02:00",
    "2006-05-11T11:48:42+02:00",
    "2006-05-11T12:43:06+02:00",
    "2006-05-11T12:47:24+02:00",
    "2006-05-11T12:50:36+02:00",
    "2006-05-11T13:09:43+02:00",
    "2006-05-11T13:22:53+02:00",
    "2006-05-11T16:31:10+02:00",
    "2006-05-11T18:07:16+02:00",
    "2006-05-16T16:52:29+02:00",
    "2006-06-12T11:18:01+02:00",
    "2006-08-08T12:31:22+02:00",
    "2006-09-11T18:25:00+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassFormatError",
      "message": "Illegal class name \"\" in class file X",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClass1",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:620"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:465"
        },
        {
          "method": "atjunit.framework.Assert.fail",
          "source": "Assert.java:47"
        },
        {
          "method": "junit.framework.Assert.assertTrue",
          "source": "Assert.java:20"
        },
        {
          "method": "org.eclipse.jdt.core.tests.compiler.regression.AbstractRegressionTest.runConformTest",
          "source": "AbstractRegressionTest.java:445"
        },
        {
          "method": "org.eclipse.jdt.core.tests.compiler.regression.AbstractRegressionTest.runConformTest",
          "source": "AbstractRegressionTest.java:317"
        },
        {
          "method": "org.eclipse.jdt.core.tests.compiler.regression.AutoBoxingTest.test109",
          "source": "AutoBoxingTest.java:3261"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:589"
        },
        {
          "method": "junit.framework.TestCase.runTest",
          "source": "TestCase.java:154"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:127"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:106"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:109"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:118"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:22"
        },
        {
          "method": "junit.extensions.TestDecorator.run",
          "source": "TestDecorator.java:28"
        },
        {
          "method": "org.eclipse.jdt.core.tests.util.CompilerTestSetup.run",
          "source": "CompilerTestSetup.java:48"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run",
          "source": "JUnit3TestReference.java:128"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.TestExecution.run",
          "source": "TestExecution.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:457"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:670"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:386"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main",
          "source": "RemotePluginTestRunner.java:58"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run",
          "source": "CoreTestApplication.java:24"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:400"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:177"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:589"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "141252",
      "date": "2006-05-11T11:39:08+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "141252",
  "bugId": "141252",
  "date": "2006-05-11T11:39:08+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}