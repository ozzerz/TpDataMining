{
  "comments": [
    "It appears that WTP 0.7 metadata migration fails when a 1.0.1 web project is being imported into a workspace. It fails while the Web App Container is trying to initialize the virtual component. The result is that the Web App Container is not populated. The user will have to know to restart the workspace to cause the Web App Container to be populated again.\n\nRepro:\n\n1. Create a new Dynamic Web Project.\n2. Add a jar into the WebContent/WEB-INF/lib directory.\n3. Open a new workspace. Make sure to launch Eclipse in such a way that the Console (System.out/System.err) will be visible. A good way to do that is to run Eclipse in a dev mode from another instance of Eclipse.\n4. Import the web project created in step 1.\n\nObserved:\n\n1. The Web App Libraries node (visible in the Package Explorer and Project Explorer directly under the project) does not have any child nodes.\n\n3. The console has the following stack trace:\n\norg.eclipse.core.internal.resources.ResourceException: The resource tree is locked for modifications.\n\tat org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:94)\n\tat org.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1676)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1716)\n\tat org.eclipse.wst.common.componentcore.internal.ModuleMigratorManager.migrateOldMetaData(ModuleMigratorManager.java:106)\n\tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:179)\n\tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:99)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:437)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:466)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:904)\n\tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getMetaResources(VirtualComponent.java:228)\n\tat org.eclipse.wst.common.componentcore.internal.resources.VirtualContainer.members(VirtualContainer.java:157)\n\tat org.eclipse.wst.common.componentcore.internal.resources.VirtualContainer.members(VirtualContainer.java:140)\n\tat org.eclipse.jst.common.jdt.internal.classpath.FlexibleProjectContainer.\u003cinit\u003e(FlexibleProjectContainer.java:133)\n\tat org.eclipse.jst.j2ee.internal.web.classpath.WebAppContainer.\u003cinit\u003e(WebAppContainer.java:46)\n\tat org.eclipse.jst.j2ee.internal.web.classpath.WebAppContainerInitializer.initialize(WebAppContainerInitializer.java:34)\n\tat org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1591)\n\tat org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:1551)\n\tat org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1038)\n\tat org.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1326)\n\tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:2046)\n\tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1954)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.createExternalArchiveDelta(DeltaProcessor.java:711)\n\tat org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged(DeltaProcessor.java:1791)\n\tat org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged(DeltaProcessingState.java:432)\n\tat org.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:276)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:270)\n\tat org.eclipse.core.internal.events.NotificationManager.broadcastChanges(NotificationManager.java:144)\n\tat org.eclipse.core.internal.resources.Workspace.broadcastPostChange(Workspace.java:180)\n\tat org.eclipse.core.internal.resources.Workspace.endOperation(Workspace.java:916)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1730)",
    "Added to 1.0.2 hotlist. Setting priority to P2, target to 1.0.2M102",
    "Hi - I am going to dup this bug - I made a drop to both the R102 and M6 streams last night.....\n\nRan across this same problem - race condition migrating metadata, and initializing the web container. - I also do a check on locked workspace root before proceeding....\n\n(BTW - the fixes did not make it into this weeks M build)   but are in the repo now...\n\n*** This bug has been marked as a duplicate of 122107 ***",
    "Created an attachment (id\u003d35974)\nParsing bug with not correctly closed attributes. Just copy the file to your WebContent  directory\n\n",
    "Created an attachment (id\u003d35975)\nAnother performance/parsing problem. Just copy the file to your WebContent\n\n",
    "I am sorry for uploading the files here.\nIt seems that bugzilla got confused. Please just ignore it, it belongs to bug 130606",
    "Closing."
  ],
  "commentCreationDates": [
    "2006-03-06T19:53:36+01:00",
    "2006-03-06T20:14:47+01:00",
    "2006-03-07T16:28:32+01:00",
    "2006-03-09T12:30:06+01:00",
    "2006-03-09T12:30:43+01:00",
    "2006-03-09T12:33:05+01:00",
    "2006-04-08T03:18:53+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.core.internal.resources.ResourceException",
      "message": "The resource tree is locked for modifications.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.resources.WorkManager.checkIn",
          "source": "WorkManager.java:94"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.prepareOperation",
          "source": "Workspace.java:1676"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1716"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleMigratorManager.migrateOldMetaData",
          "source": "ModuleMigratorManager.java:106"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary",
          "source": "ModuleStructuralModel.java:179"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject",
          "source": "ModuleStructuralModel.java:99"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot",
          "source": "StructureEdit.java:437"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules",
          "source": "StructureEdit.java:466"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent",
          "source": "StructureEdit.java:904"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getMetaResources",
          "source": "VirtualComponent.java:228"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualContainer.members",
          "source": "VirtualContainer.java:157"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualContainer.members",
          "source": "VirtualContainer.java:140"
        },
        {
          "method": "org.eclipse.jst.common.jdt.internal.classpath.FlexibleProjectContainer.\u003cinit\u003e",
          "source": "FlexibleProjectContainer.java:133"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.web.classpath.WebAppContainer.\u003cinit\u003e",
          "source": "WebAppContainer.java:46"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.web.classpath.WebAppContainerInitializer.initialize",
          "source": "WebAppContainerInitializer.java:34"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:1591"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers",
          "source": "JavaModelManager.java:1551"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:1038"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1326"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:2046"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1954"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.createExternalArchiveDelta",
          "source": "DeltaProcessor.java:711"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged",
          "source": "DeltaProcessor.java:1791"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged",
          "source": "DeltaProcessingState.java:432"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager$2.run",
          "source": "NotificationManager.java:276"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.notify",
          "source": "NotificationManager.java:270"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.broadcastChanges",
          "source": "NotificationManager.java:144"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.broadcastPostChange",
          "source": "Workspace.java:180"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.endOperation",
          "source": "Workspace.java:916"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1730"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "130618",
      "duplicateId": "122107",
      "date": "2006-03-06T19:53:36+01:00",
      "product": "Web Tools",
      "component": "wst.common",
      "severity": "major"
    }
  ],
  "groupId": "122107",
  "bugId": "130618",
  "duplicateId": "122107",
  "date": "2006-03-06T19:53:36+01:00",
  "product": "Web Tools",
  "component": "wst.common",
  "severity": "major"
}