{
  "comments": [
    "N20051030 test results:\ntestStartShutdown() is failing for the help system on mac.\n\nConnection file exists after shutdown\n\njunit.framework.AssertionFailedError: Connection file exists after shutdown\nat\norg.eclipse.help.tests.standalone.TestEclipse.testStartShutdown(TestEclipse.java:59)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:330)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:204)\nat org.eclipse.test.CoreTestApplication.runTests(CoreTestApplication.java:35)\nat org.eclipse.test.CoreTestApplication.run(CoreTestApplication.java:31)\nat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:165)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "\nThis appears to be a bug in SWT. The Display.wake() does not wake the thread\nfrom sleep(). This happens inconsistently. It works when running from the\nworkbench, but not from the command line. Please note I can still wake the\nthread from sleep() by sending external events like clicking or moving the\nmouse, so when you run this, do not move the mouse at all. This was verified on\ntwo separate macs. It always works on windows.\n\nHere\u0027s the test:\n--------------------\n\npackage my.pkg;\n\nimport org.eclipse.swt.widgets.Display;\n\npublic class Test {\n\t\n\tprivate static boolean keepRunning \u003d true;\n\tprivate static Display display;\n\t\n\tpublic static void main(String[] args) throws Exception {\n\t\tdisplay \u003d new Display();\n\t\t\n\t\t\n\t\tnew Thread() {\n\t\t\tpublic void run() {\n\t\t\t\ttry {\n\t\t\t\t\tThread.sleep(3000);\n\t\t\t\t\tkeepRunning \u003d false;\n\t\t\t\t\tdisplay.wake();\n\t\t\t\t}\n\t\t\t\tcatch (Exception e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t}.start();\n\t\t\n\t\twhile (keepRunning) {\n\t\t\tif (!display.readAndDispatch()) {\n\t\t\t\tdisplay.sleep();\n\t\t\t}\n\t\t}\n\t\tdisplay.dispose();\n\t}\n}\n",
    "When you run from the command line, are you adding the -XstartOnFirstThread VM\nargument?",
    "no we are not.",
    "If you are running from the command line, you need the -XstartOnFirstThread.",
    "The test works fine on my Tiger 10.4.3 launching from Eclipse and from the command line (with or \nwithout -XstartOnFirstThread). ",
    "Silenio,\ncan you try again but dont move you mouse? it triggers os events.",
    "I believe we might have a problem, caused either by changing to HIView or \nrecent changes in Display.sleep() (this is more likely).  However, I don\u0027t \nhave a test case that I can debug.  The code in this but report WORKSFORME.\n\nHow should we proceed?  You could hack out either or both of the changes to \nSWT and see if this fixes your problem.  To get rid of HIView, set the HIVIEW \nvariable in the class OS to false.  To get rid of the sleep() changes, delete \nthe if statement that starts \"if (eventTable !\u003d null \u0026\u0026 ...\".  Does the \nproblem go away?",
    "Mazem, can you make the simple case fail?",
    "Yes, both Mazen and I can make the simple test fail. However, it order to make \nit fail you can\u0027t move your mouse. As soon as you move it, it wakes.",
    "testcase in this defect works with the -XstartOnFirstThread.\nNeed to test Help System code with this workaround.",
    "using the -vmargs -XstartOnFirstThread consistantly resolved the Help System \nproblem. \nNot sure why testcase was passing for so long on Mac, yet they failed \nrecently. The failing testcase was trying to start and stop the standalone \nHelp server, which is an Eclipse IPlatformRunnable.\nWhen launched on Mac, -XstartOnFirstThread was not passed to the java vm. \n\nThis is not a bug in the Help System code. This is a documentation bug. The \ndocs for standalone help need to be updated to tell users to launch the \nstandalobe help application with the -vmargs -XstartOnFirstThread. \n\nWill update testcase and then close defect. \n",
    "Let me know if I need to do anything else.",
    "Verified, test no longer failing. Closing bug.",
    "thanks Steve for the help."
  ],
  "commentCreationDates": [
    "2005-10-31T22:13:46+01:00",
    "2005-11-03T02:09:13+01:00",
    "2005-11-03T03:32:30+01:00",
    "2005-11-03T15:01:22+01:00",
    "2005-11-03T16:09:38+01:00",
    "2005-11-03T16:14:35+01:00",
    "2005-11-03T16:18:35+01:00",
    "2005-11-03T16:21:21+01:00",
    "2005-11-03T16:21:50+01:00",
    "2005-11-03T16:29:26+01:00",
    "2005-11-03T16:32:08+01:00",
    "2005-11-03T17:13:53+01:00",
    "2005-11-03T19:21:18+01:00",
    "2005-11-08T22:48:29+01:00",
    "2005-11-09T19:34:10+01:00"
  ],
  "traces": [
    {
      "exceptionType": "junit.framework.AssertionFailedError",
      "message": "Connection file exists after shutdown",
      "elements": [
        {
          "method": "org.eclipse.help.tests.standalone.TestEclipse.testStartShutdown",
          "source": "TestEclipse.java:59"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:330"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:204"
        },
        {
          "method": "org.eclipse.test.CoreTestApplication.runTests",
          "source": "CoreTestApplication.java:35"
        },
        {
          "method": "org.eclipse.test.CoreTestApplication.run",
          "source": "CoreTestApplication.java:31"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:165"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "114433",
      "date": "2005-10-31T22:13:46+01:00",
      "product": "Platform",
      "component": "User Assistance",
      "severity": "normal"
    }
  ],
  "groupId": "114433",
  "bugId": "114433",
  "date": "2005-10-31T22:13:46+01:00",
  "product": "Platform",
  "component": "User Assistance",
  "severity": "normal"
}