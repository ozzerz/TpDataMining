{
  "comments": [
    "- Show task list with some queries in it\n- Create a category\n- Drag a task from a query and \n- drop it on the category\n\nOn WIndows XP, a copy of the task is created in the category\nOn Mac OSX: nothing happens!\n\nDragging a task to the FInder creates an export, so the dragging bit apparently works, at least for FileTransfer.\nRIght-Click and \u0027Move to\u0027 also works.\n\nApparently a Category finds it hard to act as a drop receiver.",
    "Leo: can you reproduce this?",
    "Also see:\nhttps://bugs.eclipse.org/bugs/buglist.cgi?query_format\u003dadvanced\u0026short_desc_type\u003dallwordssubstr\u0026short_desc\u003dDND\u0026long_desc_type\u003dallwordssubstr\u0026long_desc\u003d\u0026bug_file_loc_type\u003dallwordssubstr\u0026bug_file_loc\u003d\u0026status_whiteboard_type\u003dallwordssubstr\u0026status_whiteboard\u003d\u0026keywords_type\u003dallwords\u0026keywords\u003d\u0026rep_platform\u003dMacintosh\u0026op_sys\u003dMac+OS+X\u0026bugidtype\u003dinclude\u0026cmdtype\u003ddoit\n\nSomething\u0027s wromng with Mac DnD, but workarounds seem to exist.",
    " (In reply to comment #1)\n\u003e Leo: can you reproduce this?\n\nIndeed I can. I don\u0027t use categories, but I don\u0027t think I can remember this ever working.",
    "Please note that in the SWT Example Launcher, and dragging from anything (on the Drag Source) to a list (on Drop Target), it only works when the  DND.DRAG_MOVE is enabled on the Drag Source side :-(",
    "Maarten, Leo: are you dropping onto a task, or between tasks?  Dropping onto a task is not currently supported because we reserved it for creating subtasks.  Maybe we should revisit that decision.",
    "No, I tried dropping it onto the container title. It doesn\u0027t matter, dragging onto container title, task, or between tasks results in the same error. I don\u0027t know about Maarten, but I always get an Unhandled event loop exception:\n\njava.lang.NullPointerException\n\tat org.eclipse.swt.dnd.DragSource.dragSendDataProc(DragSource.java:389)\n\tat org.eclipse.swt.dnd.DragSource.DragSendDataProc(DragSource.java:195)\n\tat org.eclipse.swt.internal.carbon.OS.TrackDrag(Native Method)\n\tat org.eclipse.swt.dnd.DragSource.drag(DragSource.java:347)\n\tat org.eclipse.swt.dnd.DragSource$1.handleEvent(DragSource.java:163)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1495)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1519)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1504)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1295)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3350)\n\tat org.eclipse.swt.widgets.Control.sendTrackEvents(Control.java:2831)\n\tat org.eclipse.swt.widgets.Control.kEventControlTrack(Control.java:1953)\n\tat org.eclipse.swt.widgets.Widget.controlProc(Widget.java:367)\n\tat org.eclipse.swt.widgets.Display.controlProc(Display.java:835)\n\tat org.eclipse.swt.internal.carbon.OS.CallNextEventHandler(Native Method)\n\tat org.eclipse.swt.widgets.Tree.kEventMouseDown(Tree.java:2363)\n\tat org.eclipse.swt.widgets.Widget.mouseProc(Widget.java:1262)\n\tat org.eclipse.swt.widgets.Display.mouseProc(Display.java:2819)\n\tat org.eclipse.swt.internal.carbon.OS.SendEventToEventTarget(Native Method)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2938)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\n\tat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n\tat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n\tat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:169)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508)\n\tat org.eclipse.equinox.launcher.Main.basicRun(Main.java:447)\n\tat org.eclipse.equinox.launcher.Main.run(Main.java:1173)\n\tat org.eclipse.equinox.launcher.Main.main(Main.java:1148)\n",
    "I can\u0027t reproduce the exception on my test workspace, although dnd does not work their either.",
    " (In reply to comment #5)\n\u003e Maarten, Leo: are you dropping onto a task, or between tasks?\nI drop on the category title and get the same unhandled event loop exception...\n",
    "Leo, did you find out more about the cause of the problem?",
    "The only hint I\u0027ve found is that the drag listeners seem to fire off a lot earlier on the Mac than on Windows, but I haven\u0027t looked at this since Tuesday. Will try to get this resolved before the weekend is up, if you want to reassign to me.",
    "What I noticed in Task List drop adapter is that it is using current selection to figure out the drop target. The selection is probably correct when drag feedback is enabled, but it still doesn\u0027t seem right. If I am not mistaken, think Mik wrote that code, maybe he can comment on that.\n\nI would think that drop target should be based on the tree item under the current cursor location (similar to how tooltips work).",
    " (In reply to comment #11)\n\u003e What I noticed in Task List drop adapter is that it is using current selection\n\u003e to figure out the drop target.\nSounds like the Baron of Munchhausen pulling himself from the marsh by his bootstraps...",
    "That\u0027s great Leo, assigning to you. \n\nAs far as I understand the code the current selection is used to determine which object is being dragged. It is used to prevent queries of being dragged but it does not work on Mac since the item is unselected on Mac OS X when a drag starts. \n\nLeo, you could investigate replacing TaskTransfer by LocalSelectionTransfer which stores the selection in the transfer object instead of getting the selection from the viewer. \n\nAnother option is to fix TaskTransfer which is expects an array of AbstractTask objects but gets passed an array of Objects in javaToNative() so it never serializes the dragged objects correctly.\n\nEither way, this will require some cleanup of TaskListDropAdapter to not access the selection of the tree but to use the transfer objects instead.",
    "Created an attachment (id\u003d84110)\nfix serializing tasks in TaskTransfer\n\nLeo, it would be great if you could take a look at the patch and report back if that works on Mac OS X.",
    "Created an attachment (id\u003d84111)\nmylyn/context/zip\n\n",
    "Unfortunately this patch doesn\u0027t fix the issue on Mac.",
    "Okay, we can take another look at the problem together tomorrow. I have committed a modified version of the patch to get rid of the dependency on the tree selection but we may have to use LocalSelectionTransfer to get it working on Mac OS X.",
    "Created an attachment (id\u003d84223)\nrefactoring of TaskListDragSourceListener\n\nSteffen, can you apply this and confirm that it doesn\u0027t break on non-Mac systems?",
    "Created an attachment (id\u003d84224)\nmylyn/context/zip\n\n",
    "Great work Leo! Works perfectly on Linux. I have applied your patch with additional refactorings in TaskListSourceListener to simplify the code even more. Leo, please verify on Mac OS X and close this report if it works.",
    "Yes it works. Thanks for the help Steffen.",
    "Are you guys sure that saving current selection in the drag source listener and not cleaning it is harmless?"
  ],
  "commentCreationDates": [
    "2007-11-27T16:37:04+01:00",
    "2007-11-27T16:44:28+01:00",
    "2007-11-27T18:07:34+01:00",
    "2007-11-27T18:59:39+01:00",
    "2007-11-27T20:38:36+01:00",
    "2007-11-27T21:32:06+01:00",
    "2007-11-27T21:54:03+01:00",
    "2007-11-27T22:01:20+01:00",
    "2007-11-27T22:05:38+01:00",
    "2007-11-29T20:35:28+01:00",
    "2007-11-29T20:58:09+01:00",
    "2007-11-29T21:11:34+01:00",
    "2007-11-29T21:20:42+01:00",
    "2007-11-29T22:38:28+01:00",
    "2007-11-29T23:06:11+01:00",
    "2007-11-29T23:06:12+01:00",
    "2007-11-29T23:16:31+01:00",
    "2007-11-30T04:05:00+01:00",
    "2007-11-30T19:47:21+01:00",
    "2007-11-30T19:47:23+01:00",
    "2007-11-30T20:11:17+01:00",
    "2007-11-30T21:04:04+01:00",
    "2007-11-30T21:47:27+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.swt.dnd.DragSource.dragSendDataProc",
          "source": "DragSource.java:389"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource.DragSendDataProc",
          "source": "DragSource.java:195"
        },
        {
          "method": "org.eclipse.swt.internal.carbon.OS.TrackDrag",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource.drag",
          "source": "DragSource.java:347"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource$1.handleEvent",
          "source": "DragSource.java:163"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1495"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1519"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1504"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:1295"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3350"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.sendTrackEvents",
          "source": "Control.java:2831"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.kEventControlTrack",
          "source": "Control.java:1953"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.controlProc",
          "source": "Widget.java:367"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.controlProc",
          "source": "Display.java:835"
        },
        {
          "method": "org.eclipse.swt.internal.carbon.OS.CallNextEventHandler",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.kEventMouseDown",
          "source": "Tree.java:2363"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.mouseProc",
          "source": "Widget.java:1262"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.mouseProc",
          "source": "Display.java:2819"
        },
        {
          "method": "org.eclipse.swt.internal.carbon.OS.SendEventToEventTarget",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2938"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:169"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:508"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:447"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1173"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1148"
        }
      ],
      "number": 0,
      "commentIndex": 6,
      "bugId": "211080",
      "date": "2007-11-27T21:54:03+01:00",
      "product": "Mylyn",
      "component": "Tasks",
      "severity": "normal"
    }
  ],
  "groupId": "211080",
  "bugId": "211080",
  "date": "2007-11-27T16:37:04+01:00",
  "product": "Mylyn",
  "component": "Tasks",
  "severity": "normal"
}