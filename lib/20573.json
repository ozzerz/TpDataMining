{
  "comments": [
    "Version: 2.0\nBuild id: 20020612 (F3)\n\nI\u0027ve been trying to use Ant\u0027s optional task \u003cjavah\u003e to run javah against a \nclass that contains native method stubs.  Here\u0027s the my buildfile.xml I wrote \nthat resides in a folder called \"ant\" inside my project:\n\n\u003cproject name\u003d\"Run Javah\" default\u003d\"help\" basedir\u003d\".\"\u003e\n  \u003ctarget name\u003d\"generate_header\"\u003e\n    \u003cjavah\n      destDir\u003d\".\"\n      class\u003d\"com.oti.simona.jni.CalculatorAccessor\"\t\t\t\n      classpath\u003d\"${basedir}\\..\\Calc\"/\u003e\n  \u003c/target\u003e\n\u003c/project\u003e\n\nAs you can see, I\u0027m using the optional \u003cjavah\u003e task to create the header for a \nclass that resides in a source folder called Calc.  Here\u0027s what\u0027s written to \nthe Ant Console when I run buildfile.xml:\n\njava.lang.NoClassDefFoundError: com/sun/tools/javah/Main\n\tat org.apache.tools.ant.taskdefs.optional.Javah.doClassicCompile\n(Javah.java:317)\n\tat org.apache.tools.ant.taskdefs.optional.Javah.execute(Javah.java:287)\n\tat org.apache.tools.ant.Task.perform(Task.java:217)\n\tat org.apache.tools.ant.Target.execute(Target.java:184)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:202)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:601)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:560)\n\tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run\n(InternalAntRunner.java:269)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:188)\n\tat org.eclipse.ui.externaltools.internal.core.AntFileRunner.execute\n(AntFileRunner.java:54)\n\tat \norg.eclipse.ui.externaltools.internal.core.DefaultRunnerContext.executeRunner\n(DefaultRunnerContext.java:329)\n\tat org.eclipse.ui.externaltools.internal.core.DefaultRunnerContext.run\n(DefaultRunnerContext.java:379)\n\tat org.eclipse.ui.externaltools.internal.ui.AntLaunchWizard$1.run\n(AntLaunchWizard.java:116)\n\tat org.eclipse.jface.operation.ModalContext$ModalContextThread.run\n(ModalContext.java:98)\nBuild exception: java.lang.NoClassDefFoundError: com/sun/tools/javah/Main\n\n\nI tried to use the \u003cjavah\u003e attribute bootclasspath to point at my external \njdk1.3 tools library lib\\tools.jar, but this did not help.\n\nI wrote another target to query the version properties:\n\n\u003ctarget name\u003d\"properties\"\u003e\n    \u003cecho message\u003d\"ant.version\u003d${ant.version}\"/\u003e\n    \u003cecho message\u003d\"ant.java.version\u003d${ant.java.version}\"/\u003e\n\u003c/target\u003e\n\nThis target wrote the following to the Ant Console:\n\nant.version\u003dAnt version 1.4.1 compiled on October 11 2001\nant.java.version\u003d1.3",
    "Try adding tools.jar to the Ant classpath (Window-\u003ePreferences-\u003eExternal Tools-\n\u003eAnt).",
    "I tried adding tools.jar to Ant\u0027s classpath and it killed Eclipse with nothing \nwritten to .metadata\\.log file.  See the attached BMP for the dialog that was \ndisplayed as Eclipse died.",
    "Created an attachment (id\u003d1482)\nDialog Displayed By Eclipse as it Dies\n",
    "OK, so it seems that it found the class it was looking for. The problem now seem\nto be that the class you are using (or the optional task is using) calls\nSystem.exit and since Ant in Eclipse runs in the same VM, it kills the running\nEclipse.\n\nA workaround it is to or call javah.exe through the external tools or run Ant as\nan external tool. For the last one you have to download a binary distribution of\nAnt and point the external tool to be ant.bat. Provide the necessary command\nline arguments and it should work.",
    "So, is there really nothing better we can do in our Ant support to make the \n\u003cjavah\u003e task work.  Of course \u003cjavah\u003e is an optional Ant task, so it\u0027s not \ncritical, but it would certainly be nice.\n\nAt the least, I would like to see problems like this documented in the release \nnotes as known problems.\n\nRe- the System.exit(int) call.  Is there really nothing Eclipse can do to catch \nthese calls.  I\u0027ve heard about MIDP using Java\u0027s SecurityManager to make the \nSystem.exit(int) message a no-op.\n",
    "It will be in a README.\n\n*** This bug has been marked as a duplicate of 6020 ***"
  ],
  "commentCreationDates": [
    "2002-06-18T21:10:45+02:00",
    "2002-06-18T21:22:20+02:00",
    "2002-06-18T22:53:54+02:00",
    "2002-06-18T22:54:47+02:00",
    "2002-06-18T23:45:12+02:00",
    "2002-06-19T00:08:08+02:00",
    "2002-06-25T22:03:26+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "com/sun/tools/javah/Main",
      "elements": [
        {
          "method": "org.apache.tools.ant.taskdefs.optional.Javah.doClassicCompile",
          "source": "Javah.java:317"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.optional.Javah.execute",
          "source": "Javah.java:287"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:217"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:184"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:202"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTarget",
          "source": "Project.java:601"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:560"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.InternalAntRunner.run",
          "source": "InternalAntRunner.java:269"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.ant.core.AntRunner.run",
          "source": "AntRunner.java:188"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.core.AntFileRunner.execute",
          "source": "AntFileRunner.java:54"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.core.DefaultRunnerContext.executeRunner",
          "source": "DefaultRunnerContext.java:329"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.core.DefaultRunnerContext.run",
          "source": "DefaultRunnerContext.java:379"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.ui.AntLaunchWizard$1.run",
          "source": "AntLaunchWizard.java:116"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.java:98"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "20573",
      "duplicateId": "6020",
      "date": "2002-06-18T21:10:45+02:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    }
  ],
  "groupId": "6020",
  "bugId": "20573",
  "duplicateId": "6020",
  "date": "2002-06-18T21:10:45+02:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "normal"
}