{
  "comments": [
    "Build ID: I20070621-1340\n\nSteps To Reproduce:\n1. Checked-out a J2EE utility module from CVS.\n\n2. Right-clicked the project, \"properties\", \"project facets\".\n\n3. Click \"Modify Project...\"\n\n4. No dialog shows. A stack trace appears in the workspace\u0027s log.\n\n\nMore information:\n!ENTRY org.eclipse.ui 4 0 2007-08-01 22:08:15.970\n!MESSAGE Unhandled event loop exception\n!STACK 0\njava.lang.NullPointerException\n        at org.eclipse.wst.common.project.facet.core.internal.PresetsExtensionPoint$StaticPreset.\u003cinit\u003e(PresetsExtensionPoint.java:384)\n        at org.eclipse.wst.common.project.facet.core.internal.PresetsExtensionPoint$DynamicPreset.resolve(PresetsExtensionPoint.java:586)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.refreshAvailablePresets(ModifyFacetedProjectDataModel.java:209)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel$2.handleEvent(ModifyFacetedProjectDataModel.java:82)\n        at org.eclipse.wst.common.project.facet.ui.internal.AbstractDataModel.notifyListeners(AbstractDataModel.java:69)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.refreshAvailableFacets(ModifyFacetedProjectDataModel.java:181)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.access$0(ModifyFacetedProjectDataModel.java:129)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel$1.handleEvent(ModifyFacetedProjectDataModel.java:69)\n        at org.eclipse.wst.common.project.facet.ui.internal.AbstractDataModel.notifyListeners(AbstractDataModel.java:69)\n        at org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.setFixedFacets(ModifyFacetedProjectDataModel.java:110)\n        at org.eclipse.wst.common.project.facet.ui.internal.FacetsSelectionPanel.setFixedProjectFacets(FacetsSelectionPanel.java:840)\n        at org.eclipse.wst.common.project.facet.ui.internal.FacetsSelectionPage.createControl(FacetsSelectionPage.java:155)\n        at org.eclipse.jface.wizard.Wizard.createPageControls(Wizard.java:170)\n        at org.eclipse.wst.common.project.facet.ui.ModifyFacetedProjectWizard.createPageControls(ModifyFacetedProjectWizard.java:238)\n        at org.eclipse.jface.wizard.WizardDialog.createPageControls(WizardDialog.java:669)\n        at org.eclipse.jface.wizard.WizardDialog.createContents(WizardDialog.java:543)\n        at org.eclipse.jface.window.Window.create(Window.java:426)\n        at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1081)\n        at org.eclipse.jface.window.Window.open(Window.java:785)\n        at org.eclipse.wst.common.project.facet.ui.internal.FacetsPropertyPage$3.widgetSelected(FacetsPropertyPage.java:150)\n        at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:227)\n        at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n        at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1101)\n        at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3319)\n        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971)\n        at org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\n        at org.eclipse.jface.window.Window.open(Window.java:796)\n        at org.eclipse.ui.dialogs.PropertyDialogAction.run(PropertyDialogAction.java:156)\n        at org.eclipse.jface.action.Action.runWithEvent(Action.java:498)\n        at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:545)\n        at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:490)\n        at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:402)\n        at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n        at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1101)\n        at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3319)\n        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971)\n        at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\n        at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\n        at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n        at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n        at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n        at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n        at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n        at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n        at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:504)\n        at org.eclipse.equinox.launcher.Main.basicRun(Main.java:443)\n        at org.eclipse.equinox.launcher.Main.run(Main.java:1169)",
    "Hmm... Not obvious where the null is getting introduced. Would you be willing to try a patch that\u0027s instrumented to flush the source of the problem out? I can give you a pre-built plugin to drop into your Eclipse install.",
    "Sure, no problem.",
    "Konstantin, looking at the code, fv is always null.  Here is the snippet from the constructor of StaticPreset:\n\nfor( IProjectFacetVersion fv : this.facetVersions )\n{\n     this.facets.add( fv.getProjectFacet() );\n}\n\nfv is declared, but never given a value, so fv.getProjectFacet() will cause a NPE.",
    "Carl,\n\nI am afraid you are misreading Java 5 syntax. The loop is a \"for each\" statement and fv is auto-assigned with values from the this.facetVersions collection. The question is how does a null get into that collection.",
    "Created an attachment (id\u003d76821)\nInstrumented Plugin\n\nSorry for the delayed follow-up. Attached is a plugin that\u0027s instrumented to catch the cause of the problem. If you try your repro with the attached plugin installed, you should see the facets dialog come up without a problem. In the log, you should see an IllegalArgumentException stack trace (instead of the NPE). Please attach that stack trace to this bug report as that will help pin-point the source of the problem.",
    "Changes released into the 2.0.1 and 3.0 streams.",
    "Hello Konstantin,\n\nSorry, however since I have reported this bug I must have done something to my workspace so I cannot reproduce this bug at the moment.\n\nWhat I can do is install the patch and occasionally monitor my workspace\u0027s log file to see if any IAE is generated, and if it is, post the result here.\n\nFrom your description, I\u0027m led to believe that your fix involves null checking upon insertion into a collection, throwing an IAE if a null value is encountered. So that may be a good piece of code to keep around anyway, in the next released version...\n\nAnyway, I\u0027m not sure what to resolve this bug to (later? worksforme?) so I\u0027ll leave that to you.\n\nWill post another comment and (if needed) re-open this bug if it happens again.\n\nThank you for your help.\n\n\n        Isaac",
    "Ok, let\u0027s resolve this issue as fixed. The patch has been released into the code line and next time someone runs into this, we will have a better stack trace to go on."
  ],
  "commentCreationDates": [
    "2007-08-02T05:20:10+02:00",
    "2007-08-02T17:50:23+02:00",
    "2007-08-02T18:02:18+02:00",
    "2007-08-02T18:08:49+02:00",
    "2007-08-02T18:11:18+02:00",
    "2007-08-23T23:10:00+02:00",
    "2007-08-24T00:47:34+02:00",
    "2007-09-06T05:17:15+02:00",
    "2007-09-06T14:59:07+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.PresetsExtensionPoint$StaticPreset.\u003cinit\u003e",
          "source": "PresetsExtensionPoint.java:384"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.PresetsExtensionPoint$DynamicPreset.resolve",
          "source": "PresetsExtensionPoint.java:586"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.refreshAvailablePresets",
          "source": "ModifyFacetedProjectDataModel.java:209"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel$2.handleEvent",
          "source": "ModifyFacetedProjectDataModel.java:82"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.AbstractDataModel.notifyListeners",
          "source": "AbstractDataModel.java:69"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.refreshAvailableFacets",
          "source": "ModifyFacetedProjectDataModel.java:181"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.access$0",
          "source": "ModifyFacetedProjectDataModel.java:129"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel$1.handleEvent",
          "source": "ModifyFacetedProjectDataModel.java:69"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.AbstractDataModel.notifyListeners",
          "source": "AbstractDataModel.java:69"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.ModifyFacetedProjectDataModel.setFixedFacets",
          "source": "ModifyFacetedProjectDataModel.java:110"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.FacetsSelectionPanel.setFixedProjectFacets",
          "source": "FacetsSelectionPanel.java:840"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.FacetsSelectionPage.createControl",
          "source": "FacetsSelectionPage.java:155"
        },
        {
          "method": "org.eclipse.jface.wizard.Wizard.createPageControls",
          "source": "Wizard.java:170"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.ModifyFacetedProjectWizard.createPageControls",
          "source": "ModifyFacetedProjectWizard.java:238"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.createPageControls",
          "source": "WizardDialog.java:669"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.createContents",
          "source": "WizardDialog.java:543"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:426"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:1081"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:785"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.internal.FacetsPropertyPage$3.widgetSelected",
          "source": "FacetsPropertyPage.java:150"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:227"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1101"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3319"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2971"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:820"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:796"
        },
        {
          "method": "org.eclipse.ui.dialogs.PropertyDialogAction.run",
          "source": "PropertyDialogAction.java:156"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:498"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:545"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:490"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:402"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1101"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3319"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2971"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:504"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:443"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1169"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "198610",
      "date": "2007-08-02T05:20:10+02:00",
      "product": "Web Tools",
      "component": "wst.common",
      "severity": "normal"
    }
  ],
  "groupId": "198610",
  "bugId": "198610",
  "date": "2007-08-02T05:20:10+02:00",
  "product": "Web Tools",
  "component": "wst.common",
  "severity": "normal"
}