{
  "comments": [
    "Using eclipse compiler set to 1.4 compiler compliance level, 1.4 generated .class file compatibility, 1.4 source compatibility, running against Java Sun JDK 1.5.0_08, load time weaving and AspectJ 1.5.2a, I have the following exception:\n\nException in thread \"main\" java.lang.ClassFormatError: Method forName_aroundBody0 in class SomeInterface has illegal modifiers: 0x1A\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:260)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:56)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:195)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:268)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n\tat java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:260)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:56)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:195)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:268)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n\tat java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n\tat ProblemRunner.main(ProblemRunner.java:5)\n\n\n\npublic aspect ProblemAspect {\n\n\tpointcut init(): initialization(Object+.new(..));\n\n\tpointcut staticinit(): staticinitialization(Object+);\n\n\tClass around(String className): cflowbelow(init() || staticinit()) \u0026\u0026 call(Class Class.forName(String)) \u0026\u0026 args(className) {\n\t\tSystem.out.println(\"Test\");\n\t\treturn proceed(className);\n\n\t}\n}\n\npublic class SomeClass implements SomeInterface {\n\n}\n\npublic interface SomeInterface {\n\tClass ADAPTER \u003d SomeInterface.class;\n}",
    "background.  Generating code at the 1.4 level causes :\n\nClass ADAPTER \u003d SomeInterface.class;\n\nin the interface to manifest as a static initializer call to Class.forName(\"SomeInterface\");\n\nWith java 1.5, the LDC instruction is allowed to reference the class literal directly, so there is no Class.forName() call (there is no join point)\n\nSo if you compile this code at 1.5 - the advice won\u0027t match because there is no join point (and so we don\u0027t fail).  If you compile it at 1.4 - the advice will match and we will generate methods in an interface, these methods will not be abstract and so that causes the class file to be invalid.\n",
    "recognize this problem and dont weave methods into an interface"
  ],
  "commentCreationDates": [
    "2006-10-31T22:20:00+01:00",
    "2006-11-06T09:57:00+01:00",
    "2007-10-25T16:31:09+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassFormatError",
      "message": "Method forName_aroundBody0 in class SomeInterface has illegal modifiers: 0x1A",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClass1",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:620"
        },
        {
          "method": "java.security.SecureClassLoader.defineClass",
          "source": "SecureClassLoader.java:124"
        },
        {
          "method": "java.net.URLClassLoader.defineClass",
          "source": "URLClassLoader.java:260"
        },
        {
          "method": "java.net.URLClassLoader.access$100",
          "source": "URLClassLoader.java:56"
        },
        {
          "method": "java.net.URLClassLoader$1.run",
          "source": "URLClassLoader.java:195"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "java.net.URLClassLoader.findClass",
          "source": "URLClassLoader.java:188"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:306"
        },
        {
          "method": "sun.misc.Launcher$AppClassLoader.loadClass",
          "source": "Launcher.java:268"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:251"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:319"
        },
        {
          "method": "java.lang.ClassLoader.defineClass1",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:620"
        },
        {
          "method": "java.security.SecureClassLoader.defineClass",
          "source": "SecureClassLoader.java:124"
        },
        {
          "method": "java.net.URLClassLoader.defineClass",
          "source": "URLClassLoader.java:260"
        },
        {
          "method": "java.net.URLClassLoader.access$100",
          "source": "URLClassLoader.java:56"
        },
        {
          "method": "java.net.URLClassLoader$1.run",
          "source": "URLClassLoader.java:195"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "java.net.URLClassLoader.findClass",
          "source": "URLClassLoader.java:188"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:306"
        },
        {
          "method": "sun.misc.Launcher$AppClassLoader.loadClass",
          "source": "Launcher.java:268"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:251"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:319"
        },
        {
          "method": "ProblemRunner.main",
          "source": "ProblemRunner.java:5"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "163005",
      "date": "2006-10-31T22:20:00+01:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "163005",
  "bugId": "163005",
  "date": "2006-10-31T22:20:00+01:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}