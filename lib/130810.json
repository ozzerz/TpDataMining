{
  "comments": [
    "I have Eclipse 3.2 M5a where I created a Java project and added all the libraries from Sun\u0027s JAX-WS reference implementation:\n\nactivation.jar\nFastInfoset.jar\nhttp.jar\njaxb-api.jar\njaxb-impl.jar\njaxb-xjc.jar\njaxws-api.jar\njaxws-rt.jar\njaxws-tools.jar\njsr173-api.jar\njsr181-api.jar\njsr250-api.jar\nresolver.jar\nsaaj-api.jar\nsaaj-impl.jar\nsjsxp.jar\n\nI then added all these jars to the build path for my Java project as well as the Factory Path for the project. I also enabled project specific settings to do this. After applying the changes, my project rebuilt and the JAX-WS classes for my Java class were generated in the default .apt_generated directory. However, when I modified my file by adding a parameter to an annotation or even removing an annotation altogether, the files in .apt_generated were deleted I could not get the files to regenerate without going through the process of making the Factory Path dirty. My Java class is the following:\n\npackage foo;\n\nimport javax.jws.WebMethod;\nimport javax.jws.WebService;\n\n@WebService\npublic class Echo {\n\t@WebMethod\n\tpublic String echoString(String input)\n\t{\n\t\treturn input;\n\t}\n\n}",
    "When last I looked at the JAX-WS processor, it stored static data that needed to be reset every time it was run. APT can do this by reloading the class on every build, also known as \"batch mode\". This unfortunately means that the processor only gets run on a full clean build.\n\nTo try this, go to the factory path dialog and select the jar containing the annotation processor. Click on the \"Advanced...\" button. Then click on the checkbox for \"Run this container\u0027s processors in batch mode\". ",
    "Jess,\n\nThanks for the quick response. Unfortunately, running in batch mode, I get:\n\n!ENTRY org.eclipse.jdt.apt.core 4 1 2006-03-07 16:42:21.816\n!MESSAGE Unexpected failure running APT on the file(s): Echo.java\n!STACK 0\njava.lang.NoClassDefFoundError: com.sun.xml.ws.util.localization.Localizable\n\tat java.lang.J9VMInternals.verifyImpl(Native Method)\n\tat java.lang.J9VMInternals.verify(J9VMInternals.java:57)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:126)\n\tat com.sun.istack.ws.AnnotationProcessorFactoryImpl.getProcessorFor(AnnotationProcessorFactoryImpl.java:101)\n\tat org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.runAPTInMixedMode(APTDispatchRunnable.java:407)\n\tat org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.build(APTDispatchRunnable.java:561)\n\tat org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.build(APTDispatchRunnable.java:211)\n\tat org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.run(APTDispatchRunnable.java:163)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1733)\n\tat org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.runAPTDuringBuild(APTDispatchRunnable.java:86)\n\tat org.eclipse.jdt.apt.core.internal.AptCompilationParticipant.processAnnotations(AptCompilationParticipant.java:158)\n\tat org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.processAnnotations(AbstractImageBuilder.java:502)\n\tat org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:261)\n\tat org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:50)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:214)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:137)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234)\n\tat org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:303)\n\tat org.eclipse.core.internal.resources.Project.build(Project.java:87)\n\tat org.eclipse.jdt.internal.ui.util.CoreUtility$BuildJob.run(CoreUtility.java:142)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)\n\nThis missing class is coming from jaxws-rt.jar which is on my build path and also on the factory path.",
    "Ah, I think we must have the classloader hierarchy incorrect. I\u0027ll fix that, but in the meantime you could try putting *all* of the jars on the factory path into batch mode, which should put everything in the same classloader.",
    "Pardon me for asking, but how exactly do you put all the factory path jars into batch mode? The Advanced button for running an annotations processor in batch mode only applies when I single select a jar and the dialog that comes up only has a checkbox to toggle whether or not to run the processor in batch mode with a listbox showing the annotations processors in the jar.",
    "Sorry, should have attached more info.\n\nThe checkbox toggling whether or not to run the annotation processors in batch mode has the side-effect of changing which classloader the entire jar gets loaded from. If you toggle that for all of the jars in your factory path, they\u0027ll all end up in the same classloader.\n\nYou shouldn\u0027t need to be aware of this, and once I fix the classloader hierarchy problem it shouldn\u0027t matter, but if you want to try toggling the batch checkbox on all your jars it may allow the processor to run on each clean build.",
    "Thanks Jess. Your suggestion allows the JAX-WS processor to run for each clean build.",
    "I\u0027ve made the classloader hierarchy fix so that only the jar that contains the processor needs to be put into batch mode.\n\nUnfortunately, the JAX-WS processor can still only be run once per clean build, due to its use of static data and batch-based processing."
  ],
  "commentCreationDates": [
    "2006-03-07T21:08:54+01:00",
    "2006-03-07T21:22:11+01:00",
    "2006-03-07T21:41:42+01:00",
    "2006-03-07T21:42:54+01:00",
    "2006-03-07T21:54:30+01:00",
    "2006-03-07T22:24:16+01:00",
    "2006-03-07T22:28:00+01:00",
    "2006-03-29T22:06:41+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "com.sun.xml.ws.util.localization.Localizable",
      "elements": [
        {
          "method": "java.lang.J9VMInternals.verifyImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.J9VMInternals.verify",
          "source": "J9VMInternals.java:57"
        },
        {
          "method": "java.lang.J9VMInternals.initialize",
          "source": "J9VMInternals.java:126"
        },
        {
          "method": "com.sun.istack.ws.AnnotationProcessorFactoryImpl.getProcessorFor",
          "source": "AnnotationProcessorFactoryImpl.java:101"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.runAPTInMixedMode",
          "source": "APTDispatchRunnable.java:407"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.build",
          "source": "APTDispatchRunnable.java:561"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.build",
          "source": "APTDispatchRunnable.java:211"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.run",
          "source": "APTDispatchRunnable.java:163"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1733"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.APTDispatchRunnable.runAPTDuringBuild",
          "source": "APTDispatchRunnable.java:86"
        },
        {
          "method": "org.eclipse.jdt.apt.core.internal.AptCompilationParticipant.processAnnotations",
          "source": "AptCompilationParticipant.java:158"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.processAnnotations",
          "source": "AbstractImageBuilder.java:502"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile",
          "source": "AbstractImageBuilder.java:261"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build",
          "source": "BatchImageBuilder.java:50"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll",
          "source": "JavaBuilder.java:214"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.build",
          "source": "JavaBuilder.java:137"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:593"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:168"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:202"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:231"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:234"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:303"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.build",
          "source": "Project.java:87"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.CoreUtility$BuildJob.run",
          "source": "CoreUtility.java:142"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "130810",
      "date": "2006-03-07T21:41:42+01:00",
      "product": "JDT",
      "component": "APT",
      "severity": "major"
    }
  ],
  "groupId": "130810",
  "bugId": "130810",
  "date": "2006-03-07T21:08:54+01:00",
  "product": "JDT",
  "component": "APT",
  "severity": "major"
}