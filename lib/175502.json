{
  "comments": [
    "Build ID: M20060921-0945\n\nSteps To Reproduce:\nOn \"submit to Repository\", an error pops up, showing \n\nFailed to submit to repository: Changes may not have successfully committed.\nPosting to http://###.###.###.###/bugzilla-2.22 failed: Invalid Username or Password\n\n\n\nMore information:\nsee also news://news.eclipse.org:119/eqao5k$6m8$1@utils.eclipse.org\n\nException Stack Trace:\njavax.security.auth.login.LoginException: Invalid Username or Password\n\tat org.eclipse.mylar.internal.bugzilla.core.BugzillaClient.parseHtmlError(BugzillaClient.java:951)\n\tat org.eclipse.mylar.internal.bugzilla.core.BugzillaClient.postTaskData(BugzillaClient.java:767)\n\tat org.eclipse.mylar.internal.bugzilla.core.BugzillaTaskDataHandler.postTaskData(BugzillaTaskDataHandler.java:157)\n\tat org.eclipse.mylar.tasks.ui.editors.AbstractRepositoryTaskEditor$31.run(AbstractRepositoryTaskEditor.java:2496)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)",
    "Note that by switching to the \"Browser\" tab in the task editor, I can do a commit, which leads me to the bugzilla log in page (is this related to the problem?) first.\n\n",
    " (In reply to comment #1)\n\u003e Note that by switching to the \"Browser\" tab in the task editor, I can do a\n\u003e commit, which leads me to the bugzilla log in page (is this related to the\n\u003e problem?) first.\nThe credentials/authentication are handled separately from the browser. This is why you are presented with login in the browser when you have already been able to authenticate with the bugzilla connector. We hope to address this on Bug#163120.\n\nIf you\u0027ve got the source checked out you could put a println in the parseHtmlError method to see what we are actually getting back from the repository upon submit (try adding System.err.println(body) just before the exception is thrown).  Feel free to email me the output and hopefully we can get to the bottom of this! :)",
    "Thanks for sending the output. Looks like we are in fact having an authentication problem here. So that I have a better idea of the environment could you post the Mylar version, Bugzilla (2.22 but customized?), https?, proxy?, etc (is your ip changing for some reason?).   \n\nIf you want to start looking into this further you could set a breakpoint in BugzillaClient.authenticate() and see whats happening there. Chances are this is successful but during subsequent communication the appropriate information isn\u0027t being sent (cookies). If you look at WebClientUtil.setupHttpClient there are some commented debug/logging comments. Un comment those and re-launch to watch what is happening during httpclient communication. ",
    "found the problem - it was the cookies.\n\nafter switching on logging I saw warnings indicating an invalid $Domain attribute in the set cookie method so they got rejected by the user agent.\n\nI talked to our sysadmin, he corrected the $Domain attribute and now all works fine again.\n\nThanks a lot for your help and hints.",
    "Excellent! Please add your experience and solution to the Mylar FAQ so that if other experience these symptoms they can benefit from your investigation:\n\nhttp://wiki.eclipse.org/index.php/Mylar_FAQ#Why_do_tasks_fail_to_submit.3F",
    "(In reply to comment #5)\n\u003e Excellent! Please add your experience and solution to the Mylar FAQ so that if\n\u003e other experience these symptoms they can benefit from your investigation:\n\u003e \n\u003e http://wiki.eclipse.org/index.php/Mylar_FAQ#Why_do_tasks_fail_to_submit.3F\n\u003e \nan item has been added\n",
    "Great, thanks Michael.",
    "(In reply to comment #4)\n\u003e found the problem - it was the cookies.\n\u003e \n\u003e after switching on logging I saw warnings indicating an invalid $Domain\n\u003e attribute in the set cookie method so they got rejected by the user agent.\n\u003e \n\u003e I talked to our sysadmin, he corrected the $Domain attribute and now all works\n\u003e fine again.\n\u003e \n\u003e Thanks a lot for your help and hints.\n\u003e \n\nCan you be a bit more specific as to what the solution was?  Sorry for being obtuse, but think I am suffering from the same problem.  I can synchronize and get the updated tasks into Mylar, but any attempt at submitting updated tasks from mylar results in the \"unable to log in message\".  ",
    "(In reply to comment #8)\n\u003e (In reply to comment #4)\n\u003e \u003e found the problem - it was the cookies.\n\u003e \u003e \n\u003e \u003e after switching on logging I saw warnings indicating an invalid $Domain\n\u003e \u003e attribute in the set cookie method so they got rejected by the user agent.\n\u003e \u003e \n\u003e \u003e I talked to our sysadmin, he corrected the $Domain attribute and now all works\n\u003e \u003e fine again.\n\u003e \u003e \n\u003e \u003e Thanks a lot for your help and hints.\n\u003e \u003e \n\u003e \n\u003e Can you be a bit more specific as to what the solution was?  Sorry for being\n\u003e obtuse, but think I am suffering from the same problem.  I can synchronize and\n\u003e get the updated tasks into Mylar, but any attempt at submitting updated tasks\n\u003e from mylar results in the \"unable to log in message\".  \n\u003e \n\nHere is what I did:\nFirst, I had to turn on logging as explaind by Rob in comment #3. Then, in the httpclient log, I saw the following (search for \"[WARN]\"):\n[WARN] HttpMethodBase - Cookie rejected: \"$Version\u003d0; Bugzilla_login\u003d8; $Path\u003d/bugzilla-2.22/; $Domain\u003d.ibm.com\". Domain attribute \".ibm.com\" violates RFC 2109: host minus domain may not contain any dots\n[WARN] HttpMethodBase - Cookie rejected: \"$Version\u003d0; Bugzilla_logincookie\u003dZpJj7asBZ0; $Path\u003d/bugzilla-2.22/; $Domain\u003d.ibm.com\". Domain attribute \".ibm.com\" violates RFC 2109: host minus domain may not contain any dots\n\nThe error was that \"host\" was something like \"aaa.bbb.ccc.ibm.com\", and host minus domain resulted in aaa.bbb.ccc which contains dots. So the $Domain attribute should have been set to \".bbb.ccc.ibm.com\" instead of \".ibm.com\".\n\nLet me know if you need more information.",
    "(In reply to comment #9)\n\n\u003e Let me know if you need more information.\n\nActually, yes.  How do I enable the logging for the plugin?\n\nThe machine has a hostname of aaa.bbb.ccc.ddd, but my apache server name is xxx.yyy.zzz with the cookie domain set to yyy.zzz (and accessed through xxx.yyy.xxx)\n\nI\u0027d love to see what message comes back from server.\n\nThanks for your help.\n\n",
    "(In reply to comment #10)\n\n...or If it is easier than teaching me how to enable logging, I could give you a login and have you tell me what comes back?\n\nAnyway, thanks again!",
    "Here is what I did (there might be simpler and more elegant ways):\nSelect File-\u003eImport-\u003ePlug-ins and Fragments. In the first Wizard page, make sure that \"Import as Projects with source folders\" is selected.\nIn the next page, select \"org.eclipse.mylar.tasks.core\" plug-in and click finish.\nYou will see compile errors in your plug-in. \n- download from Apache Jakarta the latest release of commons-httpclient.jar, commons-logging.jar and commons-logging-api.jar. \n- in your project, create a \"lib\" folder and import the jars into that folder.\n- open the plug-in manifest (right-click on project, then select PDE Tools-\u003eopen Manifest)\n- goto runtime tab and add the jars to your classpath and verify that they are selected in the build tab. Save the manifest.\n- verify that you don\u0027t have compile errors anymore. un-comment the lines in WebClientUtil.setupHttpClient that enable logging.\n- export the plugin: File-\u003eExport... select \"Deployable plug-ins and fragments\" and export int an archive.\n- stop eclipse, and make a backup of your original org.eclipse.mylar.tasks.core plug-in, and replace it by your new version\n- start eclipse again with \"-debug\" option in order to see a console. output is written to the console.\n",
    "(In reply to comment #12)\n\nThank you.\n\nFrom the debug log, I was able to determine that it was my instance of bugzilla that had the wrong cookie domain set.  I had assumed incorrectly that it was obtaining it from my httpd configuration.  So obvious in hindsight!\n\nEditing the cookie domain in the Required Settings Configuration section ( http://\u003cserver\u003e/\u003cbugzilla path\u003e/editparams.cgi?section\u003dcore ) made the problem go away.  \n\nI\u0027ve made mention to look out for this setting in the wiki.\n\nThank you tremendously for all your help!\n\n- Paul"
  ],
  "commentCreationDates": [
    "2007-02-26T10:45:06+01:00",
    "2007-02-26T10:54:42+01:00",
    "2007-02-26T19:20:45+01:00",
    "2007-02-27T17:58:20+01:00",
    "2007-02-27T21:43:03+01:00",
    "2007-02-27T22:10:08+01:00",
    "2007-02-27T23:16:51+01:00",
    "2007-02-28T00:01:08+01:00",
    "2007-04-18T10:44:32+02:00",
    "2007-04-18T14:51:20+02:00",
    "2007-04-18T16:08:29+02:00",
    "2007-04-18T16:16:51+02:00",
    "2007-04-19T16:06:52+02:00",
    "2007-04-19T23:24:50+02:00"
  ],
  "traces": [
    {
      "exceptionType": "javax.security.auth.login.LoginException",
      "message": "Invalid Username or Password",
      "elements": [
        {
          "method": "org.eclipse.mylar.internal.bugzilla.core.BugzillaClient.parseHtmlError",
          "source": "BugzillaClient.java:951"
        },
        {
          "method": "org.eclipse.mylar.internal.bugzilla.core.BugzillaClient.postTaskData",
          "source": "BugzillaClient.java:767"
        },
        {
          "method": "org.eclipse.mylar.internal.bugzilla.core.BugzillaTaskDataHandler.postTaskData",
          "source": "BugzillaTaskDataHandler.java:157"
        },
        {
          "method": "org.eclipse.mylar.tasks.ui.editors.AbstractRepositoryTaskEditor$31.run",
          "source": "AbstractRepositoryTaskEditor.java:2496"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "175502",
      "date": "2007-02-26T10:45:06+01:00",
      "product": "Mylyn",
      "component": "Bugzilla",
      "severity": "normal"
    }
  ],
  "groupId": "175502",
  "bugId": "175502",
  "date": "2007-02-26T10:45:06+01:00",
  "product": "Mylyn",
  "component": "Bugzilla",
  "severity": "normal"
}