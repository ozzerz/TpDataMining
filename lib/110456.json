{
  "comments": [
    "When I close Eclipse with the following view, NullPointerException is thrown by \ntable.getItems()\n\n/////////////////////////////////\npublic class View extends ViewPart {\n  private TableViewer viewer;\n\n  class ViewContentProvider implements IStructuredContentProvider {\n    public void inputChanged(Viewer v, Object oldInput, Object newInput) {\n      // throws NullPointerException\n      viewer.getTable().getItems();\n    }\n    public void dispose() {}\n    public Object[] getElements(Object parent) {\n      return new String[] { \"One\", \"Two\", \"Three\" };\n    }\n  }\n  public void createPartControl(Composite parent) {\n    viewer \u003d new TableViewer(parent, SWT.NONE);\n    viewer.setContentProvider(new ViewContentProvider());\n  }\n  public void setFocus() {}\n}",
    "Do you have a stack trace that shows where the null pointer occurs?\nDoes it happen every time you exit Eclipse?",
    "(In reply to comment #1)\n\u003e Do you have a stack trace that shows where the null pointer occurs?\n\u003e Does it happen every time you exit Eclipse?\nIt happens every time when I close the view.\n\njava.lang.NullPointerException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.eclipse.swt.widgets.Table.getItems(Table.java:1413)\n\tat com.test.View$ViewContentProvider.inputChanged(View.java:18)\n\tat org.eclipse.jface.viewers.ContentViewer.handleDispose\n(ContentViewer.java:147)\n\tat org.eclipse.jface.viewers.ContentViewer$2.widgetDisposed\n(ContentViewer.java:188)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:101)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:867)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:848)\n\tat org.eclipse.swt.widgets.Widget.releaseWidget(Widget.java:755)\n\tat org.eclipse.swt.widgets.Control.releaseWidget(Control.java:1574)\n\tat org.eclipse.swt.widgets.Scrollable.releaseWidget(Scrollable.java:195)\n\tat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:594)\n\tat org.eclipse.swt.widgets.Table.releaseWidget(Table.java:1725)\n\tat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:720)\n\tat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:588)\n\tat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:593)\n\tat org.eclipse.swt.widgets.Widget.releaseResources(Widget.java:720)\n\tat org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:588)\n\tat org.eclipse.swt.widgets.Composite.releaseWidget(Composite.java:593)\n\tat org.eclipse.swt.widgets.Widget.dispose(Widget.java:382)\n\tat org.eclipse.ui.internal.PartPane.dispose(PartPane.java:164)\n\tat org.eclipse.ui.internal.ViewPane.dispose(ViewPane.java:176)\n\tat org.eclipse.ui.internal.WorkbenchPartReference.dispose\n(WorkbenchPartReference.java:625)\n\tat org.eclipse.ui.internal.WorkbenchPage.disposePart\n(WorkbenchPage.java:1432)\n\tat org.eclipse.ui.internal.WorkbenchPage.partRemoved\n(WorkbenchPage.java:1424)\n\tat org.eclipse.ui.internal.ViewFactory.releaseView(ViewFactory.java:237)\n\tat org.eclipse.ui.internal.Perspective.hideView(Perspective.java:498)\n\tat org.eclipse.ui.internal.WorkbenchPage.hideView\n(WorkbenchPage.java:2015)\n\tat org.eclipse.ui.internal.ViewPane.doHide(ViewPane.java:196)\n\tat org.eclipse.ui.internal.PartStack.close(PartStack.java:495)\n\tat org.eclipse.ui.internal.PartStack.close(PartStack.java:478)\n\tat org.eclipse.ui.internal.PartStack$1.close(PartStack.java:102)\n\tat \norg.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent\n(TabbedStackPresentation.java:81)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:267)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:276)\n\tat \norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.acces\ns$1(DefaultTabFolder.java:1)\n\tat \norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.clo\nseButtonPressed(DefaultTabFolder.java:67)\n\tat org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners\n(PaneFolder.java:563)\n\tat org.eclipse.ui.internal.presentations.PaneFolder$3.close\n(PaneFolder.java:190)\n\tat org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:2075)\n\tat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:292)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench\n(Workbench.java:367)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat com.test.MyApp.run(MyApp.java:18)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:163)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n\tat org.eclipse.core.launcher.Main.run(Main.java:973)\n\tat org.eclipse.core.launcher.Main.main(Main.java:948)\n",
    "I am pretty sure this NPE is being thrown because the items array in Table has\nalready been set to NULL but _getItems() tries to dereference it.\n\nI have the same problem because I try to set TableViewer.setItemCount(0) in the\ninputChanged method when the newInput param is NULL - like what happens during\ndispose. This call eventually triggers an NPE in remove method of Table when it\ntries to dereference a NULL items field. As far as I can tell, I can\u0027t determine\nwhen the inputChanged method has been called because of a dispose event. So, I\ncan\u0027t work around this cleanly.\n\nI am using VIRTUAL_TABLE and Eclipse 3.1.1.\n\nI am not sure what the fix is. Either items should be set to NULL later in the\nprocess of disposing or there needs to be checks for nullness whenever it is\ndereferenced.",
    "Hmmm. Just found this piece of doc in the inputChanged method of IContentProvider:\n\" The viewer should not be updated during this call, as it might be in the\nprocess of being disposed.\"\n\nSo, Frankie and I are messing up by calling methods on the viewer. But, still,\nit seems kind of flaky. If you don\u0027t update the viewer during this method call\nthen   how *are* you supposed to update it when the model changes? Especially in\nthe VIRTUAL table where you have to change the item count? If only we could ask\nthe Viewer whether it was being disposed or not....",
    "The null pointer should no longer happen (we changed the dispose story).  Not sure about the rest of the bug.  Closing."
  ],
  "commentCreationDates": [
    "2005-09-23T17:07:00+02:00",
    "2005-10-18T22:20:12+02:00",
    "2005-10-19T10:10:14+02:00",
    "2005-11-14T20:11:10+01:00",
    "2005-11-14T20:22:47+01:00",
    "2007-09-19T23:57:10+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "java.lang.System.arraycopy",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Table.getItems",
          "source": "Table.java:1413"
        },
        {
          "method": "com.test.View$ViewContentProvider.inputChanged",
          "source": "View.java:18"
        },
        {
          "method": "org.eclipse.jface.viewers.ContentViewer.handleDispose",
          "source": "ContentViewer.java:147"
        },
        {
          "method": "org.eclipse.jface.viewers.ContentViewer$2.widgetDisposed",
          "source": "ContentViewer.java:188"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:101"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:867"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:848"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseWidget",
          "source": "Widget.java:755"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.releaseWidget",
          "source": "Control.java:1574"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.releaseWidget",
          "source": "Scrollable.java:195"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:594"
        },
        {
          "method": "org.eclipse.swt.widgets.Table.releaseWidget",
          "source": "Table.java:1725"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:720"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:588"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:593"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.releaseResources",
          "source": "Widget.java:720"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseChildren",
          "source": "Composite.java:588"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.releaseWidget",
          "source": "Composite.java:593"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.dispose",
          "source": "Widget.java:382"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.dispose",
          "source": "PartPane.java:164"
        },
        {
          "method": "org.eclipse.ui.internal.ViewPane.dispose",
          "source": "ViewPane.java:176"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPartReference.dispose",
          "source": "WorkbenchPartReference.java:625"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.disposePart",
          "source": "WorkbenchPage.java:1432"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.partRemoved",
          "source": "WorkbenchPage.java:1424"
        },
        {
          "method": "org.eclipse.ui.internal.ViewFactory.releaseView",
          "source": "ViewFactory.java:237"
        },
        {
          "method": "org.eclipse.ui.internal.Perspective.hideView",
          "source": "Perspective.java:498"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.hideView",
          "source": "WorkbenchPage.java:2015"
        },
        {
          "method": "org.eclipse.ui.internal.ViewPane.doHide",
          "source": "ViewPane.java:196"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:495"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:478"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack$1.close",
          "source": "PartStack.java:102"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:81"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:276"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1",
          "source": "DefaultTabFolder.java:1"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed",
          "source": "DefaultTabFolder.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners",
          "source": "PaneFolder.java:563"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder$3.close",
          "source": "PaneFolder.java:190"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouse",
          "source": "CTabFolder.java:2075"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:292"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1699"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1663"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:367"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "com.test.MyApp.run",
          "source": "MyApp.java:18"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:163"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "110456",
      "date": "2005-10-19T10:10:14+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "110456",
  "bugId": "110456",
  "date": "2005-09-23T17:07:00+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}