{
  "comments": [
    "Open a shell, and leave it open, then start opening and disposing shells. \nWith under 100 shells opened I start getting a lot of COMExceptions.\n\nThis happens when running the Jface test suite because one of their first tests opens a dialog and doesn\u0027t close it.\n\n\nTest Case:\n\tpublic static void main(String[] args) {\n\t\tDisplay display \u003d new Display();\n\t\tfinal Shell shell \u003d new Shell(display, SWT.SHELL_TRIM);\n\t\tshell.setText(\"Application Modal Shell\");\n\t\tshell.setBounds(100, 100, 300, 100);\n\t\tshell.open();\n\t\t\n\t\tfor (int i\u003d0; ; i++) {\n\t\t\tShell s \u003d new Shell(display, SWT.SHELL_TRIM);\n\t\t\ts.setText(\"Shell - \" + i);\n\t\t\ts.setBounds(100, 400, 300, 300);\n\t\t\ts.open();\n\t\t\ts.dispose();\n\t\t\tSystem.err.println(\"Shell - \" + i);\n\t\t}\n\t\t\n\t}\n\nExample Stack trace: \nSystem.Runtime.InteropServices.COMException (0x88980406): Exception from HRESULT: 0x88980406\n   at MS.Internal.HRESULT.Check(Int32 hr)\n   at System.Windows.Media.Composition.DUCE.Channel.SyncFlush()\n   at System.Windows.Media.Composition.DUCE.CompositionTarget.UpdateWindowSettings(ResourceHandle hCompositionTarget, RECT windowRect, Color colorKey, Single constantAlpha, MILWindowLayerType windowLayerType, MILTransparencyFlags transparencyMode, Boolean isChild, Boolean isRTL, Boolean renderingEnabled, Int32 disableCookie, Channel channel)\n   at System.Windows.Interop.HwndTarget.UpdateWindowSettings(Boolean enableRenderTarget, List`1 channelList)\n   at System.Windows.Interop.HwndTarget.UpdateWindowPos(IntPtr lParam)\n   at System.Windows.Interop.HwndTarget.HandleMessage(Int32 msg, IntPtr wparam, IntPtr lparam)\n   at System.Windows.Interop.HwndSource.HwndTargetFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean\u0026 handled)\n   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean\u0026 handled)\n   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)\n   at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)\n   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at MS.Win32.HwndSubclass.DefWndProcWrapper(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at MS.Win32.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at MS.Win32.UnsafeNativeMethods.UnsafeSendMessage(IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n   at System.Windows.Window.InternalClose(Boolean shutdown, Boolean ignoreCancel)\n   at System.Windows.Window.Close()\n   at Java_org_eclipse_swt_internal_wpf_OS_Window_1Close(JNIEnv_* env, _jclass* that, Int32 arg0)\nJava: \njava.lang.Exception: Stack trace\n\tat java.lang.Thread.dumpStack(Thread.java:1158)\n\tat org.eclipse.swt.internal.wpf.OS.Window_Close(Native Method)\n\tat org.eclipse.swt.widgets.Shell.destroyWidget(Shell.java:548)\n\tat org.eclipse.swt.widgets.Widget.release(Widget.java:828)\n\tat org.eclipse.swt.widgets.Widget.dispose(Widget.java:446)\n\tat org.eclipse.swt.widgets.Decorations.dispose(Decorations.java:282)\n\tat org.eclipse.swt.widgets.Shell.dispose(Shell.java:568)\n\tat Stub.main(Stub.java:19)"
  ],
  "commentCreationDates": [
    "2007-11-13T16:54:31+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.Exception",
      "message": "Stack trace",
      "elements": [
        {
          "method": "java.lang.Thread.dumpStack",
          "source": "Thread.java:1158"
        },
        {
          "method": "org.eclipse.swt.internal.wpf.OS.Window_Close",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.destroyWidget",
          "source": "Shell.java:548"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.release",
          "source": "Widget.java:828"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.dispose",
          "source": "Widget.java:446"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.dispose",
          "source": "Decorations.java:282"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.dispose",
          "source": "Shell.java:568"
        },
        {
          "method": "Stub.main",
          "source": "Stub.java:19"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "209664",
      "date": "2007-11-13T16:54:31+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "209664",
  "bugId": "209664",
  "date": "2007-11-13T16:54:31+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}