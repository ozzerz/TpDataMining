{
  "comments": [
    "Problem seems to be caused by OSGI manifest header\n\nBundle-NativeCode: libwrapper-linux-x86-32.so; wrapper-linux-x86-32; osname\u003dlinux; processor\u003dx86\n\njava.lang.NullPointerException\nat org.eclipse.osgi.internal.resolver.StateObjectFactoryImpl.createNativeCodeSpecification(StateObjectFactoryImpl.java:129)\nat org.eclipse.osgi.internal.resolver.StateObjectFactoryImpl.createBundleDescription(StateObjectFactoryImpl.java:108)\nat org.eclipse.pde.internal.core.PDEState.readWorkspaceState(PDEState.java:174)\nat org.eclipse.pde.internal.core.PDEState.\u003cinit\u003e(PDEState.java:84)\nat org.eclipse.pde.internal.core.PluginModelManager.initializeTable(PluginModelManager.java:400)\nat org.eclipse.pde.internal.core.PluginModelManager.findModel(PluginModelManager.java:673)\nat org.eclipse.pde.core.plugin.PluginRegistry.findModel(PluginRegistry.java:74)\nat org.eclipse.pde.internal.core.RequiredPluginsInitializer.initialize(RequiredPluginsInitializer.java:32)\nat org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:2261)\nat org.eclipse.jdt.internal.core.JavaModelManager$12.run(JavaModelManager.java:2191)\nat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1797)\nat org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:2207)\nat org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1585)\nat org.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1585)\nat org.eclipse.jdt.internal.core.JavaProject.resolveClasspath(JavaProject.java:2559)\nat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:1849)\nat org.eclipse.jdt.core.JavaCore.initializeAfterLoad(JavaCore.java:3314)\nat org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:35)\nat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)",
    "I tried addding selection-filter\u003d(\u0026 (osgi.os\u003dlinux) (osgi.arch\u003dx86)). This works, so problem is indeed in entry without selection-filter.",
    "Created an attachment (id\u003d79661)\npatch\n\nThanks for confirming that the missing selection-filter caused the NPE.\n\nThere are some other issues that need to be fixed in this area.  Currently PDE does not set the necessary platform properties on the resolver in order to resolve the Bundle-NativeCode attributes (processor, osname, osversion, language etc.).  The resolver should attempt to set the platform properties to acceptable values passed on the platform properties defined by Eclipse (osgi.os, osgi.arch, osgi.ws, osgi.nl).  This will allow PDE-UI and PDE-BUILD to continue to resolve bundles with Bundle-Native code without supplying any additional properties.\n\nThis patch sets some defaults for the org.osgi.framework.* properties based on the osgi.* properties in Eclipse.  It also ignores the osversion when one is not supplied by the platform properties.  This allows Bundle-NativeCode headers to resolve when the org.osgi.framework.* properties are not set.  At runtime this is not an problem because the runtime will always set these properties, but at development time we do not want to unresolve a bundle based on os version.  The patch also fixes the NPE in StateObjectFactoryImpl when the selection-filter is null.\n\nI added a couple of new tests also.",
    "Patch released to HEAD for 3.4 M3.",
    "created bug 205373 to track PDE problem mentioned in comment #2"
  ],
  "commentCreationDates": [
    "2007-10-03T11:02:33+02:00",
    "2007-10-03T17:34:17+02:00",
    "2007-10-03T19:33:45+02:00",
    "2007-10-03T19:35:44+02:00",
    "2007-10-04T01:07:26+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.osgi.internal.resolver.StateObjectFactoryImpl.createNativeCodeSpecification",
          "source": "StateObjectFactoryImpl.java:129"
        },
        {
          "method": "org.eclipse.osgi.internal.resolver.StateObjectFactoryImpl.createBundleDescription",
          "source": "StateObjectFactoryImpl.java:108"
        },
        {
          "method": "org.eclipse.pde.internal.core.PDEState.readWorkspaceState",
          "source": "PDEState.java:174"
        },
        {
          "method": "org.eclipse.pde.internal.core.PDEState.\u003cinit\u003e",
          "source": "PDEState.java:84"
        },
        {
          "method": "org.eclipse.pde.internal.core.PluginModelManager.initializeTable",
          "source": "PluginModelManager.java:400"
        },
        {
          "method": "org.eclipse.pde.internal.core.PluginModelManager.findModel",
          "source": "PluginModelManager.java:673"
        },
        {
          "method": "org.eclipse.pde.core.plugin.PluginRegistry.findModel",
          "source": "PluginRegistry.java:74"
        },
        {
          "method": "org.eclipse.pde.internal.core.RequiredPluginsInitializer.initialize",
          "source": "RequiredPluginsInitializer.java:32"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:2261"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager$12.run",
          "source": "JavaModelManager.java:2191"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1797"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers",
          "source": "JavaModelManager.java:2207"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:1585"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1585"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.resolveClasspath",
          "source": "JavaProject.java:2559"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:1849"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.initializeAfterLoad",
          "source": "JavaCore.java:3314"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run",
          "source": "InitializeAfterLoadJob.java:35"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "205270",
      "date": "2007-10-03T11:02:33+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "major"
    }
  ],
  "groupId": "205270",
  "bugId": "205270",
  "date": "2007-10-03T11:02:33+02:00",
  "product": "Equinox",
  "component": "Framework",
  "severity": "major"
}