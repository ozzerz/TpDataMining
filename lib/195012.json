{
  "comments": [
    "The compiler produces an invalid class file for a top-level class that implements an interface that is parameterized by an inner class of that top-level class when the interface declares a method whose return type is an array of the interface\u0027s generic type parameter and the outer class is woven with an aspect.\n\nAttempting to load the invalid class at runtime results in the JVM throwing a ClassFormatError: Duplicate method name\u0026signature in class file.\n\nExample:\n\n////\n// pkg1/MyInterface.java\npackage pkg1;\npublic interface MyInterface\u003cF\u003e {\n\tpublic F[] getValues();\n}\n////\n\n////\n// pkg1/MyClass.java\npackage pkg1;\npublic class MyClass implements MyInterface\u003cMyClass.MyInnerEnum\u003e {\n\tpublic enum MyInnerEnum {\n\t}\n\tpublic MyInnerEnum[] getValues() {\n\t\treturn MyInnerEnum.values();\n\t}\n\tpublic static void main(String[] args) {\n\t}\n}\n////\n\n////\n// pkg2/MyAspect.aj\npackage pkg2;\nimport pkg1.MyClass;\npublic aspect MyAspect pertypewithin(MyClass) {\n}\n////\n\nAttempting to execute the main method throws this error:\n\nException in thread \"main\" java.lang.ClassFormatError: Duplicate method name\u0026signature in class file pkg1/MyClass\n        at java.lang.ClassLoader.defineClass1(Native Method)\n        at java.lang.ClassLoader.defineClass(Unknown Source)\n        at java.security.SecureClassLoader.defineClass(Unknown Source)\n        at java.net.URLClassLoader.defineClass(Unknown Source)\n        at java.net.URLClassLoader.access$000(Unknown Source)\n        at java.net.URLClassLoader$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n\nDeleting the aspect makes the error go away.  Also, changing the declared return type of MyInterface.getValues() to Object[] rather than F[] makes the error go away.",
    "Created an attachment (id\u003d72810)\nexample demonstrating bug\n\nThis is a maven project demonstrating the bug.\n\nUnzip and run \u0027mvn package\u0027.\nThen simply execute \u0027java -jar target/bug-0.jar\u0027."
  ],
  "commentCreationDates": [
    "2007-06-30T12:03:27+02:00",
    "2007-06-30T12:05:13+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassFormatError",
      "message": "Duplicate method name\u0026signature in class file pkg1/MyClass",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClass1",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.security.SecureClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader.defineClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader.access$000",
          "source": "Unknown Source"
        },
        {
          "method": "java.net.URLClassLoader$1.run",
          "source": "Unknown Source"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "java.net.URLClassLoader.findClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "sun.misc.Launcher$AppClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "Unknown Source"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "195012",
      "date": "2007-06-30T12:03:27+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "195012",
  "bugId": "195012",
  "date": "2007-06-30T12:03:27+02:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}