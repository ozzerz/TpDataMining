{
  "comments": [
    "Unsure of the steps to reproduce but this was in my log:\n\njava.lang.NullPointerException\nat \norg.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.isAutoMana\ngeViews(LaunchViewContextListener.java:883)\nat \norg.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.contextEna\nbled(LaunchViewContextListener.java:427)\nat \norg.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.contextMan\nagerChanged(LaunchViewContextListener.java:403)\nat \norg.eclipse.ui.internal.contexts.AbstractContextManager.fireContextManagerChang\ned(AbstractContextManager.java:47)\nat org.eclipse.ui.internal.contexts.ProxyContextManager$1.contextManagerChanged\n(ProxyContextManager.java:43)\nat \norg.eclipse.ui.internal.contexts.AbstractContextManager.fireContextManagerChang\ned(AbstractContextManager.java:47)\nat org.eclipse.ui.internal.contexts.MutableContextManager.setEnabledContextIds\n(MutableContextManager.java:268)\nat \norg.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.processEnabledSubmi\nssions(WorkbenchContextSupport.java:667)\nat \norg.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.processEnabledSubmi\nssions(WorkbenchContextSupport.java:520)\nat \norg.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.removeEnabledSubmis\nsions(WorkbenchContextSupport.java:767)\nat org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.checkWindowType\n(WorkbenchContextSupport.java:296)\nat org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.access$0\n(WorkbenchContextSupport.java:279)\nat org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport$1.handleEvent\n(WorkbenchContextSupport.java:93)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\nat org.eclipse.swt.widgets.Display.filterEvent(Display.java:748)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:799)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:824)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:805)\nat org.eclipse.swt.widgets.Decorations.WM_ACTIVATE(Decorations.java:1424)\nat org.eclipse.swt.widgets.Shell.WM_ACTIVATE(Shell.java:1438)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:2976)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1400)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:3351)\nat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:1484)\nat org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:399)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3058)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1400)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:3351)\nat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1489)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2441)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1443)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1414)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:271)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:144)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:102)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:335)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:273)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:129)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:324)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:185)\nat org.eclipse.core.launcher.Main.run(Main.java:704)\nat org.eclipse.core.launcher.Main.main(Main.java:688)",
    "Moving to UI for comment. The JavaDoc on the methods we\u0027re calling doesn\u0027t say \nthat they can return null. Is this just a JavaDoc problem (in which case, please \nclarify when we can get null) or is there a JFace issue here?",
    "Passing to nick for comment.",
    "For the record, the line in question is:\n\nIWorkbenchPage page \u003d launchView.getViewSite().getWorkbenchWindow().getActivePage();",
    "getActivePage() can return null, and is spec\u0027ed this way.  This can happen if\nall perspectives are closed (e.g. via Window \u003e Close All Perspectives).\nBut in this case, I wouldn\u0027t expect the LaunchView to still be around, unless\nthe listener is not properly disposed, or it\u0027s tracking the wrong window.\n\ngetActiveWorkbenchWindow and getActivePage() should be avoided if at all possible.\nParts and their listeners should know their context from their site, and\nshouldn\u0027t need to call getActive*.\n\nTry the following instead:\nlaunchView.getViewSite().getPage()\n\nIt\u0027s also possible for getViewSite() to return null in the small interval\nbetween when the view is constructed and before its initialize method calls\nsetSite().  This was spec\u0027ed in IWorkbenchPart.getSite(), but not\nIViewPart.getViewSite() or IEditorPart.getEditorSite().  I\u0027ve fixed this up.\nThis gap should really only be seen by the view itself.  Other observers can\nassume that it\u0027s non-null.  If you\u0027re seeing this from your listener, please let\nme know.\n",
    "Suggest breaking the expression into multiple lines so that, if this occurs\nagain, we\u0027ll know for which expression the NPE occurs.\n",
    "Ok. I\u0027ll use the workaround you suggested. However, even if our current code \nisn\u0027t optimal, it\u0027s still handles every null value that the API says is \npossible. We\u0027re getting an unspec\u0027ed null from either IViewPart#getViewSite() or \nIWorkbenchSite#getWorkbenchWindow(), neither of which say they can return null.",
    "Oops. Ignore my comment about the spec of IViewPart#getViewSite().\n\nIs it possible for IWorkbenchSite#getWorkbenchWindow() to ever return null? I\u0027d \nbe surprised if the NPE here was caused by the getViewSite() call. The stack \ntrace shows that our view\u0027s listener is responding to a context change event.\n\nSince views are created in the UI thread, I don\u0027t see how we could be getting a \ncontext change event in the window of vulnerability you mentioned.",
    "Fixed in LaunchViewContextListener as per Nick\u0027s suggestion. Please verify, \nDarinS.",
    "Re comment #6, no I wouldn\u0027t expect getWorkbenchWindow() to be returning null,\neven if the part had been disposed.  In the implementation, PartSite is passed\nthe page in its constructor and never nulls it out. \nPartSite.getWorkbenchWindow() delegates to the page.  WorkbenchPage it passed\nthe window in its constructor and never nulls it out.\n",
    "Verified.\nI also changed the two perspective changed methods to not require the unused \nIWorkbenchPage parameter. Changes to LaunchViewContextListener and LaunchView"
  ],
  "commentCreationDates": [
    "2004-10-19T02:11:17+02:00",
    "2004-10-19T03:25:06+02:00",
    "2004-10-19T14:27:23+02:00",
    "2004-10-19T14:38:01+02:00",
    "2004-10-20T18:48:35+02:00",
    "2004-10-20T18:49:30+02:00",
    "2004-10-20T23:32:11+02:00",
    "2004-10-20T23:38:15+02:00",
    "2004-10-21T18:52:05+02:00",
    "2004-10-21T20:27:23+02:00",
    "2004-10-26T19:41:36+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.isAutoManageViews",
          "source": "LaunchViewContextListener.java:883"
        },
        {
          "method": "org.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.contextEnabled",
          "source": "LaunchViewContextListener.java:427"
        },
        {
          "method": "org.eclipse.debug.internal.ui.views.launch.LaunchViewContextListener.contextManagerChanged",
          "source": "LaunchViewContextListener.java:403"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.AbstractContextManager.fireContextManagerChanged",
          "source": "AbstractContextManager.java:47"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ProxyContextManager$1.contextManagerChanged",
          "source": "ProxyContextManager.java:43"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.AbstractContextManager.fireContextManagerChanged",
          "source": "AbstractContextManager.java:47"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.MutableContextManager.setEnabledContextIds",
          "source": "MutableContextManager.java:268"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.processEnabledSubmissions",
          "source": "WorkbenchContextSupport.java:667"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.processEnabledSubmissions",
          "source": "WorkbenchContextSupport.java:520"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.removeEnabledSubmissions",
          "source": "WorkbenchContextSupport.java:767"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.checkWindowType",
          "source": "WorkbenchContextSupport.java:296"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport.access$0",
          "source": "WorkbenchContextSupport.java:279"
        },
        {
          "method": "org.eclipse.ui.internal.contexts.ws.WorkbenchContextSupport$1.handleEvent",
          "source": "WorkbenchContextSupport.java:93"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.filterEvent",
          "source": "Display.java:748"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:799"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:824"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:805"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.WM_ACTIVATE",
          "source": "Decorations.java:1424"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.WM_ACTIVATE",
          "source": "Shell.java:1438"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2976"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1400"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3351"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:1484"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.callWindowProc",
          "source": "Shell.java:399"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3058"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1400"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3351"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1489"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2441"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1443"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1414"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:271"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:144"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:102"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:335"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:273"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:129"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:185"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:704"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:688"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "76517",
      "date": "2004-10-19T02:11:17+02:00",
      "product": "Platform",
      "component": "Debug",
      "severity": "normal"
    }
  ],
  "groupId": "76517",
  "bugId": "76517",
  "date": "2004-10-19T02:11:17+02:00",
  "product": "Platform",
  "component": "Debug",
  "severity": "normal"
}