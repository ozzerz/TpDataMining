{
  "comments": [
    "I was trying to create a new folder inside the EAR project.\n\nHowever, the EAR Project seem to be locked by another job. Creating new file or\nfolder, or copying is not possible using workspace file operation. (I have not\nconfirmed if non-EAR project has the same problem; nor, I have confirmed that if\nthe whole workspace is locked or just the EAR)\n\nMy works will be similar to PublishTask Assember (creating a EAR). So, it will\nblock PublishTask Assember work which is schedule for M5. Because of that, I\nfile set the Severity as blocker.\n\n\n----------- reproduction -----------\nAdd the TestWriteTask (to be attached) as an extention point. Create a server,\ncreate an EAR project, publish the EAR.\n\n\n----------- code sample ------------\nclass TestWriterTask extends PublishOperation {\n        \n        ...\n\n        public void execute(IProgressMonitor monitor, IAdaptable shell) throws\nCoreException {\n                IModule[] module \u003d (IModule[]) itor.next();\n                IModule mod \u003d module[0];\n                if (!mod.getModuleType().getId().equals(\"j2ee.ear\"))\n                    continue;\n                \n                IWorkspace ws \u003d mod.getProject().getWorkspace();\n                IProject proj \u003d mod.getProject();\n\n                IPath destinPath \u003d new Path(\".beadeploy\");\n                IFile file \u003d proj.getFile(destinPath);\n                file.create(new ByteArrayInputStream(new byte[] {0,0,0}), true,\nmonitor);\n                break;\n           }\n       }\n       ...\n}\n\n\n----------- workaround -------------\nUse standard java.io.File... and, suffer funny refresh problem... \n\n----------- stack trace ------------\njava.lang.IllegalArgumentException: Attempted to beginRule: P/WPAEAR, does not\nmatch outer scope rule: Server scheduling rule for BEA Weblogic Server\n(Enhanced) @ localhost\n\tat org.eclipse.core.internal.runtime.Assert.isLegal(Assert.java:58)\n\tat org.eclipse.core.internal.jobs.ThreadJob.illegalPush(ThreadJob.java:117)\n\tat org.eclipse.core.internal.jobs.ThreadJob.push(ThreadJob.java:211)\n\tat org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:81)\n\tat org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:190)\n\tat org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:96)\n\tat\norg.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1674)\n\tat org.eclipse.core.internal.resources.File.create(File.java:107)\n\tat org.eclipse.core.internal.resources.File.create(File.java:183)\n\tat\ncom.bea.wlw.server.internal.core.TestWriteTask$Task.executeOnce(TestWriteTask.java:92)\n\tat\ncom.bea.wlw.server.internal.core.TestWriteTask$Task.execute(TestWriteTask.java:70)\n\tat\norg.eclipse.wst.server.core.model.ServerBehaviourDelegate.performTasks(ServerBehaviourDelegate.java:732)\n\tat\norg.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish(ServerBehaviourDelegate.java:564)\n\tat org.eclipse.wst.server.core.internal.Server.doPublish(Server.java:683)\n\tat org.eclipse.wst.server.core.internal.Server.publish(Server.java:670)\n\tat\norg.eclipse.wst.server.core.internal.PublishServerJob.run(PublishServerJob.java:65)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)",
    "Created an attachment (id\u003d23265)\nTest PublishTask to reproduce the problem.\n",
    "This is an Eclipse Job issue. Because the publish is running within an Eclipse\njob, trying to modify the workspace (which also uses a Job) will fail because\nthe rules for the two job do not match.\n\nI\u0027ll extend the rule for the publish task to include resource modification,\nwhich should solve this specific issue. However, it does have a potential\nperformance/delay issue since publish will not be able to run at the same time\nas a save or build. We also may not be able to keep adding rules to the publish\njob since it may not make sense for all servers - in this case the publish\noperation provider would have to use another thread for some of it\u0027s work.",
    "Fix dropped to HEAD, will be tagged for this week\u0027s I-build.",
    "\"However, it does have a potential performance/delay issue since publish will\nnot be able to run at the same time as a save or build.\"\n\nI think it is a desirable behaviour. In general, PublishTask should be ran after\nbuild anyway.\n",
    "Thank Tim. The fix looks good.",
    "Verified. Tested in I20050629.",
    "Closing."
  ],
  "commentCreationDates": [
    "2005-06-16T04:40:29+02:00",
    "2005-06-16T04:41:13+02:00",
    "2005-06-21T16:43:08+02:00",
    "2005-06-21T17:15:15+02:00",
    "2005-06-21T20:09:39+02:00",
    "2005-06-21T20:10:02+02:00",
    "2005-06-29T23:34:21+02:00",
    "2005-07-07T20:37:31+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Attempted to beginRule: P/WPAEAR, does not match outer scope rule: Server scheduling rule for BEA Weblogic Server (Enhanced) @ localhost",
      "elements": [
        {
          "method": "org.eclipse.core.internal.runtime.Assert.isLegal",
          "source": "Assert.java:58"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.illegalPush",
          "source": "ThreadJob.java:117"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.push",
          "source": "ThreadJob.java:211"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ImplicitJobs.begin",
          "source": "ImplicitJobs.java:81"
        },
        {
          "method": "org.eclipse.core.internal.jobs.JobManager.beginRule",
          "source": "JobManager.java:190"
        },
        {
          "method": "org.eclipse.core.internal.resources.WorkManager.checkIn",
          "source": "WorkManager.java:96"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.prepareOperation",
          "source": "Workspace.java:1674"
        },
        {
          "method": "org.eclipse.core.internal.resources.File.create",
          "source": "File.java:107"
        },
        {
          "method": "org.eclipse.core.internal.resources.File.create",
          "source": "File.java:183"
        },
        {
          "method": "com.bea.wlw.server.internal.core.TestWriteTask$Task.executeOnce",
          "source": "TestWriteTask.java:92"
        },
        {
          "method": "com.bea.wlw.server.internal.core.TestWriteTask$Task.execute",
          "source": "TestWriteTask.java:70"
        },
        {
          "method": "org.eclipse.wst.server.core.model.ServerBehaviourDelegate.performTasks",
          "source": "ServerBehaviourDelegate.java:732"
        },
        {
          "method": "org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish",
          "source": "ServerBehaviourDelegate.java:564"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.doPublish",
          "source": "Server.java:683"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.publish",
          "source": "Server.java:670"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.PublishServerJob.run",
          "source": "PublishServerJob.java:65"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "100347",
      "date": "2005-06-16T04:40:29+02:00",
      "product": "Web Tools",
      "component": "wst.server",
      "severity": "blocker"
    }
  ],
  "groupId": "100347",
  "bugId": "100347",
  "date": "2005-06-16T04:40:29+02:00",
  "product": "Web Tools",
  "component": "wst.server",
  "severity": "blocker"
}