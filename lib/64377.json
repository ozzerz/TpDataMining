{
  "comments": [
    "Steps to reproduce:\n\n1. Create a new Java project\n2. Create class A in top-level package\n3. Delete all generated contents of A.java\n4. Paste the following code\n\nclass A\n{\n\tA( B b, C c )\n\t{\n\t\n\tinterface B\n\t{\n\t}\n\t\n\tinterface C\n\t{\n\t}\n}\n\n5. Press Ctrl+S\n\nWhat I see:\n\nDialog box pops up:\nJava AST creation (Error: An internal error occured during: \"Java AST creation\".\n)\n\nClicking on error in this dialog box makes lower part of dialog box show stack \ntrace:\nAn internal error occurred during: \"Java AST creation\".\njava.lang.ArrayIndexOutOfBoundsException: -1\norg.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:5490)\norg.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:5450)\norg.eclipse.jdt.internal.compiler.ast.ConstructorDeclaration.\nparseStatements(ConstructorDeclaration.java:368)\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.\nparseMethod(TypeDeclaration.java:791)\norg.eclipse.jdt.internal.compiler.parser.Parser.getMethodBodies(Parser.java:\n4665)\norg.eclipse.jdt.core.dom.CompilationUnitResolver.\nresolve(CompilationUnitResolver.java:404)\norg.eclipse.jdt.core.dom.CompilationUnitResolver.\nresolve(CompilationUnitResolver.java:313)\norg.eclipse.jdt.core.dom.ASTParser.internalCreateAST(ASTParser.java:653)\norg.eclipse.jdt.core.dom.ASTParser.createAST(ASTParser.java:573)\norg.eclipse.jdt.internal.ui.javaeditor.ASTProvider.createAST(ASTProvider.java:\n437)\norg.eclipse.jdt.internal.ui.javaeditor.ASTProvider.getAST(ASTProvider.java:389)\norg.eclipse.jdt.internal.ui.viewsupport.\nSelectionListenerWithASTManager$PartListenerGroup.\ncalculateASTandInform(SelectionListenerWithASTManager.java:123)\norg.eclipse.jdt.internal.ui.viewsupport.SelectionListenerWithASTManager$1.\nrun(SelectionListenerWithASTManager.java:101)\norg.eclipse.core.internal.jobs.Worker.run(Worker.java:66)\n\nPressing \"Close\" on this dialog box causes the dialog to close but the same \ndialog box re-appears immediately.\n\nWhen I exit Eclipse it asks me if I want to save A.java. If I answer \"yes\" it \npops another dialog box: Save All Failed: -1\n\nAfter that Eclise window closes, but javaw.exe remains running in the \nbackground. If I relaunch Eclipse for the same workspace I get dialog box:\nWorkspace in use, choose a different one. If I kill javaw.exe from Task Manager \nI can launch Eclipse for that workspace again.\n\nWhat I expect to see\n\nA) When Eclipse exists albeit after all these errors I expect no javaw.exe to \nremain running\n\nB) After I close the first error dialog box I expect it not to reappear again\n\nC) I expect Eclipse to parse this incorrect java code and just treat it as \nincorrect code, not to blow up\n\nCheers!",
    "Created an attachment (id\u003d11208)\nSample .log containing stack traces for this error\n",
    "I figured out why javaw.exe was not exiting, I\u0027ve got lots of small windows \noutput maybe by eclipse.exe binary java launcher. They say:\n\nJVM terminated. Exit code\u003d1\n\nand all the arguments given javaw.exe at launch. One complaint less :-)\n\nBTW, exact build of Eclipse I\u0027m running (this should be the M9)\nBuild id: 200405211200\n",
    "I am investigating. This is also a bug in the compiler.\nI get this compiling the code using the batch compiler:\n\n----------\n1. ERROR in C:\\tests_sources\\A.java (at line 0)\n\tclass A\n\t^\nInternal compiler error\njava.lang.ArrayIndexOutOfBoundsException: -1\n\tat org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:5489)\n\tat org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:5449)\n\tat\norg.eclipse.jdt.internal.compiler.ast.ConstructorDeclaration.parseStatements(ConstructorDeclaration.java:368)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.parseMethod(TypeDeclaration.java:790)\n\tat\norg.eclipse.jdt.internal.compiler.parser.Parser.getMethodBodies(Parser.java:4665)\n\tat org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:497)\n\tat org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:335)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.performCompilation(Main.java:1543)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:320)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:213)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:205)\n\tat org.eclipse.jdt.core.tools.compiler.Compile.main(Compile.java:19)\n\n----------\n2. ERROR in C:\\tests_sources\\A.java (at line 6)\n\tinterface B\n\t          ^\nThe member interface B can only be defined inside a top-level class or interface\n----------\n3. ERROR in C:\\tests_sources\\A.java (at line 10)\n\tinterface C\n\t          ^\nThe member interface C can only be defined inside a top-level class or interface\n----------\n4. ERROR in C:\\tests_sources\\A.java (at line 13)\n\t}\n\t^\nSyntax error, insert \"}\" to complete ClassBody\n----------",
    "I think we had two bugs.\n1) The way we handle the invalid interface declarations was not right \u003d\u003e leading\nto the exception.\n2) During the recovery, we should not include the two interfaces inside the\nconstructor declaration.\nI am working on a fix for these two problems.",
    "Fixed and released in HEAD.\nRegression test added.",
    "Still same bug in build 200405280010\nBtw, jvm really hanging after this bug\nuntil I kill it from Task Manager",
    "Of course you found the same bug in 200405280010. JDT/Core didn\u0027t submit any\ncode for that build.\nThis is fixed. So wait for the next build with a submission from JDT/Core and\nyou will see it fixed.\nReopened it only if it is not fixed then.",
    "Verified in 200405281200"
  ],
  "commentCreationDates": [
    "2004-05-27T18:10:36+02:00",
    "2004-05-27T18:12:32+02:00",
    "2004-05-27T18:40:30+02:00",
    "2004-05-27T19:04:42+02:00",
    "2004-05-27T21:16:17+02:00",
    "2004-05-27T21:51:47+02:00",
    "2004-05-28T14:48:39+02:00",
    "2004-05-28T15:37:03+02:00",
    "2004-05-28T21:47:42+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "-1",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.parse",
          "source": "Parser.java:5489"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.parse",
          "source": "Parser.java:5449"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.ConstructorDeclaration.parseStatements",
          "source": "ConstructorDeclaration.java:368"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.parseMethod",
          "source": "TypeDeclaration.java:790"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.getMethodBodies",
          "source": "Parser.java:4665"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.process",
          "source": "Compiler.java:497"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:335"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.performCompilation",
          "source": "Main.java:1543"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:320"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:213"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:205"
        },
        {
          "method": "org.eclipse.jdt.core.tools.compiler.Compile.main",
          "source": "Compile.java:19"
        }
      ],
      "number": 0,
      "commentIndex": 3,
      "bugId": "64377",
      "date": "2004-05-27T19:04:42+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "critical"
    }
  ],
  "groupId": "64377",
  "bugId": "64377",
  "date": "2004-05-27T18:10:36+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "critical"
}