{
  "comments": [
    "Build ID: WTP 153\n\nSteps To Reproduce:\nin a clearcase environment, adding a ejb reference to a web project does not validateEdit/checkout the manifest file\nIn a product based on WTP with many plugins\n1. create an ejb project with an ear\n2. create a session bean, add a method, promote to local/remote interface\n3. create a web project and web page in the same ear\n4. Go to the project properties-j2ee module dependencies.\n5. try adding a ejb reference (from the web page)\n6. you get this error in the console\n\n*** ERROR ***: Thu Mar 15 13:21:00 EDT 2007    org.eclipse.emf.ecore.resource.Resource$IOWrappedException: Could not write to read-only file: /webtest/WebContent/META-INF/MANIFEST.MF.\n    \tat org.eclipse.emf.ecore.resource.impl.URIConverterImpl$PlatformResourceOutputStream.flush(URIConverterImpl.java:149)\n    \tat org.eclipse.jem.util.emf.workbench.WorkbenchByteArrayOutputStream.flush(WorkbenchByteArrayOutputStream.java:78)\n    \tat java.io.DataOutputStream.flush(DataOutputStream.java:131)\n    \tat org.eclipse.jst.j2ee.commonarchivecore.internal.helpers.ArchiveManifestImpl.writeSplittingClasspath(ArchiveManifestImpl.java:219)\n    \tat org.eclipse.jst.j2ee.internal.project.J2EEProjectUtilities.writeManifest(J2EEProjectUtilities.java:283)\n    \tat org.eclipse.jst.j2ee.internal.project.J2EEProjectUtilities.writeManifest(J2EEProjectUtilities.java:273)\n    \tat .....etools.j2ee.reference.EJBReferenceCreationOperation.updateJARDependencyIfNecessary(EJBReferenceCreationOperation.java:383)\n    \tat .....etools.j2ee.reference.EJBReferenceCreationOperation.updateJARDependencyIfNecessary(EJBReferenceCreationOperation.java:264)\n    \tat .....etools.j2ee.reference.EJBReferenceCreationOperation.addHelpers(EJBReferenceCreationOperation.java:153)\n    \tat .....etools.j2ee.common.operations.ModelModifierOperation.execute(ModelModifierOperation.java:101)\n\n\n\n\nMore information:\nFix is to validate edit the manifest file like this\nin J2EEProjectUtilities.writeManifest(...)\n\n\tprivate static void writeManifest(IProject aProject, IFile aFile, ArchiveManifest manifest) throws java.io.IOException {\n\t\tif (aFile !\u003d null) {\n\t\t\tif(SimpleValidateEdit.validateEdit(new IFile[] { aFile })){\n\t\t\t\tOutputStream out \u003d new WorkbenchByteArrayOutputStream(aFile);\n\t\t\t\tmanifest.writeSplittingClasspath(out);\n\t\t\t\tout.close();\n\t\t\t\tJ2EEComponentClasspathUpdater.getInstance().queueUpdateModule(aProject);\n\t\t\t}\n\t\t}\n\t}\n\n\nSee patch for more details.",
    "Created an attachment (id\u003d60986)\npatch to validate edit manifest file\n\n",
    "I approve of this fix...\n\nThis is a critical issue in the clearcase environment\n\nSimple fix, and has been tested\n\n",
    "+1\n",
    "Simple fix, looks like it would affect other team providers as well.\n+1",
    "assigned",
    "fixed",
    "closed"
  ],
  "commentCreationDates": [
    "2007-03-15T18:44:09+01:00",
    "2007-03-15T18:46:09+01:00",
    "2007-03-21T14:06:03+01:00",
    "2007-03-21T16:23:41+01:00",
    "2007-03-21T23:02:43+01:00",
    "2007-03-27T00:10:57+02:00",
    "2007-03-27T00:54:19+02:00",
    "2007-03-30T19:38:22+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.emf.ecore.resource.Resource$IOWrappedException",
      "message": "Could not write to read-only file: /webtest/WebContent/META-INF/MANIFEST.MF.",
      "elements": [
        {
          "method": "org.eclipse.emf.ecore.resource.impl.URIConverterImpl$PlatformResourceOutputStream.flush",
          "source": "URIConverterImpl.java:149"
        },
        {
          "method": "org.eclipse.jem.util.emf.workbench.WorkbenchByteArrayOutputStream.flush",
          "source": "WorkbenchByteArrayOutputStream.java:78"
        },
        {
          "method": "java.io.DataOutputStream.flush",
          "source": "DataOutputStream.java:131"
        },
        {
          "method": "org.eclipse.jst.j2ee.commonarchivecore.internal.helpers.ArchiveManifestImpl.writeSplittingClasspath",
          "source": "ArchiveManifestImpl.java:219"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.project.J2EEProjectUtilities.writeManifest",
          "source": "J2EEProjectUtilities.java:283"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.project.J2EEProjectUtilities.writeManifest",
          "source": "J2EEProjectUtilities.java:273"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "177605",
      "date": "2007-03-15T18:44:09+01:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "normal"
    }
  ],
  "groupId": "177605",
  "bugId": "177605",
  "date": "2007-03-15T18:44:09+01:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "normal"
}