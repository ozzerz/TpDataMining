{
  "comments": [
    "3.1-RC4\n\n- have the CU I will attach\n- try to Refactor\u003eMove Nested Type to New File on nested type \u0027Domain\u003cT\u003e\u0027\n\n-\u003e AFE:\n\nCaused by: org.eclipse.jdt.internal.corext.Assert$AssertionFailedException: null\nargument;\n\tat org.eclipse.jdt.internal.corext.Assert.isNotNull(Assert.java:108)\n\tat org.eclipse.jdt.internal.corext.Assert.isNotNull(Assert.java:86)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.findTypeDeclaration(MoveInnerToTopRefactoring.java:406)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.createNewSource(MoveInnerToTopRefactoring.java:1018)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.createChangeManager(MoveInnerToTopRefactoring.java:839)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.checkFinalConditions(MoveInnerToTopRefactoring.java:743)\n\tat\norg.eclipse.ltk.core.refactoring.CheckConditionsOperation.run(CheckConditionsOperation.java:84)\n\tat\norg.eclipse.ltk.core.refactoring.CreateChangeOperation.run(CreateChangeOperation.java:114)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1719)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:86)\n\tat\norg.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)",
    "Created an attachment (id\u003d24029)\nPreferencesView.java\n\nJava file as described in comment 0.",
    "Unfortunately, it\u0027s a regression: The AFE happens in situations where a top-\nlevel class contains more than one direct member type and the refactoring is \nnot applied to the first one. It has nothing to do with generics and/or enums. \n\nAll other cases work fine.\n\nWorkaround is to move the class to be refactored to the first position within \nthe top-level type.",
    "Comment 2 is only partially correct: The following case works fine:\n\npublic class Foo{\n\tclass Bar1{\n\t}\n\tclass Bar2{\n\t}\n\tclass Bar3{\n\t}\n}\n\nSince the fix does not seem very easy and there is no general pattern to \nproduce the failure, I suggest to leave this for 3.1.",
    "I was finally able to track down the problem: During rewriting of the inner \nclass, a new AST is created, but the ASTParser is not currently set up (only a \ncall to setSource)\n\nThe result is that the parser is trying to parse 5.0 code in 1.4 compliance \nmode. The enum keyword in the code example causes unrecoverable problems to \nthe parser, which results in a compilation unit node where some the inner \ntypes after the enum appear as top-level types, causing the refactoring to \nfail.\n\nThis defect is not an actual regression, since it is not caused by changes in \nthe refactoring code, but by the fact that the setup of the ASTParser \ndescribed above is not sufficent anymore for 5.0 code, but is still for 1.4.\n\nThe fix is to call ASTParser#setProject(...) before creating the AST.",
    "Will not fix for 3.1 for the following reasons:\n\n- inner enums or inner classes inside enums are both special cases\n- the refactoring fails, but does no harm\n\nI suggest to add this to the list of 3.1.1 bugs",
    "The refactoring works correctly wrt. this bug for all \u003c\u003d 1.4 code.\nThe only setup that is causing the AFE is a class which is moved out of a 5.0 \ncompliant compilation unit where enums are declared with a source offset less \nthan the offset of the class to be refactored.\nAll other scenarios work fine.",
    "Given this I opt to postpone the bug to 3.1.1.",
    "Fixed in HEAD \u003e 20050630",
    "*** Bug 102483 has been marked as a duplicate of this bug. ***",
    "Martin, can you please yote?",
    "Dirk, can you please vote?",
    "Tobias, can you please provide a patch we can vote on ?",
    "Created an attachment (id\u003d25965)\nproposed fix\n",
    "patch looks good. ",
    "Patch looks good to me.",
    "Fixed in 3.1.1 maintenance stream \u003e 20050810",
    "verifying...",
    "verified the \"Move to its own CU\" refactoring works as expected in the described\nscenarios.",
    "*** Bug 120432 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2005-06-27T15:23:37+02:00",
    "2005-06-27T15:24:38+02:00",
    "2005-06-27T17:08:15+02:00",
    "2005-06-27T17:13:38+02:00",
    "2005-06-27T18:12:56+02:00",
    "2005-06-27T18:23:29+02:00",
    "2005-06-27T18:26:20+02:00",
    "2005-06-27T18:30:49+02:00",
    "2005-06-30T10:54:09+02:00",
    "2005-07-02T19:47:59+02:00",
    "2005-08-10T14:54:49+02:00",
    "2005-08-10T14:56:17+02:00",
    "2005-08-10T15:03:57+02:00",
    "2005-08-10T15:05:49+02:00",
    "2005-08-10T16:22:06+02:00",
    "2005-08-10T17:11:25+02:00",
    "2005-08-10T18:03:08+02:00",
    "2005-09-02T15:53:09+02:00",
    "2005-09-02T16:05:42+02:00",
    "2005-12-13T10:42:56+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.jdt.internal.corext.Assert$AssertionFailedException",
      "message": "null argument;",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.corext.Assert.isNotNull",
          "source": "Assert.java:108"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.Assert.isNotNull",
          "source": "Assert.java:86"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.findTypeDeclaration",
          "source": "MoveInnerToTopRefactoring.java:406"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.createNewSource",
          "source": "MoveInnerToTopRefactoring.java:1018"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.createChangeManager",
          "source": "MoveInnerToTopRefactoring.java:839"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.structure.MoveInnerToTopRefactoring.checkFinalConditions",
          "source": "MoveInnerToTopRefactoring.java:743"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.CheckConditionsOperation.run",
          "source": "CheckConditionsOperation.java:84"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.CreateChangeOperation.run",
          "source": "CreateChangeOperation.java:114"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1719"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run",
          "source": "WorkbenchRunnableAdapter.java:86"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.java:113"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "101863",
      "date": "2005-06-27T15:23:37+02:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "101863",
  "bugId": "101863",
  "date": "2005-06-27T15:23:37+02:00",
  "product": "JDT",
  "component": "UI",
  "severity": "normal"
}