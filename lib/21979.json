{
  "comments": [
    "extssh connection fails with a server key larger than 768 bits. Using OpenSSH\n3.0 on linux 2.0.34. Don\u0027t have more details since the problem is about six\nmonths old and I don\u0027t have access to the same environment I used then.",
    "I\u0027m not sure if this is relevant since we only support password authentication \nwith extssh. Should investigate what role server keys play in password \nauthentication, if any.",
    "Server key is needed for password authentication - that\u0027s because the server\npublic  key is used to encrypt the password sent from the client. \n\nI am having problem using Eclipse with a SSH server that\u0027s using 1024bit server\nkey (e.g. IBM Internal OpenSource Bazaar). You can replicate this problem by\nchanging the sshd on your server to use 1024bit key (on a linux box, add/modify\nyour sshd config with ServerKeyBits 1024) it will say Unexpected End of stream\nand stop.\n\nIt fails for 2.0 and 2.01.",
    "One bug was found and fixed that may have been causing this problem. If \npossible, could you try the latest 2.1 integration build?",
    "I tried Integration build I20021016 and it doesn\u0027t work, and the following error\nmessage is found in \"configuration details\"\n\n!SESSION Oct 18, 2002 17:46:25.954 ---------------------------------------------\njava.fullversion\u003dJ2RE 1.3.1 IBM Windows 32 build cn131-20020710 (JIT enabled: jitc)\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_GB\nCommand-line arguments: -os win32 -ws win32 -arch x86 -install file:D:/eclipse/\n!ENTRY org.eclipse.ui 4 4 Oct 18, 2002 17:46:25.954\n!MESSAGE Unhandled exception caught in event loop.\n!ENTRY org.eclipse.ui 4 0 Oct 18, 2002 17:46:25.954\n!MESSAGE -17\n!STACK 0\njava.lang.ArrayIndexOutOfBoundsException: -17\n\tat org.eclipse.team.internal.ccvs.ssh.Misc.encryptRSAPkcs1(Misc.java:437)\n\tat\norg.eclipse.team.internal.ccvs.ssh.Client.send_SSH_CMSG_SESSION_KEY(Client.java:655)\n\tat\norg.eclipse.team.internal.ccvs.ssh.Client.receive_SSH_SMSG_PUBLIC_KEY(Client.java:569)\n\tat org.eclipse.team.internal.ccvs.ssh.Client.login(Client.java:486)\n\tat org.eclipse.team.internal.ccvs.ssh.Client.connect(Client.java:404)\n\tat\norg.eclipse.team.internal.ccvs.ssh.SSHServerConnection.open(SSHServerConnection.java:76)\n\tat\norg.eclipse.team.internal.ccvs.core.connection.Connection.open(Connection.java:123)\n\tat\norg.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.createConnection(CVSRepositoryLocation.java:150)\n\tat\norg.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.openConnection(CVSRepositoryLocation.java:333)\n\tat org.eclipse.team.internal.ccvs.core.client.Session.open(Session.java:295)\n\tat org.eclipse.team.internal.ccvs.core.client.Session.run(Session.java:188)\n\tat\norg.eclipse.team.internal.ccvs.core.resources.RemoteFolder.getMembers(RemoteFolder.java:325)\n\tat\norg.eclipse.team.internal.ccvs.core.resources.RemoteFolder.getMembers(RemoteFolder.java:253)\n\tat\norg.eclipse.team.internal.ccvs.core.resources.RemoteFolder.members(RemoteFolder.java:598)\n\tat\norg.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.members(CVSRepositoryLocation.java:231)\n\tat org.eclipse.team.internal.ccvs.ui.model.BranchTag$1.run(BranchTag.java:63)\n\tat org.eclipse.team.internal.ui.TeamUIPlugin$2.run(TeamUIPlugin.java:142)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:66)\n\tat org.eclipse.team.internal.ui.TeamUIPlugin.runWithProgress(TeamUIPlugin.java:139)\n\tat\norg.eclipse.team.internal.ccvs.ui.CVSUIPlugin.runWithProgress(CVSUIPlugin.java:221)\n\tat org.eclipse.team.internal.ccvs.ui.model.BranchTag.getChildren(BranchTag.java:59)\n\tat\norg.eclipse.ui.model.WorkbenchContentProvider.getChildren(WorkbenchContentProvider.java:51)\n\tat\norg.eclipse.jface.viewers.AbstractTreeViewer.getRawChildren(AbstractTreeViewer.java:571)\n\tat\norg.eclipse.jface.viewers.StructuredViewer.getFilteredChildren(StructuredViewer.java:346)\n\tat\norg.eclipse.jface.viewers.StructuredViewer.getSortedChildren(StructuredViewer.java:447)\n\tat\norg.eclipse.jface.viewers.AbstractTreeViewer.createChildren(AbstractTreeViewer.java:241)\n\tat\norg.eclipse.jface.viewers.AbstractTreeViewer.handleTreeExpand(AbstractTreeViewer.java:614)\n\tat\norg.eclipse.jface.viewers.AbstractTreeViewer$1.treeExpanded(AbstractTreeViewer.java:626)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:173)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Tree.wmNotifyChild(Tree.java:1764)\n\tat org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:3703)\n\tat org.eclipse.swt.widgets.Composite.WM_NOTIFY(Composite.java:639)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n\tat org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:152)\n\tat org.eclipse.swt.widgets.Tree.WM_LBUTTONDOWN(Tree.java:1393)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1420)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1403)\n\tat\norg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:775)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:462)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:247)\n\tat org.eclipse.core.launcher.Main.run(Main.java:703)\n\tat org.eclipse.core.launcher.Main.main(Main.java:539)",
    "I have reproduced this.\nThe problem is that the chunk of data we are trying to encrypt, is too big for \nthe given modulus.  This results in the line \"offset+\u003dblock.length-data.length-\n3\" (line 435 in Misc.java rev.1.6), giving a negative offset.\n",
    "The problem is in Client.java 1.12, line 655.  The session key encryption code \nalways uses the server key first.  This breaks if the server key is numerically \nlarger than the host key.  The fix is to follow the SSH protocol spec which \nsays, \"The resulting string is then encrypted using the smaller key (one with \nsmaller modulus), and the result is then encrypted using the other key:\"\n\nbyte[] result;\nif (new BigInteger(1,server_key_public_modulus).compareTo(new BigInteger\n(1,host_key_public_modulus)) \u003d\u003d -1) {\n\tresult \u003d Misc.encryptRSAPkcs1(session_key_xored, \nserver_key_public_exponent, server_key_public_modulus);\n\tresult \u003d Misc.encryptRSAPkcs1(result, host_key_public_exponent, \nhost_key_public_modulus);\n} else {\n\tresult \u003d Misc.encryptRSAPkcs1(session_key_xored, \nhost_key_public_exponent, host_key_public_modulus);\n\tresult \u003d Misc.encryptRSAPkcs1(result, server_key_public_exponent, \nserver_key_public_modulus);\t \n}\n",
    "Created an attachment (id\u003d2251)\nProposed fix\n",
    "Fix released to HEAD",
    "*** Bug 24298 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2002-07-26T22:52:20+02:00",
    "2002-08-23T22:05:58+02:00",
    "2002-10-15T16:30:06+02:00",
    "2002-10-15T18:44:35+02:00",
    "2002-10-18T18:19:46+02:00",
    "2002-10-22T20:08:22+02:00",
    "2002-10-22T22:46:25+02:00",
    "2002-10-22T23:23:21+02:00",
    "2002-10-23T20:48:02+02:00",
    "2002-11-01T17:22:25+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "-17",
      "elements": [
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.Misc.encryptRSAPkcs1",
          "source": "Misc.java:437"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.Client.send_SSH_CMSG_SESSION_KEY",
          "source": "Client.java:655"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.Client.receive_SSH_SMSG_PUBLIC_KEY",
          "source": "Client.java:569"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.Client.login",
          "source": "Client.java:486"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.Client.connect",
          "source": "Client.java:404"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ssh.SSHServerConnection.open",
          "source": "SSHServerConnection.java:76"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.Connection.open",
          "source": "Connection.java:123"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.createConnection",
          "source": "CVSRepositoryLocation.java:150"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.openConnection",
          "source": "CVSRepositoryLocation.java:333"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.client.Session.open",
          "source": "Session.java:295"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.client.Session.run",
          "source": "Session.java:188"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.resources.RemoteFolder.getMembers",
          "source": "RemoteFolder.java:325"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.resources.RemoteFolder.getMembers",
          "source": "RemoteFolder.java:253"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.resources.RemoteFolder.members",
          "source": "RemoteFolder.java:598"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.CVSRepositoryLocation.members",
          "source": "CVSRepositoryLocation.java:231"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.model.BranchTag$1.run",
          "source": "BranchTag.java:63"
        },
        {
          "method": "org.eclipse.team.internal.ui.TeamUIPlugin$2.run",
          "source": "TeamUIPlugin.java:142"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:66"
        },
        {
          "method": "org.eclipse.team.internal.ui.TeamUIPlugin.runWithProgress",
          "source": "TeamUIPlugin.java:139"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.CVSUIPlugin.runWithProgress",
          "source": "CVSUIPlugin.java:221"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.model.BranchTag.getChildren",
          "source": "BranchTag.java:59"
        },
        {
          "method": "org.eclipse.ui.model.WorkbenchContentProvider.getChildren",
          "source": "WorkbenchContentProvider.java:51"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.getRawChildren",
          "source": "AbstractTreeViewer.java:571"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.getFilteredChildren",
          "source": "StructuredViewer.java:346"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.getSortedChildren",
          "source": "StructuredViewer.java:447"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.createChildren",
          "source": "AbstractTreeViewer.java:241"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.handleTreeExpand",
          "source": "AbstractTreeViewer.java:614"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer$1.treeExpanded",
          "source": "AbstractTreeViewer.java:626"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:173"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.wmNotifyChild",
          "source": "Tree.java:1764"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_NOTIFY",
          "source": "Control.java:3703"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_NOTIFY",
          "source": "Composite.java:639"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProc",
          "source": "OS.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.callWindowProc",
          "source": "Tree.java:152"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.WM_LBUTTONDOWN",
          "source": "Tree.java:1393"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1420"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1403"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:775"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:462"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:247"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:703"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:539"
        }
      ],
      "number": 0,
      "commentIndex": 4,
      "bugId": "21979",
      "date": "2002-10-18T18:19:46+02:00",
      "product": "Platform",
      "component": "Team",
      "severity": "normal"
    }
  ],
  "groupId": "21979",
  "bugId": "21979",
  "date": "2002-07-26T22:52:20+02:00",
  "product": "Platform",
  "component": "Team",
  "severity": "normal"
}