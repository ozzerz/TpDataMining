{
  "comments": [
    "I am starting Equinox by using the EclipseStarter with\n\njava -Djava.security.manager -Djava.security.policy\u003d\".java.policy\" \n\nor \n\njava -Djava.security.manager\u003dorg.eclipse.osgi.framework.internal.core.FrameworkSecurityManager \n-Djava.security.policy\u003d\".java.policy\"\n\n// .java.policy file\n\ngrant\n{\n  permission java.security.AllPermission;\n};\n\nThe very first bundle started is a \"Initial Provisioning\" bundle built in-house and this IP bundle will install lots of other bundles and start one of them called \"bundlemanager\" and inside the bundlemanager I am getting the following exception\n\nCaused by: java.security.AccessControlException: access denied (java.security.Al\n\nlPermission \u003call permissions\u003e \u003call actions\u003e)\n\n        at java.security.AccessControlContext.checkPermission(AccessControlConte\n\nxt.java:264)\n\n        at org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.int\n\nernalCheckPermission(FrameworkSecurityManager.java:118)\n\n        at org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager$Che\n\nckPermissionAction.run(FrameworkSecurityManager.java:83)\n\n        at java.security.AccessController.doPrivileged(Native Method)\n\n        at org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.che\n\nckPermission(FrameworkSecurityManager.java:89)\n\n        at org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.che\n\nckPermission(FrameworkSecurityManager.java:218)\n\n        at org.eclipse.osgi.framework.internal.core.PermissionAdminImpl.setPermi\n\nssions(PermissionAdminImpl.java:173)\n\n        at com.bea.backplane.bundlemanager.internal.Manager.setPermissionAdminSe\n\nrvice(Manager.java:121)\n\n        ... 25 more",
    "when using -Djava.security.manager the exception is:\n\nCaused by: java.security.AccessControlException: access denied (java.security.Al\nlPermission \u003call permissions\u003e \u003call actions\u003e)\n        at java.security.AccessControlContext.checkPermission(AccessControlConte\nxt.java:264)\n        at java.security.AccessController.checkPermission(AccessController.java:\n427)\n        at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n        at org.eclipse.osgi.framework.internal.core.PermissionAdminImpl.setPermi\nssions(PermissionAdminImpl.java:173)\n        at com.bea.backplane.bundlemanager.internal.Manager.setPermissionAdminSe\nrvice(Manager.java:121)\n        ... 25 more\n\n\n\n\n\nThe code from org.eclipse.osgi.framework.internal.core.PermissionAdminImpl is\n\npublic void setPermissions(String location, PermissionInfo[] permissions) {\n  SecurityManager sm \u003d System.getSecurityManager();\n  if (sm !\u003d null)\n    sm.checkPermission(new AllPermission());  \u003c-------------  ??????\n  if (location \u003d\u003d null) {\n    throw new NullPointerException();\n  }",
    "The setPermission methiods on PermissionAdmin require AllPermission according to the javadoc.\n\nAre you calling PermissionAdmin.setDefaultPermissions in your code?  By default all bundles in the framework will get AllPermissions unless you set the default permissions to something else.  Before you do this you should give yourself AllPermission to ensure that you can continue to set permissions.  OSGi\u0027s rational for requiring AllPermission is because if you can set permissions then you essentially have AllPermission already because you will be able to assign yourself more permissions.",
    "Shean, do you have any more information?  Did you scope the \"intial provisioning\" bundle\u0027s permissions down before calling setPermissions from it?  This bundle must alway have AllPermission to call setPermissions.\n\nClosing as invalid.  Please reopen if you are still having issues and can provide more information.  Thanks."
  ],
  "commentCreationDates": [
    "2006-06-09T03:27:04+02:00",
    "2006-06-09T05:14:11+02:00",
    "2006-06-09T14:40:57+02:00",
    "2006-07-26T21:05:05+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.security.AccessControlException",
      "message": "access denied (java.security.Al  lPermission \u003call permissions\u003e \u003call actions\u003e)",
      "elements": [
        {
          "method": "java.security.AccessControlContext.checkPermission",
          "source": "AccessControlConte  xt.java:264"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.internalCheckPermission",
          "source": "FrameworkSecurityManager.java:118"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager$CheckPermissionAction.run",
          "source": "FrameworkSecurityManager.java:83"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.checkPermission",
          "source": "FrameworkSecurityManager.java:89"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager.checkPermission",
          "source": "FrameworkSecurityManager.java:218"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PermissionAdminImpl.setPermissions",
          "source": "PermissionAdminImpl.java:173"
        },
        {
          "method": "com.bea.backplane.bundlemanager.internal.Manager.setPermissionAdminService",
          "source": "Manager.java:121"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "146152",
      "date": "2006-06-09T03:27:04+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    },
    {
      "exceptionType": "java.security.AccessControlException",
      "message": "access denied (java.security.Al lPermission \u003call permissions\u003e \u003call actions\u003e)",
      "elements": [
        {
          "method": "java.security.AccessControlContext.checkPermission",
          "source": "AccessControlConte xt.java:264"
        },
        {
          "method": "java.security.AccessController.checkPermission",
          "source": "AccessController.java: 427"
        },
        {
          "method": "java.lang.SecurityManager.checkPermission",
          "source": "SecurityManager.java:532"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PermissionAdminImpl.setPermissions",
          "source": "PermissionAdminImpl.java:173"
        },
        {
          "method": "com.bea.backplane.bundlemanager.internal.Manager.setPermissionAdminService",
          "source": "Manager.java:121"
        }
      ],
      "number": 1,
      "commentIndex": 1,
      "bugId": "146152",
      "date": "2006-06-09T05:14:11+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    }
  ],
  "groupId": "146152",
  "bugId": "146152",
  "date": "2006-06-09T03:27:04+02:00",
  "product": "Equinox",
  "component": "Framework",
  "severity": "normal"
}