{
  "comments": [
    "The following exception is produced when modifying the Java editor\u0027s document \nvia an IRewriteTarget:\n\n\njava.lang.IllegalArgumentException: Index out of bounds\n\tat org.eclipse.swt.SWT.error(SWT.java:2677)\n\tat org.eclipse.swt.SWT.error(SWT.java:2616)\n\tat org.eclipse.swt.SWT.error(SWT.java:2587)\n\tat org.eclipse.swt.custom.StyledText.replaceStyleRanges\n(StyledText.java:6231)\n\tat org.eclipse.jface.text.TextViewer.addPresentation\n(TextViewer.java:4040)\n\tat org.eclipse.jface.text.TextViewer.changeTextPresentation\n(TextViewer.java:4119)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler.applyTextRegionColle\nction(PresentationReconciler.java:568)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler.processDamage\n(PresentationReconciler.java:557)\n\tat org.eclipse.jface.text.presentation.PresentationReconciler.access$3\n(PresentationReconciler.java:553)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler$InternalListener.tex\ntChanged(PresentationReconciler.java:222)\n\tat org.eclipse.jface.text.TextViewer.updateTextListeners\n(TextViewer.java:2235)\n\tat org.eclipse.jface.text.TextViewer.fireRedrawChanged\n(TextViewer.java:4275)\n\tat org.eclipse.jface.text.TextViewer.enabledRedrawing\n(TextViewer.java:4345)\n\tat org.eclipse.jface.text.TextViewer.enabledRedrawing\n(TextViewer.java:4304)\n\tat org.eclipse.jface.text.TextViewer.setRedraw(TextViewer.java:4420)\n\tat org.eclipse.jface.text.TextViewer.setRedraw(TextViewer.java:4392)\n\tat org.eclipse.jface.text.TextViewer$RewriteTarget.setRedraw\n(TextViewer.java:951)\n\n\nSample code to reproduce the problem:\n\nwhile (!validateEditorInputState()) {\n\tif (!display.readAndDispatch()) {\n\t\tdisplay.sleep();\n\t}\n}\n\t\t\t\t\t\t\t\nIRewriteTarget target\u003d (IRewriteTarget) getTextEditor().getAdapter\n(IRewriteTarget.class);\nif (target !\u003d null) {\n\ttarget.beginCompoundChange();\n\ttarget.setRedraw(false);\n}\n\ntry {\n\tIDocument document \u003d target.getDocument();\n\n\t// modify the document here\n\n} finally {\n\ttarget.endCompoundChange();\n\ttarget.setRedraw(true);\n}\n\nThe exception is reproducible in build 200406180800",
    "Changing the \"ConvertLineDelimiterAction\" to your snippet, I cannot reproduce \nthe problem in RC3. Please attach the source you\u0027re using. What kind of editor \nare you working on?",
    "I\u0027ve managed to reproduce the problem by taking the following actions:\n\n1. Open any .java file\n2. In the Java editor, select all text by using the edit menu (CTRL+A probably \nworks, too)\n3. Press CTRL+I to fix indenting\n\nThe following stack trace results:\n\njava.lang.IllegalArgumentException: Index out of bounds\n\tat org.eclipse.swt.SWT.error(SWT.java:2677)\n\tat org.eclipse.swt.SWT.error(SWT.java:2616)\n\tat org.eclipse.swt.SWT.error(SWT.java:2587)\n\tat org.eclipse.swt.custom.StyledText.replaceStyleRanges\n(StyledText.java:6231)\n\tat org.eclipse.jface.text.TextViewer.addPresentation\n(TextViewer.java:4042)\n\tat org.eclipse.jface.text.TextViewer.changeTextPresentation\n(TextViewer.java:4121)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler.applyTextRegionColle\nction(PresentationReconciler.java:568)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler.processDamage\n(PresentationReconciler.java:557)\n\tat org.eclipse.jface.text.presentation.PresentationReconciler.access$3\n(PresentationReconciler.java:553)\n\tat \norg.eclipse.jface.text.presentation.PresentationReconciler$InternalListener.tex\ntChanged(PresentationReconciler.java:222)\n\tat org.eclipse.jface.text.TextViewer.updateTextListeners\n(TextViewer.java:2237)\n\tat org.eclipse.jface.text.TextViewer.fireRedrawChanged\n(TextViewer.java:4277)\n\tat org.eclipse.jface.text.TextViewer.enabledRedrawing\n(TextViewer.java:4347)\n\tat org.eclipse.jface.text.TextViewer.enabledRedrawing\n(TextViewer.java:4306)\n\tat org.eclipse.jface.text.TextViewer.setRedraw(TextViewer.java:4422)\n\tat org.eclipse.jface.text.TextViewer.setRedraw(TextViewer.java:4394)\n\tat org.eclipse.jface.text.TextViewer$RewriteTarget.setRedraw\n(TextViewer.java:951)\n\tat org.eclipse.jdt.internal.ui.actions.IndentAction$1.run\n(IndentAction.java:173)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile\n(BusyIndicator.java:69)\n\tat org.eclipse.jdt.internal.ui.actions.IndentAction.run\n(IndentAction.java:181)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:881)\n\tat org.eclipse.ui.actions.RetargetAction.runWithEvent\n(RetargetAction.java:212)\n\tat org.eclipse.ui.internal.WWinPluginAction.runWithEvent\n(WWinPluginAction.java:211)\n\tat org.eclipse.ui.commands.ActionHandler.execute\n(ActionHandler.java:141)\n\tat org.eclipse.ui.internal.commands.Command.execute(Command.java:132)\n\tat org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand\n(WorkbenchKeyboard.java:469)\n\tat org.eclipse.ui.internal.keys.WorkbenchKeyboard.press\n(WorkbenchKeyboard.java:887)\n\tat org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent\n(WorkbenchKeyboard.java:928)\n\tat \norg.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings\n(WorkbenchKeyboard.java:546)\n\tat org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$2\n(WorkbenchKeyboard.java:494)\n\tat org.eclipse.ui.internal.keys.WorkbenchKeyboard$1.handleEvent\n(WorkbenchKeyboard.java:259)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Display.filterEvent(Display.java:714)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:795)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:820)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:805)\n\tat org.eclipse.swt.widgets.Control.sendKeyEvent(Control.java:1734)\n\tat org.eclipse.swt.widgets.Control.sendKeyEvent(Control.java:1730)\n\tat org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:3067)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:2970)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:3298)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1467)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2396)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1375)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1346)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench\n(Workbench.java:252)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:141)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run\n(IDEApplication.java:96)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:335)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:272)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:128)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:186)\n\tat org.eclipse.core.launcher.Main.run(Main.java:647)\n\tat org.eclipse.core.launcher.Main.main(Main.java:631)\n\n\nNote that I\u0027m not able to reproduce this consistently: it appears to be timing-\nrelated.",
    "BTW, the afore comment was in eclipse 3.0 RC3",
    "Tried several *.java files using I200406230010 and could not reproduce.",
    "David, What kind of visual decorations of the text do you have enabled? \nSemantic highlighting, find occurrences, etc.? Do you have any non-SDK \nimplementer of ITextPresentationListener installed on the Java editor or are \nyou running the bar SDK?",
    "Thanks for your quick response.\n\nAs far as visual decorations, I\u0027ve got the following enabled:\n- code folding\n- highlight current line\n- line numbers\n\nSymantic highlighting is turned off.\n\nI do have an ITextPresentationListener installed on the Java editor.",
    "Does it (the text presentation listener) come from the SDK or is it a custom \none?",
    "It is a custom one.  It inspects the text presentation\u0027s extent offset and \nlength, and if they meet certain criteria calls textPresentation.mergeStyle() \nwith a new foreground color.",
    "Oops... this one is a defect with my ITextPresentationListener that had an off-\nby-one index problem, not related to the eclipse codebase.\n\nMy apologies to everyone for their effort on this one.",
    "Get rid of deprecated state.",
    "."
  ],
  "commentCreationDates": [
    "2004-06-22T02:27:24+02:00",
    "2004-06-22T15:36:06+02:00",
    "2004-06-23T02:45:39+02:00",
    "2004-06-23T02:46:29+02:00",
    "2004-06-23T09:40:23+02:00",
    "2004-06-23T12:05:04+02:00",
    "2004-06-23T15:36:58+02:00",
    "2004-06-23T15:43:47+02:00",
    "2004-06-23T16:15:54+02:00",
    "2004-07-14T01:39:17+02:00",
    "2007-06-22T15:58:48+02:00",
    "2007-06-22T16:04:14+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Index out of bounds",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2677"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2616"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2587"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.replaceStyleRanges",
          "source": "StyledText.java:6231"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.addPresentation",
          "source": "TextViewer.java:4040"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.changeTextPresentation",
          "source": "TextViewer.java:4119"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.applyTextRegionCollection",
          "source": "PresentationReconciler.java:568"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.processDamage",
          "source": "PresentationReconciler.java:557"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.access$3",
          "source": "PresentationReconciler.java:553"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler$InternalListener.textChanged",
          "source": "PresentationReconciler.java:222"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.updateTextListeners",
          "source": "TextViewer.java:2235"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.fireRedrawChanged",
          "source": "TextViewer.java:4275"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.enabledRedrawing",
          "source": "TextViewer.java:4345"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.enabledRedrawing",
          "source": "TextViewer.java:4304"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.setRedraw",
          "source": "TextViewer.java:4420"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.setRedraw",
          "source": "TextViewer.java:4392"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer$RewriteTarget.setRedraw",
          "source": "TextViewer.java:951"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "68130",
      "date": "2004-06-22T02:27:24+02:00",
      "product": "Platform",
      "component": "Text",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Index out of bounds",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2677"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2616"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2587"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.replaceStyleRanges",
          "source": "StyledText.java:6231"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.addPresentation",
          "source": "TextViewer.java:4042"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.changeTextPresentation",
          "source": "TextViewer.java:4121"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.applyTextRegionCollection",
          "source": "PresentationReconciler.java:568"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.processDamage",
          "source": "PresentationReconciler.java:557"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler.access$3",
          "source": "PresentationReconciler.java:553"
        },
        {
          "method": "org.eclipse.jface.text.presentation.PresentationReconciler$InternalListener.textChanged",
          "source": "PresentationReconciler.java:222"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.updateTextListeners",
          "source": "TextViewer.java:2237"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.fireRedrawChanged",
          "source": "TextViewer.java:4277"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.enabledRedrawing",
          "source": "TextViewer.java:4347"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.enabledRedrawing",
          "source": "TextViewer.java:4306"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.setRedraw",
          "source": "TextViewer.java:4422"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer.setRedraw",
          "source": "TextViewer.java:4394"
        },
        {
          "method": "org.eclipse.jface.text.TextViewer$RewriteTarget.setRedraw",
          "source": "TextViewer.java:951"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.actions.IndentAction$1.run",
          "source": "IndentAction.java:173"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.actions.IndentAction.run",
          "source": "IndentAction.java:181"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:881"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction.runWithEvent",
          "source": "RetargetAction.java:212"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPluginAction.runWithEvent",
          "source": "WWinPluginAction.java:211"
        },
        {
          "method": "org.eclipse.ui.commands.ActionHandler.execute",
          "source": "ActionHandler.java:141"
        },
        {
          "method": "org.eclipse.ui.internal.commands.Command.execute",
          "source": "Command.java:132"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand",
          "source": "WorkbenchKeyboard.java:469"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.press",
          "source": "WorkbenchKeyboard.java:887"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent",
          "source": "WorkbenchKeyboard.java:928"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings",
          "source": "WorkbenchKeyboard.java:546"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$2",
          "source": "WorkbenchKeyboard.java:494"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard$1.handleEvent",
          "source": "WorkbenchKeyboard.java:259"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.filterEvent",
          "source": "Display.java:714"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:795"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:820"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:805"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.sendKeyEvent",
          "source": "Control.java:1734"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.sendKeyEvent",
          "source": "Control.java:1730"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_CHAR",
          "source": "Control.java:3067"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2970"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3298"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1467"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2396"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1375"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1346"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:252"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:141"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:96"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:335"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:272"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:128"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:186"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:647"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:631"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "68130",
      "date": "2004-06-23T02:45:39+02:00",
      "product": "Platform",
      "component": "Text",
      "severity": "normal"
    }
  ],
  "groupId": "68130",
  "bugId": "68130",
  "date": "2004-06-22T02:27:24+02:00",
  "product": "Platform",
  "component": "Text",
  "severity": "normal"
}