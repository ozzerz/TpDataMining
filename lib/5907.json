{
  "comments": [
    "Build 20011108\n\nWhen the hard-disk is full, the indexer can choke while trying to save.  This is \na borderline case, but since indexes write alot to disk, it\u0027s not unheard of.  \nHere\u0027s the stack trace:\n\njava.lang.ArrayIndexOutOfBoundsException: 883\n\tat \norg.eclipse.jdt.internal.core.index.impl.MergeFactory.mergeFiles(MergeFactory.ja\nva:136)\n\tat \norg.eclipse.jdt.internal.core.index.impl.MergeFactory.merge(MergeFactory.java:77\n)\n\tat org.eclipse.jdt.internal.core.index.impl.Index.merge(Index.java:231)\n\tat org.eclipse.jdt.internal.core.index.impl.Index.save(Index.java:340)\n\tat \norg.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndexes(IndexMana\nger.java:335)\n\tat \norg.eclipse.jdt.internal.core.search.indexing.IndexManager.notifyIdle(IndexManag\ner.java:267)\n\tat \norg.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:2\n54)\n\tat java.lang.Thread.run(Thread.java:498)",
    "This failure mode is bad, because if I shutdown the workbench, clear up enough \nspace on my hard-disk, and then restart, I get another error:\n\njava.lang.ArrayIndexOutOfBoundsException: 1551\n\tat \norg.eclipse.jdt.internal.core.index.impl.MergeFactory.mergeFiles(MergeFactory.ja\nva:136)\n\tat \norg.eclipse.jdt.internal.core.index.impl.MergeFactory.merge(MergeFactory.java:77\n)\n\tat org.eclipse.jdt.internal.core.index.impl.Index.merge(Index.java:231)\n\tat org.eclipse.jdt.internal.core.index.impl.Index.save(Index.java:340)\n\tat \norg.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndexes(IndexMana\nger.java:335)\n\tat \norg.eclipse.jdt.internal.core.search.indexing.IndexManager.notifyIdle(IndexManag\ner.java:267)\n\tat \norg.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:2\n54)\n\tat java.lang.Thread.run(Thread.java:498)\n",
    "Would this be related to the other merge issue we have been seeing ?\nProtection should probably be added, no problem if the index is left \ninconsistent beyond that point, since there is no more disk space anyway.",
    "By any chance, do you still have the workspace that when restarted caused the \nsecond stack trace?",
    "No I don\u0027t have the old workspace. Sorry, I should have kept it.  Here is a \nfairly easy way to reproduce the initial error:\n\n1) Start with lots of disk space free\n2) Create a java project with lots of classes\n3) Delete the project, but don\u0027t delete content from disk\n4) Fill the disk to within about 20K of being full\n5) Recreate the java project on the existing content\n\nStep 5 should kick in a large index operation that will fill the disk and cause \nthe indexer errors.  I also found it best to work with the test workspace on a \nfloppy drive, as this makes it easier to fill the disk without crashing other \nthings (such as your dev environment).",
    "Problem was that on the second merge (i.e. when part of the index was on disk), \nwe got an IOException because of the full disk. However the file numbers in the \nInMemoryIndex had already been updated. So next time we tried to merge (i.e. \nwhen the index manager was idle), we failed with an \nArrayIndexOutOfBoundsException as the \u0027merge\u0027 algorithm expected the file \nnumbers of the InMemoryIndex to start with 1.",
    "*** Bug 5837 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2001-11-14T16:22:16+01:00",
    "2001-11-14T17:14:25+01:00",
    "2001-11-15T11:53:54+01:00",
    "2001-11-21T09:41:16+01:00",
    "2001-11-21T14:50:23+01:00",
    "2001-11-22T15:48:05+01:00",
    "2001-11-29T16:18:07+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "883",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.MergeFactory.mergeFiles",
          "source": "MergeFactory.ja va:136"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.MergeFactory.merge",
          "source": "MergeFactory.java:77 "
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.Index.merge",
          "source": "Index.java:231"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.Index.save",
          "source": "Index.java:340"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndexes",
          "source": "IndexMana ger.java:335"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.indexing.IndexManager.notifyIdle",
          "source": "IndexManag er.java:267"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.processing.JobManager.run",
          "source": "JobManager.java:2 54"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:498"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "5907",
      "date": "2001-11-14T16:22:16+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "1551",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.MergeFactory.mergeFiles",
          "source": "MergeFactory.ja va:136"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.MergeFactory.merge",
          "source": "MergeFactory.java:77 "
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.Index.merge",
          "source": "Index.java:231"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.impl.Index.save",
          "source": "Index.java:340"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndexes",
          "source": "IndexMana ger.java:335"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.indexing.IndexManager.notifyIdle",
          "source": "IndexManag er.java:267"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.processing.JobManager.run",
          "source": "JobManager.java:2 54"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:498"
        }
      ],
      "number": 1,
      "commentIndex": 1,
      "bugId": "5907",
      "date": "2001-11-14T17:14:25+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "5907",
  "bugId": "5907",
  "date": "2001-11-14T16:22:16+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}