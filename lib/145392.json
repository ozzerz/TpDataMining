{
  "comments": [
    "org.eclipse.wst.sse.ui.internal.ExtendedEditorDropTargetAdapter.dragOver(ExtendedEditorDropTargetAdapter)\n\nUsing Quick Edit View to recreate error....\n\u003c\u003c recreation step \u003e\u003e\u003e\n1. open a html or jsp with page designer\n2. bring up quick edit view\n3. move caret in page designer until some javascript events are listed in the left side of QEV\n4. bring up snippet view\n5. drag one item from Snippet view over the right side of QEV\n6. move mouse lower in the script editing window\n     -\u003e DnD mode goes off suddenly !\nDnD fails when you hit the first line after the comment text ( but not if you are on subsequent lines )\n\nPrevious versions would show the \u0027can\u0027t drop here\u0027 feedback.\n\n     -\u003e .log file shows the following SWTError\n\n!ENTRY org.eclipse.ui 4 0 2006-05-30 20:31:59.344\n!MESSAGE Index out of bounds\n!STACK 0\njava.lang.IllegalArgumentException: Index out of bounds\n\tat org.eclipse.swt.SWT.error(SWT.java:3358)\n\tat org.eclipse.swt.SWT.error(SWT.java:3297)\n\tat org.eclipse.swt.SWT.error(SWT.java:3268)\n\tat org.eclipse.swt.custom.StyledText.getLocationAtOffset(StyledText.java:3661)\n\tat org.eclipse.wst.sse.ui.internal.ExtendedEditorDropTargetAdapter.dragOver(ExtendedEditorDropTargetAdapter.java:182)\n\tat org.eclipse.swt.dnd.DNDListener.handleEvent(DNDListener.java:59)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)",
    "Created an attachment (id\u003d44435)\nin-progress patch\n\nAttaching a patch that prevents the IllegalArgumentException from happening.  Although it works fine with visible region support, there remains an issue with the recently added folding support where each folded region causes the drop offset to shift up one line.",
    "Amy, could our drawing of the last line of a folded region be interfering with the widget to model offset conversion?",
    "Maybe.  Dragging and dropping a file from the navigator seems to work fine with folded regions though.  So I\u0027m guessing there is a way to get things working correctly.  I\u0027ll investigate some more.",
    "Amy, everything seems to work fine for me with the patch when I enable folding, as long as I haven\u0027t collapsed any regions.",
    "Created an attachment (id\u003d44458)\norg.eclipse.wst.sse.ui.patch\n\nI believe textViewer.setSelectedRange() which is called in ExtendedEditorDropTargetAdapter#drop() expects you to pass in an offset in relation to the document inside the textViewer.  This is different than the offset you get from getDropOffset(), which seems to give you the offset in relation to the text widget.  The following should get you the correct offset to pass in to setSelectedRange():\nif (textViewer instanceof ITextViewerExtension5) {\n\toffset \u003d ((ITextViewerExtension5) textViewer).widgetOffset2ModelOffset(offset);\n}",
    "I have applied the posted patch and it works like a dream. Since QEV is an intergral part of the RAD web tooling experience and the DND\u0027ing of snipets is a very common user activity I would like WTP to conSider this as a critial fix for 1.5.1",
    "Path applied, thanks, Amy.",
    "verified on wtp 1.5.1 9/23/06 build"
  ],
  "commentCreationDates": [
    "2006-06-05T19:46:08+02:00",
    "2006-06-14T20:08:05+02:00",
    "2006-06-14T21:03:50+02:00",
    "2006-06-14T21:33:09+02:00",
    "2006-06-14T21:36:18+02:00",
    "2006-06-14T23:21:01+02:00",
    "2006-06-19T17:13:36+02:00",
    "2006-07-10T18:49:40+02:00",
    "2006-09-28T17:19:29+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Index out of bounds",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3358"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3297"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3268"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.getLocationAtOffset",
          "source": "StyledText.java:3661"
        },
        {
          "method": "org.eclipse.wst.sse.ui.internal.ExtendedEditorDropTargetAdapter.dragOver",
          "source": "ExtendedEditorDropTargetAdapter.java:182"
        },
        {
          "method": "org.eclipse.swt.dnd.DNDListener.handleEvent",
          "source": "DNDListener.java:59"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "145392",
      "date": "2006-06-05T19:46:08+02:00",
      "product": "Web Tools",
      "component": "wst.sse",
      "severity": "normal"
    }
  ],
  "groupId": "145392",
  "bugId": "145392",
  "date": "2006-06-05T19:46:08+02:00",
  "product": "Web Tools",
  "component": "wst.sse",
  "severity": "normal"
}