{
  "comments": [
    "I\u0027m writing a custom PreferencePage. Part of the PreferencePage is a Composite \nsubclass that has a FormLayout. Opening a PreferenceDialog containing only \nthis PreferencePage results in an error dialog saying \"The currently displayed \npage contains invalid values\" (see attachment #1).\n\nThe code below demonstrates this happening. Note that if you comment out the \nfour lines in the MyComposite constructor, it works OK. It seems that the \nPreferencePage is assuming that GridLayouts are used \"all the way down\" the \nwidget containment hierarchy, which is not true in this case.\n\n\nUsing SWT3.1M4\n\n-----8\u003c------\nimport org.eclipse.jface.preference.PreferenceDialog;\nimport org.eclipse.jface.preference.PreferenceManager;\nimport org.eclipse.jface.preference.PreferenceNode;\nimport org.eclipse.jface.preference.PreferencePage;\nimport org.eclipse.swt.SWT;\nimport org.eclipse.swt.layout.FillLayout;\nimport org.eclipse.swt.layout.FormAttachment;\nimport org.eclipse.swt.layout.FormData;\nimport org.eclipse.swt.layout.FormLayout;\nimport org.eclipse.swt.widgets.Composite;\nimport org.eclipse.swt.widgets.Control;\nimport org.eclipse.swt.widgets.Display;\nimport org.eclipse.swt.widgets.Shell;\nimport org.eclipse.swt.widgets.Text;\n\npublic class PreferenceLayoutBugDemo {\n\n    public static void main(String[] args) {\n        Display display \u003d new Display();\n        Shell shell \u003d new Shell(display);\n\n        PreferenceLayoutBugDemo demo \u003d new PreferenceLayoutBugDemo();\n        PreferenceNode node1 \u003d new PreferenceNode(\"node1\", demo.new \nPreferencePageOne());\n        PreferenceManager mgr \u003d new PreferenceManager();\n        mgr.addToRoot(node1);\n        PreferenceDialog dlg \u003d new PreferenceDialog(shell, mgr);\n        dlg.setBlockOnOpen(true);\n\n        shell.open();\n        dlg.open();\n        while (!shell.isDisposed()) {\n            if (!display.readAndDispatch())\n                display.sleep();\n        }\n        display.dispose();\n    }\n\n    public class PreferencePageOne\n        extends PreferencePage {\n\n        public PreferencePageOne() {\n            super(\"Page One\");\n        }\n\n        protected Control createContents(Composite parent) {\n            Composite contents \u003d new Composite(parent, SWT.NONE);\n            contents.setLayout(new FillLayout());\n            new MyComposite(contents, SWT.NONE);\n            return contents;\n        }\n\n        public boolean isValid() {\n            return true;\n        }\n    }\n\n    public class MyComposite\n        extends Composite {\n\n        public MyComposite(Composite parent, int style) {\n            super(parent, style);\n\n            this.setLayout(new FormLayout());\n\n            Text dateText \u003d new Text(this, SWT.BORDER);\n\n            // Comment out the following four lines and it works.\n            // Otherwise the error \"The currently displayed page contains\n            // invalid values\" appears.\n            FormData dateTextFD \u003d new FormData();\n            dateTextFD.top \u003d new FormAttachment(0);\n            dateTextFD.left \u003d new FormAttachment(0);\n            dateText.setLayoutData(dateText);\n        }\n\n    }\n}\n------8\u003c-----",
    "Created an attachment (id\u003d18155)\nError dialog produced by the test code below\n",
    "Created an attachment (id\u003d18156)\nWhat it looks like when it works (with the problematic four lines commented\nout)\n",
    "Is there anything of note in your log file?",
    "I can\u0027t see any log files in my eclipse installation directory or workspace. \nWhere should the log file be, and is there something special I have to do to \nturn logging on?",
    "It is in the .metadata directory under your install",
    "Found it. There\u0027s nothing in the log file relating to this bug.\nBelow is the stack trace, in case it helps:\n\n----8\u003c----\njava.lang.ClassCastException\n\tat org.eclipse.swt.layout.FormLayout.layout(FormLayout.java:250)\n\tat org.eclipse.swt.layout.FormLayout.computeSize(FormLayout.java:198)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.FillLayout.computeSize(FillLayout.java:110)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.jface.preference.PreferencePage.doComputeSize\n(PreferencePage.java:544)\n\tat org.eclipse.jface.preference.PreferencePage.computeSize\n(PreferencePage.java:332)\n\tat org.eclipse.jface.preference.PreferenceDialog$14.run\n(PreferenceDialog.java:1145)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:616)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:747)\n\tat org.eclipse.jface.preference.PreferenceDialog.showPage\n(PreferenceDialog.java:1139)\n\tat org.eclipse.jface.preference.PreferenceDialog$9.selectionChanged\n(PreferenceDialog.java:628)\n\tat org.eclipse.jface.viewers.StructuredViewer$3.run\n(StructuredViewer.java:681)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:616)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:747)\n\tat org.eclipse.jface.viewers.StructuredViewer.firePostSelectionChanged\n(StructuredViewer.java:679)\n\tat org.eclipse.jface.viewers.StructuredViewer.setSelection\n(StructuredViewer.java:1350)\n\tat org.eclipse.jface.preference.PreferenceDialog.selectSavedItem\n(PreferenceDialog.java:912)\n\tat org.eclipse.jface.preference.PreferenceDialog$3.run\n(PreferenceDialog.java:335)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile\n(BusyIndicator.java:69)\n\tat org.eclipse.jface.preference.PreferenceDialog.createContents\n(PreferenceDialog.java:331)\n\tat org.eclipse.jface.window.Window.create(Window.java:375)\n\tat org.eclipse.jface.dialogs.Dialog.create(Dialog.java:983)\n\tat org.eclipse.jface.window.Window.open(Window.java:685)\n\tat test.PreferenceLayoutBugDemo.main(PreferenceLayoutBugDemo.java:32)\njava.lang.ClassCastException\n\tat org.eclipse.swt.layout.FormLayout.layout(FormLayout.java:250)\n\tat org.eclipse.swt.layout.FormLayout.computeSize(FormLayout.java:198)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.FillLayout.computeSize(FillLayout.java:110)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.jface.preference.PreferenceDialog$PageLayout.computeSize\n(PreferenceDialog.java:95)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:450)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:197)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:207)\n\tat org.eclipse.jface.window.Window.getInitialSize(Window.java:532)\n\tat org.eclipse.jface.window.Window.initializeBounds(Window.java:660)\n\tat org.eclipse.jface.dialogs.Dialog.initializeBounds(Dialog.java:630)\n\tat org.eclipse.jface.window.Window.create(Window.java:379)\n\tat org.eclipse.jface.dialogs.Dialog.create(Dialog.java:983)\n\tat org.eclipse.jface.window.Window.open(Window.java:685)\n\tat test.PreferenceLayoutBugDemo.main(PreferenceLayoutBugDemo.java:32)\n-----8\u003c-----",
    "There are currently no plans to work on this although we would be happy to review a patch"
  ],
  "commentCreationDates": [
    "2005-02-21T23:10:40+01:00",
    "2005-02-21T23:12:07+01:00",
    "2005-02-21T23:14:21+01:00",
    "2005-02-22T17:45:04+01:00",
    "2005-02-22T23:14:18+01:00",
    "2005-02-23T12:48:36+01:00",
    "2005-02-23T23:16:43+01:00",
    "2007-06-14T19:05:51+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "elements": [
        {
          "method": "org.eclipse.swt.layout.FormLayout.layout",
          "source": "FormLayout.java:250"
        },
        {
          "method": "org.eclipse.swt.layout.FormLayout.computeSize",
          "source": "FormLayout.java:198"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.FillLayout.computeSize",
          "source": "FillLayout.java:110"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.jface.preference.PreferencePage.doComputeSize",
          "source": "PreferencePage.java:544"
        },
        {
          "method": "org.eclipse.jface.preference.PreferencePage.computeSize",
          "source": "PreferencePage.java:332"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$14.run",
          "source": "PreferenceDialog.java:1145"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:616"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.showPage",
          "source": "PreferenceDialog.java:1139"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$9.selectionChanged",
          "source": "PreferenceDialog.java:628"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$3.run",
          "source": "StructuredViewer.java:681"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:616"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.firePostSelectionChanged",
          "source": "StructuredViewer.java:679"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.setSelection",
          "source": "StructuredViewer.java:1350"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.selectSavedItem",
          "source": "PreferenceDialog.java:912"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$3.run",
          "source": "PreferenceDialog.java:335"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.createContents",
          "source": "PreferenceDialog.java:331"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:375"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:983"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:685"
        },
        {
          "method": "test.PreferenceLayoutBugDemo.main",
          "source": "PreferenceLayoutBugDemo.java:32"
        }
      ],
      "number": 0,
      "commentIndex": 6,
      "bugId": "86073",
      "date": "2005-02-23T23:16:43+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ClassCastException",
      "elements": [
        {
          "method": "org.eclipse.swt.layout.FormLayout.layout",
          "source": "FormLayout.java:250"
        },
        {
          "method": "org.eclipse.swt.layout.FormLayout.computeSize",
          "source": "FormLayout.java:198"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.FillLayout.computeSize",
          "source": "FillLayout.java:110"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$PageLayout.computeSize",
          "source": "PreferenceDialog.java:95"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:450"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:197"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:207"
        },
        {
          "method": "org.eclipse.jface.window.Window.getInitialSize",
          "source": "Window.java:532"
        },
        {
          "method": "org.eclipse.jface.window.Window.initializeBounds",
          "source": "Window.java:660"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.initializeBounds",
          "source": "Dialog.java:630"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:379"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:983"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:685"
        },
        {
          "method": "test.PreferenceLayoutBugDemo.main",
          "source": "PreferenceLayoutBugDemo.java:32"
        }
      ],
      "number": 1,
      "commentIndex": 6,
      "bugId": "86073",
      "date": "2005-02-23T23:16:43+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "86073",
  "bugId": "86073",
  "date": "2005-02-21T23:10:40+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}