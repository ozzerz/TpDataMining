{
  "comments": [
    "I received a ClassCastException from the following code after applying the patch\nwith bug #93752. The patch removed the cover of the bug.\n\n\nI was attempting to implement wst.server.model.ServerDelegate.getChildModules().\nThe method was called by WTP when user select \"Add/Remove Projects\".\n\nThe ClassCastException occurred on the line \"for (IJ2EEModule mod: ea.getModules()\"\n\n    public IModule[] getChildModules(IModule[] modulePath) {\n        try {\n            IModule module \u003d modulePath[modulePath.length-1];\n            String moduleTypeId \u003d module.getModuleType().getId();\n\n            // return itself for top level module\n\t\t\tIEnterpriseApplication ea \u003d\n(IEnterpriseApplication)module.getAdapter(IEnterpriseApplication.class);\n\t\t\tif (ea!\u003dnull) {\n                ArrayList list \u003d new ArrayList();\n\n                for (IJ2EEModule mod: ea.getModules())\n                    list.add(mod);\n                    return null;\n                }\n            }\n\n\nI believe the problem can be reproduced if you replace GenericServer\u0027s\nequivalent method with mine.\n\n\n------------- stack trace -----------------\n\njava.lang.ClassCastException:\norg.eclipse.wst.common.componentcore.internal.impl.ReferencedComponentImpl\n\tat\norg.eclipse.jst.j2ee.componentcore.util.EARArtifactEdit.getWorkbenchJ2EEModules(EARArtifactEdit.java:389)\n\tat\norg.eclipse.jst.j2ee.internal.deployables.EnterpriseApplicationDeployable.getModules(EnterpriseApplicationDeployable.java:77)\n\tat\ncom.bea.wlw.server.internal.core.WeblogicServer.getChildModules(WeblogicServer.java:400)\n\tat org.eclipse.wst.server.core.internal.Server.getChildModules(Server.java:1546)\n\tat\norg.eclipse.wst.server.ui.internal.wizard.page.ModifyModulesComposite.setServer(ModifyModulesComposite.java:179)\n\tat\norg.eclipse.wst.server.ui.internal.wizard.fragment.ModifyModulesWizardFragment.updateModules(ModifyModulesWizardFragment.java:72)\n\tat\norg.eclipse.wst.server.ui.internal.wizard.fragment.ModifyModulesWizardFragment.enter(ModifyModulesWizardFragment.java:66)\n\tat\norg.eclipse.wst.server.ui.internal.wizard.TaskWizard.switchWizardFragment(TaskWizard.java:298)\n\tat\norg.eclipse.wst.server.ui.internal.wizard.TaskWizardPage.setVisible(TaskWizardPage.java:67)\n\tat org.eclipse.jface.wizard.WizardDialog.showStartingPage(WizardDialog.java:1056)\n\tat org.eclipse.jface.wizard.WizardDialog.createContents(WizardDialog.java:504)\n\tat org.eclipse.jface.window.Window.create(Window.java:418)\n\tat org.eclipse.jface.dialogs.Dialog.create(Dialog.java:996)\n\tat org.eclipse.jface.window.Window.open(Window.java:770)\n\tat\norg.eclipse.wst.server.ui.internal.actions.ModifyModulesAction.run(ModifyModulesAction.java:107)\n\tat org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:246)\n\tat\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:538)\n\tat\norg.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n\tat\norg.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2894)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2527)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1570)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1534)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:306)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:228)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:156)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:315)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:268)\n\tat org.eclipse.core.launcher.Main.run(Main.java:942)\n\tat org.eclipse.core.launcher.Main.main(Main.java:926)",
    "Even with Elson\u0027s patch, I am not able to obtain a sub module under EAR.\n\nI was trying to debug it. But, it turned out to be another catch-22 situation. \n\n    List refComponents \u003d module.getReferencedComponents();\n    for(int i \u003d 0; i \u003c refComponents.size(); i++) {\n        WorkbenchComponent component \n        \u003d (WorkbenchComponent)refComponents.get(i);\n\n\nrefComponents are actually ReferenceComponentImpl, not WorkbenchComponent. And,\nI found no way to travse from ReferenceComponent to WorkbenchComponent.\n",
    "Fixed and released to head. Should be picked up next integration build: \n\nDeveloper assumed dependant WorkbenchComponents were being returned from the\norginal WorkbenchComponent(Ear) instead of ReferecedComponents (EJB,WEB..)\n(earlier design). Now, the ArtifactEdit can derive the dependant\nWorkbenchcomponents from ReferencedComponents. The resulting dependant\nWorkbenchComponents are converted to IModules via the FlexProjectServerUtil- \n\n\tpublic List getWorkbenchJ2EEModules(WorkbenchComponent module) {\n\t\tif\n(module.getComponentType().getComponentTypeId().equals(IModuleConstants.JST_EAR_MODULE))\n{\n\t\t\tList j2eeComponents \u003d new ArrayList();\n\t\t\tList refComponents \u003d module.getReferencedComponents();\n\t\t\tfor (int i \u003d 0; i \u003c refComponents.size(); i++) {\n\t\t\t\tReferencedComponent component \u003d (ReferencedComponent) refComponents.get(i);\n\t\t\t\tStructureEdit moduleCore \u003d null;\n\t\t\t\ttry {\n\t\t\t\t\tURI moduleUri \u003d component.getHandle();\n\t\t\t\t\tIProject project \u003d StructureEdit.getContainingProject(moduleUri);\n\t\t\t\t\tmoduleCore \u003d StructureEdit.getStructureEditForRead(project);\n\t\t\t\t\tWorkbenchComponent wbComponent \u003d moduleCore.findComponentByURI(moduleUri);\n\t\t\t\t\tj2eeComponents.add(wbComponent);\n\t\t\t\t} catch (Exception e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t} finally {\n\t\t\t\t\tif (moduleCore !\u003d null)\n\t\t\t\t\t\tmoduleCore.dispose();\n\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\t\t\treturn j2eeComponents;\n\t\t}\n\t\treturn null;\n\t}\n} ",
    "I tried to update a few plugin to head, but I don\u0027t find FlexProjectUtil.\n\nI updated to I20050510, and didn\u0027t see something like that either.",
    "The ClassCastException is fixed I20050511 as described.\n\nI marked this bug as fixed.\n\n\n\nAs a side note, I still not able to find the utility that give me back IModule.\nA hack of casting IJ2EEMoudle to a ModuleDelegate and getModule() workaround my\nneed for now.",
    "Thomas the name of the util is FlexibleProjectServerUtil. As stated in the\nwtpdev note the ear deployable (getJ2EEModules(...)) uses this.",
    "Verified by code review.",
    "Closing already verified defects"
  ],
  "commentCreationDates": [
    "2005-05-05T04:00:14+02:00",
    "2005-05-06T04:58:08+02:00",
    "2005-05-09T17:21:46+02:00",
    "2005-05-10T23:56:34+02:00",
    "2005-05-11T03:53:25+02:00",
    "2005-05-11T14:55:56+02:00",
    "2005-07-12T01:15:31+02:00",
    "2005-07-26T20:02:22+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.wst.common.componentcore.internal.impl.ReferencedComponentImpl",
      "elements": [
        {
          "method": "org.eclipse.jst.j2ee.componentcore.util.EARArtifactEdit.getWorkbenchJ2EEModules",
          "source": "EARArtifactEdit.java:389"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.deployables.EnterpriseApplicationDeployable.getModules",
          "source": "EnterpriseApplicationDeployable.java:77"
        },
        {
          "method": "com.bea.wlw.server.internal.core.WeblogicServer.getChildModules",
          "source": "WeblogicServer.java:400"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.getChildModules",
          "source": "Server.java:1546"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.wizard.page.ModifyModulesComposite.setServer",
          "source": "ModifyModulesComposite.java:179"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.wizard.fragment.ModifyModulesWizardFragment.updateModules",
          "source": "ModifyModulesWizardFragment.java:72"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.wizard.fragment.ModifyModulesWizardFragment.enter",
          "source": "ModifyModulesWizardFragment.java:66"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.wizard.TaskWizard.switchWizardFragment",
          "source": "TaskWizard.java:298"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.wizard.TaskWizardPage.setVisible",
          "source": "TaskWizardPage.java:67"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.showStartingPage",
          "source": "WizardDialog.java:1056"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.createContents",
          "source": "WizardDialog.java:504"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:418"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:996"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:770"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.actions.ModifyModulesAction.run",
          "source": "ModifyModulesAction.java:107"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:246"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:538"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:400"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:842"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2894"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2527"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1570"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1534"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:306"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:228"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:344"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:156"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:315"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:268"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:942"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:926"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "93753",
      "date": "2005-05-05T04:00:14+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "normal"
    }
  ],
  "groupId": "93753",
  "bugId": "93753",
  "date": "2005-05-05T04:00:14+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "normal"
}