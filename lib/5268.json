{
  "comments": [
    "PRODUCT VERSION:\n203\n\nDESCRIPTION:\nI did a copy to clipboard operation in the SwtStyledTextUseCase when I got\nthe exception shown below. \n\njava.lang.VerifyError: (class: org/eclipse/swt/custom/StyledText$RTFWriter, \nmethod: write signature: (Ljava/lang/String;II)V) Inconsistent stack height 1 !\n\u003d 0\n\tat org.eclipse.swt.custom.StyledText.copy(StyledText.java:1169)\n\tat org.eclipse.swt.custom.StyledText.invokeAction(StyledText.java:4613)\n\tat org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:4297)\n\tat org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:4267)\n\tat org.eclipse.swt.custom.StyledText$8.handleEvent(StyledText.java:3989)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:54)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:645)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1359)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1160)\n\tat org.eclipse.swt.examples.exampleframework.SwtExample.run\n(SwtExample.java:186)\n\tat org.eclipse.swt.examples.tests.SwtStyledTextUseCase.main\n(SwtStyledTextUseCase.java:631)\nException in thread \"main\" \n\nNOTES:\n\nThe bytecodes for the guilty method are:\nMethod void write(java.lang.String, int, int)\n   0 iload_2\t\t\t\u003d\u003e stack height \u003d 1\n   1 istore 4 \t\t\t\u003d\u003e stack height \u003d 0\n   3 goto 41\t\t\t\u003d\u003e stack height \u003d 0\n   6 aload_1\t\t\t\u003d\u003e stack height \u003d 1\n   7 iload 4\t\t\t\u003d\u003e stack height \u003d 2\n   9 invokevirtual #224 \u003cMethod char charAt(int)\u003e\t\t\t\u003d\u003e \nstack height \u003d 1\n  12 istore 5\t\t\t\u003d\u003e stack height \u003d 0\n  14 iload 5\t\t\t\u003d\u003e stack height \u003d 1\n  16 bipush 125\t\t\t\u003d\u003e stack height \u003d 2\n  18 if_icmpeq 47\t\t\t\u003d\u003e stack height \u003d 0\n  21 iload 5\t\t\t\u003d\u003e stack height \u003d 1\n  23 bipush 123\t\t\t\u003d\u003e stack height \u003d 2\n  25 if_icmpeq 47\t\t\t\u003d\u003e stack height \u003d 0\n  28 iload 5\t\t\t\u003d\u003e stack height \u003d 1\n  30 bipush 92\t\t\t\u003d\u003e stack height \u003d 2\n  32 if_icmpne 38\t\t\t\u003d\u003e stack height \u003d 0\n  35 goto 47\t\t\t\u003d\u003e stack height \u003d 0\n  38 iinc 4 1\t\t\t\u003d\u003e stack height \u003d 0\n  41 iload 4\t\t\t\u003d\u003e stack height \u003d 1\n  43 iload_3\t\t\t\u003d\u003e stack height \u003d 2\n  44 if_icmplt 6\t\t\t\u003d\u003e stack height \u003d 0\n  47 iload 4\t\t\t\u003d\u003e stack height \u003d 1\n  49 iload_3\t\t\t\u003d\u003e stack height \u003d 2\n  50 if_icmpne 66\t\t\t\u003d\u003e stack height \u003d 0\n  53 aload_0\t\t\t\u003d\u003e stack height \u003d 1\n  54 aload_1\t\t\t\u003d\u003e stack height \u003d 2\n  55 iload_2\t\t\t\u003d\u003e stack height \u003d 3\n  56 iload_3\t\t\t\u003d\u003e stack height \u003d 4\n  57 invokevirtual #122 \u003cMethod java.lang.String substring(int, int)\u003e\t\t\n\t\u003d\u003e stack height \u003d 2\n  60 invokevirtual #63 \u003cMethod void write(java.lang.String)\u003e\t\t\n\t\u003d\u003e stack height \u003d 0\n  63 goto 154\t\t\t\u003d\u003e stack height \u003d 0\n  66 iload_3\t\t\t\u003d\u003e stack height \u003d 1\n  67 iload_2\t\t\t\u003d\u003e stack height \u003d 2\n  68 isub\t\t\t\u003d\u003e stack height \u003d 1\n  69 newarray char\t\t\t\u003d\u003e stack height \u003d 1\n  71 astore 5\t\t\t\u003d\u003e stack height \u003d 0\n  73 aload_1\t\t\t\u003d\u003e stack height \u003d 1\n  74 iload_2\t\t\t\u003d\u003e stack height \u003d 2\n  75 iload_3\t\t\t\u003d\u003e stack height \u003d 3\n  76 aload 5\t\t\t\u003d\u003e stack height \u003d 4\n  78 iconst_0\t\t\t\u003d\u003e stack height \u003d 5\n  79 invokevirtual #228 \u003cMethod void getChars(int, int, char[], int)\u003e\t\t\n\t\u003d\u003e stack height \u003d 0\n  82 iconst_0\t\t\t\u003d\u003e stack height \u003d 1\n  83 istore 4\t\t\t\u003d\u003e stack height \u003d 0\n  85 goto 146\t\t\t\u003d\u003e stack height \u003d 0\n  88 aload 5\t\t\t\u003d\u003e stack height \u003d 1\n  90 iload 4\t\t\t\u003d\u003e stack height \u003d 2\n  92 caload\t\t\t\u003d\u003e stack height \u003d 1\n  93 lookupswitch 3: default\u003d134\t\t\t\u003d\u003e stack height \u003d 0\n\t   92: 128\n\t  123: 128\n\t  125: 93\n 128 aload_0\t\t\t\u003d\u003e stack height \u003d 1\n 129 ldc #230 \u003cString \"\\\"\u003e\t\t\t\u003d\u003e stack height \u003d 2\n 131 invokevirtual #63 \u003cMethod void write(java.lang.String)\u003e\t\t\n\t\u003d\u003e stack height \u003d 0\n 134 aload_0\t\t\t\u003d\u003e stack height \u003d 1\n 135 aload 5\t\t\t\u003d\u003e stack height \u003d 2\n 137 iload 4\t\t\t\u003d\u003e stack height \u003d 3\n 139 caload\t\t\t\u003d\u003e stack height \u003d 2\n 140 invokevirtual #233 \u003cMethod void write(char)\u003e\t\t\t\u003d\u003e \nstack height \u003d 0\n 143 iinc 4 1\t\t\t\u003d\u003e stack height \u003d 0\n 146 iload 4\t\t\t\u003d\u003e stack height \u003d 1\n 148 aload 5\t\t\t\u003d\u003e stack height \u003d 2\n 150 arraylength\t\t\t\u003d\u003e stack height \u003d 2\n 151 if_icmplt 88\t\t\t\u003d\u003e stack height \u003d 0\n 154 return\t\t\t\u003d\u003e stack height \u003d 0\n\n\tThe jump 93 inside the lookupswitch is wrong. It should be 128 like \nthe others.\n\n\tThis is really weird. I use the jdtcore.jar from the 203 build to \nrecompile the source you provided with the workspace and I could get the same \nbytecodes. I have:\n  93 lookupswitch 3: default\u003d134\t\t\t\u003d\u003e stack height \u003d 0\n\t   92: 128\n\t  123: 128\n\t  125: 128\n\tWhich is the expected answer.\n\tIf I recompile the project org.eclipse.swt doing a full build, I can \nreproduce the problem. If I take all the sources according to the classpath and \nuse a batch compilation, I don\u0027t\n\tget it. I need to find out a reproducable test case that I can debug.\n\nOT (10/10/2001 6:51:00 PM)\n\tAfter looking at the problem, I suspect a resize of the code stream \nbyte array to be responsible of this problem. The last offset for the case \nlabel is offsetted by one\n\tcompare to its right position.\n\nOT (10/10/2001 7:20:30 PM)\n\tThe method writeSignedWord was wrong. If a resize of the byte array \nwas necessary while writing one of these four bytes, the byte was actually \nwritten offsetted by one, because the currentOffset was already incremented. \ncurrentOffset - 1 is the right position. So according to the size of the byte \narray when the StyledText class is compiled, we can hit or not the problem. \n\tReleased in HEAD 2.0",
    "Fixed and backported to 1.0 patch",
    "Fixed in 1.0 Rollup 139"
  ],
  "commentCreationDates": [
    "2001-10-26T01:04:40+02:00",
    "2001-10-26T13:04:23+02:00",
    "2001-12-05T11:28:48+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.VerifyError",
      "message": "(class: org/eclipse/swt/custom/StyledText$RTFWriter,  method: write signature: (Ljava/lang/String;II)V) Inconsistent stack height 1 ! \u003d 0",
      "elements": [
        {
          "method": "org.eclipse.swt.custom.StyledText.copy",
          "source": "StyledText.java:1169"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.invokeAction",
          "source": "StyledText.java:4613"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKey",
          "source": "StyledText.java:4297"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKeyDown",
          "source": "StyledText.java:4267"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$8.handleEvent",
          "source": "StyledText.java:3989"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:54"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:645"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1359"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1160"
        },
        {
          "method": "org.eclipse.swt.examples.exampleframework.SwtExample.run",
          "source": "SwtExample.java:186"
        },
        {
          "method": "org.eclipse.swt.examples.tests.SwtStyledTextUseCase.main",
          "source": "SwtStyledTextUseCase.java:631"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "5268",
      "date": "2001-10-26T01:04:40+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "5268",
  "bugId": "5268",
  "date": "2001-10-26T01:04:40+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}