{
  "comments": [
    "I performed a Search\u003eFile of a project and chose to Replace text that I knew \nappeared in multiple files. The desired behavior is for the operation to \ninvoke validate edit once with all files involved and to provide a UI context \nfor promting. The ReplaceDialog2 calls validate edit separately for each file \nand does not provide a UI context.",
    "I don\u0027t really understand the functioning of validateEdit(...) then. My\nassumption was that, since validateEdit() might involve server roundtrips etc.\nthat we shouldn\u0027t call it unless we\u0027re pretty sure we\u0027re going to change the\nfile. If the intent is that validateEdit() should be called earlier, I didn\u0027t\nget the idea from the javadoc.\nSame thing for the UI context. The javadoc reads like it\u0027s really up to the\nclient to decide wether to pass in a UI context. If there is a preference for\nhaving a UI context, we should state it.\n\nDo you just object to the current behaviour on principle or do you have a\nscenario where the current behaviour is bad? If so, could you please provide\nsteps? (I\u0027m trying to assess the severity of this bug).",
    "Comments:\n\n- we should only validateEdit those files for which we are sure that we are\n  modifying them. That means\n  o replacing text file by file validateEdit should be called on a file per\n    file basis\n  o replace in all files. We should validate all files upfront. \n\n- if possible we should pass in a shell to allow repository providers to show\n  a dialog. \n\nPlease note that when we pass in a shell we have to make sure that in the \nreplace all files case we call validateEdit with all files to be modified. \nOtherwise the user will get a separate dialog for each file to validate.",
    "Michael, can you propose a scenario to test this? Something that would exercise\nthe thing with CVS?",
    "Sure, try the following:\n\n1) On the Team\u003eCVS\u003eWatch/Edit preference page, enable Watch/Edit and \nselect \"Always Prompt\".\n2) Check out the org.eclipse.releng plugin from dev.eclipse.org\n3) Perform a File search on the project and enter \"Eclipse\" as the text and \nclick Replace...\n4) Enter the new text and click Repalce All\n\nThe expected behavior is that the replace would result in one prompt to \nperform a \"cvs edit\" on the files being changed.",
    "Created an attachment (id\u003d12155)\nPatch to validateEdit once for \"replace all\"\n",
    "Note that the above patch has a workaround for bug 67253 (marked in a comment). ",
    "Approved by Erich \u0026 Dirk",
    "Released the patch without the workaround. Reviewed by martin aeschlimann.",
    "A vetoing of the file modification results in an entry in th elog file:\n\norg.eclipse.core.runtime.CoreException: User vetoed file modification\nat org.eclipse.search.internal.ui.text.ReplaceDialog2.replaceAll\n(ReplaceDialog2.java:391)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2.access$4\n(ReplaceDialog2.java:387)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2$4.doReplace\n(ReplaceDialog2.java:331)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2$ReplaceOperation.run\n(ReplaceDialog2.java:98)\nat org.eclipse.jface.operation.ModalContext.runInCurrentThread\n(ModalContext.java:303)\nat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:253)\nat org.eclipse.search.internal.ui.util.ExtendedDialogWindow.run\n(ExtendedDialogWindow.java:185)\nat org.eclipse.ui.internal.progress.ProgressManager$5.run\n(ProgressManager.java:991)\nat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\nat org.eclipse.ui.internal.progress.ProgressManager.runInUI\n(ProgressManager.java:987)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2.run\n(ReplaceDialog2.java:367)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2.buttonPressed\n(ReplaceDialog2.java:329)\nat org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:506)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:89)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:796)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2732)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2398)\nat org.eclipse.jface.window.Window.runEventLoop(Window.java:668)\nat org.eclipse.jface.window.Window.open(Window.java:648)\nat org.eclipse.search.internal.ui.text.ReplaceDialog2.open\n(ReplaceDialog2.java:180)\nat org.eclipse.search.internal.ui.text.ReplaceAction2.run\n(ReplaceAction2.java:152)\nat org.eclipse.jface.action.Action.runWithEvent(Action.java:881)\nat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection\n(ActionContributionItem.java:915)\nat org.eclipse.jface.action.ActionContributionItem.access$2\n(ActionContributionItem.java:866)\nat org.eclipse.jface.action.ActionContributionItem$7.handleEvent\n(ActionContributionItem.java:785)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:796)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2732)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2398)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1375)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1346)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:252)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:141)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:96)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:335)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:272)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:128)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:324)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:186)\nat org.eclipse.core.launcher.Main.run(Main.java:647)\nat org.eclipse.core.launcher.Main.main(Main.java:631)\n\n\nThis is totally strange. ",
    "We\u0027re treating the \"Veto\" case as an error. Our default error handing routine \nlogs it. Can you recommend a way we can check that the IStatus we\u0027re getting \nback is a \"Veto\" (in the general case).",
    "start verifying",
    "I still see the error in .log.\n\n\u003eCan you recommend a way we can check that the IStatus we\u0027re getting \n\u003eback is a \"Veto\" (in the general case).\n\u003d\u003d\u003e status.getSeverity() \u003d\u003d IStatus.CANCEL\n",
    "It did some further testing and here is what\u0027s happending:\n\n- if the operation gets canceled, no dialog pops up and an entry is generated\n  in the log. The replace dialog stays open, which is correct. So the bad thing\n  here is the entry in the log.\n\n- if an error occurs during validate edit a dialog is shown and an entry is\n  generated in the log.\n\nBottom line: PR is fixed, but we have unnecessary entries in the log in error/\ncancel situations. Opened PR 68007"
  ],
  "commentCreationDates": [
    "2004-06-14T21:57:52+02:00",
    "2004-06-15T10:01:28+02:00",
    "2004-06-15T11:13:14+02:00",
    "2004-06-15T15:49:50+02:00",
    "2004-06-15T15:56:51+02:00",
    "2004-06-15T17:02:32+02:00",
    "2004-06-15T17:03:24+02:00",
    "2004-06-16T15:04:04+02:00",
    "2004-06-17T12:52:13+02:00",
    "2004-06-19T13:26:01+02:00",
    "2004-06-20T13:28:40+02:00",
    "2004-06-21T10:27:47+02:00",
    "2004-06-21T11:04:45+02:00",
    "2004-06-21T17:08:45+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.core.runtime.CoreException",
      "message": "User vetoed file modification",
      "elements": [
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2.replaceAll",
          "source": "ReplaceDialog2.java:391"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2.access$4",
          "source": "ReplaceDialog2.java:387"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2$4.doReplace",
          "source": "ReplaceDialog2.java:331"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2$ReplaceOperation.run",
          "source": "ReplaceDialog2.java:98"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.runInCurrentThread",
          "source": "ModalContext.java:303"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:253"
        },
        {
          "method": "org.eclipse.search.internal.ui.util.ExtendedDialogWindow.run",
          "source": "ExtendedDialogWindow.java:185"
        },
        {
          "method": "org.eclipse.ui.internal.progress.ProgressManager$5.run",
          "source": "ProgressManager.java:991"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ui.internal.progress.ProgressManager.runInUI",
          "source": "ProgressManager.java:987"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2.run",
          "source": "ReplaceDialog2.java:367"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2.buttonPressed",
          "source": "ReplaceDialog2.java:329"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog$2.widgetSelected",
          "source": "Dialog.java:506"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:796"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2732"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2398"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:668"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:648"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceDialog2.open",
          "source": "ReplaceDialog2.java:180"
        },
        {
          "method": "org.eclipse.search.internal.ui.text.ReplaceAction2.run",
          "source": "ReplaceAction2.java:152"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:881"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:915"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:866"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$7.handleEvent",
          "source": "ActionContributionItem.java:785"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:796"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2732"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2398"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1375"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1346"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:252"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:141"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:96"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:335"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:272"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:128"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:186"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:647"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:631"
        }
      ],
      "number": 0,
      "commentIndex": 9,
      "bugId": "67109",
      "date": "2004-06-19T13:26:01+02:00",
      "product": "Platform",
      "component": "Search",
      "severity": "normal"
    }
  ],
  "groupId": "67109",
  "bugId": "67109",
  "date": "2004-06-14T21:57:52+02:00",
  "product": "Platform",
  "component": "Search",
  "severity": "normal"
}