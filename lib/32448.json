{
  "comments": [
    "Hi,\n  I had written my own custom task - which does a stylesheet transformation \nusing Saxon. I do not wish to use the default ones (I think its Xalan). So I \nfirst tested my ant script from the command line, and it works fine. But when I \nattempted to run it the tool, it says (every time) :\nBUILD FAILED: javax.xml.transform.TransformerFactoryConfigurationError: \nProvider net.sf.saxon.TransformerFactoryImpl not found\n\nNow, my code is using System.setProperty() to define the SAX transformer \nfactory. I have ensured that saxon.jar is in the runtime classpath - I also put \nit in the additional classpath and project classpath, but none of them worked.\n\nThe interesting side effect was, previous transformations that didn\u0027t use Saxon \nalso stopped working, and I started getting this error:\n       [style] DEPRECATED - xslp processor is deprecated. Use trax or xalan \ninstead.\n       [style] java.lang.NoClassDefFoundError: com/kvisco/xsl/XSLProcessor\n       [style] \tat org.apache.tools.ant.taskdefs.optional.XslpLiaison.\u003cinit\u003e\n(XslpLiaison.java:80)\n       [style] \tat sun.reflect.NativeConstructorAccessorImpl.newInstance0\n(Native Method)\n       [style] \tat sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n       [style] \tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n       [style] \tat java.lang.reflect.Constructor.newInstance\n(Constructor.java:274)\n       [style] \tat java.lang.Class.newInstance0(Class.java:306)\n       [style] \tat java.lang.Class.newInstance(Class.java:259)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.resolveProcessor\n(XSLTProcess.java:376)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.getLiaison\n(XSLTProcess.java:557)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.execute\n(XSLTProcess.java:195)\n       [style] \tat org.apache.tools.ant.Task.perform(Task.java:319)\n       [style] \tat org.apache.tools.ant.Target.execute(Target.java:309)\n       [style] \tat org.apache.tools.ant.Target.performTasks(Target.java:336)\n       [style] \tat org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n       [style] \tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run\n(InternalAntRunner.java:535)\n       [style] \tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run\n(InternalAntRunner.java:336)\n       [style] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n       [style] \tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n       [style] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n       [style] \tat java.lang.reflect.Method.invoke(Method.java:324)\n       [style] \tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:309)\n       [style] \tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:382)\n       [style] \tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchDelegate\n$1.run(AntLaunchDelegate.java:154)\n       [style] \tat java.lang.Thread.run(Thread.java:536)\n       [style] java.lang.NoClassDefFoundError: \norg/apache/xalan/xslt/XSLTProcessorFactory\n       [style] \tat org.apache.tools.ant.taskdefs.optional.XalanLiaison.\u003cinit\u003e\n(XalanLiaison.java:84)\n       [style] \tat sun.reflect.NativeConstructorAccessorImpl.newInstance0\n(Native Method)\n       [style] \tat sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n       [style] \tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n       [style] \tat java.lang.reflect.Constructor.newInstance\n(Constructor.java:274)\n       [style] \tat java.lang.Class.newInstance0(Class.java:306)\n       [style] \tat java.lang.Class.newInstance(Class.java:259)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.resolveProcessor\n(XSLTProcess.java:379)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.getLiaison\n(XSLTProcess.java:554)\n       [style] \tat org.apache.tools.ant.taskdefs.XSLTProcess.execute\n(XSLTProcess.java:195)\n       [style] \tat org.apache.tools.ant.Task.perform(Task.java:319)\n       [style] \tat org.apache.tools.ant.Target.execute(Target.java:309)\n       [style] \tat org.apache.tools.ant.Target.performTasks(Target.java:336)\n       [style] \tat org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n       [style] \tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run\n(InternalAntRunner.java:535)\n       [style] \tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run\n(InternalAntRunner.java:336)\n       [style] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n       [style] \tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n       [style] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n       [style] \tat java.lang.reflect.Method.invoke(Method.java:324)\n       [style] \tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:309)\n       [style] \tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:382)\n       [style] \tat \norg.eclipse.ui.externaltools.internal.ant.launchConfigurations.AntLaunchDelegate\n$1.run(AntLaunchDelegate.java:154)\n       [style] \tat java.lang.Thread.run(Thread.java:536)\n       [style] BUILD FAILED: \nfile:c:/data/dev/eclipse_workspace/ActivityCatalogGenerator/build.xml:20: \njavax.xml.transform.TransformerFactoryConfigurationError: Provider \nnet.sf.saxon.TransformerFactoryImpl not found\n\nI tried rolling back, took out everything related to my custom task, but \nstrangely this kept happening.\n\nThis looks like a bug..\n\nRegards,\nSomik",
    "Is it possible to attach the build file?",
    "Here is my build file:\n\n\u003cproject name\u003d\"ProductData\" default\u003d\"makeAllIndexes\" basedir\u003d\".\"\u003e\n\n  \u003c!-- set global properties for this build --\u003e\n  \u003cproperty name\u003d\"html\" value\u003d\"catalogs\"/\u003e\n  \u003cproperty name\u003d\"xml\" value\u003d\"src/data\"/\u003e\n  \u003cproperty name\u003d\"xsl\" value\u003d\"src/stylesheets\"/\u003e\n  \u003ctaskdef name\u003d\"buildActivityCatalog\" \nclassname\u003d\"com.industriallogic.ant.ActivityCatalogBuilder\"/\u003e\n\n  \u003ctarget name\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"*  Initializing.....             *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n  \u003c/target\u003e\n    \n  \u003ctarget name\u003d\"createWorkshopIndex\" depends\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"* Creating Workshop Index        *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e  \t\n\t\u003cstyle  in\u003d\"${xml}/catalogs/workshopCatalog.xml\" \nout\u003d\"${html}/workshops/index.html\"\n       style\u003d\"${xsl}/workshopCatalogIndexBuilder.xsl\"\u003e\t  \t  \n\t\t\n\t\u003c/style\u003e\n  \u003c/target\u003e\n  \n  \u003ctarget name\u003d\"createActivityIndex\" depends\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"* Creating Activity Index        *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e  \t\n\t\u003cstyle  in\u003d\"${xml}/catalogs/activityCatalog.xml\" \nout\u003d\"${html}/activities/index.html\"\n       style\u003d\"${xsl}/activityCatalogIndexBuilder.xsl\"\u003e\t  \t  \n\t\t\n\t\u003c/style\u003e\n  \u003c/target\u003e\n\n  \u003ctarget name\u003d\"createExperienceIndex\" depends\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"* Creating Experience Index        *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e  \t\n\t\u003cstyle  in\u003d\"${xml}/catalogs/experienceCatalog.xml\" \nout\u003d\"${html}/experiences/index.html\"\n       style\u003d\"${xsl}/workshopCatalogIndexBuilder.xsl\"\u003e\t  \t  \n\t\t\n\t\t\u003cparam name\u003d\"dataDirectory\" expression\u003d\"../data/experiences/\"/\u003e\n  \t\n\t\u003c/style\u003e\n  \u003c/target\u003e\n  \n\n  \u003ctarget name\u003d\"createActivityCatalog\" depends\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"* Creating Activity Catalog      *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e  \t\n\n\t\u003cbuildActivityCatalog \n\t\tactivityDataDir\u003d\"${xml}/activities\" \n\t\tactivityCatalogDir\u003d\"${html}/activities\"\n\t\tstyle\u003d\"${xsl}/activityCatalogHtmlBuilder.xsl\"\n\t/\u003e\n  \u003c/target\u003e\n\n  \u003ctarget name\u003d\"makeAllIndexes\" \ndepends\u003d\"createActivityCatalog,createWorkshopIndex,createActivityIndex,createExp\nerienceIndex\"/\u003e\n  \n\u003c/project\u003e",
    "Hi,\n I found a pattern to this bug. When I ran the other tasks this morning, it \nworked fine. But when I ran my custom task, which changes the System property \nto net.sf.saxon.TransformerFactoryImpl, all the other tasks started to look for \nthis. Which is actually not a bad idea, since I\u0027d like to use Saxon throughout. \nBut you might consider changing the system property to a default one upon \nlaunching...\n\n  But anyway, the bug still remains - being able to use Saxon for \ntransformations.\n\nRegards\nSomik\n  ",
    "I would say your custom task should restore the system property. Remember that \nAnt within Eclipse runs in the same VM as Eclipse. Once you have set that \nsystem property you could be causing unknown side effects for the remaining \ntime of that Eclipse session.\n\nThat said have you tried setting the classpath attribute for the style task to \ninclude the saxon.jar? \nWhen building from the commandline have you put the Saxon jar in the \nant_home/lib directory? Likely the style task is inheriting the ant runtime \nclasspath which would include this JAR when running from the commandline.",
    "I tried setting the classpath attribute, and the processor.\n\n  \u003cproperty name\u003d\"xsltClasspath\" value\u003d\"saxon7.jar\"/\u003e\n\n  \u003ctarget name\u003d\"createActivityIndex\" depends\u003d\"init\"\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e\n\t\u003cecho message\u003d\"* Creating Activity Index        *\"/\u003e\n\t\u003cecho message\u003d\"**********************************\"/\u003e  \t\n\t\u003cstyle  in\u003d\"${xml}/catalogs/activityCatalog.xml\" \nout\u003d\"${html}/activities/index.html\"\n       classpath\u003d\"${xsltClasspath}\"\n       processor\u003d\"trax\"\n       style\u003d\"${xsl}/activityCatalogIndexBuilder.xsl\"\u003e\t  \t  \n\t\t\n\t\u003c/style\u003e\n  \u003c/target\u003e\n\nBut that still gives the same error, if run after the custom task. The file \nsaxon7.jar is located in the ant/lib directory. It works if I restart Eclipse - \nso I think its still not taking the classpath correctly..\n\nFor the custom task, I tried stuff a bit differently. I am passing in the \nclasspath, and using it to instantiate a TransformerFactoryImpl, and passing \nthis to create the transformer. This seems to work, except that, if a \nstylesheet refers to another stylesheet, then the path to get to the referenced \nstylesheet is totally messed up.\n\ne.g. my stylesheet refers to :\n\t\u003cxsl:import href\u003d\"src/stylesheets/common.xsl\"/\u003e\nThis is within the eclipse project directory. However, on running the ant task, \nthe path being searched becomes :\nC:\\eclipse\\src\\stylesheets\\common.xsl\n\nThe base directory seems to change from the eclipse project workspace to the \neclipse installation location. I confirmed again, that all of this continues to \nrun fine from the command line.\n\nRegards,\nSomik\n\n",
    "When running Ant within Eclipse you are running in the same VM that started \nEclipse. Therefore basedir \".\" will be Eclipse install location.\nYou can set the basedir explictly on the Main tab of the Ant launch \nconfiguration for your build or modify your script accordingly.",
    "I tried that as well, with the directory set to:\n${resource_loc:/ActivityCatalogGenerator}\n\nfor Working Directory, but that didnt cause any change, the referenced \nstylesheet is still being looked for in the eclipse install directory.\n\nAlso tried absolute path, and that didnt work either.\n\nRegards,\nSomik\n",
    "Did you try setting the basedir attribute on the style task?",
    "I am setting the base directory in my custom task . In my execute(), I have \nthis code:\n\tFile stylesheet \u003d fileUtils.resolveFile(baseDir, style);\n\t\t\nThis resolves the first stylesheet. However, resolving any referenced \nstylesheets are not in this program\u0027s control - that happens automatically I \nguess.\n\nRegards,\nSomik",
    "I am running into similar problems both with \u0027Additional Classpath Entries\u0027 in\nmy ant launch config and with base path setting. Seeing this on the following\nEclipse  version:\nVersion: 2.1.0\nBuild id: 200303272130\n\nHere\u0027s a snip from a question I just posted on the eclipse.tools newsgroup:\n\n\u003csnip\u003e\nI am having difficulty running an existing project\u0027s ant build script from\nwithin Eclipse.\n\n1. One of the build targets (javac) used to rely on system CLASSPATH\nentries to be present. My eclipse launch does not get that CLASSPATH env\nvariable. I sought to simulate those entries by adding the required\nCLASSPATH entries manually to my ant launch config\u0027s \u0027Additional Classpath\nEntries\u0027. Unfortunately, my javac task still complains of missing symbols\nand packages which I know are defined in jars I added.\n\n2. Another build target reads in a file from a location relative to my\nproject base directory. I went into my ant launch configuration and set\nthe \u0027Base Directory\u0027 to ${workspace_loc:/MyProject}, where \u0027MyProject\u0027 is\nthe name of my project. My File reads continue to fail with an IOException\nsaying that the file cannot be found. The attempted file location printed\nin the IOException does not have the project\u0027s base path that I configured\nin my ant launch config.\n\u003c/snip\u003e\n\n#2 above is actually a custom ant task. I modified its code to print the\n\u0027user.dir\u0027 system property. I get the eclipse install\u0027s base directory, not the\ndirectory I configured.",
    "As I indicated on the newsgroup, likely the mechanism to make this work is to \nlaunch Ant in a separate VM. We are weak on support for this currently.\nSee bug 24129 for the planned feature details.",
    "Somik, are you still having trouble here?\nHave you been able to try the support for running Ant in a separate VM?",
    "With nothing further from the reporter marking as worksforme with the support \nin 3.0 to launch in a separate vm."
  ],
  "commentCreationDates": [
    "2003-02-21T03:06:32+01:00",
    "2003-02-21T13:36:38+01:00",
    "2003-02-21T17:01:39+01:00",
    "2003-02-21T17:34:53+01:00",
    "2003-02-21T18:05:17+01:00",
    "2003-02-21T19:06:52+01:00",
    "2003-02-21T19:23:26+01:00",
    "2003-02-21T19:34:04+01:00",
    "2003-02-25T20:37:14+01:00",
    "2003-02-25T21:10:50+01:00",
    "2003-04-15T19:42:05+02:00",
    "2003-04-15T19:44:59+02:00",
    "2003-06-02T23:18:41+02:00",
    "2003-08-06T23:28:18+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "com/kvisco/xsl/XSLProcessor        [style]",
      "elements": [
        {
          "method": "org.apache.tools.ant.taskdefs.optional.XslpLiaison.\u003cinit\u003e",
          "source": "XslpLiaison.java:80"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "32448",
      "date": "2003-02-21T03:06:32+01:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org/apache/xalan/xslt/XSLTProcessorFactory        [style]",
      "elements": [
        {
          "method": "org.apache.tools.ant.taskdefs.optional.XalanLiaison.\u003cinit\u003e",
          "source": "XalanLiaison.java:84"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "32448",
      "date": "2003-02-21T03:06:32+01:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    }
  ],
  "groupId": "32448",
  "bugId": "32448",
  "date": "2003-02-21T03:06:32+01:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "normal"
}