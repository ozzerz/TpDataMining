{
  "comments": [
    "Eclipse 3.1 M4, Web Tools plug-ins from 20.12.2004:\n\nThe following exception was logged:\n\njava.lang.ClassCastException:\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument\nat\norg.eclipse.ant.internal.ui.editor.text.AntEditorDocumentProvider.disposeFileInfo(AntEditorDocumentProvider.java:129)\nat\norg.eclipse.ui.editors.text.TextFileDocumentProvider.disconnect(TextFileDocumentProvider.java:583)\nat\norg.eclipse.ui.texteditor.AbstractTextEditor.disposeDocumentProvider(AbstractTextEditor.java:3125)\nat\norg.eclipse.ui.texteditor.AbstractDecoratedTextEditor.disposeDocumentProvider(AbstractDecoratedTextEditor.java:1202)\nat\norg.eclipse.ui.texteditor.AbstractTextEditor.dispose(AbstractTextEditor.java:3044)\nat\norg.eclipse.ui.texteditor.AbstractDecoratedTextEditor.dispose(AbstractDecoratedTextEditor.java:232)\nat org.eclipse.ui.editors.text.TextEditor.dispose(TextEditor.java:101)\nat org.eclipse.ant.internal.ui.editor.AntEditor.dispose(AntEditor.java:844)\nat\norg.eclipse.ui.internal.WorkbenchPartReference.dispose(WorkbenchPartReference.java:404)\nat org.eclipse.ui.internal.EditorManager$Editor.dispose(EditorManager.java:1557)\nat org.eclipse.ui.internal.WorkbenchPage$4.run(WorkbenchPage.java:1218)\nat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\nat org.eclipse.core.runtime.Platform.run(Platform.java:747)\nat org.eclipse.ui.internal.WorkbenchPage.disposePart(WorkbenchPage.java:1216)\nat org.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:941)\nat org.eclipse.ui.internal.WorkbenchPage.closeAllEditors(WorkbenchPage.java:881)\nat org.eclipse.ui.internal.WorkbenchPage.dispose(WorkbenchPage.java:1237)\nat org.eclipse.ui.internal.WorkbenchWindow.closeAllPages(WorkbenchWindow.java:647)\nat org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:1229)\nat org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:533)\nat org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:514)\nat org.eclipse.ui.internal.WorkbenchWindow$1.run(WorkbenchWindow.java:612)\nat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\nat org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:610)\nat org.eclipse.jface.window.WindowManager.close(WindowManager.java:108)\nat org.eclipse.ui.internal.Workbench$12.run(Workbench.java:505)\nat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\nat org.eclipse.core.runtime.Platform.run(Platform.java:747)\nat org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:501)\nat org.eclipse.ui.internal.Workbench.access$8(Workbench.java:436)\nat org.eclipse.ui.internal.Workbench$14.run(Workbench.java:623)\nat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\nat org.eclipse.ui.internal.Workbench.close(Workbench.java:621)\nat org.eclipse.ui.internal.Workbench.close(Workbench.java:596)\nat org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:530)\nat org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:514)\nat org.eclipse.ui.internal.WorkbenchWindow$1.run(WorkbenchWindow.java:612)\nat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\nat org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:610)\nat org.eclipse.jface.window.Window.handleShellCloseEvent(Window.java:637)\nat org.eclipse.jface.window.Window$2.shellClosed(Window.java:584)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:158)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:833)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:857)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842)\nat org.eclipse.swt.widgets.Decorations.closeWidget(Decorations.java:246)\nat org.eclipse.swt.widgets.Decorations.WM_CLOSE(Decorations.java:1538)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3014)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1483)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:3370)\nat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:1565)\nat org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:399)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3097)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1483)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:3370)\nat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:1565)\nat org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:399)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:3097)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1483)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:3370)\nat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\nat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1570)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2446)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1569)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1540)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:285)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:144)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:102)\nat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:220)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:273)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:129)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:185)\nat org.eclipse.core.launcher.Main.run(Main.java:710)\nat org.eclipse.core.launcher.Main.main(Main.java:694)",
    "Was the Ant Editor open on an Ant buildfile?\nDoes the exception always occur?",
    "Well, it was logged while an editor was open. According to the trace I was\nshutting down the workbench. But I can\u0027t remember any steps to repeat.\n\nCould it be possible that somehow the WST document implementation got\ninitialized for an Ant editor?",
    "I have added a workaround in the Ant code but it seems another strange \ninteraction of document setup etc.",
    "Released a change to AntEditorDocumentProvider.",
    "I\u0027ll add two observations/thoughts: \n\n1. I assume the class cast exception was related to the line:\nISynchronizable doc\u003d (ISynchronizable) xmlInfo.fTextFileBuffer.getDocument();\n\nOur JobSafeStructuredDocument does not implement ISynchronizable, and would hope\nthat\u0027s never \"required\" from participants, since we have another, similar\nlocking mechanism, but if we have to implement ISynchronizable, then we have to\nensure the two locks are well coordinated (hard enough to do one :)\n\n2. Fundamentally, I\u0027m surprised you\u0027re getting one of our documents, if you have \nyour own provider. Might be related to someone having an XML file, without\n\u0027project\u0027 in it, which is still intended to be an ant build file (e.g. maybe a\nnew, empty ant build file?). \n\nWe are obviously *the* test case for Kai\u0027s participant/setup infrastructure :)\nIdeally we should develop some good JUnit test cases that ensures all is\nbehaving as desired. (as well, as, perhaps, a clear statement of what\u0027s\ndesired!) Darin, perhaps you have some JUnit tests that should be run in the\n\"WTP Environment\"?\n",
    "You are correct on the source of the problem.\n\n1. I know no requirement to implement the inteface. I just made the incorrect \nassumption (with corresponding hard cast) that I would always be dealing with \none of my docs. Likely it would be good for you to reconcile your locking \nscheme with this interface to just be a \"consistent\" member of the document \ncommunity. Sometimes easier said than done...I know :-)\n\n2. I was surprised as well :-)\n\nAs for tests, I would think that running all of the Ant UI tests would do the \ntrick.",
    "I am going to mark this issue fixed as I currently know of nothing more the \nAnt integration can do to prevent the \"wrong\" documents being using in the \neditor. We have all of those other bugs for that :-)",
    "Please verify DarinW.",
    "Verified code."
  ],
  "commentCreationDates": [
    "2004-12-21T09:01:08+01:00",
    "2005-01-05T18:56:37+01:00",
    "2005-01-06T05:08:10+01:00",
    "2005-01-08T18:58:57+01:00",
    "2005-01-08T18:59:29+01:00",
    "2005-01-08T22:23:14+01:00",
    "2005-01-09T01:20:11+01:00",
    "2005-01-12T21:31:13+01:00",
    "2005-01-12T21:31:33+01:00",
    "2005-01-17T16:19:00+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument",
      "elements": [
        {
          "method": "org.eclipse.ant.internal.ui.editor.text.AntEditorDocumentProvider.disposeFileInfo",
          "source": "AntEditorDocumentProvider.java:129"
        },
        {
          "method": "org.eclipse.ui.editors.text.TextFileDocumentProvider.disconnect",
          "source": "TextFileDocumentProvider.java:583"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.disposeDocumentProvider",
          "source": "AbstractTextEditor.java:3125"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.disposeDocumentProvider",
          "source": "AbstractDecoratedTextEditor.java:1202"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.dispose",
          "source": "AbstractTextEditor.java:3044"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.dispose",
          "source": "AbstractDecoratedTextEditor.java:232"
        },
        {
          "method": "org.eclipse.ui.editors.text.TextEditor.dispose",
          "source": "TextEditor.java:101"
        },
        {
          "method": "org.eclipse.ant.internal.ui.editor.AntEditor.dispose",
          "source": "AntEditor.java:844"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPartReference.dispose",
          "source": "WorkbenchPartReference.java:404"
        },
        {
          "method": "org.eclipse.ui.internal.EditorManager$Editor.dispose",
          "source": "EditorManager.java:1557"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage$4.run",
          "source": "WorkbenchPage.java:1218"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.disposePart",
          "source": "WorkbenchPage.java:1216"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditors",
          "source": "WorkbenchPage.java:941"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeAllEditors",
          "source": "WorkbenchPage.java:881"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.dispose",
          "source": "WorkbenchPage.java:1237"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.closeAllPages",
          "source": "WorkbenchWindow.java:647"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.hardClose",
          "source": "WorkbenchWindow.java:1229"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.busyClose",
          "source": "WorkbenchWindow.java:533"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.access$0",
          "source": "WorkbenchWindow.java:514"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow$1.run",
          "source": "WorkbenchWindow.java:612"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.close",
          "source": "WorkbenchWindow.java:610"
        },
        {
          "method": "org.eclipse.jface.window.WindowManager.close",
          "source": "WindowManager.java:108"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$12.run",
          "source": "Workbench.java:505"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:747"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.busyClose",
          "source": "Workbench.java:501"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$8",
          "source": "Workbench.java:436"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$14.run",
          "source": "Workbench.java:623"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.close",
          "source": "Workbench.java:621"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.close",
          "source": "Workbench.java:596"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.busyClose",
          "source": "WorkbenchWindow.java:530"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.access$0",
          "source": "WorkbenchWindow.java:514"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow$1.run",
          "source": "WorkbenchWindow.java:612"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.close",
          "source": "WorkbenchWindow.java:610"
        },
        {
          "method": "org.eclipse.jface.window.Window.handleShellCloseEvent",
          "source": "Window.java:637"
        },
        {
          "method": "org.eclipse.jface.window.Window$2.shellClosed",
          "source": "Window.java:584"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:158"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:833"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:857"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:842"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.closeWidget",
          "source": "Decorations.java:246"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.WM_CLOSE",
          "source": "Decorations.java:1538"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3014"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1483"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3370"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:1565"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.callWindowProc",
          "source": "Shell.java:399"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3097"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1483"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3370"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:1565"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.callWindowProc",
          "source": "Shell.java:399"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3097"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1483"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3370"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1570"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2446"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1569"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1540"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:285"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:144"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:102"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:220"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:273"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:129"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:185"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:710"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:694"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "81717",
      "date": "2004-12-21T09:01:08+01:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    }
  ],
  "groupId": "81717",
  "bugId": "81717",
  "date": "2004-12-21T09:01:08+01:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "normal"
}