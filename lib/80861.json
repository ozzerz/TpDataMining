{
  "comments": [
    "200412013\n\nEvery time I switch a perspective I get the following NPE\n\n!ENTRY org.eclipse.ui 4 0 2004-12-13 14:41:51.477\n!MESSAGE java.lang.NullPointerException\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.ui.internal.PerspectiveBarContributionItem.select\n(PerspectiveBarContributionItem.java:112)\n\tat org.eclipse.ui.internal.PerspectiveBarManager$1.widgetSelected\n(PerspectiveBarManager.java:145)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:89)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:814)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2803)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2448)\n\tat org.eclipse.ui.internal.PerspectiveBarManager.handleChevron\n(PerspectiveBarManager.java:161)\n\tat org.eclipse.ui.internal.PerspectiveSwitcher$9.widgetSelected\n(PerspectiveSwitcher.java:741)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:89)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:814)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2803)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2448)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1569)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1540)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench\n(Workbench.java:285)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:144)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run\n(IDEApplication.java:102)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:220)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:273)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:129)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:185)\n\tat org.eclipse.core.launcher.Main.run(Main.java:710)\n\tat org.eclipse.core.launcher.Main.main(Main.java:694)",
    "Nick, were you doing something to ensure proper de-parenting of contribution items?",
    "Yes, see bug 80569.\nI\u0027ll look into this.\n",
    "While this dumps NPEs to the log, it does not prevent the perspective switcher\nfrom working, or cause any further problems, so this doesn\u0027t require a rebuild\nfor the M4 test candidate.\n\nThis fix should go in for M4 though.\n\nIt\u0027s a result of the combined changes for bug 80569 and bug 71078 (both recent\nchanges by me), causing the item in question to be removed while processing its\nselection.\n\nPerspectiveBarContributionItem.select() has:\n           workbenchPage.setPerspective(perspective);\n            update();\n            getParent().update(true);\n\nThe setPerspective() call fires notifications, which the PerspectiveSwitcher now\nlistens to in order to update.  In order to make the selected item visible, it\nremoves the contribution item for the selected item, and a creates a new one at\nthe front of the list.  So the subsequent getParent() was returning null.\n\nThe fix is to remove the explicit update()s and just let the listener do the\nupdate instead of forcing it in select().  select() is change to just do:\n           workbenchPage.setPerspective(perspective);\n",
    "Fix released.\n",
    "Verified in I20041214-2000.\n"
  ],
  "commentCreationDates": [
    "2004-12-13T19:45:22+01:00",
    "2004-12-13T19:51:53+01:00",
    "2004-12-13T20:19:10+01:00",
    "2004-12-13T21:10:26+01:00",
    "2004-12-13T21:12:31+01:00",
    "2004-12-15T21:14:50+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.PerspectiveBarContributionItem.select",
          "source": "PerspectiveBarContributionItem.java:112"
        },
        {
          "method": "org.eclipse.ui.internal.PerspectiveBarManager$1.widgetSelected",
          "source": "PerspectiveBarManager.java:145"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:814"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2803"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2448"
        },
        {
          "method": "org.eclipse.ui.internal.PerspectiveBarManager.handleChevron",
          "source": "PerspectiveBarManager.java:161"
        },
        {
          "method": "org.eclipse.ui.internal.PerspectiveSwitcher$9.widgetSelected",
          "source": "PerspectiveSwitcher.java:741"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:814"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2803"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2448"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1569"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1540"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:285"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:144"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:102"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:220"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:273"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:129"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:185"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:710"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:694"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "80861",
      "date": "2004-12-13T19:45:22+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "critical"
    }
  ],
  "groupId": "80861",
  "bugId": "80861",
  "date": "2004-12-13T19:45:22+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "critical"
}