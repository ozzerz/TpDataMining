{
  "comments": [
    "Got the following log entries during shutdown using i200406082000?\n\n!SESSION Jun 09, 2004 10:27:27.755 ---------------------------------------------\neclipse.buildId\u003dI200406082000\njava.version\u003d1.4.2_03\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_CA\nCommand-line arguments: -keyring d:\\temp\\.keyring -showlocation\n!ENTRY org.eclipse.core.runtime 4 2 Jun 09, 2004 10:27:27.755\n!MESSAGE Problems occurred when invoking code from plug-in:\n\"org.eclipse.core.runtime\".\n!STACK 0\njava.lang.NullPointerException\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.newConfig(ExternalToolMigration.java:299)\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFrom20ArgumentMap(ExternalToolMigration.java:225)\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFromArgumentMap(ExternalToolMigration.java:164)\n\tat\norg.eclipse.ui.externaltools.internal.model.BuilderUtils.configFromBuildCommandArgs(BuilderUtils.java:71)\n\tat\norg.eclipse.ui.externaltools.internal.model.ExternalToolBuilder.build(ExternalToolBuilder.java:77)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:558)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:758)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:154)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:246)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:226)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:758)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:229)\n\tat\norg.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:265)\n\tat org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:294)\n\tat org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:153)\n\tat org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:207)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:66)\n!ENTRY org.eclipse.core.resources 2 75 Jun 09, 2004 10:27:27.942\n!MESSAGE Errors during build.\n!SUBENTRY 1 org.eclipse.ui.externaltools 2 75 Jun 09, 2004 10:27:27.942\n!MESSAGE Errors running builder \"Integrated External Tool Builder\" on project\norg.eclipse.core.resources.\n!SUBENTRY 1 org.eclipse.ui.externaltools 2 75 Jun 09, 2004 10:27:27.942\n!MESSAGE java.lang.NullPointerException encountered while running Integrated\nExternal Tool Builder.\n!STACK 0\njava.lang.NullPointerException\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.newConfig(ExternalToolMigration.java:299)\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFrom20ArgumentMap(ExternalToolMigration.java:225)\n\tat\norg.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFromArgumentMap(ExternalToolMigration.java:164)\n\tat\norg.eclipse.ui.externaltools.internal.model.BuilderUtils.configFromBuildCommandArgs(BuilderUtils.java:71)\n\tat\norg.eclipse.ui.externaltools.internal.model.ExternalToolBuilder.build(ExternalToolBuilder.java:77)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:558)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:758)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:154)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:246)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:226)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:615)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:758)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:229)\n\tat\norg.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:265)\n\tat org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:294)\n\tat org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:153)\n\tat org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:207)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:66)",
    "It looks like DebugPlugin#getDefault() is returning null since the workbench is shutting down. Do we \nhave a known way to work around this problem?",
    "You don\u0027t need to make your plugin state invalid during shutdown (you are\nsetting the default reference to null on stop). Cleaning up state maintained by\nother plugins is good enough.\n\n",
    "We set the DebugPlugin to null on stop, however, even if we avoid this, \ngetting the launch manager will fail (which is what the external tool \nmigration is doing). The launch manager does not exist anymore (after shutting \ndown the debug plug-in). \n\nSince external tools pre-reqs debug, why is debug shutdown before external \ntools? Or, why is the build being run after shutdown?",
    "Resources has not been shutdown yet, so builders can be called after their\nplugin has been shutdown.\n\nWhat PED UI did in their build was to just bail with no further action when a\nbuild happens after the bundle has shutdown.",
    "(of course, I meant PDE UI)",
    "Ideally, builds should not be happening after plugins have begun to shutdown.\nThis suggests to me that some plugin is modifying the workspace during its\nplugin.shutdown() method, which is after the workspace has been saved. If we get\na reproducible case we might be able to find the guilty plugin and get them to\navoid modifying the workspace during shutdown. As far as the resources plugin is\nconcerned, it is fair game to modify the workspace up until the point when the\nresources plugin shuts down, but in the context of the Workbench this doesn\u0027t\nmake sense.",
    "But isn\u0027t possible that the user may shutdown Eclipse while a background build\nis happening? Is there any mechanism that ensures that all background jobs are\nstopped before the application is finished? If not, that should be a good test case.",
    "When the user clicks exit, the workspace is saved (IWorkspace.save). If a build\nis running at this point, the save will be blocked until the build completes or\ncancels. After the workspace is saved, the workbench exits and the plugins start\nto shutdown. So, I still think this may be caused by a plugin that is modifying\nthe workspace during shutdown.\n\nNote: it would be good for the debug builder to protect itself against this anyway.\n\n",
    "If I understand correctly, our build method should check the state of the bundle before proceeding to \ndefend against this case. If I\u0027m reading Bundle correctly, our check should just be:\n  if (ExternalToolsPlugin.getDefault().getBundle().getState() !\u003d Bundle.ACTIVE()) {\n    return null;\n  }\nDoes that sound about right, John?",
    "That is at least what I would suggest. If your plugin has been shutdown (or is\nshutting down), Bundle.getState() will be Bundle.RESOLVED (or Bundle.STOPPING).\nChecking against ACTIVE is the right thing to do.",
    "Fixed in ExternalToolBuilder#build(...). Please verify, DarinS.",
    "Verified."
  ],
  "commentCreationDates": [
    "2004-06-09T16:33:14+02:00",
    "2004-06-09T19:00:31+02:00",
    "2004-06-09T19:15:44+02:00",
    "2004-06-09T19:20:01+02:00",
    "2004-06-09T19:30:31+02:00",
    "2004-06-09T19:30:53+02:00",
    "2004-06-09T20:55:58+02:00",
    "2004-06-09T21:03:19+02:00",
    "2004-06-09T22:19:19+02:00",
    "2004-06-10T18:57:10+02:00",
    "2004-06-10T20:44:04+02:00",
    "2004-06-10T21:07:33+02:00",
    "2004-06-10T23:59:00+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.newConfig",
          "source": "ExternalToolMigration.java:299"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFrom20ArgumentMap",
          "source": "ExternalToolMigration.java:225"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFromArgumentMap",
          "source": "ExternalToolMigration.java:164"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.model.BuilderUtils.configFromBuildCommandArgs",
          "source": "BuilderUtils.java:71"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.model.ExternalToolBuilder.build",
          "source": "ExternalToolBuilder.java:77"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:558"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:758"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:154"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:246"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:199"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:226"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:758"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:229"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "BuildManager.java:265"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:294"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.doBuild",
          "source": "AutoBuildJob.java:153"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.run",
          "source": "AutoBuildJob.java:207"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:66"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "66303",
      "date": "2004-06-09T16:33:14+02:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.newConfig",
          "source": "ExternalToolMigration.java:299"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFrom20ArgumentMap",
          "source": "ExternalToolMigration.java:225"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.registry.ExternalToolMigration.configFromArgumentMap",
          "source": "ExternalToolMigration.java:164"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.model.BuilderUtils.configFromBuildCommandArgs",
          "source": "BuilderUtils.java:71"
        },
        {
          "method": "org.eclipse.ui.externaltools.internal.model.ExternalToolBuilder.build",
          "source": "ExternalToolBuilder.java:77"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:558"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:758"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:154"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:246"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:199"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:226"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:615"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:758"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:229"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "BuildManager.java:265"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:294"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.doBuild",
          "source": "AutoBuildJob.java:153"
        },
        {
          "method": "org.eclipse.core.internal.events.AutoBuildJob.run",
          "source": "AutoBuildJob.java:207"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:66"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "66303",
      "date": "2004-06-09T16:33:14+02:00",
      "product": "Platform",
      "component": "Ant",
      "severity": "normal"
    }
  ],
  "groupId": "66303",
  "bugId": "66303",
  "date": "2004-06-09T16:33:14+02:00",
  "product": "Platform",
  "component": "Ant",
  "severity": "normal"
}