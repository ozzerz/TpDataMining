{
  "comments": [
    "Build ID: M20071023-1652\n\nSteps To Reproduce:\n1. Open CVS Repositories view\n2. Right-click on a CVS connection\n3. Select \"Refresh Branches...\" action\n\nAfter selecting a project and clicking Finish, the wizard blocks at \"Fetching log information Receiving server response\" step. After a while, an OutOfMemoryError occurs. \n\nMore information:\nThe same problem does not appear with earlier versions of Eclipse, but only with version 3.3 and later. The CVS server is on a Redhat system, so nothing unusual there. Performing a thread dump shows that the CVS operation spends its time here:\n\n\"ModalContext\" prio\u003d6 tid\u003d0x4cee2018 nid\u003d0xf2c runnable [0x4e1ff000..0x4e1ffb68]\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:129)\n        at org.eclipse.team.internal.core.streams.PollingInputStream.read(PollingInputStream.java:121)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:235)\n        - locked \u003c0x0d805aa8\u003e (a java.io.BufferedInputStream)\n        at org.eclipse.team.internal.ccvs.core.connection.Connection.readLine(Connection.java:148)\n        at org.eclipse.team.internal.ccvs.core.client.Session.readLine(Session.java:300)\n        at org.eclipse.team.internal.ccvs.core.client.Request.executeRequest(Request.java:145)\n        at org.eclipse.team.internal.ccvs.core.client.Command.doExecute(Command.java:410)\n        at org.eclipse.team.internal.ccvs.core.client.Command$1.run(Command.java:329)\n        at org.eclipse.team.internal.ccvs.core.resources.EclipseSynchronizer.run(EclipseSynchronizer.java:1463)\n        at org.eclipse.team.internal.ccvs.core.resources.EclipseResource$2.run(EclipseResource.java:262)\n        at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1797)\n        at org.eclipse.team.internal.ccvs.core.resources.EclipseResource.run(EclipseResource.java:259)\n        at org.eclipse.team.internal.ccvs.core.client.Command.execute(Command.java:341)\n        at org.eclipse.team.internal.ccvs.core.client.Command.execute(Command.java:801)\n        at org.eclipse.team.internal.ccvs.ui.operations.RemoteLogOperation.execute(RemoteLogOperation.java:272)\n        at org.eclipse.team.internal.ccvs.ui.operations.RepositoryLocationOperation.execute(RepositoryLocationOperation.\njava:46)\n        at org.eclipse.team.internal.ccvs.ui.operations.CVSOperation.run(CVSOperation.java:81)\n        at org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.fetchTagsUsingLog(RepositoryRoot.java:377)\n        at org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.refreshDefinedTags(RepositoryRoot.java:353)\n        at org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.refreshDefinedTags(RepositoryManager.java:249)\n        at org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.internalRefresh(RefreshRemoteProjectWizard.\njava:143)\n        at org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.access$0(RefreshRemoteProjectWizard.java:13\n6)\n        at org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$3.run(RefreshRemoteProjectWizard.java:114)\n        at org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.run(RepositoryManager.java:717)\n        at org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$2.run(RefreshRemoteProjectWizard.java:111)\n        at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)",
    "Does it occur regularly?\n\nCan you see other errors related to the connection or cvs preceding the OoME problem? Could you attach the error log?",
    "It happens each time I perfom the \"Refresh Branches...\". The direct effect of this is that a new tag in repository does not appear in the list. However, all other CVS operations seem to work. \n\nIf I perform the \"Refresh Tags\" action (for instance in Merge... dialog), then the tag appears in the branches list, however I cannot see all the projects tagged with this tag. I see some of them, they seem to appear after some other CVS operation that was performed on them, but I am not sure which. The direct effect of this is that I cannot checkout all branched projects from Eclipse. Instead I have to do it from the command line where it works as it should.\n\nI am reproducing the error each time. The \"Refresh Branches\" operations blocks and I can see the memory usage climbing steadily until the OutOfMemoryError. Increasing memory using -Xmx option just delays the outcome. \n\nApart from the OutOfMemoryError there are no other errors in the log. It is probably useless, but here it goes:\n\n!ENTRY org.eclipse.ui 4 0 2007-11-23 10:25:50.531\n!MESSAGE Unhandled event loop exception\n!STACK 0\njava.lang.OutOfMemoryError: Java heap space\n\tat org.eclipse.team.internal.core.streams.PollingInputStream.readPendingInput(PollingInputStream.java:158)\n\tat org.eclipse.team.internal.core.streams.PollingInputStream.close(PollingInputStream.java:67)\n\tat java.io.BufferedInputStream.close(BufferedInputStream.java:440)\n\tat org.eclipse.team.internal.ccvs.core.connection.PServerConnection.close(PServerConnection.java:79)\n\tat org.eclipse.team.internal.ccvs.core.connection.Connection.close(Connection.java:71)\n\tat org.eclipse.team.internal.ccvs.core.client.Session.close(Session.java:223)\n\tat org.eclipse.team.internal.ccvs.ui.operations.RemoteLogOperation.execute(RemoteLogOperation.java:275)\n\tat org.eclipse.team.internal.ccvs.ui.operations.RepositoryLocationOperation.execute(RepositoryLocationOperation.java:46)\n\tat org.eclipse.team.internal.ccvs.ui.operations.CVSOperation.run(CVSOperation.java:81)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.fetchTagsUsingLog(RepositoryRoot.java:377)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.refreshDefinedTags(RepositoryRoot.java:353)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.refreshDefinedTags(RepositoryManager.java:249)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.internalRefresh(RefreshRemoteProjectWizard.java:143)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.access$0(RefreshRemoteProjectWizard.java:136)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$3.run(RefreshRemoteProjectWizard.java:114)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.run(RepositoryManager.java:717)\n\tat org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$2.run(RefreshRemoteProjectWizard.java:111)\n\tat org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)\n!SESSION 2007-11-23 10:29:06.796 -----------------------------------------------\n\n\n",
    "Just to make sure we are testing the same thing, are you using a basic Eclipse install or do you have other plug-ins installed. If you have other plug-ins installed, could you try it with just the basic Eclipse SDK just to rule out other causes (however unlikely that may be). Also, does this happen for all projects you  try or just a specific one? There may be something in the nature of the project that is exhausting the memory. The reason I ask is that I just did a Refresh Branches on all the projects in the Eclipse Project repository (:pserver:anonymous@dev.clipse.org:/cvsroot/eclipse) and didn\u0027t encounter any problems (there are over 100 projects).\n\nI don\u0027t recall making any significant changes to the Refresh Branches action in 3.3 but we should do a comparison between the 3.3 code and the 3.2 code to see if there is anything there that looks like it uses more memory. Out of curiosity, what value did you set for -Xmx? Could you enable the Heap monitor and the General  tab of the Window\u003ePreferences dialog to confirm that your heap has grown to the size you allocated?",
    "I\u0027ve done some more research. After enabling the CVS debug output I can see more clearly where the problem comes from. The operation Refresh Branches spends its time executing \"cvs rlog -l /root_project\". The output of this command is huge as we have quite a large repository. \n\nWhy this operation is performed? My guess is that Eclipse expects our root_project to have some specific layout. All our Eclipse projects are actually found under the root CVS project, like this:\n/root_project\n  /subproject1\n  /subproject2\n  ...\n\nIn previous versions there was a possibility to configure specific files to extract the tags from. We were using this option to specify a file like this /root_project/subproject1/.project. No it looks like this option is gone.",
    "Looking further, I can see that the actual sequence of CVS commands is the following:\n\nCMD\u003e cvs version\nCMD\u003e cvs -n update -d \"\"\nCMD\u003e cvs co -c\nCMD\u003e cvs log \".project\"\nE cvs server: .project has been added, but not committed\nCMD\u003e cvs rlog -l \"/root_project\""
  ],
  "commentCreationDates": [
    "2007-11-23T09:27:50+01:00",
    "2007-11-23T11:46:42+01:00",
    "2007-11-23T13:49:53+01:00",
    "2007-11-23T14:16:00+01:00",
    "2007-11-23T16:00:12+01:00",
    "2007-11-23T16:04:30+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.OutOfMemoryError",
      "message": "Java heap space",
      "elements": [
        {
          "method": "org.eclipse.team.internal.core.streams.PollingInputStream.readPendingInput",
          "source": "PollingInputStream.java:158"
        },
        {
          "method": "org.eclipse.team.internal.core.streams.PollingInputStream.close",
          "source": "PollingInputStream.java:67"
        },
        {
          "method": "java.io.BufferedInputStream.close",
          "source": "BufferedInputStream.java:440"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.PServerConnection.close",
          "source": "PServerConnection.java:79"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.connection.Connection.close",
          "source": "Connection.java:71"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.core.client.Session.close",
          "source": "Session.java:223"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.operations.RemoteLogOperation.execute",
          "source": "RemoteLogOperation.java:275"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.operations.RepositoryLocationOperation.execute",
          "source": "RepositoryLocationOperation.java:46"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.operations.CVSOperation.run",
          "source": "CVSOperation.java:81"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.fetchTagsUsingLog",
          "source": "RepositoryRoot.java:377"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RepositoryRoot.refreshDefinedTags",
          "source": "RepositoryRoot.java:353"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.refreshDefinedTags",
          "source": "RepositoryManager.java:249"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.internalRefresh",
          "source": "RefreshRemoteProjectWizard.java:143"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard.access$0",
          "source": "RefreshRemoteProjectWizard.java:136"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$3.run",
          "source": "RefreshRemoteProjectWizard.java:114"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RepositoryManager.run",
          "source": "RepositoryManager.java:717"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.repo.RefreshRemoteProjectWizard$2.run",
          "source": "RefreshRemoteProjectWizard.java:111"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.java:113"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "210727",
      "date": "2007-11-23T13:49:53+01:00",
      "product": "Platform",
      "component": "Team",
      "severity": "normal"
    }
  ],
  "groupId": "210727",
  "bugId": "210727",
  "date": "2007-11-23T09:27:50+01:00",
  "product": "Platform",
  "component": "Team",
  "severity": "normal"
}