{
  "comments": [
    "I am trying to implement a bundle and fragment combination on 3.2.0 and 3.2.1.  It is almost completely working except for 1 thing.  When I use the 3.2.1 release, everything resolves as I want and expect.  When I use the 3.2.0 release, the plug-ins resolve.  Excellent, I like that.  The problem is that the associated fragments do not start.  The status and diag output is below, as well as stack traces from when I attempt to start these by hand.  Any ideas?\n\n\n641     INSTALLED   org.eclipse.pde.core.nl1_3.2.0.v20060726\n642     INSTALLED   org.eclipse.pde.core.nl1_3.2.1.BUILDDATE\n643     RESOLVED    org.eclipse.pde.core_3.2.0.v20060726\n644     INSTALLED   org.eclipse.pde.core_3.2.1.BUILDDATE\n645     INSTALLED   org.eclipse.pde.ui.nl1_3.2.0.v20060726\n646     INSTALLED   org.eclipse.pde.ui.nl1_3.2.1.BUILDDATE\n647     RESOLVED    org.eclipse.pde.ui_3.2.0.v20060726\n648     INSTALLED   org.eclipse.pde.ui_3.2.1.BUILDDATE\n\nosgi\u003e diag 645\nupdate@../../toolkit_320/eclipse/plugins/org.eclipse.pde.ui.nl1_3.2.0.v20060726.jar [645]\n  Missing Constraint: Fragment-Host: org.eclipse.pde.ui; bundle-version\u003d\"[3.2.0,3.2.1)\"\n  Another singleton version selected: org.eclipse.pde.ui.nl1_3.2.1.BUILDDATE\n\nosgi\u003e diag 641\nupdate@../../toolkit_320/eclipse/plugins/org.eclipse.pde.core.nl1_3.2.0.v20060726.jar [641]\n  Missing Constraint: Fragment-Host: org.eclipse.pde.core; bundle-version\u003d\"[3.2.0,3.2.1)\"\n  Another singleton version selected: org.eclipse.pde.core.nl1_3.2.1.BUILDDATE\n\nosgi\u003e start 645\norg.osgi.framework.BundleException: A fragment bundle cannot be started: update@../../toolkit_320/eclipse/plugins/org.ec\nlipse.pde.ui.nl1_3.2.0.v20060726.jar [645]\n        at org.eclipse.osgi.framework.internal.core.BundleFragment.startWorker(BundleFragment.java:224)\n        at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:256)\n        at org.eclipse.osgi.framework.internal.core.FrameworkCommandProvider._start(FrameworkCommandProvider.java:239)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at org.eclipse.osgi.framework.internal.core.FrameworkCommandInterpreter.execute(FrameworkCommandInterpreter.java\n:145)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.docommand(FrameworkConsole.java:293)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.console(FrameworkConsole.java:278)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.run(FrameworkConsole.java:213)\n        at java.lang.Thread.run(Unknown Source)\n\nosgi\u003e start 641\norg.osgi.framework.BundleException: A fragment bundle cannot be started: update@../../toolkit_320/eclipse/plugins/org.ec\nlipse.pde.core.nl1_3.2.0.v20060726.jar [641]\n        at org.eclipse.osgi.framework.internal.core.BundleFragment.startWorker(BundleFragment.java:224)\n        at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:256)\n        at org.eclipse.osgi.framework.internal.core.FrameworkCommandProvider._start(FrameworkCommandProvider.java:239)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at org.eclipse.osgi.framework.internal.core.FrameworkCommandInterpreter.execute(FrameworkCommandInterpreter.java\n:145)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.docommand(FrameworkConsole.java:293)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.console(FrameworkConsole.java:278)\n        at org.eclipse.osgi.framework.internal.core.FrameworkConsole.run(FrameworkConsole.java:213)\n        at java.lang.Thread.run(Unknown Source)",
    "There is a problem with singleton selection for fragment bundles.\n\nIn this case we choose the higher version of the nl fragments as the selected singleton fragments to resolve.  The problem is the higher versions of the singleton nl fragments cannot resolve because their required host bundles did not resolve.  This results on both fragment versions being unresolved.  One because it was not choosen as the singleton bundle, the other because its host is not resolved.",
    "Created an attachment (id\u003d46904)\npatch\n\nThe fix for this is simple.  We should not be selecting our singleton fragment bundles until after we have determined all the resolvable bundles.  This is how we select the singletons for normal bundles.  This patch simple removes the singleton selection code that was used while attaching the fragment bundles to their hosts.  Instead fragment singletons will be selected just like normal bundles during the call to selectSingletons.\n",
    "I released the fix to 3.3 and added a new testcase for this scenario.  Leaving open for 3.2.1 consideration.  Jeff, do you approve for 3.2.1?",
    "I tried out the fix in the 3.2.0 and the 3.2.1 environments I have set up.  It resolved the problem I was seeing in the 3.2.0 environment.  The 3.2.1 environment continued to work as expected.",
    "+1",
    "+1",
    "Fix released to 3.2.1 maintenance release."
  ],
  "commentCreationDates": [
    "2006-07-27T20:28:33+02:00",
    "2006-07-27T21:11:59+02:00",
    "2006-07-27T21:18:24+02:00",
    "2006-07-27T22:18:35+02:00",
    "2006-07-27T22:49:18+02:00",
    "2006-08-10T17:06:43+02:00",
    "2006-08-10T17:09:15+02:00",
    "2006-08-10T18:04:33+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.osgi.framework.BundleException",
      "message": "A fragment bundle cannot be started: update@../../toolkit_320/eclipse/plugins/org.ec lipse.pde.ui.nl1_3.2.0.v20060726.jar [645]",
      "elements": [
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleFragment.startWorker",
          "source": "BundleFragment.java:224"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.start",
          "source": "AbstractBundle.java:256"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkCommandProvider._start",
          "source": "FrameworkCommandProvider.java:239"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkCommandInterpreter.execute",
          "source": "FrameworkCommandInterpreter.java :145"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.docommand",
          "source": "FrameworkConsole.java:293"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.console",
          "source": "FrameworkConsole.java:278"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.run",
          "source": "FrameworkConsole.java:213"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Unknown Source"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "152042",
      "date": "2006-07-27T20:28:33+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    },
    {
      "exceptionType": "org.osgi.framework.BundleException",
      "message": "A fragment bundle cannot be started: update@../../toolkit_320/eclipse/plugins/org.ec lipse.pde.core.nl1_3.2.0.v20060726.jar [641]",
      "elements": [
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleFragment.startWorker",
          "source": "BundleFragment.java:224"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.start",
          "source": "AbstractBundle.java:256"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkCommandProvider._start",
          "source": "FrameworkCommandProvider.java:239"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkCommandInterpreter.execute",
          "source": "FrameworkCommandInterpreter.java :145"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.docommand",
          "source": "FrameworkConsole.java:293"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.console",
          "source": "FrameworkConsole.java:278"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.FrameworkConsole.run",
          "source": "FrameworkConsole.java:213"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "152042",
      "date": "2006-07-27T20:28:33+02:00",
      "product": "Equinox",
      "component": "Framework",
      "severity": "normal"
    }
  ],
  "groupId": "152042",
  "bugId": "152042",
  "date": "2006-07-27T20:28:33+02:00",
  "product": "Equinox",
  "component": "Framework",
  "severity": "normal"
}