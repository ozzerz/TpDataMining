{
  "comments": [
    "Problem:\n--------\nDropTarget cleanup (COM-level) does not seem to be complete. Instantiating\nanother DragDrop instance within the same process\nfails after calling CoLockObjectExternal COM API.\n\norg.eclipse.swt.SWTError: Cannot initialize Drop\n\tat org.eclipse.swt.dnd.DND.error(DND.java:220)\n\tat org.eclipse.swt.dnd.DND.error(DND.java:181)\n\tat org.eclipse.swt.dnd.DropTarget.\u003cinit\u003e(DropTarget.java:133)\n\tat\norg.eclipse.swt.examples.dnd.DNDExample.createDropTarget(DNDExample.java:640)\n\tat org.eclipse.swt.examples.dnd.DNDExample.access$2000\n(DNDExample.java:21)\n\tat\norg.eclipse.swt.examples.dnd.DNDExample$25.widgetSelected(DNDExample.java:839)\n\tat\norg.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:89)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:769)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2578)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2256)\n\tat org.eclipse.swt.examples.dnd.DNDExample.open(DNDExample.java:1101)\n\tat org.eclipse.swt.examples.dnd.DNDExample.access$000\n(DNDExample.java:21)\n\tat org.eclipse.swt.examples.dnd.DNDExample$1.run(DNDExample.java:67)\n\tat java.lang.Thread.run(Thread.java:534)\n\nEnvironment:\n------------\nWindows XP Pro 2002 SP1\nSWT M08\nj2sdk1.4.2_03\n\nSteps to reproduce:\n------------------\n1. Modify DNDExample.java (SWT sample), main() method as shown below, so\nthat \nit displays two Shell instances, one after another:\npublic static void main(String[] args) throws Exception{\n    //fisrt instance works OK\n    DNDExample example \u003d new DNDExample();\n    example.open();\n\n    //second instance has problems with DropTarget initialization\n    //for cleaner experiment, let\u0027s use another UI thread\n    Runnable runnable \u003d new Runnable() {\n        public void run() {\n            DNDExample example2 \u003d new DNDExample();\n            example2.open();\n        }\n    };\n    new Thread(runnable).start();\n\n    Thread.sleep(Long.MAX_VALUE);\n}\n\n2. Run DNDExample, make sure example Shell is displayed.\n3. Click on DropTarget check box, which causes creation of DropTarget\nassociated with Label control.\n4. Close the Shell, which causes disposal of Label control and associated\nDropTarget. When DropTarget refCount becomes 0, disposeCOMInterfaces()\nmethod is called, which should completely release all system resources\nassociated with DropTarget.\n5. Make sure example2 Shell instance is displayed.\n6. Click on DropTarget check box, which should create another DropTarget\ninstance. Instead, SWT fails with stack trace provided above."
  ],
  "commentCreationDates": [
    "2004-05-30T00:11:18+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "Cannot initialize Drop",
      "elements": [
        {
          "method": "org.eclipse.swt.dnd.DND.error",
          "source": "DND.java:220"
        },
        {
          "method": "org.eclipse.swt.dnd.DND.error",
          "source": "DND.java:181"
        },
        {
          "method": "org.eclipse.swt.dnd.DropTarget.\u003cinit\u003e",
          "source": "DropTarget.java:133"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample.createDropTarget",
          "source": "DNDExample.java:640"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample.access$2000",
          "source": "DNDExample.java:21"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample$25.widgetSelected",
          "source": "DNDExample.java:839"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:769"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2578"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2256"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample.open",
          "source": "DNDExample.java:1101"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample.access$000",
          "source": "DNDExample.java:21"
        },
        {
          "method": "org.eclipse.swt.examples.dnd.DNDExample$1.run",
          "source": "DNDExample.java:67"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:534"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "64682",
      "date": "2004-05-30T00:11:18+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "64682",
  "bugId": "64682",
  "date": "2004-05-30T00:11:18+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}