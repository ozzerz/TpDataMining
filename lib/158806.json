{
  "comments": [
    "When we programmatically import a J2EE EAR and targetted it to a server runtime\nthat does not support the highest Java facet level, this facet level is set\nanyway resulting in an error about the constraint being invalid:\n\n*** ERROR ***: Tue Sep 26 10:15:17 EDT 2006    org.eclipse.core.runtime.CoreException: One or more constraints have not been satisfied.\n    \tat org.eclipse.wst.common.project.facet.core.internal.FacetedProject.modifyInternal(FacetedProject.java:282)\n    \tat org.eclipse.wst.common.project.facet.core.internal.FacetedProject.access$2(FacetedProject.java:264)\n    \tat org.eclipse.wst.common.project.facet.core.internal.FacetedProject$1.run(FacetedProject.java:249)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.wst.common.project.facet.core.internal.FacetedProject.modify(FacetedProject.java:259)\n    \tat org.eclipse.wst.common.componentcore.internal.operation.FacetProjectCreationOperation.addDefaultFacets(FacetProjectCreationOperation.java:133)\n    \tat org.eclipse.wst.common.componentcore.internal.operation.FacetProjectCreationOperation.execute(FacetProjectCreationOperation.java:106)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run(DataModelPausibleOperationImpl.java:376)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:400)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:352)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute(DataModelPausibleOperationImpl.java:242)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl(DataModelPausibleOperationImpl.java:214)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue(DataModelPausibleOperationImpl.java:89)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute(DataModelPausibleOperationImpl.java:202)\n    \tat org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.createVirtualComponent(J2EEArtifactImportOperation.java:96)\n    \tat org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.doExecute(J2EEArtifactImportOperation.java:77)\n    \tat org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.execute(J2EEArtifactImportOperation.java:58)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run(DataModelPausibleOperationImpl.java:376)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:400)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:352)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute(DataModelPausibleOperationImpl.java:242)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl(DataModelPausibleOperationImpl.java:214)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue(DataModelPausibleOperationImpl.java:89)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute(DataModelPausibleOperationImpl.java:202)\n    \tat org.eclipse.jst.j2ee.internal.archive.operations.EARComponentImportOperation.doExecute(EARComponentImportOperation.java:103)\n    \tat org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.execute(J2EEArtifactImportOperation.java:58)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run(DataModelPausibleOperationImpl.java:376)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:400)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation(DataModelPausibleOperationImpl.java:352)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute(DataModelPausibleOperationImpl.java:242)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl(DataModelPausibleOperationImpl.java:214)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue(DataModelPausibleOperationImpl.java:89)\n    \tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute(DataModelPausibleOperationImpl.java:202)\n\nI was able to reproduce this consistently in WTP 1.5.1 build 200609221939. Here\u0027s a snippet of code showing the EAR import model settings:\n\nIDataModel earImportInfo \u003d DataModelFactory.createDataModel(new EARComponentImportDataModelProvider())\n...\nearImportInfo.setProperty(IFacetProjectCreationDataModelProperties.FACET_RUNTIME,FacetUtil.getRuntime(myRuntime));\t\t  \nList list \u003d provider.getSelectedModels();\nfor (Iterator i\u003dlist.iterator();i.hasNext();)\n{\n  // Loop over the modules in the EAR...\n  IDataModel j2eeArtifactImportInfo \u003d (IDataModel)i.next();\n  ...\n}\nIDataModelOperation op \u003d earImportInfo.getDefaultOperation();\nop.execute(new NullProgressMonitor(),null);\n\nThis problem does not occur in the EAR import wizard. After talking to Jason Sholl, he pointed out bugzilla 157117 which was apparently used to fix the EAR\nimport wizard case but not the headless API case. The workaround was to call validateProperty(J2EEArtifactImportDataModelProvider.FACET_RUNTIME) on the EAR and each of the modules import data models. The headless API case should be addressed as well so we can remove this hack.",
    "Created an attachment (id\u003d56986)\npatch\n\nThe fix is to perform the same logic in the hack described above down in the headless level DataModel in order to force the update to the Java facet versions.  This check is performed when either the Server Target or the EAR file name is set.",
    "approve",
    "dropping to build",
    "verified patch in code.",
    "verified by Hari",
    "closing"
  ],
  "commentCreationDates": [
    "2006-09-26T18:57:49+02:00",
    "2007-01-16T21:40:08+01:00",
    "2007-01-17T22:17:44+01:00",
    "2007-01-18T00:48:16+01:00",
    "2007-02-07T17:53:16+01:00",
    "2007-02-07T18:06:55+01:00",
    "2007-02-07T18:07:12+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.core.runtime.CoreException",
      "message": "One or more constraints have not been satisfied.",
      "elements": [
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.FacetedProject.modifyInternal",
          "source": "FacetedProject.java:282"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.FacetedProject.access$2",
          "source": "FacetedProject.java:264"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.FacetedProject$1.run",
          "source": "FacetedProject.java:249"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.FacetedProject.modify",
          "source": "FacetedProject.java:259"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.operation.FacetProjectCreationOperation.addDefaultFacets",
          "source": "FacetProjectCreationOperation.java:133"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.operation.FacetProjectCreationOperation.execute",
          "source": "FacetProjectCreationOperation.java:106"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run",
          "source": "DataModelPausibleOperationImpl.java:376"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:400"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:352"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute",
          "source": "DataModelPausibleOperationImpl.java:242"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl",
          "source": "DataModelPausibleOperationImpl.java:214"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue",
          "source": "DataModelPausibleOperationImpl.java:89"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute",
          "source": "DataModelPausibleOperationImpl.java:202"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.createVirtualComponent",
          "source": "J2EEArtifactImportOperation.java:96"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.doExecute",
          "source": "J2EEArtifactImportOperation.java:77"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.execute",
          "source": "J2EEArtifactImportOperation.java:58"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run",
          "source": "DataModelPausibleOperationImpl.java:376"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:400"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:352"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute",
          "source": "DataModelPausibleOperationImpl.java:242"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl",
          "source": "DataModelPausibleOperationImpl.java:214"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue",
          "source": "DataModelPausibleOperationImpl.java:89"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute",
          "source": "DataModelPausibleOperationImpl.java:202"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.archive.operations.EARComponentImportOperation.doExecute",
          "source": "EARComponentImportOperation.java:103"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.archive.operations.J2EEArtifactImportOperation.execute",
          "source": "J2EEArtifactImportOperation.java:58"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl$1.run",
          "source": "DataModelPausibleOperationImpl.java:376"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:400"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.runOperation",
          "source": "DataModelPausibleOperationImpl.java:352"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.doExecute",
          "source": "DataModelPausibleOperationImpl.java:242"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.executeImpl",
          "source": "DataModelPausibleOperationImpl.java:214"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.cacheThreadAndContinue",
          "source": "DataModelPausibleOperationImpl.java:89"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelPausibleOperationImpl.execute",
          "source": "DataModelPausibleOperationImpl.java:202"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "158806",
      "date": "2006-09-26T18:57:49+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "major"
    }
  ],
  "groupId": "158806",
  "bugId": "158806",
  "date": "2006-09-26T18:57:49+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "major"
}