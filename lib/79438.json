{
  "comments": [
    "Sessions are being cached in the test execution harness but the state of the \nsession is not checked before use.  If the agent controller is restarted or \ntaken down while the client workbench still maintains the cached session then \nsubsequent tests will fail because the session is pulled from the cache in an \nunusable state (this fact or to-do is also already found annotated in the \nsource code).\n\nIf the session is not usable then it should be removed from the cache and a \nnew session should be created for use.  Here is the stack trace you get if the \nsession is unusable (in this case I had restarted the agent controller while \nusing the workbench client and then tried to launch a test).  I assumed in \nthis defect description that the problem was with the session being cached but \nhave not confirmed this by following the stack trace into the code.\n\norg.eclipse.hyades.execution.invocation.RemoteInvocationException\n\tat org.eclipse.hyades.execution.local.SessionImpl.invokeRemote\n(SessionImpl.java:98)\n\tat org.eclipse.hyades.execution.local.SessionStub.invokeRemote\n(SessionStub.java:41)\n\tat \norg.eclipse.hyades.execution.local.ExecutionComponentFactoryImpl.delegateRemote\nCall(ExecutionComponentFactoryImpl.java:264)\n\tat \norg.eclipse.hyades.execution.local.EclipseExecutionComponentFactoryImpl.addExec\nutionComponent(EclipseExecutionComponentFactoryImpl.java:86)\n\tat \norg.eclipse.hyades.execution.harness.TestExecutionHarness.initializeRegisteredE\nxecutionComponents(TestExecutionHarness.java:307)\n\tat org.eclipse.hyades.execution.harness.TestExecutionHarness.launchTest\n(TestExecutionHarness.java:1290)\n\tat org.eclipse.hyades.execution.harness.TestExecutionHarness.launchTest\n(TestExecutionHarness.java:562)\n\tat \norg.eclipse.hyades.test.ui.launch.delegates.BasicTestLaunchConfigurationDelegat\ne2.invokeTestExecutionHarness(BasicTestLaunchConfigurationDelegate2.java:140)\n\tat \norg.eclipse.hyades.test.ui.launch.delegates.AbstractLaunchConfigurationDelegate\n2.launch(AbstractLaunchConfigurationDelegate2.java:164)\n\tat org.eclipse.debug.internal.core.LaunchConfiguration.launch\n(LaunchConfiguration.java:569)\n\tat org.eclipse.debug.internal.ui.DebugUIPlugin.buildAndLaunch\n(DebugUIPlugin.java:788)\n\tat org.eclipse.debug.internal.ui.DebugUIPlugin$6.run\n(DebugUIPlugin.java:955)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:66)\nCaused by: \norg.eclipse.hyades.internal.execution.local.control.InactiveAgentException\n\tat \norg.eclipse.hyades.internal.execution.local.control.AgentImpl.invokeCustomComma\nnd(AgentImpl.java:422)\n\tat org.eclipse.hyades.execution.local.SessionImpl.invokeRemote\n(SessionImpl.java:95)\n\t... 12 more",
    "\nThis defect has been fixed and tested in my local sources--this will get \ncommitted when the 3.3 stream is ready as the HEAD.\n\nTwo fixes were put in place:\n\n--Changed HyadesTestNodeImpl.java to use correct session, now using the \nsession context in local anonymous class listener scope to remove from session \ncontext to session map.  \n\nThe code was: \no  sessionCache.removeSessionEntry((ISession) event.getComponent());\n\nThe code is now (correct and faster since it doesn\u0027t have to find key first):\no  sessionCache.removeSessionEntry(cachedSessionContext);\n\n--The second fix involved confirming the state as IExecutionComponent.READY \nbefore accepting the session from the cache.  It is useless to us at that \nparticular point in the code unless it is READY for our use.\n\nThese two fixes taken together improve the robustness and reliability of using \nthe test execution harness now that the agent controller can be restarted \nbetween tests in the same client workbench instance.  To test this, a test is \nfirst executed and then the agent controller is restarted.  A second test is \nthen run and everything should work as the first test did (previously the \nsecond test would fail due to an invalid cached session being used).\n\n",
    "\nNow committed, see comments above for solution.",
    "setting target based on last change date, please adjust if not correct"
  ],
  "commentCreationDates": [
    "2004-11-24T19:50:15+01:00",
    "2004-12-29T19:12:17+01:00",
    "2005-01-12T23:38:44+01:00",
    "2005-03-16T13:31:19+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.hyades.execution.invocation.RemoteInvocationException",
      "elements": [
        {
          "method": "org.eclipse.hyades.execution.local.SessionImpl.invokeRemote",
          "source": "SessionImpl.java:98"
        },
        {
          "method": "org.eclipse.hyades.execution.local.SessionStub.invokeRemote",
          "source": "SessionStub.java:41"
        },
        {
          "method": "org.eclipse.hyades.execution.local.ExecutionComponentFactoryImpl.delegateRemoteCall",
          "source": "ExecutionComponentFactoryImpl.java:264"
        },
        {
          "method": "org.eclipse.hyades.execution.local.EclipseExecutionComponentFactoryImpl.addExecutionComponent",
          "source": "EclipseExecutionComponentFactoryImpl.java:86"
        },
        {
          "method": "org.eclipse.hyades.execution.harness.TestExecutionHarness.initializeRegisteredExecutionComponents",
          "source": "TestExecutionHarness.java:307"
        },
        {
          "method": "org.eclipse.hyades.execution.harness.TestExecutionHarness.launchTest",
          "source": "TestExecutionHarness.java:1290"
        },
        {
          "method": "org.eclipse.hyades.execution.harness.TestExecutionHarness.launchTest",
          "source": "TestExecutionHarness.java:562"
        },
        {
          "method": "org.eclipse.hyades.test.ui.launch.delegates.BasicTestLaunchConfigurationDelegate2.invokeTestExecutionHarness",
          "source": "BasicTestLaunchConfigurationDelegate2.java:140"
        },
        {
          "method": "org.eclipse.hyades.test.ui.launch.delegates.AbstractLaunchConfigurationDelegate2.launch",
          "source": "AbstractLaunchConfigurationDelegate2.java:164"
        },
        {
          "method": "org.eclipse.debug.internal.core.LaunchConfiguration.launch",
          "source": "LaunchConfiguration.java:569"
        },
        {
          "method": "org.eclipse.debug.internal.ui.DebugUIPlugin.buildAndLaunch",
          "source": "DebugUIPlugin.java:788"
        },
        {
          "method": "org.eclipse.debug.internal.ui.DebugUIPlugin$6.run",
          "source": "DebugUIPlugin.java:955"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:66"
        }
      ],
      "causedBy": {
        "exceptionType": "org.eclipse.hyades.internal.execution.local.control.InactiveAgentException",
        "elements": [
          {
            "method": "org.eclipse.hyades.internal.execution.local.control.AgentImpl.invokeCustomCommand",
            "source": "AgentImpl.java:422"
          },
          {
            "method": "org.eclipse.hyades.execution.local.SessionImpl.invokeRemote",
            "source": "SessionImpl.java:95"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 0,
      "bugId": "79438",
      "date": "2004-11-24T19:50:15+01:00",
      "product": "Hyades",
      "component": "Exec.harness",
      "severity": "normal"
    }
  ],
  "groupId": "79438",
  "bugId": "79438",
  "date": "2004-11-24T19:50:15+01:00",
  "product": "Hyades",
  "component": "Exec.harness",
  "severity": "normal"
}