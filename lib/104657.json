{
  "comments": [
    "N20050721-0010\n\nProbably caused by the fix for bug 103379.\n\nThe test log for org.eclipse.jdt.ui.tests.AutomatedSuite (\nhttp://download.eclipse.org/downloads/drops/N20050721-0010/testresults/consolelogs/win32_consolelog.txt\n) contains several suspicious intances of the NPE below, although tests don\u0027t\nfail because of this.\n\norg.eclipse.jdt.text.tests such as BracketInserterTest fail in HEAD because of\nthis (there was another bug in the test, which has been corrected \u003e 20050721).\n\n     [java] !MESSAGE Failed to execute runnable (java.lang.NullPointerException)\n     [java] !STACK 0\n     [java] org.eclipse.swt.SWTException: Failed to execute runnable\n(java.lang.NullPointerException)\n     [java] \tat org.eclipse.swt.SWT.error(SWT.java:2942)\n     [java] \tat org.eclipse.swt.SWT.error(SWT.java:2865)\n     [java] \tat\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:126)\n     [java] \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3114)\n     [java] \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2768)\n     [java] \tat\norg.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.runEventLoop(EventLoopProgressMonitor.java:123)\n     [java] \tat\norg.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.isCanceled(EventLoopProgressMonitor.java:97)\n     [java] \tat\norg.eclipse.core.internal.jobs.ThreadJob.isCanceled(ThreadJob.java:127)\n     [java] \tat org.eclipse.core.internal.jobs.ThreadJob.joinRun(ThreadJob.java:157)\n     [java] \tat\norg.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:88)\n     [java] \tat\norg.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:190)\n     [java] \tat\norg.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:96)\n     [java] \tat\norg.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1674)\n     [java] \tat\norg.eclipse.core.internal.resources.Workspace.run(Workspace.java:1714)\n     [java] \tat\norg.eclipse.core.internal.resources.Workspace.run(Workspace.java:1739)\n     [java] \tat\norg.eclipse.jdt.testplugin.JavaProjectHelper.delete(JavaProjectHelper.java:264)\n     [java] \tat\norg.eclipse.jdt.ui.tests.core.CodeFormatterUtilTest.tearDown(CodeFormatterUtilTest.java:78)\n     [java] \tat junit.framework.TestCase.runBare(TestCase.java:130)\n     [java] \tat junit.framework.TestResult$1.protect(TestResult.java:106)\n     [java] \tat junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java] \tat junit.framework.TestResult.run(TestResult.java:109)\n     [java] \tat junit.framework.TestCase.run(TestCase.java:118)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n     [java] \tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\n     [java] \tat junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java] \tat junit.extensions.TestSetup.run(TestSetup.java:23)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n     [java] \tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\n     [java] \tat junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java] \tat junit.extensions.TestSetup.run(TestSetup.java:23)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n     [java] \tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\n     [java] \tat junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java] \tat junit.extensions.TestSetup.run(TestSetup.java:23)\n     [java] \tat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:313)\n     [java] \tat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:199)\n     [java] \tat org.eclipse.test.UITestApplication$3.run(UITestApplication.java:188)\n     [java] \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n     [java] \tat\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n     [java] \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3114)\n     [java] \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2768)\n     [java] Unhandled event loop exception\n     [java] \tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n     [java] Reason:\n     [java] \tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n     [java] \tat\norg.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:367)\n     [java] \tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n     [java] \tat\norg.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n     [java] \tat\norg.eclipse.test.UITestApplication.runApplication(UITestApplication.java:131)\n     [java] \tat org.eclipse.test.UITestApplication.run(UITestApplication.java:58)\n     [java] \tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\n     [java] \tat\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n     [java] \tat\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:163)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] \tat java.lang.reflect.Method.invoke(Method.java:324)\n     [java] \tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n     [java] \tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n     [java] \tat org.eclipse.core.launcher.Main.run(Main.java:973)\n     [java] \tat org.eclipse.core.launcher.Main.main(Main.java:948)\n     [java] Caused by: java.lang.NullPointerException\n     [java] \tat\norg.eclipse.ui.operations.OperationHistoryActionHandler.getWorkbenchWindow(OperationHistoryActionHandler.java:301)\n     [java] Failed to execute runnable (java.lang.NullPointerException)\n     [java] \tat\norg.eclipse.ui.operations.OperationHistoryActionHandler.getHistory(OperationHistoryActionHandler.java:224)\n     [java] \tat\norg.eclipse.ui.operations.UndoActionHandler.shouldBeEnabled(UndoActionHandler.java:71)\n     [java] \tat\norg.eclipse.ui.operations.OperationHistoryActionHandler.update(OperationHistoryActionHandler.java:343)\n     [java] \tat\norg.eclipse.ui.operations.OperationHistoryActionHandler$1.run(OperationHistoryActionHandler.java:129)\n     [java] \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n     [java] \tat\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n     [java] \t... 62 more",
    "Oops - I scanned this quickly while reviewing a sea of newly assigned bugs and \nthought that tests were not failing, so I did not address yet.  I just reread \nthe comment and realized the text tests are failing.  This may fail again in \ntonight\u0027s build, depending on whether I get a chance to get back to this \ntonight, but it is next on my list.",
    "Sorry for my lousy ordering of issues. I don\u0027t think I would have understood\nthis PR correctly on first reading either ... .\n\nHowever, the bug does not seem to be too severe, since it only happens in the\ntests -- I could not reproduce it manually. You probably have to be very quick\nat deleting a project after doing a text change.",
    "Fixed in HEAD \u003e 20050722.\n\nThis was indeed related to the fix for bug #103379.  In that fix, the \nhandler\u0027s site was nulled out during dispose to fix some leaks.  In the test \ncases, the action handler was being run in an async which occurred after the \nhandler had been disposed, and was attempting to access the site.  Added \nchecks so that the handler will not NPE when accessed after disposal.\n\nI still see intermittent failures in the JDT Text Suites \n(testAngleBracketsBeforeMethodDecl15) but this does not seem to be related at \nall the OperationHistoryActionHandler.\n\n",
    "Nick gives +1.  Good to go for 3.1.1. ",
    "committed change to R3_1_maintenance branch.\nAvailable \u003e20050801",
    "Verified in I20050808-2000 (3.2 M1 test pass) via test suites and visual \ninspection of source.\n\nLeaving this bug marked \"fixed\" (vs. \"verified\") so it can be verified again \nagainst 3.1.1 when the time comes",
    "verified on Motif 3.1.1 build M200509231430\n\nby running the org.eclipse.jdt.text.tests.JdtTextTestSuite tests and the test\nsuite that contains the CodeFormatterUtilTest"
  ],
  "commentCreationDates": [
    "2005-07-21T15:59:45+02:00",
    "2005-07-22T00:05:41+02:00",
    "2005-07-22T14:41:49+02:00",
    "2005-07-23T03:19:45+02:00",
    "2005-07-26T18:00:42+02:00",
    "2005-08-01T21:43:52+02:00",
    "2005-08-09T18:42:17+02:00",
    "2005-09-26T22:40:55+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Failed to execute runnable (java.lang.NullPointerException)      [java]",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2942"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "104657",
      "date": "2005-07-21T15:59:45+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "104657",
  "bugId": "104657",
  "date": "2005-07-21T15:59:45+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}