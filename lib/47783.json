{
  "comments": [
    "I get an exception when I save an ImageData (width\u003dx HEIGHT\u003d1) to JPEG file :\n\nException:\n-------------------------------------------------------\njava.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.eclipse.swt.internal.image.JPEGFileFormat.compress(JPEGFileFormat.java:207)\n\tat\norg.eclipse.swt.internal.image.JPEGFileFormat.convertMultiRGBToYCbCr(JPEGFileFormat.java:373)\n\tat\norg.eclipse.swt.internal.image.JPEGFileFormat.convertImageToYCbCr(JPEGFileFormat.java:316)\n\tat\norg.eclipse.swt.internal.image.JPEGFileFormat.unloadIntoByteStream(JPEGFileFormat.java:1887)\n\tat org.eclipse.swt.internal.image.FileFormat.unloadIntoStream(FileFormat.java:107)\n\tat org.eclipse.swt.internal.image.FileFormat.save(FileFormat.java:99)\n\tat org.eclipse.swt.graphics.ImageLoader.save(ImageLoader.java:194)\n\tat XXXXXXXXXXXXXXX\n\n\nSource code:\n-------------------------------------------------------------------\n\t\tif (compressedHeight \u003c componentHeight) {\n\t\t\tint srcOfs \u003d (compressedHeight - 1) * componentWidth;\n\t\t\tfor (int yPos \u003d compressedHeight; yPos \u003c\u003d componentHeight; yPos++) {\n\t\t\t\tint dstOfs \u003d (yPos - 1) * componentWidth;\n\t\t\t\tSystem.arraycopy(imageComponent, srcOfs, imageComponent, dstOfs,\ncomponentWidth);\n\t\t\t}\n\t\t}\n\nSo, if compressedHeight\u003d1 ,  \nI understand that it calls an System.arrayCopy from a position O\nto the SAME position 0 !\n\nThanks for your fantastic project: ECLIPSE !",
    "I am seeing this problem as well with a slight difference.\nMy image is 1x128, but in the snippet below, compressedHeight has been computed to be 0, thus subtracting 1 and multiplying yields negative srcOfs and dstOfs values.",
    "Hi Stef!\nWhat version of eclipse are you using?\nCan you attach your image, please?\nThanks,\nCarolyn",
    "Hey Carolyn. Long time no see.\n\nWe\u0027re still running on Eclipse 3.2.2 at the moment, so it\u0027s SWT v3236b.\nI did peek quickly at the source for 3.3.0 v3325g, but it looked similar and I haven\u0027t tried running with that.\n\nI don\u0027t actually have an image file. We create the image using \"new Image(display, width, height)\", do some drawing and then calling getImageData(). We put that into an ImageLoader and use FileFormat to save it to a stream.",
    "Created an attachment (id\u003d75415)\nreproducible testcase\n\n",
    "Sorry for not getting back to this sooner, but things have been busy (plus my machine crashed the first time I wrote a testcase and I doubt this is a hot topic for anyone ;)).\n\nI\u0027m attaching a simple testcase that mimics what our product does (roughly) and recreates the problem. I just tried it with SWT 3.346 and got the same error I\u0027d seen previously."
  ],
  "commentCreationDates": [
    "2003-12-01T09:57:43+01:00",
    "2007-06-22T21:01:31+02:00",
    "2007-06-22T21:32:57+02:00",
    "2007-06-22T21:56:42+02:00",
    "2007-08-06T04:59:54+02:00",
    "2007-08-06T05:00:48+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "java.lang.System.arraycopy",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.image.JPEGFileFormat.compress",
          "source": "JPEGFileFormat.java:207"
        },
        {
          "method": "org.eclipse.swt.internal.image.JPEGFileFormat.convertMultiRGBToYCbCr",
          "source": "JPEGFileFormat.java:373"
        },
        {
          "method": "org.eclipse.swt.internal.image.JPEGFileFormat.convertImageToYCbCr",
          "source": "JPEGFileFormat.java:316"
        },
        {
          "method": "org.eclipse.swt.internal.image.JPEGFileFormat.unloadIntoByteStream",
          "source": "JPEGFileFormat.java:1887"
        },
        {
          "method": "org.eclipse.swt.internal.image.FileFormat.unloadIntoStream",
          "source": "FileFormat.java:107"
        },
        {
          "method": "org.eclipse.swt.internal.image.FileFormat.save",
          "source": "FileFormat.java:99"
        },
        {
          "method": "org.eclipse.swt.graphics.ImageLoader.save",
          "source": "ImageLoader.java:194"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "47783",
      "date": "2003-12-01T09:57:43+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "47783",
  "bugId": "47783",
  "date": "2003-12-01T09:57:43+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}