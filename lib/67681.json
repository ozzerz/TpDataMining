{
  "comments": [
    "In the bug #67369 I mentionned the existence of a NoClassDefFoundError and here\nit is. I don\u0027t have clear steps to reproduce it but here is how I proceed.\nI start eclipse, wait for the UI to come up, wait a second or two. Shutdown.\nOf course this is not really precise but I guess that with setting a few\nbreakpoints this is easily reproduceable.\n\nIn the console, I get the following error which is the result of a thread still\nrunning and loading classes while the framework already stopped (almost). \nHere is an explanation of why this exception is being thrown:\n- The app exit, \n- EclipseStarter calls the shutdown mechanism that stops all the plugins\n(following the prereq graph), \n- The framework shuts down itself, causing the classloaders to be \"closed\". This\nmeans that no more classes can be loaded and any attempt to load classes results\nin NoClassDefFoundErrors.\n\nIt seems to me that in this case, the indexer thread (I believe this is it) has\nnot been killed properly and is still running while the fwk is being shutdown.\n\n\nThe application \"org.eclipse.ui.ide.workbench\" returned with code: 0.\njava.lang.NoClassDefFoundError: org/eclipse/jdt/internal/core/index/EntryResult\n    at\norg.eclipse.jdt.internal.core.index.DiskIndex.addQueryResult(DiskIndex.java:119)\n    at\norg.eclipse.jdt.internal.core.index.DiskIndex.addQueryResults(DiskIndex.java:156)\n    at org.eclipse.jdt.internal.core.index.Index.query(Index.java:128)\n    at\norg.eclipse.jdt.internal.core.search.matching.TypeDeclarationPattern.queryIn(TypeDeclarationPattern.java:189)\n    at\norg.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.findIndexMatches(InternalSearchPattern.java:51)\n    at\norg.eclipse.jdt.internal.core.search.matching.MatchLocator.findIndexMatches(MatchLocator.java:266)",
    "Where is the rest of the trace?\n\nThis doesn\u0027t show who requested the query.",
    "Unfortunately this is the only information available. This has been captured in \nthe console.\nThere is no other info available because when it happens the fwk has been \nshutdown.",
    "Moving to JDT UI.\n\nLooks like the AllTypesCache thread is not shutdown when JDT UI is shutdown.",
    "\n\n*** This bug has been marked as a duplicate of 67753 ***"
  ],
  "commentCreationDates": [
    "2004-06-17T19:57:08+02:00",
    "2004-06-24T17:16:43+02:00",
    "2004-06-24T17:25:02+02:00",
    "2004-06-24T17:51:35+02:00",
    "2004-06-24T17:54:08+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org/eclipse/jdt/internal/core/index/EntryResult",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.index.DiskIndex.addQueryResult",
          "source": "DiskIndex.java:119"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.DiskIndex.addQueryResults",
          "source": "DiskIndex.java:156"
        },
        {
          "method": "org.eclipse.jdt.internal.core.index.Index.query",
          "source": "Index.java:128"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.TypeDeclarationPattern.queryIn",
          "source": "TypeDeclarationPattern.java:189"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.findIndexMatches",
          "source": "InternalSearchPattern.java:51"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.MatchLocator.findIndexMatches",
          "source": "MatchLocator.java:266"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "67681",
      "duplicateId": "67753",
      "date": "2004-06-17T19:57:08+02:00",
      "product": "JDT",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "67753",
  "bugId": "67681",
  "duplicateId": "67753",
  "date": "2004-06-17T19:57:08+02:00",
  "product": "JDT",
  "component": "UI",
  "severity": "normal"
}