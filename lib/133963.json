{
  "comments": [
    "Here is the stack trace of the problem. The problem happens when our client calls CopyToImageUtil.copyToImage().\n\norg.eclipse.jface.util.Assert$AssertionFailedException: Assertion failed: \n\tat org.eclipse.jface.util.Assert.isTrue(Assert.java:182)\n\tat org.eclipse.jface.util.Assert.isTrue(Assert.java:167)\n\tat org.eclipse.gmf.runtime.diagram.ui.OffscreenEditPartFactory.createDiagramEditPart(OffscreenEditPartFactory.java:112)\n\tat org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.createDiagramEditPart(CopyToImageUtil.java:76)\n\tat org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.copyToImage(CopyToImageUtil.java:113)\n\tat com.ibm.ccl.erf.tools.DiagramExtractor.extractDiagramImage(DiagramExtractor.java:68)\n\tat com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule.extractDiagram(DiagramRule.java:634)\n\tat com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule$DiagramExtractionJob.runInUIThread(DiagramRule.java:700)\n\tat org.eclipse.ui.progress.UIJob$1.run(UIJob.java:94)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3323)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2969)\n\tat org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.runEventLoop(EventLoopProgressMonitor.java:123)\n\tat org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.isCanceled(EventLoopProgressMonitor.java:97)\n\tat org.eclipse.core.internal.jobs.ThreadJob.isCanceled(ThreadJob.java:126)\n\tat org.eclipse.core.internal.jobs.ThreadJob.joinRun(ThreadJob.java:161)\n\tat org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:87)\n\tat org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:218)\n\tat org.eclipse.emf.transaction.util.Lock.uiSafeAcquire(Lock.java:371)\n\tat org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.acquire(TransactionalEditingDomainImpl.java:492)\n\tat org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.activate(TransactionalEditingDomainImpl.java:424)\n\tat org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.activate(MSLTXEditingDomain.java:85)\n\tat org.eclipse.emf.transaction.impl.TransactionImpl.start(TransactionImpl.java:136)\n\tat org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.startTransaction(MSLTXEditingDomain.java:68)\n\tat org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.runExclusive(MSLTXEditingDomain.java:166)\n\tat org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain.runExclusive(MSLEditingDomain.java:2197)\n\tat org.eclipse.gmf.runtime.diagram.ui.services.editpart.EditPartService.createEditPart(EditPartService.java:227)\n\tat org.eclipse.gef.ui.parts.AbstractEditPartViewer.setContents(AbstractEditPartViewer.java:587)\n\tat org.eclipse.gmf.runtime.diagram.ui.OffscreenEditPartFactory.createDiagramEditPart(OffscreenEditPartFactory.java:109)\n\tat org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.createDiagramEditPart(CopyToImageUtil.java:76)\n\tat org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.copyToImage(CopyToImageUtil.java:113)\n\tat com.ibm.ccl.erf.tools.DiagramExtractor.extractDiagramImage(DiagramExtractor.java:68)\n\tat com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule.extractDiagram(DiagramRule.java:634)\n\tat com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule$DiagramExtractionJob.runInUIThread(DiagramRule.java:700)\n\tat org.eclipse.ui.progress.UIJob$1.run(UIJob.java:94)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3323)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2969)\n\tat org.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:158)\n\tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:326)\n\tat org.eclipse.jface.dialogs.ProgressMonitorDialog.run(ProgressMonitorDialog.java:470)\n\tat com.ibm.xtools.publish.ui.internal.PublishUIDelegate.doPublish(PublishUIDelegate.java:131)\n\tat com.ibm.xtools.publish.ui.internal.PublishUIDelegate.doPublish(PublishUIDelegate.java:60)\n\tat com.ibm.xtools.publish.ui.internal.actions.AbstractPublishUIActionDelegate.doRun(AbstractPublishUIActionDelegate.java:126)\n\tat org.eclipse.gmf.runtime.common.ui.action.AbstractActionDelegate.run(AbstractActionDelegate.java:403)\n\tat org.eclipse.gmf.runtime.common.ui.action.ActionManager$1.run(ActionManager.java:246)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat org.eclipse.gmf.runtime.common.ui.action.ActionManager.run(ActionManager.java:244)\n\tat org.eclipse.gmf.runtime.common.ui.action.AbstractActionDelegate.run(AbstractActionDelegate.java:245)\n\tat org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:254)\n\tat org.eclipse.ui.internal.WWinPluginAction.runWithEvent(WWinPluginAction.java:229)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:539)\n\tat org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n\tat org.eclipse.jface.action.ActionContributionItem$6.handleEvent(ActionContributionItem.java:441)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:925)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3346)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2966)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1909)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1873)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:418)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:107)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\n\tat org.eclipse.core.launcher.Main.run(Main.java:977)\n\tat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Why in your stack is the copyToImage method being reentered?  \n\nI\u0027m unable to duplicate the problem in a simple test...\n\npublic void testCopyToImageOffscreenUtilTest_BMP()\n        throws Exception {\n        copyToImageOffscreenTestForFormat(\".bmp\", ImageFileFormat.BMP);//$NON-NLS-1$ \n}\n\nprivate void copyToImageOffscreenTestForFormat(String suffix, ImageFileFormat type)\n        throws IOException, CoreException {\n        IProgressMonitor monitor \u003d new NullProgressMonitor();\n        File file \u003d File.createTempFile(\"test\", suffix);//$NON-NLS-1$ \n        IPath tmpDest \u003d new Path(file.getPath());\n\n        // export to each file type\n        new CopyToImageUtil().copyToImage(getDiagramEditPart().getDiagramView(), tmpDest, type,\n            monitor, getDiagramEditPart().getDiagramPreferencesHint());\n\n        RenderedImage ri \u003d RenderedImageFactory.getInstance(tmpDest.toString());\n        assertTrue(\"RenderedImage is null\", ri !\u003d null);//$NON-NLS-1$ \n        assertTrue(\"SWTImage is null\", ri.getSWTImage() !\u003d null);//$NON-NLS-1$ \n        file.delete();\n}"
  ],
  "commentCreationDates": [
    "2006-03-30T01:32:02+02:00",
    "2006-04-11T23:27:33+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.jface.util.Assert$AssertionFailedException",
      "message": "Assertion failed:",
      "elements": [
        {
          "method": "org.eclipse.jface.util.Assert.isTrue",
          "source": "Assert.java:182"
        },
        {
          "method": "org.eclipse.jface.util.Assert.isTrue",
          "source": "Assert.java:167"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.OffscreenEditPartFactory.createDiagramEditPart",
          "source": "OffscreenEditPartFactory.java:112"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.createDiagramEditPart",
          "source": "CopyToImageUtil.java:76"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.copyToImage",
          "source": "CopyToImageUtil.java:113"
        },
        {
          "method": "com.ibm.ccl.erf.tools.DiagramExtractor.extractDiagramImage",
          "source": "DiagramExtractor.java:68"
        },
        {
          "method": "com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule.extractDiagram",
          "source": "DiagramRule.java:634"
        },
        {
          "method": "com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule$DiagramExtractionJob.runInUIThread",
          "source": "DiagramRule.java:700"
        },
        {
          "method": "org.eclipse.ui.progress.UIJob$1.run",
          "source": "UIJob.java:94"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3323"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2969"
        },
        {
          "method": "org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.runEventLoop",
          "source": "EventLoopProgressMonitor.java:123"
        },
        {
          "method": "org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.isCanceled",
          "source": "EventLoopProgressMonitor.java:97"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.isCanceled",
          "source": "ThreadJob.java:126"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.joinRun",
          "source": "ThreadJob.java:161"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ImplicitJobs.begin",
          "source": "ImplicitJobs.java:87"
        },
        {
          "method": "org.eclipse.core.internal.jobs.JobManager.beginRule",
          "source": "JobManager.java:218"
        },
        {
          "method": "org.eclipse.emf.transaction.util.Lock.uiSafeAcquire",
          "source": "Lock.java:371"
        },
        {
          "method": "org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.acquire",
          "source": "TransactionalEditingDomainImpl.java:492"
        },
        {
          "method": "org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.activate",
          "source": "TransactionalEditingDomainImpl.java:424"
        },
        {
          "method": "org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.activate",
          "source": "MSLTXEditingDomain.java:85"
        },
        {
          "method": "org.eclipse.emf.transaction.impl.TransactionImpl.start",
          "source": "TransactionImpl.java:136"
        },
        {
          "method": "org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.startTransaction",
          "source": "MSLTXEditingDomain.java:68"
        },
        {
          "method": "org.eclipse.gmf.runtime.emf.core.internal.domain.MSLTXEditingDomain.runExclusive",
          "source": "MSLTXEditingDomain.java:166"
        },
        {
          "method": "org.eclipse.gmf.runtime.emf.core.internal.domain.MSLEditingDomain.runExclusive",
          "source": "MSLEditingDomain.java:2197"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.services.editpart.EditPartService.createEditPart",
          "source": "EditPartService.java:227"
        },
        {
          "method": "org.eclipse.gef.ui.parts.AbstractEditPartViewer.setContents",
          "source": "AbstractEditPartViewer.java:587"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.OffscreenEditPartFactory.createDiagramEditPart",
          "source": "OffscreenEditPartFactory.java:109"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.createDiagramEditPart",
          "source": "CopyToImageUtil.java:76"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToImageUtil.copyToImage",
          "source": "CopyToImageUtil.java:113"
        },
        {
          "method": "com.ibm.ccl.erf.tools.DiagramExtractor.extractDiagramImage",
          "source": "DiagramExtractor.java:68"
        },
        {
          "method": "com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule.extractDiagram",
          "source": "DiagramRule.java:634"
        },
        {
          "method": "com.ibm.xtools.publish.uml2.internal.traversal.DiagramRule$DiagramExtractionJob.runInUIThread",
          "source": "DiagramRule.java:700"
        },
        {
          "method": "org.eclipse.ui.progress.UIJob$1.run",
          "source": "UIJob.java:94"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3323"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2969"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.block",
          "source": "ModalContext.java:158"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:326"
        },
        {
          "method": "org.eclipse.jface.dialogs.ProgressMonitorDialog.run",
          "source": "ProgressMonitorDialog.java:470"
        },
        {
          "method": "com.ibm.xtools.publish.ui.internal.PublishUIDelegate.doPublish",
          "source": "PublishUIDelegate.java:131"
        },
        {
          "method": "com.ibm.xtools.publish.ui.internal.PublishUIDelegate.doPublish",
          "source": "PublishUIDelegate.java:60"
        },
        {
          "method": "com.ibm.xtools.publish.ui.internal.actions.AbstractPublishUIActionDelegate.doRun",
          "source": "AbstractPublishUIActionDelegate.java:126"
        },
        {
          "method": "org.eclipse.gmf.runtime.common.ui.action.AbstractActionDelegate.run",
          "source": "AbstractActionDelegate.java:403"
        },
        {
          "method": "org.eclipse.gmf.runtime.common.ui.action.ActionManager$1.run",
          "source": "ActionManager.java:246"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.gmf.runtime.common.ui.action.ActionManager.run",
          "source": "ActionManager.java:244"
        },
        {
          "method": "org.eclipse.gmf.runtime.common.ui.action.AbstractActionDelegate.run",
          "source": "AbstractActionDelegate.java:245"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:254"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPluginAction.runWithEvent",
          "source": "WWinPluginAction.java:229"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:539"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$6.handleEvent",
          "source": "ActionContributionItem.java:441"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:925"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3346"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2966"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1909"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1873"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:418"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:107"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "133963",
      "date": "2006-03-30T01:32:02+02:00",
      "product": "GMF",
      "component": "Runtime Diagram",
      "severity": "normal"
    }
  ],
  "groupId": "133963",
  "bugId": "133963",
  "date": "2006-03-30T01:32:02+02:00",
  "product": "GMF",
  "component": "Runtime Diagram",
  "severity": "normal"
}