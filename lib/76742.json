{
  "comments": [
    "I200410190941\n\nFound this in my .log - sorry no steps.\n\n!ENTRY org.eclipse.jdt.debug 4 5010 2004-10-21 12:05:28.866\n!MESSAGE At least one target failed to drop to frame after successful hot code\nreplace.\n!SUBENTRY 1 org.eclipse.jdt.debug 4 100 2004-10-21 12:05:28.866\n!MESSAGE Unable to retrieve stack frame - thread not suspended.\n!STACK 0\ncom.sun.jdi.IncompatibleThreadStateException: Thread was not suspended\n\tat\norg.eclipse.jdi.internal.ThreadReferenceImpl.frames(ThreadReferenceImpl.java:192)\n\tat org.eclipse.jdi.internal.ThreadReferenceImpl.frame(ThreadReferenceImpl.java:140)\n\tat\norg.eclipse.jdt.internal.debug.core.model.JDIThread.getUnderlyingFrame(JDIThread.java:571)\n\tat\norg.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingStackFrame(JDIStackFrame.java:976)\n\tat\norg.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingMethod(JDIStackFrame.java:227)\n\tat\norg.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getDeclaringTypeName(JDIStackFrame.java:713)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.containsChangedType(JavaHotCodeReplaceManager.java:777)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.getAffectedFrame(JavaHotCodeReplaceManager.java:719)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.getAffectedFrames(JavaHotCodeReplaceManager.java:681)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.attemptPopFrames(JavaHotCodeReplaceManager.java:631)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace(JavaHotCodeReplaceManager.java:382)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0(JavaHotCodeReplaceManager.java:363)\n\tat\norg.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run(JavaHotCodeReplaceManager.java:292)\n\tat org.eclipse.debug.core.DebugPlugin$AsynchJob.run(DebugPlugin.java:876)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:66)",
    "Looking at JavaHotCodeReplaceManager.doHotCodeRepalce(...), we are logging an \nerror via a multi-status: one target failed to drop frames. We should just be \nnotifying the user of the failed pop, rather than logging the exception.",
    "Exceptions can occur at different points during the HCR and they\u0027re all put into \nthe multi-status which is reported and logged at the end. Are you suggesting \nthat we keep the \"drop to frame\" exceptions separately and not log them? Or are \nyou saying that we shouldn\u0027t log any exceptions that occur during an HCR?\n\nReporting the problem to the user is great and all, but it doesn\u0027t replace \nlogging, which is helpful for bug reports like this one.\n\nThe logged exception in this case is interesting - Why are we getting an \nincompatible thread state exception?",
    "(adding DW as CC for previous comment)",
    "We check if the thread is suspended in getAffectedFrames(...). There could be a \ntiming issue here if the threads gets resumed (through divine user timing) after \nwe do the suspended check and before we have a chance to ask our questions about \nthe stack frame.\n\nSince this is something that is \"expected\" and not a big deal, I think it\u0027s safe \nto catch the incompatible thread state and do nothing - not report it to the \nuser *or* log it.",
    "Agreed, this particular error should not be logged.",
    "Fixed in JavaHotCodeReplaceManager. Please verify, DW.",
    "Verified."
  ],
  "commentCreationDates": [
    "2004-10-21T15:33:54+02:00",
    "2004-10-21T17:26:50+02:00",
    "2004-10-21T19:07:06+02:00",
    "2004-10-21T19:07:31+02:00",
    "2004-10-21T19:12:54+02:00",
    "2004-10-21T19:16:59+02:00",
    "2004-10-21T21:19:11+02:00",
    "2004-10-22T20:18:52+02:00"
  ],
  "traces": [
    {
      "exceptionType": "com.sun.jdi.IncompatibleThreadStateException",
      "message": "Thread was not suspended",
      "elements": [
        {
          "method": "org.eclipse.jdi.internal.ThreadReferenceImpl.frames",
          "source": "ThreadReferenceImpl.java:192"
        },
        {
          "method": "org.eclipse.jdi.internal.ThreadReferenceImpl.frame",
          "source": "ThreadReferenceImpl.java:140"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.model.JDIThread.getUnderlyingFrame",
          "source": "JDIThread.java:571"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingStackFrame",
          "source": "JDIStackFrame.java:976"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingMethod",
          "source": "JDIStackFrame.java:227"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getDeclaringTypeName",
          "source": "JDIStackFrame.java:713"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.containsChangedType",
          "source": "JavaHotCodeReplaceManager.java:777"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.getAffectedFrame",
          "source": "JavaHotCodeReplaceManager.java:719"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.getAffectedFrames",
          "source": "JavaHotCodeReplaceManager.java:681"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.attemptPopFrames",
          "source": "JavaHotCodeReplaceManager.java:631"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace",
          "source": "JavaHotCodeReplaceManager.java:382"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0",
          "source": "JavaHotCodeReplaceManager.java:363"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run",
          "source": "JavaHotCodeReplaceManager.java:292"
        },
        {
          "method": "org.eclipse.debug.core.DebugPlugin$AsynchJob.run",
          "source": "DebugPlugin.java:876"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:66"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "76742",
      "date": "2004-10-21T15:33:54+02:00",
      "product": "JDT",
      "component": "Debug",
      "severity": "normal"
    }
  ],
  "groupId": "76742",
  "bugId": "76742",
  "date": "2004-10-21T15:33:54+02:00",
  "product": "JDT",
  "component": "Debug",
  "severity": "normal"
}