{
  "comments": [
    "With eclipse-3.3RC2 on WinXP, Sun Java 1.6.0_01\n\n* Applied a patch that created two new files\n* Performed a Search for a String that appers in one old and two new files\n  (PFWorkspaceJob.java and another one)\n* From the search results, select one old file (SaveRSEDOMJob.java) and one\n  new file (PFWorkspaceJob.java), righ-click \u003e Compare with Each Other\n* From the Compare Editor, edit the new file and press Save\n\n--\u003e Get a Dialog showing this:\nAn internal error occurred during: \"Update comparison Compare (PFWorkspaceJob.java-SaveRSEDOMJob.java)\".\njava.lang.NullPointerException\n\n\"Save\" did not complete normally.  Please see the log for more information.\njava.lang.NullPointerException\n\nMy log has more NPEs that might warrant opening other bugs as well. See the full .log file attached.",
    "Created an attachment (id\u003d69936)\n.log file showing the errors\n\n",
    "I\u0027ve tried a few simple things and haven\u0027t been able to reproduce the failure. Is this reproducable for you? If so, can you give me the repository/project to check out so I can try your exact scenario?",
    "*** Bug 192302 has been marked as a duplicate of this bug. ***",
    "I think the problem is that we are performing operation involving an IDocument in the background and the text framework requires such accesses to happen in the foreground. We should investigate whether we can safely address this in 3.3.1.",
    "Steps to reproduce in I20070615-1200:\n\n- new workspace\n- paste to Package Explorer:\npackage p;\npublic class C {\n}\npackage p;\npublic class D {\n}\n\n- select C.java and D.java in Package Explorer and choose context menu \u003e Compare With \u003e Each Other\n- type a space \n- give focus to another part (e.g. open Error Log view)\n\nError\nTue Jun 19 16:04:41 CEST 2007\nAn internal error occurred during: \"Update comparison Compare (C.java-D.java)\".\n\njava.lang.NullPointerException\n\tat org.eclipse.jface.text.AbstractDocument.computeIndexInPositionList(AbstractDocument.java:472)\n\tat org.eclipse.jface.text.AbstractDocument.addPosition(AbstractDocument.java:356)\n\tat org.eclipse.compare.structuremergeviewer.DocumentRangeNode.registerPositionUpdater(DocumentRangeNode.java:105)\n\tat org.eclipse.compare.structuremergeviewer.DocumentRangeNode.\u003cinit\u003e(DocumentRangeNode.java:98)\n\tat org.eclipse.jdt.internal.ui.compare.JavaNode.\u003cinit\u003e(JavaNode.java:56)\n\tat org.eclipse.jdt.internal.ui.compare.JavaParseTreeBuilder.push(JavaParseTreeBuilder.java:174)\n\tat org.eclipse.jdt.internal.ui.compare.JavaParseTreeBuilder.visit(JavaParseTreeBuilder.java:69)\n\tat org.eclipse.jdt.core.dom.TypeDeclaration.accept0(TypeDeclaration.java:466)\n\tat org.eclipse.jdt.core.dom.ASTNode.accept(ASTNode.java:2476)\n\tat org.eclipse.jdt.core.dom.ASTNode.acceptChildren(ASTNode.java:2546)\n\tat org.eclipse.jdt.core.dom.CompilationUnit.accept0(CompilationUnit.java:213)\n\tat org.eclipse.jdt.core.dom.ASTNode.accept(ASTNode.java:2476)\n\tat org.eclipse.jdt.internal.ui.compare.JavaStructureCreator.createStructureComparator(JavaStructureCreator.java:294)\n\tat org.eclipse.jdt.internal.ui.compare.JavaStructureCreator.getStructure(JavaStructureCreator.java:243)\n\tat org.eclipse.compare.structuremergeviewer.StructureCreator.createStructure(StructureCreator.java:97)\n\tat org.eclipse.compare.structuremergeviewer.StructureDiffViewer$StructureInfo.createStructure(StructureDiffViewer.java:157)\n\tat org.eclipse.compare.structuremergeviewer.StructureDiffViewer$StructureInfo.refresh(StructureDiffViewer.java:135)\n\tat org.eclipse.compare.structuremergeviewer.StructureDiffViewer$3.run(StructureDiffViewer.java:88)\n\tat org.eclipse.compare.internal.Worker.performNextTask(Worker.java:116)\n\tat org.eclipse.compare.internal.Worker.run(Worker.java:63)\n\tat org.eclipse.compare.internal.WorkerJob.run(WorkerJob.java:30)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\n",
    "Created an attachment (id\u003d74079)\nPatch to manipulate document in the UI thread\n\n",
    "I am not able to reproduce this with the steps from comment 5. Does this work (or fail) every time for you Markus? Does it matter where you put the space? I suspect that moving the access to IDocument to the UI thread will fix the problem but it would be nice if I was able to prove that.",
    "Sorry, steps were not sufficient. I can reproduce every time in I20070717-1020 when I replace the last step of comment 5 with:\n- open Error Log view by pressing Alt+Shift+Q, L\n\nWith the patch, the NPE is gone.",
    "Thanks Markus. I released the patch to HEAD with a slight modification and will release it to 3.3.1 before the next maintenance build.",
    "Patch released to 3.3.1.",
    "I\u0027ve tried the steps provided by Markus using both I20070615-1200 and I20070717-1020 but I haven\u0027t been able to reproduce the failure. On the other hand, I haven\u0027t been able to reproduce it on 3.4M1 (I20070809-1105) neither. Michael, did you succeed in reproducing the failure using Markus\u0027 steps?",
    "*** Bug 198830 has been marked as a duplicate of this bug. ***",
    "*** Bug 200781 has been marked as a duplicate of this bug. ***",
    "No , I never was but Markus confirmed that the patch fixed the problem for him (see comment 8).",
    "I can still reproduce with 3.3 (I20070625-1500), and I verified again in M20070822-0800 and I20070828-0800 that the bug is really fixed.\nYou might need a dual-core processor to reproduce the problem."
  ],
  "commentCreationDates": [
    "2007-06-04T13:01:43+02:00",
    "2007-06-04T13:02:06+02:00",
    "2007-06-04T20:14:14+02:00",
    "2007-06-18T17:52:31+02:00",
    "2007-06-18T17:54:11+02:00",
    "2007-06-19T16:08:27+02:00",
    "2007-07-18T19:18:55+02:00",
    "2007-07-18T19:51:32+02:00",
    "2007-07-19T18:35:01+02:00",
    "2007-07-19T19:02:18+02:00",
    "2007-07-24T15:58:26+02:00",
    "2007-08-22T17:31:44+02:00",
    "2007-08-23T13:51:49+02:00",
    "2007-08-23T13:52:58+02:00",
    "2007-08-28T18:52:14+02:00",
    "2007-08-29T11:12:59+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jface.text.AbstractDocument.computeIndexInPositionList",
          "source": "AbstractDocument.java:472"
        },
        {
          "method": "org.eclipse.jface.text.AbstractDocument.addPosition",
          "source": "AbstractDocument.java:356"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.DocumentRangeNode.registerPositionUpdater",
          "source": "DocumentRangeNode.java:105"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.DocumentRangeNode.\u003cinit\u003e",
          "source": "DocumentRangeNode.java:98"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.compare.JavaNode.\u003cinit\u003e",
          "source": "JavaNode.java:56"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.compare.JavaParseTreeBuilder.push",
          "source": "JavaParseTreeBuilder.java:174"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.compare.JavaParseTreeBuilder.visit",
          "source": "JavaParseTreeBuilder.java:69"
        },
        {
          "method": "org.eclipse.jdt.core.dom.TypeDeclaration.accept0",
          "source": "TypeDeclaration.java:466"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.accept",
          "source": "ASTNode.java:2476"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.acceptChildren",
          "source": "ASTNode.java:2546"
        },
        {
          "method": "org.eclipse.jdt.core.dom.CompilationUnit.accept0",
          "source": "CompilationUnit.java:213"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.accept",
          "source": "ASTNode.java:2476"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.compare.JavaStructureCreator.createStructureComparator",
          "source": "JavaStructureCreator.java:294"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.compare.JavaStructureCreator.getStructure",
          "source": "JavaStructureCreator.java:243"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.StructureCreator.createStructure",
          "source": "StructureCreator.java:97"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.StructureDiffViewer$StructureInfo.createStructure",
          "source": "StructureDiffViewer.java:157"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.StructureDiffViewer$StructureInfo.refresh",
          "source": "StructureDiffViewer.java:135"
        },
        {
          "method": "org.eclipse.compare.structuremergeviewer.StructureDiffViewer$3.run",
          "source": "StructureDiffViewer.java:88"
        },
        {
          "method": "org.eclipse.compare.internal.Worker.performNextTask",
          "source": "Worker.java:116"
        },
        {
          "method": "org.eclipse.compare.internal.Worker.run",
          "source": "Worker.java:63"
        },
        {
          "method": "org.eclipse.compare.internal.WorkerJob.run",
          "source": "WorkerJob.java:30"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 5,
      "bugId": "190778",
      "date": "2007-06-19T16:08:27+02:00",
      "product": "Platform",
      "component": "Compare",
      "severity": "normal"
    }
  ],
  "groupId": "190778",
  "bugId": "190778",
  "date": "2007-06-04T13:01:43+02:00",
  "product": "Platform",
  "component": "Compare",
  "severity": "normal"
}