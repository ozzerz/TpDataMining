{
  "comments": [
    "Steps To Reproduce:\n\n(1) Create a new extension point schema\n(2) Create a new element\n(3) Delete the new element\u0027s name by making the \"Name\" field empty\n(4) Switch to the source page\n(5) Switch back to the \"Definition\" form page\n    -\u003e BUG:  NPE produced (see below)\n\nAt this point everything goes haywire because the model is corrupt.\n\nThere are two problems here:\n(1) The form page allows the user to specify an empty element name\n    -\u003e If the user specifies an empty field name, we should revert\n       it back to a previous valid value (perhaps when the focus is lost?)\n(2) The schema model does not guard against empty names on load\n    -\u003e We should guard against NPEs\n\njava.lang.NullPointerException\n\tat org.eclipse.pde.internal.core.schema.Schema.processElement(Schema.java:646)\n\tat org.eclipse.pde.internal.core.schema.Schema.traverseDocumentTree(Schema.java:923)\n\tat org.eclipse.pde.internal.core.schema.Schema.load(Schema.java:391)\n\tat org.eclipse.pde.internal.core.schema.Schema.reload(Schema.java:783)\n\tat org.eclipse.pde.internal.ui.editor.schema.SchemaInputContext.synchronizeModel(SchemaInputContext.java:160)\n\tat org.eclipse.pde.internal.ui.editor.context.InputContext.synchronizeModelIfNeeded(InputContext.java:360)\n\tat org.eclipse.pde.internal.ui.editor.context.InputContext.isModelCorrect(InputContext.java:382)\n\tat org.eclipse.pde.internal.ui.editor.XMLSourcePage.canLeaveThePage(XMLSourcePage.java:27)\n\tat org.eclipse.ui.forms.editor.FormEditor.pageChange(FormEditor.java:478)\n\tat org.eclipse.pde.internal.ui.editor.PDEFormEditor.pageChange(PDEFormEditor.java:290)",
    "Created an attachment (id\u003d73782)\npatch\n\nWith this patch, when the attribute name and element name fields lose focus, their text will be reverted to the previous contents if they are empty. This will leave the editor in a dirty state even if it was not previously similarly to pressing the escape key. I have opened bug 196520 to address the issue of the escape key leaving the editor dirty. When there is a fix available for that, it should be applied to this case as well.\n\nThis patch also marks the schema model as invalid if any element or attribute names are empty when it is built. This results in the user being unable to leave the source page if they enter an empty name.",
    "Based on bug 196520 comment 1, it is fine that this patch leaves the editor in a dirty state after reverting the name.",
    "(From update of attachment 73782)\nExcellent patch, Adam.  Thanks.",
    "Patch applied to HEAD.\n\nTarget: 3.4 M1",
    "Unfortunately, the patch causes compositors not to be loaded correctly.  \nUpon closer inspection one method is being used to process both elements and element references so null is a valid value for the \"name\" attribute if an element reference is being processed.\n\nSorry Adam, I should have caught this.",
    "Created an attachment (id\u003d73889)\npatch correcting the problem\n\nThis patch is to be applied on top of the previous one. It corrects the compositor loading problem.\n\nThe processElement method is split into processElementReference and processElementDeclaration to avoid confusion in the future.",
    "(From update of attachment 73889)\nTested well, Adam.  Thanks.",
    "Patch released to HEAD."
  ],
  "commentCreationDates": [
    "2007-07-12T17:25:07+02:00",
    "2007-07-14T01:02:00+02:00",
    "2007-07-16T16:21:00+02:00",
    "2007-07-16T17:15:29+02:00",
    "2007-07-16T17:16:02+02:00",
    "2007-07-16T21:18:06+02:00",
    "2007-07-16T21:45:21+02:00",
    "2007-07-16T23:15:08+02:00",
    "2007-07-16T23:15:41+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.pde.internal.core.schema.Schema.processElement",
          "source": "Schema.java:646"
        },
        {
          "method": "org.eclipse.pde.internal.core.schema.Schema.traverseDocumentTree",
          "source": "Schema.java:923"
        },
        {
          "method": "org.eclipse.pde.internal.core.schema.Schema.load",
          "source": "Schema.java:391"
        },
        {
          "method": "org.eclipse.pde.internal.core.schema.Schema.reload",
          "source": "Schema.java:783"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.schema.SchemaInputContext.synchronizeModel",
          "source": "SchemaInputContext.java:160"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.context.InputContext.synchronizeModelIfNeeded",
          "source": "InputContext.java:360"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.context.InputContext.isModelCorrect",
          "source": "InputContext.java:382"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.XMLSourcePage.canLeaveThePage",
          "source": "XMLSourcePage.java:27"
        },
        {
          "method": "org.eclipse.ui.forms.editor.FormEditor.pageChange",
          "source": "FormEditor.java:478"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.PDEFormEditor.pageChange",
          "source": "PDEFormEditor.java:290"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "196335",
      "date": "2007-07-12T17:25:07+02:00",
      "product": "PDE",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "196335",
  "bugId": "196335",
  "date": "2007-07-12T17:25:07+02:00",
  "product": "PDE",
  "component": "UI",
  "severity": "normal"
}