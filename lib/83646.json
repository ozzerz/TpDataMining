{
  "comments": [
    "Build: I20050118\n\nI got the following NPE while renaming a Java package.  I have zipped up my\nproject and can make it available if necessary.\n\njava.lang.NullPointerException\n\tat\norg.eclipse.jdt.internal.debug.core.refactoring.JavaBreakpointTypeChange.performPackageRename(JavaBreakpointTypeChange.java:336)\n\tat\norg.eclipse.jdt.internal.debug.core.refactoring.JavaBreakpointTypeChange.perform(JavaBreakpointTypeChange.java:241)\n\tat\norg.eclipse.ltk.core.refactoring.CompositeChange.perform(CompositeChange.java:262)\n\tat\norg.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run(PerformChangeOperation.java:231)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1703)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1723)\n\tat\norg.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange(PerformChangeOperation.java:279)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.access$4(UIPerformChangeOperation.java:1)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$1.run(UIPerformChangeOperation.java:70)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2787)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2458)\n\tat\norg.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:151)\n\tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:301)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run(RefactoringWizardDialog2.java:282)\n\tat\norg.eclipse.ltk.ui.refactoring.RefactoringWizard.internalPerformFinish(RefactoringWizard.java:539)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.PreviewWizardPage.performFinish(PreviewWizardPage.java:175)\n\tat\norg.eclipse.ltk.ui.refactoring.RefactoringWizard.performFinish(RefactoringWizard.java:605)\n\tat\norg.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.okPressed(RefactoringWizardDialog2.java:406)\n\tat org.eclipse.jface.dialogs.Dialog.buttonPressed(Dialog.java:396)\n\tat org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:543)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:89)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:833)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2810)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2455)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:718)\n\tat org.eclipse.jface.window.Window.open(Window.java:696)\n\tat\norg.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:125)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat\norg.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:138)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate(RefactoringStarter.java:40)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.UserInterfaceStarter.activate(UserInterfaceStarter.java:56)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.reorg.RenameUserInterfaceStarter.activate(RenameUserInterfaceStarter.java:113)\n\tat org.eclipse.jdt.ui.refactoring.RenameSupport.openDialog(RenameSupport.java:114)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:178)\n\tat\norg.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:99)\n\tat org.eclipse.jdt.ui.actions.RenameAction.run(RenameAction.java:107)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:212)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:188)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:989)\n\tat\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:555)\n\tat\norg.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:505)\n\tat\norg.eclipse.jface.action.ActionContributionItem$6.handleEvent(ActionContributionItem.java:419)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:833)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2810)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2455)",
    "Created an attachment (id\u003d17431)\nLog file\n",
    "The NPE happens in the Debug participant. Moving to Debug.",
    "The NPE appears when trying to rename a package to a sub-package of itself\n(test -\u003e test.sub), if the package contains Java breakpoints.\n\nThe Java Breakpoint participants rely on the fact than when perform() is called,\nthe workspace is already in the new state (the \u0027after refactoring\u0027 state). But\nin this case, the state of the workspace doesn\u0027t look good.\n\nIf the project was :\n\nProject Test\n+ package test\n  + compilation unit HW.java\n\nWhen the perform() method of the change is called, the project still looks the same.\nI would have excepted it to look like :\n\nProject Test\n+ package test\n+ package test.sub\n  + compilation unit HW.java\n\nThe consequense is project.findType(\"test.sub.HW\") returns null, and an NPE is\nthrown when we try to use this value.\n\nIt\u0027s only a problem when renaming to a sub package. It works fine in the other\ncases (test.sub1 -\u003e tes2.subA, test.sub -\u003e test).\n\nMoving to JDT/UI for comment.",
    "The refactoring calls IPackageFragment#rename(\"test.sub\", false, pm);\n\nThe renaming is executed correctly, but if I ask the package fragment root after\nthe rename for its package I still get only \"test\" not \"test\" and \"test.sub\" (as\nLus pointed out).\n\nMoving to JDT/Core for comments. The Java Model should reflect the changes in\nall cases.\n\nLuc, is it possible that Debug protects itself against the NPE. I all cases it\nis better to log this and do nothing instead of blowing up the refactoring.",
    "Changed JavaModelOperation#run(...) to close the parent element of the created\nelement and to reset the corresponding project\u0027s cache.\nAdded regresison test RenameTests#testRenamePF3()",
    "Verified in I20050214-0927"
  ],
  "commentCreationDates": [
    "2005-01-25T19:42:09+01:00",
    "2005-01-25T19:42:32+01:00",
    "2005-01-26T09:42:35+01:00",
    "2005-01-26T20:15:34+01:00",
    "2005-01-27T10:39:50+01:00",
    "2005-01-28T11:42:23+01:00",
    "2005-02-15T16:08:49+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.debug.core.refactoring.JavaBreakpointTypeChange.performPackageRename",
          "source": "JavaBreakpointTypeChange.java:336"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.core.refactoring.JavaBreakpointTypeChange.perform",
          "source": "JavaBreakpointTypeChange.java:241"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.CompositeChange.perform",
          "source": "CompositeChange.java:262"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run",
          "source": "PerformChangeOperation.java:231"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1703"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1723"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange",
          "source": "PerformChangeOperation.java:279"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.access$4",
          "source": "UIPerformChangeOperation.java:1"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$1.run",
          "source": "UIPerformChangeOperation.java:70"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:118"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:2787"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2458"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.block",
          "source": "ModalContext.java:151"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:301"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run",
          "source": "RefactoringWizardDialog2.java:282"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizard.internalPerformFinish",
          "source": "RefactoringWizard.java:539"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.PreviewWizardPage.performFinish",
          "source": "PreviewWizardPage.java:175"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizard.performFinish",
          "source": "RefactoringWizard.java:605"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.okPressed",
          "source": "RefactoringWizardDialog2.java:406"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.buttonPressed",
          "source": "Dialog.java:396"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog$2.widgetSelected",
          "source": "Dialog.java:543"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:833"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2810"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2455"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:718"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:696"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run",
          "source": "RefactoringWizardOpenOperation.java:125"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run",
          "source": "RefactoringWizardOpenOperation.java:138"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate",
          "source": "RefactoringStarter.java:40"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.UserInterfaceStarter.activate",
          "source": "UserInterfaceStarter.java:56"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.reorg.RenameUserInterfaceStarter.activate",
          "source": "RenameUserInterfaceStarter.java:113"
        },
        {
          "method": "org.eclipse.jdt.ui.refactoring.RenameSupport.openDialog",
          "source": "RenameSupport.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:178"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:99"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.RenameAction.run",
          "source": "RenameAction.java:107"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:212"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:188"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:989"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:555"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:505"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$6.handleEvent",
          "source": "ActionContributionItem.java:419"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:833"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2810"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2455"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "83646",
      "date": "2005-01-25T19:42:09+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "83646",
  "bugId": "83646",
  "date": "2005-01-25T19:42:09+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}