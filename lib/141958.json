{
  "comments": [
    "N20060516-0010\n\nI played around with external browser settings and help. When I closed the Cheat Sheets view, I got an error dialog and this log entry:\n\njava.lang.ClassCastException: org.eclipse.ui.internal.browser.SystemBrowserInstance\nat org.eclipse.ui.internal.browser.DefaultBrowserSupport.removeBrowser(DefaultBrowserSupport.java:175)\nat org.eclipse.ui.internal.browser.InternalBrowserInstance$1.partClosed(InternalBrowserInstance.java:66)\nat org.eclipse.ui.internal.PartListenerList$3.run(PartListenerList.java:102)\nat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\nat org.eclipse.core.runtime.Platform.run(Platform.java:843)\nat org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)\nat org.eclipse.ui.internal.PartListenerList.firePartClosed(PartListenerList.java:100)\nat org.eclipse.ui.internal.PartService.firePartClosed(PartService.java:100)\nat org.eclipse.ui.internal.WorkbenchPagePartList.firePartClosed(WorkbenchPagePartList.java:38)\nat org.eclipse.ui.internal.PartList.partClosed(PartList.java:255)\nat org.eclipse.ui.internal.PartList.removePart(PartList.java:176)\nat org.eclipse.ui.internal.WorkbenchPage.disposePart(WorkbenchPage.java:1540)\nat org.eclipse.ui.internal.WorkbenchPage.partRemoved(WorkbenchPage.java:1533)\nat org.eclipse.ui.internal.ViewFactory.releaseView(ViewFactory.java:252)\nat org.eclipse.ui.internal.Perspective.hideView(Perspective.java:494)\nat org.eclipse.ui.internal.WorkbenchPage.hideView(WorkbenchPage.java:2201)\nat org.eclipse.ui.internal.ViewPane.doHide(ViewPane.java:213)\nat org.eclipse.ui.internal.PartStack.close(PartStack.java:499)\nat org.eclipse.ui.internal.PartStack.close(PartStack.java:482)\nat org.eclipse.ui.internal.PartStack$1.close(PartStack.java:106)\nat org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:81)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:267)\nat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:276)\nat org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1(DefaultTabFolder.java:1)\nat org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed(DefaultTabFolder.java:67)\nat org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners(PaneFolder.java:580)\nat org.eclipse.ui.internal.presentations.PaneFolder$3.close(PaneFolder.java:187)\nat org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:2107)\nat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:292)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:585)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Do you have a specific sequence of steps that will reproduce this?",
    "Sorry, no exact steps.\n\nBut looking at the usage of browserIdMap in DefaultBrowserSupport, it is not unlikely that the value of an browserIdMap is an IWebBrowser.",
    "From a quick look at the code for the DefaultBrowserSupport.removeBrowser() method, I do not see any casts to SystemBrowserInstance. Furthermore, the method appears to ensure type safety. I think this has been resolved.",
    "(In reply to comment #3)\n\u003e From a quick look at the code for the DefaultBrowserSupport.removeBrowser()\n\u003e method, I do not see any casts to SystemBrowserInstance. Furthermore, the\n\u003e method appears to ensure type safety. I think this has been resolved.\n\nNo. Nobody talked about a cast to SystemBrowserInstance. If you look at the history of DefaultBrowserSupport, you can see that the file has not even been touched since this bug was filed.\n\nThe CCE happens on line 175:\n\t\t\tHashMap wmap \u003d (HashMap) browserIdMap.get(baseId);\n\nApparently, the browserIdMap contains an entry with a value of type SystemBrowserInstance. This can e.g. occur on line 146:\n\t\t\tbrowserIdMap.put(browserId, webBrowser);\n\nSince browser.getId() does not guarantee to return a unique ID, the baseId can well be mapped to a SystemBrowserInstance (if the given browser has been created with an explicit ID).\n\nHint: check cases like BrowserLauncher, where the browserId is a path. If you combine that with a user who opens a file, switches browser preferences, and then reopens the same file, I\u0027m sure you can find ways to break this approach."
  ],
  "commentCreationDates": [
    "2006-05-16T11:27:15+02:00",
    "2006-05-19T01:40:20+02:00",
    "2006-05-22T11:48:20+02:00",
    "2007-07-03T17:21:29+02:00",
    "2007-07-04T18:48:28+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.ui.internal.browser.SystemBrowserInstance",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.browser.DefaultBrowserSupport.removeBrowser",
          "source": "DefaultBrowserSupport.java:175"
        },
        {
          "method": "org.eclipse.ui.internal.browser.InternalBrowserInstance$1.partClosed",
          "source": "InternalBrowserInstance.java:66"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$3.run",
          "source": "PartListenerList.java:102"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:843"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.fireEvent",
          "source": "PartListenerList.java:57"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartClosed",
          "source": "PartListenerList.java:100"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartClosed",
          "source": "PartService.java:100"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.firePartClosed",
          "source": "WorkbenchPagePartList.java:38"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.partClosed",
          "source": "PartList.java:255"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.removePart",
          "source": "PartList.java:176"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.disposePart",
          "source": "WorkbenchPage.java:1540"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.partRemoved",
          "source": "WorkbenchPage.java:1533"
        },
        {
          "method": "org.eclipse.ui.internal.ViewFactory.releaseView",
          "source": "ViewFactory.java:252"
        },
        {
          "method": "org.eclipse.ui.internal.Perspective.hideView",
          "source": "Perspective.java:494"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.hideView",
          "source": "WorkbenchPage.java:2201"
        },
        {
          "method": "org.eclipse.ui.internal.ViewPane.doHide",
          "source": "ViewPane.java:213"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:499"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:482"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack$1.close",
          "source": "PartStack.java:106"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:81"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:276"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1",
          "source": "DefaultTabFolder.java:1"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed",
          "source": "DefaultTabFolder.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners",
          "source": "PaneFolder.java:580"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder$3.close",
          "source": "PaneFolder.java:187"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouse",
          "source": "CTabFolder.java:2107"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:292"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3348"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2968"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1914"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1878"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:419"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:400"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:177"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "141958",
      "date": "2006-05-16T11:27:15+02:00",
      "product": "Platform",
      "component": "User Assistance",
      "severity": "normal"
    }
  ],
  "groupId": "141958",
  "bugId": "141958",
  "date": "2006-05-16T11:27:15+02:00",
  "product": "Platform",
  "component": "User Assistance",
  "severity": "normal"
}