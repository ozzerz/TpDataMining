{
  "comments": [
    "If values in org.eclipse.wst.common.project.facet.core.xml are not valid, a NPE is thrown when trying to access the \"j2ee\" tab in the project preference dialog.\n\nAfter this NPE _there is no way_ to close the dialog (either ok, cancel, or close don\u0027t work) and eclipse must be killed :/\n\nWTP seems very sensitive to values in facet xml: it seems that the following\n\u003cinstalled facet\u003d\"jst.java\" version\u003d\"1.5\"/\u003e\n(which is wrong, since wtp only accepts \u003cinstalled facet\u003d\"jst.java\" version\u003d\"5.0\"/\u003e for java 5) causes the above exception.\n\nThe problem is in J2EEDependenciesPage, line 61:\nfinal IFacetedProject facetedProject \u003d ProjectFacetsManager.create(project);\n\t\t\tisEAR \u003d facetedProject.hasProjectFacet(ProjectFacetsManager.getProjectFacet(IModuleConstants.JST_EAR_MODULE)); \n\nif the xml descriptor is not \"valid\" ProjectFacetsManager.create seems to return null and the follwing line throws the NPE.\nIt should at least say the facet xml is not valid (or better give some hint on the error), but not blocking eclipse.\n\ntested both in 1.5M4 and in the current 1.0.1 I build\n\n\n\n\nviewcvs link for J2EEDependenciesPage:\nhttp://dev.eclipse.org/viewcvs/index.cgi/jst/components/j2ee/plugins/org.eclipse.jst.j2ee.ui/j2ee_ui/org/eclipse/jst/j2ee/internal/J2EEDependenciesPage.java?rev\u003d1.5\u0026cvsroot\u003dWebTools_Project\u0026content-type\u003dtext/vnd.viewcvs-markup\n\n\nstack trace from eclipse log:\n\njava.lang.NullPointerException\n\tat org.eclipse.jst.j2ee.internal.J2EEDependenciesPage.createContents(J2EEDependenciesPage.java:61)\n\tat org.eclipse.jface.preference.PreferencePage.createControl(PreferencePage.java:232)\n\tat org.eclipse.jface.preference.PreferenceDialog.createPageControl(PreferenceDialog.java:1371)\n\tat org.eclipse.jface.preference.PreferenceDialog$12.run(PreferenceDialog.java:1138)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:785)\n\tat org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:44)\n\tat org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:148)\n\tat org.eclipse.jface.preference.PreferenceDialog.showPage(PreferenceDialog.java:1132)",
    "I\u0027ll a null check to J2EEDependenciesPage; Konstantin: based on the code in ProjectFacetsManager, it looks like isNatureEnabled() returned false for the facets nature (not clear if an invalid facet version would cause that...); Q: should create() throw an exception in this case instead of returning null? (i.e. the callers expectation is that the project is a faceted project)",
    "Invalid facet version would not cause isNatureEnabled to return false. The project must not be a faceted project. The create method is specifically designed to return null in this case in order to allow the calling code to gracefully recover from the case where the project is not a faceted project.",
    "Created an attachment (id\u003d33234)\nPatch for org.eclipse.jst.j2ee.ui\n\nAdds the null check.",
    "Patch with a null check was applied; please reopen if you encounter further issues.",
    "This change is a bulk update of all _un_targeted, fixed, resolved bugs upon release of M5. This particular bug _might_ have been fixed earlier than M5. (Feel free to correct). \n\n",
    "Given the length of time this has been in the resolved state, I am going to close; please reopen if you still encounter problems."
  ],
  "commentCreationDates": [
    "2006-01-15T14:23:14+01:00",
    "2006-01-18T19:23:50+01:00",
    "2006-01-18T19:36:21+01:00",
    "2006-01-18T21:08:39+01:00",
    "2006-01-27T14:46:33+01:00",
    "2006-03-04T06:05:05+01:00",
    "2006-09-26T16:25:07+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jst.j2ee.internal.J2EEDependenciesPage.createContents",
          "source": "J2EEDependenciesPage.java:61"
        },
        {
          "method": "org.eclipse.jface.preference.PreferencePage.createControl",
          "source": "PreferencePage.java:232"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.createPageControl",
          "source": "PreferenceDialog.java:1371"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog$12.run",
          "source": "PreferenceDialog.java:1138"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:785"
        },
        {
          "method": "org.eclipse.ui.internal.JFaceUtil$1.run",
          "source": "JFaceUtil.java:44"
        },
        {
          "method": "org.eclipse.jface.util.SafeRunnable.run",
          "source": "SafeRunnable.java:148"
        },
        {
          "method": "org.eclipse.jface.preference.PreferenceDialog.showPage",
          "source": "PreferenceDialog.java:1132"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "123904",
      "date": "2006-01-15T14:23:14+01:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "normal"
    }
  ],
  "groupId": "123904",
  "bugId": "123904",
  "date": "2006-01-15T14:23:14+01:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "normal"
}