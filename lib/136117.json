{
  "comments": [
    "Create this Entity:\n\n@Entity\npublic class Employee {\n  private Collection\u003cAddress\u003e address;\n}\n\nChange the mapping type to OneToMany using the \u0027Map As\u0027 combo box in the Persistence Properties view.  This exception occurs:\n\nCaused by: java.lang.NullPointerException\n   at org.eclipse.dali.ui.selection.internal.dispatcher.SelectionDispatcher.getCurrentSelection(SelectionDispatcher.java:123)    at org.eclipse.dali.ui.binding.EMFSWTBinding.\u003cinit\u003e(EMFSWTBinding.java:44)\n   at org.eclipse.dali.ui.composites.OrderByComposite.\u003cinit\u003e(OrderByComposite.java:52)    at org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.buildGeneralTab(MultiRelationshipMappingComposite.java:120)    at org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.initializeLayout(MultiRelationshipMappingComposite.java:56)    at org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.\u003cinit\u003e(MultiRelationshipMappingComposite.java:45)    at org.eclipse.dali.ui.views.MultiRelationshipMappingComposite$MultiRelationshipMappingCompositeBuilder.buildMappingComposite(MultiRelationshipMappingComposite.java:238)    at org.eclipse.dali.ui.views.MappingComposite.populate(MappingComposite.java:239)    at org.eclipse.dali.ui.views.MappingComposite.access$1(MappingComposite.java:214)    at org.eclipse.dali.ui.views.MappingComposite$5.run(MappingComposite.java:279)\n   at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\n\nThe problem is in our use of the selection framework.  In this situation, the selection occured when I selected the address attribute in the java editor.  At this point the address mapping was an InvalidMapping, so the SelectionDispatcher stored that information.  When I selected One to Many as the mapping type through the Persistence Properties view, the MultiRelationshipComposite is built and along with it the OrderByComposite.  The OrderByComposite creates the EMFSWTBinding and in that constructor the call to dispatcher.getCurrentSelection is made.  The SelectionDispatcher only has information about the selection when the attribute was an InvalidMapping, not in its current state as a OneToManyMapping, because a new selection did not occur.  How is this expected to work?",
    "Created an attachment (id\u003d38391)\npatch proposal for #136117 \n\nThis patch only applies to mondays version of the selection project.",
    "Hi Karen,\n\nplease check if this patch solves your problem.",
    "This fixes the problem but some of the DaliUiTests are still failing.  The fix made to the Selection framework on Tuesday fixed these tests, so I think this patch should fix them as well.",
    "I uncovered an issue where the MappingComposite and its mapping pages were getting rebuilt every time the mapping type changed.  Also, each time a new MappingComposite was built, it was never thrown out and would still build new subpanels each time a selectionEvent occurred.  I changed the selectionEvents firing to send the Shell as the eventView instead of the MappingComposite, OutlineView, etc.  This way we can key on the Shell for seeing if a Composite is already built instead of having a new Composite built just by selecting in the outline or selecting in the java editor.\n\nI have checked in the patch with these changes.  Also fixed the MappingCompositeTests.",
    "Ok, i shouldn\u0027t have checked in yet, that didn\u0027t go well.  i\u0027m reverting those\nchanges for now.  Markus, maybe you have ideas for how to fix the problem with\nthe MappingComposite being rebuilt so many times?\n",
    "increasing the shortDelay(), longDelay() timers lets all the testcases pass.",
    "verified this is fixed in build R-0.5RC2-200606280020",
    "Closing Verified Fixed bugs from 0.5."
  ],
  "commentCreationDates": [
    "2006-04-11T16:50:18+02:00",
    "2006-04-12T14:13:02+02:00",
    "2006-04-12T14:13:33+02:00",
    "2006-04-12T19:03:56+02:00",
    "2006-04-14T16:41:02+02:00",
    "2006-04-14T16:47:21+02:00",
    "2006-04-17T23:57:55+02:00",
    "2006-06-28T20:39:45+02:00",
    "2007-03-14T23:21:32+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.dali.ui.selection.internal.dispatcher.SelectionDispatcher.getCurrentSelection",
          "source": "SelectionDispatcher.java:123"
        },
        {
          "method": "org.eclipse.dali.ui.binding.EMFSWTBinding.\u003cinit\u003e",
          "source": "EMFSWTBinding.java:44"
        },
        {
          "method": "org.eclipse.dali.ui.composites.OrderByComposite.\u003cinit\u003e",
          "source": "OrderByComposite.java:52"
        },
        {
          "method": "org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.buildGeneralTab",
          "source": "MultiRelationshipMappingComposite.java:120"
        },
        {
          "method": "org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.initializeLayout",
          "source": "MultiRelationshipMappingComposite.java:56"
        },
        {
          "method": "org.eclipse.dali.ui.views.MultiRelationshipMappingComposite.\u003cinit\u003e",
          "source": "MultiRelationshipMappingComposite.java:45"
        },
        {
          "method": "org.eclipse.dali.ui.views.MultiRelationshipMappingComposite$MultiRelationshipMappingCompositeBuilder.buildMappingComposite",
          "source": "MultiRelationshipMappingComposite.java:238"
        },
        {
          "method": "org.eclipse.dali.ui.views.MappingComposite.populate",
          "source": "MappingComposite.java:239"
        },
        {
          "method": "org.eclipse.dali.ui.views.MappingComposite.access$1",
          "source": "MappingComposite.java:214"
        },
        {
          "method": "org.eclipse.dali.ui.views.MappingComposite$5.run",
          "source": "MappingComposite.java:279"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "136117",
      "date": "2006-04-11T16:50:18+02:00",
      "product": "Dali JPA Tools",
      "component": "General",
      "severity": "normal"
    }
  ],
  "groupId": "136117",
  "bugId": "136117",
  "date": "2006-04-11T16:50:18+02:00",
  "product": "Dali JPA Tools",
  "component": "General",
  "severity": "normal"
}