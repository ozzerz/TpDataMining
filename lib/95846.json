{
  "comments": [
    "Our NodeImpl.connect clas does not specify security information, so attempts \nto connect with a secure RAC always fail.\n\nNeed to work with profiling team to determine how to properly connect to a \nsecure RAC.",
    "*** Bug 105006 has been marked as a duplicate of this bug. ***",
    "This defect gets a higher priority \u0026 severity due to some new RAC installers\nthat configure security by default, rendering the system usless for TPTP testing.",
    "\n[ sizing \u003d 2 day ]",
    "\nThis requires us to use ConnectUtil underneath for our connection needs -- I\nwill augment our current solution with either the code that does the same thing\nor a call into the ConnectUtil class itself.",
    "\nThis has been fixed but I\u0027m have a difficult time testing it right now due to my\nRAC that supports security being a 3.3 version and the test seemingly locking up\nwhen a process is launched.  I believe this should work once the correct version\nof RAC has security enabled in my testing.  For now, the change is transparent\nuntil the user picks port 10003 for test (in the preferences) and uses security.  \n\nThe connection is seen to be made successfully in the new code -- a new\nautomatable service was created \"ConnectorServer\" that uses the in-process\nstrategy for launching (kicks offs and executes the service in the same VM from\nanother plug-in) and connects to the RAC returning back the appropriate node\nobject.  For now the code is delegated to PDCoreUtil.profileConnect(...) for the\nsecure/unsecure handling and connection, in the future this should be refactored\ninto a common execution framework service (for all to share).",
    "\nNow that I have a test environment setup for testing features against secure\nagent controllers -- I find that test execution hangs on the session initiation\nand start-up.  I am re-opening this and attending to it.\n\nI was able to run the profiling features fine after authenticating so I do\nbelieve this is a test execution issue and not an environment issue.",
    "\nAll the authentication has been verified to be functional, after the process\nlaunches, test execution does not get notified via the execution framework.",
    "\nGiven the time and resource constraint this might be pushed until 4.2 (although\nwe\u0027ll still strive to 4.1).",
    "\nSamson, I need help debugging the native code on this one as well -- it is a\nvery similar symptom as the Linux test execution issue (launches session VM but\nthen hangs). \n\nI am now using the profile code\u0027s ConnectUtil underneath (wrapped by the\nConnectorService TPTP automatable service) -- and I see it authenticating\ncorrectly and making a secure connection successfully but then from that point\nit hangs in NodeImpl waiting on the session launch success to be communicated\nback to the workbench side.",
    "\nThis needs to be pushed into i3 or pushed to TPTP 4.2 (no downstream consumers\nthat I\u0027m aware of need this fixed until TPTP 4.2).",
    "\nHi Samson, we need you to debug the rest, this needs to be in TPTP 4.2 before we ship so a downstream product can take function (it blocks functionality on this downstream product due to secure AC being the default installation from downstream product onwards).",
    "I suspect that the problem may be caused by the secured file server. Since RAC is configured as secured, the file server is secured as well and may require username/password in order to connect. Can anyone confirm if user authentication is required for the secured file server?",
    "\nIn my tests in TPTP 4.0 I was able to use a secured connection to initiate and complete file transfer (using authentication, so I believe that this is not the issue).  This was a standalone test I used, it created a secure connection via the Node and then did file transfer after authentication.  I had modified a bunch of secure file transfer code, etc, to make this work.",
    "We have already migrated SSL/security code to TPTP. Profiling and log import with secured TPTP RAC works. Test execution does not and the following exception is shown on the RAC console window. Anyone knows what\u0027s happening?\n\njava.lang.NullPointerException\n        at org.eclipse.hyades.execution.core.loader.ScopedChannelClassLoader$Con\nsumer$ContextClassLoader.loadClass(ScopedChannelClassLoader.java:334)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n        at java.lang.ClassLoader.defineClass1(Native Method)\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:465)\n        at org.eclipse.hyades.execution.core.loader.ScopedChannelClassLoader$Con\nsumer$ContextClassLoader.loadClass(ScopedChannelClassLoader.java:334)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n        at java.lang.Class.getDeclaredMethods0(Native Method)\n        at java.lang.Class.privateGetDeclaredMethods(Class.java:2365)\n        at java.lang.Class.getDeclaredMethod(Class.java:1907)\n        at org.eclipse.hyades.internal.collection.framework.FileClientHandlerExt\nendedImpl.executeCommand(FileClientHandlerExtendedImpl.java:134)\n        at org.eclipse.hyades.internal.collection.framework.FileClientHandlerExt\nendedImpl.run(FileClientHandlerExtendedImpl.java:289)\n        at java.lang.Thread.run(Thread.java:595)\n",
    "Scott, can you take a look at the exception occurred inside FileClientHandlerExt\nendedImpl?",
    "\nYes, I will investigate and fix.",
    "\nI debugged through this--it appears that the \"unsecure\" file system services server is getting instantiated by the agent controller on start-up, even when security is enabled in the agent controller.\n\nBefore, in the previous agent controller, the SecureServer vs. the FileServer was used (instantiated at agent controller start-up time) in the secure and unsecure cases respectively; currently, in the new agent controller it appears that the unsecure file server is started up when the SecureServer should be started instead.  Please fix to make the secure server start up and then I can re-test it from there (this is in the native code, at least it was in the older agent controller).\n\nTo verify the right one starts up, do a \u0027SET IBM_JAVA_OPTIONS\u003d-DSHOW_DEBUG\u003dTRUE\u0027 right before starting RAServer.exe (while using an IBM JRE on the AC side) and then see which file server class gets started up, it should list the fully-qualified class name right after it starts listening for connections.",
    "\nSome more info, (if the secure file server starts you will probably see no initial debug output in the RAServer console but if the unsecure one starts, as is the case, you will see it).  Also after some searching in the code, I found a file, \"ClientCTL.c\" that might have an issue (it appears to start both the unsecure and the secure file servers?):\n\n\n\t\t/* Start createFileServer */\n\t\tif (jvmCreated)\n\t\t{\n\t\t\tstartFileServer(stateData, \u0026_fileServerTID);\n\t\t}\n\n\t\t/* Start secured server if needed */\n\t\tif(cctlData-\u003esecurityEnabled) {\n\t\t\tBOOL isValid \u003d TRUE;\n\n\t\t\trc \u003d getConfigurationInt(pTransportData-\u003econfigurationData, \"SecuredPort\", \u0026cctlData-\u003esecuredPort);\n\t\t\tif ( rc \u003d\u003d -1 )\n\t\t\t{\n\t\t\t\tTPTP_LOG_ERROR_MSG( stateData, \"Cannot retrieve the secured port from configuration file.\" );\n\t\t\t\tisValid \u003d FALSE;\n\t\t\t}\n\n\t\t\trc \u003d getConfigurationString(pTransportData-\u003econfigurationData, \"Keystore\", \u0026cctlData-\u003ekeystore);\n\t\t\tif ( rc \u003d\u003d -1 )\n\t\t\t{\n\t\t\t\tTPTP_LOG_ERROR_MSG( stateData, \"Cannot retrieve the security keystore from configuration file.\" );\n\t\t\t\tisValid \u003d FALSE;\n\t\t\t}\n\n\t\t\trc \u003d getConfigurationString(pTransportData-\u003econfigurationData, \"KeystorePassword\", \u0026cctlData-\u003ekeystorePassword);\n\t\t\tif ( rc \u003d\u003d -1 )\n\t\t\t{\n\t\t\t\tTPTP_LOG_ERROR_MSG( stateData, \"Cannot retrieve the security keystorePassword from configuration file.\" );\n\t\t\t\tisValid \u003d FALSE;\n\t\t\t}\n\n\t\t\trc \u003d getConfigurationString(pTransportData-\u003econfigurationData, \"UserDefinition\", \u0026cctlData-\u003eusers);\n\t\t\tif ( rc \u003d\u003d -1 )\n\t\t\t{",
    "Tansferring the component to Platform.Collection.",
    "\nBTW--the latest tests and observations I wrote are based on using the new AC, I will test also right now on Linux with the old AC to see if there are differences.",
    "Secured file server code has been checked in 2006/05/02 13:42 EDT. Tested remote JUnit test deployment with security and it worked.",
    "*** Bug 136426 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2005-05-18T22:40:56+02:00",
    "2005-07-25T22:18:16+02:00",
    "2005-07-25T23:53:58+02:00",
    "2005-08-01T06:26:03+02:00",
    "2005-08-23T19:55:37+02:00",
    "2005-08-24T21:59:25+02:00",
    "2005-09-26T01:51:46+02:00",
    "2005-10-05T21:06:37+02:00",
    "2005-10-19T20:22:17+02:00",
    "2005-10-21T21:01:37+02:00",
    "2005-10-23T04:14:20+02:00",
    "2006-01-31T17:37:44+01:00",
    "2006-03-20T16:24:22+01:00",
    "2006-03-27T18:14:53+02:00",
    "2006-04-03T17:20:29+02:00",
    "2006-04-06T16:48:57+02:00",
    "2006-04-11T17:17:48+02:00",
    "2006-05-01T18:02:31+02:00",
    "2006-05-01T18:12:35+02:00",
    "2006-05-01T20:01:03+02:00",
    "2006-05-01T23:57:03+02:00",
    "2006-05-02T19:44:01+02:00",
    "2006-05-04T18:19:47+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.hyades.execution.core.loader.ScopedChannelClassLoader$Consumer$ContextClassLoader.loadClass",
          "source": "ScopedChannelClassLoader.java:334"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:251"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:319"
        },
        {
          "method": "java.lang.ClassLoader.defineClass1",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:620"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:465"
        },
        {
          "method": "org.eclipse.hyades.execution.core.loader.ScopedChannelClassLoader$Consumer$ContextClassLoader.loadClass",
          "source": "ScopedChannelClassLoader.java:334"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:251"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:319"
        },
        {
          "method": "java.lang.Class.getDeclaredMethods0",
          "source": "Native Method"
        },
        {
          "method": "java.lang.Class.privateGetDeclaredMethods",
          "source": "Class.java:2365"
        },
        {
          "method": "java.lang.Class.getDeclaredMethod",
          "source": "Class.java:1907"
        },
        {
          "method": "org.eclipse.hyades.internal.collection.framework.FileClientHandlerExtendedImpl.executeCommand",
          "source": "FileClientHandlerExtendedImpl.java:134"
        },
        {
          "method": "org.eclipse.hyades.internal.collection.framework.FileClientHandlerExtendedImpl.run",
          "source": "FileClientHandlerExtendedImpl.java:289"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:595"
        }
      ],
      "number": 0,
      "commentIndex": 14,
      "bugId": "95846",
      "date": "2006-04-03T17:20:29+02:00",
      "product": "TPTP Agent Controller",
      "component": "Platform.Collection",
      "severity": "critical"
    }
  ],
  "groupId": "95846",
  "bugId": "95846",
  "date": "2005-05-18T22:40:56+02:00",
  "product": "TPTP Agent Controller",
  "component": "Platform.Collection",
  "severity": "critical"
}