{
  "comments": [
    "I\u0027m not sure exactly what I did, but this appeared in my console:\n\njava.lang.NullPointerException\n\tat org.eclipse.jdt.internal.core.SourceMapper.enterClass\n(SourceMapper.java:389)\n\tat \norg.eclipse.jdt.internal.compiler.SourceElementParser.notifySourceElementRequest\nor(SourceElementParser.java:922)\n\tat \norg.eclipse.jdt.internal.compiler.SourceElementParser.notifySourceElementRequest\nor(SourceElementParser.java:600)\n\tat \norg.eclipse.jdt.internal.compiler.SourceElementParser.parseCompilationUnit\n(SourceElementParser.java:1062)\n\tat org.eclipse.jdt.internal.core.SourceMapper.mapSource\n(SourceMapper.java:978)\n\tat org.eclipse.jdt.internal.core.SourceMapper.mapSource\n(SourceMapper.java:923)\n\tat org.eclipse.jdt.internal.core.ClassFile.openBuffer\n(ClassFile.java:407)\n\tat org.eclipse.jdt.internal.core.Openable.getBuffer(Openable.java:192)\n\tat org.eclipse.jdt.internal.corext.javadoc.JavaDocAccess.getJavaDoc\n(JavaDocAccess.java:38)\n\tat org.eclipse.jdt.internal.ui.text.java.hover.JavadocHover.getHoverInfo\n(JavadocHover.java:62)\n\tat \norg.eclipse.jdt.internal.ui.text.java.hover.AbstractJavaEditorTextHover.getHover\nInfo(AbstractJavaEditorTextHover.java:98)\n\tat \norg.eclipse.jdt.internal.ui.text.java.hover.BestMatchHover.getHoverInfo\n(BestMatchHover.java:130)\n\tat \norg.eclipse.jdt.internal.ui.text.java.hover.JavaEditorTextHoverProxy.getHoverInf\no(JavaEditorTextHoverProxy.java:72)\n\tat org.eclipse.jface.text.TextViewerHoverManager$2.run\n(TextViewerHoverManager.java:108)",
    "Would you have the name of the .class file you tried to open? This is not a new \nproblem (related to latest changes for better root path inference).\n",
    "Do you remember what you did? I don\u0027t understand how the types collection can \nbe null on the line I see in the stack trace.\nIt might be a concurrency problem. I need to find out if this is possible.",
    "I did open java.lang.System - but I might have been opening something from \nthere (I can\u0027t remember).",
    "Can you reproduce it? I guess not, but if you get it again, please let me know \nwhat you have done.\n\nIt looks like the source mapper has been called twice to map source and the \ntypes collection have been reset before the second mapping is completed.\n\nmapSouce sets the types collection to an array with one element. At the end in \na finally block it resets the collection to null. But the collection cannot be \nnull during the notification except if the types has been reset to null before \nthe second source mapping is completed.\n",
    "I have not been able to reproduce it, but will let you know if I can.",
    "Which VM are you using? IBM 1.3.1?",
    "I was using IBM 1.4 in this case.",
    "I really don\u0027t see how this types collection could be null.\nIt doesn\u0027t seem to be a concurrency problem, because I don\u0027t think the hover\ncalls are done concurrently.\nWhat version are you running? 0218?",
    "I running the lastest JCORE from HEAD.",
    "Then I have no idea how types can be null. It is set to new IType[1] at the\nbeginning of mapSource and set to null at the end (in the finally block). If you\nhave more details how you got this error, they are welcome.",
    "This is a threading issue. The source mapper might be called from two different\nthreads. The bug is that the source mapper is not thread safe. So we need to\nsynchronize the method ISourceRange mapSource(IType type, char[] contents,\t\nIJavaElement searchedElement).\nWe will do that for 2.1RC2. It is too risky now for RC1.",
    "Fixed and released in 2.1 stream.\nI synchronize the method mapSource in the source mapper. The NPE was a \nconsequence of the usage of the Source mapper instance concurrently. If you see \nit again or if you get dead-lock, please reopen it.",
    "Verified. There is no test case for this PR. It is a concurrency problem."
  ],
  "commentCreationDates": [
    "2003-02-20T19:56:51+01:00",
    "2003-02-20T20:13:27+01:00",
    "2003-02-20T20:23:20+01:00",
    "2003-02-20T20:24:50+01:00",
    "2003-02-20T20:37:25+01:00",
    "2003-02-20T20:40:04+01:00",
    "2003-02-20T20:45:20+01:00",
    "2003-02-20T20:54:29+01:00",
    "2003-02-20T21:02:38+01:00",
    "2003-02-20T21:04:30+01:00",
    "2003-02-20T21:14:31+01:00",
    "2003-02-21T15:54:52+01:00",
    "2003-02-26T14:10:01+01:00",
    "2003-03-10T16:52:43+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.SourceMapper.enterClass",
          "source": "SourceMapper.java:389"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.SourceElementParser.notifySourceElementRequestor",
          "source": "SourceElementParser.java:922"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.SourceElementParser.notifySourceElementRequestor",
          "source": "SourceElementParser.java:600"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.SourceElementParser.parseCompilationUnit",
          "source": "SourceElementParser.java:1062"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SourceMapper.mapSource",
          "source": "SourceMapper.java:978"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SourceMapper.mapSource",
          "source": "SourceMapper.java:923"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ClassFile.openBuffer",
          "source": "ClassFile.java:407"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.getBuffer",
          "source": "Openable.java:192"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.javadoc.JavaDocAccess.getJavaDoc",
          "source": "JavaDocAccess.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.hover.JavadocHover.getHoverInfo",
          "source": "JavadocHover.java:62"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.hover.AbstractJavaEditorTextHover.getHoverInfo",
          "source": "AbstractJavaEditorTextHover.java:98"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.hover.BestMatchHover.getHoverInfo",
          "source": "BestMatchHover.java:130"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.hover.JavaEditorTextHoverProxy.getHoverInfo",
          "source": "JavaEditorTextHoverProxy.java:72"
        },
        {
          "method": "org.eclipse.jface.text.TextViewerHoverManager$2.run",
          "source": "TextViewerHoverManager.java:108"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "32392",
      "date": "2003-02-20T19:56:51+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "32392",
  "bugId": "32392",
  "date": "2003-02-20T19:56:51+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}