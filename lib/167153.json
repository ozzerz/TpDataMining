{
  "comments": [
    "This may just require educating me, but I\u0027ve run into an error from the platform that I don\u0027t know how to resolve.\n\nIn WTP we have an action that starts a server within a Job and then opens a web browser (the platform internal browser editor in this case) when the server is ready. If the user has any open editor during that time, the file changes outside of the editor, and the editor uses an activation listener to prompt the user to reload the file, there is a recursive attempt to activate editors and the error below is written to the .log.\n\nMost editors seem to use the activation listener and a prompt, but the browser editor is pretty standard too. Is one of the teams to blame, or is there a mechanism to avoid this? Thanks.\n\n!ENTRY org.eclipse.ui.workbench 4 0 2006-12-07 13:25:18.906\n!MESSAGE WARNING: Prevented recursive attempt to activate part org.eclipse.ui.browser.editor while still in the middle of activating part org.eclipse.wst.server.ui.editor\n!STACK 0\njava.lang.RuntimeException: WARNING: Prevented recursive attempt to activate part org.eclipse.ui.browser.editor while still in the middle of activating part org.eclipse.wst.server.ui.editor\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3133)\n\tat org.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:585)\n\tat org.eclipse.ui.internal.browser.InternalBrowserEditorInstance.openURL(InternalBrowserEditorInstance.java:44)\n\tat org.eclipse.wst.server.ui.internal.WebLaunchableClient.launch(WebLaunchableClient.java:39)\n\tat org.eclipse.wst.server.core.internal.Client.launch(Client.java:114)\n\tat org.eclipse.wst.server.ui.internal.LaunchClientJob$1.run(LaunchClientJob.java:78)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3440)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3080)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\n\tat org.eclipse.jface.window.Window.open(Window.java:796)\n\tat org.eclipse.jface.dialogs.MessageDialog.openQuestion(MessageDialog.java:371)\n\tat org.eclipse.wst.server.ui.internal.editor.ServerEditor.promptReloadServerFile(ServerEditor.java:881)\n\tat org.eclipse.wst.server.ui.internal.editor.ServerEditor.checkResourceState(ServerEditor.java:930)\n\tat org.eclipse.wst.server.ui.internal.editor.ServerEditor$ActivationListener.handleActivation(ServerEditor.java:82)\n\tat org.eclipse.wst.server.ui.internal.editor.ServerEditor$ActivationListener.partActivated(ServerEditor.java:52)\n\tat org.eclipse.ui.internal.PartListenerList$1.run(PartListenerList.java:72)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:850)\n\tat org.eclipse.ui.internal.PartListenerList.fireEvent(PartListenerList.java:57)\n\tat org.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:70)\n\tat org.eclipse.ui.internal.PartService.firePartActivated(PartService.java:73)\n\tat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:171)\n\tat org.eclipse.ui.internal.WWinPartService.updateActivePart(WWinPartService.java:124)\n\tat org.eclipse.ui.internal.WWinPartService.access$0(WWinPartService.java:115)\n\tat org.eclipse.ui.internal.WWinPartService$1.partDeactivated(WWinPartService.java:48)\n\tat org.eclipse.ui.internal.PartListenerList2$4.run(PartListenerList2.java:113)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:850)\n\tat org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:53)\n\tat org.eclipse.ui.internal.PartListenerList2.firePartDeactivated(PartListenerList2.java:111)\n\tat org.eclipse.ui.internal.PartService.firePartDeactivated(PartService.java:116)\n\tat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:165)\n\tat org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged(WorkbenchPagePartList.java:56)\n\tat org.eclipse.ui.internal.PartList.setActivePart(PartList.java:126)\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3183)\n\tat org.eclipse.ui.internal.WorkbenchPage.requestActivation(WorkbenchPage.java:2726)\n\tat org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:256)\n\tat org.eclipse.ui.internal.EditorPane.requestActivation(EditorPane.java:89)\n\tat org.eclipse.ui.internal.presentations.PresentablePart.setFocus(PresentablePart.java:152)\n\tat org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:92)\n\tat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:267)\n\tat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:272)\n\tat org.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown(AbstractTabFolder.java:342)\n\tat org.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown(AbstractTabFolder.java:79)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:133)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:925)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3463)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3077)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1924)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1888)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:104)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:74)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:348)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:165)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:615)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:341)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:285)\n\tat org.eclipse.core.launcher.Main.run(Main.java:987)\n\tat org.eclipse.core.launcher.Main.main(Main.java:962)",
    "The problem seems to be that an part cannot activate another part within its own activation (as your wst.server.ui.editor editor is doing with the call to openURL on the browser support).  I suggest wrapping your attempt to open the URL in a job that will run after your own editor is finished opening.",
    "Hi Kim,\nPlease take another look at the trace - the server editor was just an example and it is not opening up another editor. The user just happens to be clicking back into the editor after the file was modified externally. This causes the editor to open up a dialog, just like the platform Java or text editor would.\n\nThe problem is that this gives back control to the Display, which allows a background job (launched by another process) to run it\u0027s asyncExec to run and try to open it\u0027s own editor. In other words, it\u0027s already using the proposed solution."
  ],
  "commentCreationDates": [
    "2006-12-07T20:09:22+01:00",
    "2006-12-08T14:54:47+01:00",
    "2006-12-08T17:46:15+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.RuntimeException",
      "message": "WARNING: Prevented recursive attempt to activate part org.eclipse.ui.browser.editor while still in the middle of activating part org.eclipse.wst.server.ui.editor",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:3133"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.activate",
          "source": "WorkbenchPage.java:585"
        },
        {
          "method": "org.eclipse.ui.internal.browser.InternalBrowserEditorInstance.openURL",
          "source": "InternalBrowserEditorInstance.java:44"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.WebLaunchableClient.launch",
          "source": "WebLaunchableClient.java:39"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Client.launch",
          "source": "Client.java:114"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.LaunchClientJob$1.run",
          "source": "LaunchClientJob.java:78"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3440"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:820"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:796"
        },
        {
          "method": "org.eclipse.jface.dialogs.MessageDialog.openQuestion",
          "source": "MessageDialog.java:371"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.editor.ServerEditor.promptReloadServerFile",
          "source": "ServerEditor.java:881"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.editor.ServerEditor.checkResourceState",
          "source": "ServerEditor.java:930"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.editor.ServerEditor$ActivationListener.handleActivation",
          "source": "ServerEditor.java:82"
        },
        {
          "method": "org.eclipse.wst.server.ui.internal.editor.ServerEditor$ActivationListener.partActivated",
          "source": "ServerEditor.java:52"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$1.run",
          "source": "PartListenerList.java:72"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:850"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.fireEvent",
          "source": "PartListenerList.java:57"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartActivated",
          "source": "PartListenerList.java:70"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartActivated",
          "source": "PartService.java:73"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:171"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.updateActivePart",
          "source": "WWinPartService.java:124"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:115"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partDeactivated",
          "source": "WWinPartService.java:48"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$4.run",
          "source": "PartListenerList2.java:113"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:850"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.fireEvent",
          "source": "PartListenerList2.java:53"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartDeactivated",
          "source": "PartListenerList2.java:111"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartDeactivated",
          "source": "PartService.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:165"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged",
          "source": "WorkbenchPagePartList.java:56"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.setActivePart",
          "source": "PartList.java:126"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:3183"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.requestActivation",
          "source": "WorkbenchPage.java:2726"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.requestActivation",
          "source": "PartPane.java:256"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.requestActivation",
          "source": "EditorPane.java:89"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PresentablePart.setFocus",
          "source": "PresentablePart.java:152"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:92"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:272"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown",
          "source": "AbstractTabFolder.java:342"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown",
          "source": "AbstractTabFolder.java:79"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:133"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:925"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3463"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3077"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1924"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1888"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:419"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:104"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:74"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:348"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:165"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:341"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:285"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:987"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:962"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "167153",
      "date": "2006-12-07T20:09:22+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "167153",
  "bugId": "167153",
  "date": "2006-12-07T20:09:22+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}