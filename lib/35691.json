{
  "comments": [
    "build I20030325\n\nNoticed the following in my log.\nI had been using the schema editor, and had been switching between pages.\nNot sure exactly which operation triggered this, since I only saw it in the log \nlater.\n\n!ENTRY org.eclipse.ui 4 4 Mar 25, 2003 23:04:51.529\n!MESSAGE Unhandled exception caught in event loop.\n!ENTRY org.eclipse.ui 4 0 Mar 25, 2003 23:04:52.250\n!MESSAGE org.eclipse.pde.internal.core.schema.EditableSchema\n!STACK 0\njava.lang.ClassCastException: \norg.eclipse.pde.internal.core.schema.EditableSchema\n\tat \norg.eclipse.pde.internal.ui.editor.PDEMultiPageEditor.validateModelSemantics\n(PDEMultiPageEditor.java:656)\n\tat org.eclipse.pde.internal.ui.editor.PDESourcePage.becomesInvisible\n(PDESourcePage.java:66)\n\tat org.eclipse.update.ui.forms.internal.CustomWorkbook.switchPages\n(CustomWorkbook.java:127)\n\tat org.eclipse.update.ui.forms.internal.CustomWorkbook.access$2\n(CustomWorkbook.java:125)\n\tat org.eclipse.update.ui.forms.internal.CustomWorkbook$4.run\n(CustomWorkbook.java:102)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat org.eclipse.update.ui.forms.internal.CustomWorkbook.selectPage\n(CustomWorkbook.java:100)\n\tat org.eclipse.update.ui.forms.internal.CustomWorkbook$1.widgetSelected\n(CustomWorkbook.java:54)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:91)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:81)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:840)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:865)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:849)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:656)\n\tat org.eclipse.swt.custom.CTabFolder.setSelection(CTabFolder.java:1742)\n\tat org.eclipse.swt.custom.CTabFolder.onMouseDown(CTabFolder.java:1910)\n\tat org.eclipse.swt.custom.CTabFolder.access$4(CTabFolder.java:1902)\n\tat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:201)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:81)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:840)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1842)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1549)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1402)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1385)\n\tat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:845)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:461)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:291)\n\tat org.eclipse.core.launcher.Main.run(Main.java:747)\n\tat org.eclipse.core.launcher.Main.main(Main.java:583)",
    "It is fairly easy to reproduce this. All that is needed is to switch to the \nsource page, modify something, then try to switch back into any of the form \npages.\n\nThe class cast exception is caused by the following method in the editor\nsuperclass:\n\n\tpublic boolean validateModelSemantics() {\n\t\tIModel model \u003d (IModel)getModel();\n\t\treturn model!\u003dnull \u0026\u0026 model.isValid();\n\t}\n\nThe method above is in PDEMultiPageEditor that all PDE editors subclass.\n\nThe \u0027blind\u0027 cast to IModel fails because \u0027getModel()\u0027 returns ISchema\nin the schema editor. For historic reasons, ISchema does not extend\nIModel (we will address this in 2.2). In the mean time, the proposed fix \nis to override this method in SchemaEditor as follows:\n\n\tpublic boolean validateModelSemantics() {\n\t\tISchema schema \u003d (ISchema)getModel();\n\t\treturn schema!\u003dnull \u0026\u0026 schema.isValid();\n\t}\n\nThe method above does pretty much the same, but it performs the\ncorrect cast (notice that ISchema also has \u0027isValid()\u0027 method so\nsemantically this method is identical).\n\nWe should fix this problem because it will consistently fail with\nthe exception, is easy to understand why, and the fix is localized\nand trivial.\n\nI released the fix into HEAD.\n\nNick, DJ, please verify the fix (by comparing org.eclipse.pde.ui in \nHEAD with version v20030319c).",
    "We built updateui.jar and replaced it in the file system. Ve verified that the \nJAR fixes the problem.",
    "+1",
    "Dorian, just in case Nick is busy today and cannot take a look at this before \n2pm build, could you cast your vote for this must-fix defect?",
    "Dejan proposed the following:\n\n\tpublic boolean validateModelSemantics() {\n              if (getModel() instanceof ISchema){\n\t\tISchema schema \u003d (ISchema)getModel();\n\t\treturn schema!\u003dnull \u0026\u0026 schema.isValid();\n              }\n              else \n                return super.validateModelSemantics();\n\t}\n\nand this looks fine for releasing in RC4.",
    "Released.",
    "+1 (better late than never)",
    "Thanks :-)."
  ],
  "commentCreationDates": [
    "2003-03-26T05:14:22+01:00",
    "2003-03-26T15:49:35+01:00",
    "2003-03-26T15:51:12+01:00",
    "2003-03-26T16:09:19+01:00",
    "2003-03-26T16:49:01+01:00",
    "2003-03-26T18:16:58+01:00",
    "2003-03-26T18:40:14+01:00",
    "2003-03-26T19:58:03+01:00",
    "2003-03-26T19:58:48+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.pde.internal.core.schema.EditableSchema",
      "elements": [
        {
          "method": "org.eclipse.pde.internal.ui.editor.PDEMultiPageEditor.validateModelSemantics",
          "source": "PDEMultiPageEditor.java:656"
        },
        {
          "method": "org.eclipse.pde.internal.ui.editor.PDESourcePage.becomesInvisible",
          "source": "PDESourcePage.java:66"
        },
        {
          "method": "org.eclipse.update.ui.forms.internal.CustomWorkbook.switchPages",
          "source": "CustomWorkbook.java:127"
        },
        {
          "method": "org.eclipse.update.ui.forms.internal.CustomWorkbook.access$2",
          "source": "CustomWorkbook.java:125"
        },
        {
          "method": "org.eclipse.update.ui.forms.internal.CustomWorkbook$4.run",
          "source": "CustomWorkbook.java:102"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.update.ui.forms.internal.CustomWorkbook.selectPage",
          "source": "CustomWorkbook.java:100"
        },
        {
          "method": "org.eclipse.update.ui.forms.internal.CustomWorkbook$1.widgetSelected",
          "source": "CustomWorkbook.java:54"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:91"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:81"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:840"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:865"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:849"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:656"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.setSelection",
          "source": "CTabFolder.java:1742"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouseDown",
          "source": "CTabFolder.java:1910"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.access$4",
          "source": "CTabFolder.java:1902"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:201"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:81"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:840"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1842"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1549"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1402"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1385"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:845"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:461"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:291"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:747"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:583"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "35691",
      "date": "2003-03-26T05:14:22+01:00",
      "product": "PDE",
      "component": "UI",
      "severity": "major"
    }
  ],
  "groupId": "35691",
  "bugId": "35691",
  "date": "2003-03-26T05:14:22+01:00",
  "product": "PDE",
  "component": "UI",
  "severity": "major"
}