{
  "comments": [
    "The test should be prepared for InterruptedException. It should either catch  and ignore the exception if the join is not important, or it needs to loop until the join succeeded.\n\nNote also that using IDEWorkbenchMessages.DeleteResourceAction_jobName (an internationalized string) is not a very good choice for a job family identifier.\n\njava.lang.InterruptedException: sleep interrupted\nat java.lang.Thread.sleep(Native Method)\nat org.eclipse.core.internal.jobs.JobManager.join(JobManager.java:756)\nat org.eclipse.ui.tests.internal.Bug99858Test.testDeleteClosedProject(Bug99858Test.java:118)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:330)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:204)\nat org.eclipse.test.UITestApplication$3.run(UITestApplication.java:188)\nat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\nat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\nat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3264)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2910)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1830)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1794)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:410)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\nat org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:131)\nat org.eclipse.test.UITestApplication.run(UITestApplication.java:58)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:99)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "\nThis test failed today\u0027s test run on my box...same exception. I\u0027m using N20060212-0010.\n",
    "Created an attachment (id\u003d34629)\npatch for fixing the test failure\n\nI have committed a change to the test that should fix the \"sleep interrupted\" exception.",
    "Here is another one:\n\njunit.framework.AssertionFailedError: sleep interrupted\nat org.eclipse.ui.tests.datatransfer.ImportExistingTest.waitForRefresh(ImportExistingTest.java:111)\nat org.eclipse.ui.tests.datatransfer.ImportExistingTest.testImportSingleDirectory(ImportExistingTest.java:429)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:330)\nat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:204)\nat org.eclipse.test.UITestApplication$3.run(UITestApplication.java:188)\nat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\nat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\nat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3264)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2910)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1899)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1863)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:417)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\nat org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:131)\nat org.eclipse.test.UITestApplication.run(UITestApplication.java:58)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:99)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Do we understand why the InterruptedException is being generated?",
    "Yes, the UISynchronizer interrupts the UI thread whenever another thread holds a lock and does a syncExec.\n\nOn second thought, maybe we should look at all places in our code where we catch InterruptedException. My guess is that it is mostly ignored, or retried, where what you should do if you are on the UI thread is spin the event loop if possible before you retry. Just ignoring the InterruptedException may lead to problems e.g. when you assume that the job you waited on has finished.",
    "It doesn\u0027t seem to me like clients should have to spin the event loop.\nI would consider it to be a programming error to either sleep in the UI thread, or to do a syncExec while holding a lock.  As such, it would be better if these failed immediately rather than later, if possible (I know sleep can\u0027t be intercepted).\n",
    "True.  Since any method that throws InterruptedException is likely to be long-running (including IJobManager#join), it generally shouldn\u0027t be called in the UI thread.  I\u0027ll attach a patch to show an alternative fix.",
    "Created an attachment (id\u003d34876)\nFix\n\nThis is a fix for ImportExistingTest.  Perhaps UITestCase should have a \"join\" convenience method that all UI tests can use to ensure the right pattern is applied consistently.  Note this patch still doesn\u0027t handle InterruptedException, but since it runs in a background thread there shouldn\u0027t be anyone interrupting it.",
    "Note: I\u0027m not suggesting this for M5.",
    "Created an attachment (id\u003d81467)\nUpdated patch\n\nUpdated to compile with HEAD",
    "Patch updated and released for build \u003e20071204",
    "Verified by test in I20071211-0010"
  ],
  "commentCreationDates": [
    "2006-02-10T21:53:43+01:00",
    "2006-02-13T14:51:15+01:00",
    "2006-02-13T23:44:12+01:00",
    "2006-02-15T01:27:07+01:00",
    "2006-02-15T21:42:06+01:00",
    "2006-02-16T01:22:32+01:00",
    "2006-02-16T14:52:01+01:00",
    "2006-02-16T21:02:18+01:00",
    "2006-02-16T21:03:52+01:00",
    "2006-02-16T21:04:26+01:00",
    "2007-10-29T16:20:31+01:00",
    "2007-12-04T18:49:01+01:00",
    "2007-12-11T15:33:25+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.InterruptedException",
      "message": "sleep interrupted",
      "elements": [
        {
          "method": "java.lang.Thread.sleep",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.core.internal.jobs.JobManager.join",
          "source": "JobManager.java:756"
        },
        {
          "method": "org.eclipse.ui.tests.internal.Bug99858Test.testDeleteClosedProject",
          "source": "Bug99858Test.java:118"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:330"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:204"
        },
        {
          "method": "org.eclipse.test.UITestApplication$3.run",
          "source": "UITestApplication.java:188"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3264"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2910"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1830"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1794"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:410"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.test.UITestApplication.runApplication",
          "source": "UITestApplication.java:131"
        },
        {
          "method": "org.eclipse.test.UITestApplication.run",
          "source": "UITestApplication.java:58"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:99"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:374"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "127344",
      "date": "2006-02-10T21:53:43+01:00",
      "product": "Platform",
      "component": "IDE",
      "severity": "normal"
    },
    {
      "exceptionType": "junit.framework.AssertionFailedError",
      "message": "sleep interrupted",
      "elements": [
        {
          "method": "org.eclipse.ui.tests.datatransfer.ImportExistingTest.waitForRefresh",
          "source": "ImportExistingTest.java:111"
        },
        {
          "method": "org.eclipse.ui.tests.datatransfer.ImportExistingTest.testImportSingleDirectory",
          "source": "ImportExistingTest.java:429"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:330"
        },
        {
          "method": "org.eclipse.test.EclipseTestRunner.run",
          "source": "EclipseTestRunner.java:204"
        },
        {
          "method": "org.eclipse.test.UITestApplication$3.run",
          "source": "UITestApplication.java:188"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3264"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2910"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1899"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1863"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:417"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.test.UITestApplication.runApplication",
          "source": "UITestApplication.java:131"
        },
        {
          "method": "org.eclipse.test.UITestApplication.run",
          "source": "UITestApplication.java:58"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:99"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:374"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 1,
      "commentIndex": 3,
      "bugId": "127344",
      "date": "2006-02-15T01:27:07+01:00",
      "product": "Platform",
      "component": "IDE",
      "severity": "normal"
    }
  ],
  "groupId": "127344",
  "bugId": "127344",
  "date": "2006-02-10T21:53:43+01:00",
  "product": "Platform",
  "component": "IDE",
  "severity": "normal"
}