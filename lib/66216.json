{
  "comments": [
    "Selecting Source-\u003eSort Members results in the following exception: \n\njava.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat java.lang.StringBuffer.append(StringBuffer.java:499)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder$SortMultipleFieldDeclaration.generateSource(SortElementBuilder.java:603)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder$SortType.generateSource(SortElementBuilder.java:801)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder$SortAbstractMethodDeclaration.generateSource(SortElementBuilder.java:207)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder$SortType.generateSource(SortElementBuilder.java:801)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder$SortCompilationUnit.generateSource(SortElementBuilder.java:896)\n\tat\norg.eclipse.jdt.internal.core.SortElementBuilder.getSource(SortElementBuilder.java:948)\n\tat\norg.eclipse.jdt.internal.core.SortElementsOperation.processElement(SortElementsOperation.java:117)\n\tat\norg.eclipse.jdt.internal.core.SortElementsOperation.executeOperation(SortElementsOperation.java:74)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:700)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1673)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:744)\n\tat\norg.eclipse.jdt.core.util.CompilationUnitSorter.sort(CompilationUnitSorter.java:174)\n\tat\norg.eclipse.jdt.internal.corext.codemanipulation.SortMembersOperation.run(SortMembersOperation.java:248)\n\tat\norg.eclipse.jdt.internal.core.BatchOperation.executeOperation(BatchOperation.java:34)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:700)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1673)\n\tat org.eclipse.jdt.core.JavaCore.run(JavaCore.java:3246)\n\tat\norg.eclipse.jdt.internal.ui.actions.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:65)\n\tat\norg.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext$BusyRunnable.internalRun(BusyIndicatorRunnableContext.java:113)\n\tat\norg.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext$BusyRunnable.run(BusyIndicatorRunnableContext.java:80)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat\norg.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext.run(BusyIndicatorRunnableContext.java:126)\n\tat org.eclipse.ui.internal.progress.ProgressManager$5.run(ProgressManager.java:980)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat\norg.eclipse.ui.internal.progress.ProgressManager.runInUI(ProgressManager.java:976)\n\tat org.eclipse.jdt.ui.actions.SortMembersAction.run(SortMembersAction.java:205)\n\tat org.eclipse.jdt.ui.actions.SortMembersAction.run(SortMembersAction.java:138)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:212)\n\tat\norg.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:188)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:881)\n\tat\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:915)\n\tat\norg.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:866)\n\tat\norg.eclipse.jface.action.ActionContributionItem$7.handleEvent(ActionContributionItem.java:785)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:796)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2716)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2382)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1363)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1334)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:253)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:141)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:96)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:334)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:273)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:128)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:185)\n\tat org.eclipse.core.launcher.Main.run(Main.java:638)\n\tat org.eclipse.core.launcher.Main.main(Main.java:622)",
    "Which build?\nCan you attach the CU (or a similar example) which causes the problem?\n",
    "Please provide steps to reproduce and build ID.",
    "Please reopen once info is made available.",
    "Here is the build info:\n\neclipse.buildId\u003dI200405290105\njava.version\u003d1.4.2_02\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_US\n\nThis happens with some classes altough I\u0027m not sure what the correlation is. I\nhave verified this on two seperate machines with two seperate class files. I\njust tested a third and it appeared to work without a problem. To reproduce it\nall I have to do is attempt to run the Sort Members tool, the dialog box appears\nwarning me about losing break points, etc and then nothing appears to happen. It\nis deterministic in that running the particular class always produces this error. \n\nUnfortunately I can\u0027t send the class due to employer restrictions, so I tried to\nstrip the class down to empty methods so that I could send it as an attachment,\nbut there were no errors running the stripped down class. The class contains\nmethods (private, public, protected, and some static), attributes, constructors,\nan inner class, and a static initializer. \n\nI will do some further testing to see if I can find what is specific to the\nclass that would cause the error.\n",
    "Could you please extract all the code relative the multiple field declarations?\nThe problem occurs in a multiple field declaration.\nSomething like this:\nint i, j, k;\n\nThanks.",
    "Thanks to Olivier\u0027s post I have created a small class that breaks everytime. It\nappears to break when an inner class or an anonymous class inside of a method\nuses multiple field declarations. \n\nHowever I have discovered something else that appears to break it. If you\ncomment out the multiple field declartions in class E and the anonymous class\nthen it still breaks until you comment out class D. Just having an inner class\nwithin the method which is below an anonymous class causes the sort to break also.\n\npublic class SortMembersBreakTest {\n   \n   public void c() {\n      \n   }\n   \n   public void b() {\n      \n   }\n   \n   public void a() {\n      class E {\n         // this is the line that breaks the Sort Members.\n         // comment this fix the problem.\n         int x, y;\n      }\n      \n      \n      new Object() {\n         // it breaks in an anonymous class also.\n         // comment this fix the problem.\n         int x, y;\n      }; \n      \n      \n      class D {\n         // this appears to break also.\n      }\n   } \n   \n   private class F {\n      // but this works fine\n      int x, y;\n   }\n}",
    "I am investigating.",
    "Reproduced. The problem comes from a wrong fieldEndPosition for the field\ndeclaration located inside a local class inside a method.\nI need to assess the risk of a fix for this issue.",
    "Created an attachment (id\u003d11816)\nApply on HEAD\n\nThis patch fixes the fieldEndPosition for field declaration inside a class\nlocated inside a method declaration. Doing this, no other changes is required.\nThe Sort member operation is working as is.",
    "With this patch, all JDT/Core + JDT/UI + JDT/UI refactoring tests passed.",
    "Created an attachment (id\u003d11827)\nNew regression tests. Apply on HEAD\n\nRegression tests for this bug",
    "Fixed and released in HEAD.\nRegression tests added.",
    "Verified for 3.0RC2"
  ],
  "commentCreationDates": [
    "2004-06-08T22:08:43+02:00",
    "2004-06-09T10:25:33+02:00",
    "2004-06-09T10:36:19+02:00",
    "2004-06-09T10:36:43+02:00",
    "2004-06-09T16:17:57+02:00",
    "2004-06-09T16:37:38+02:00",
    "2004-06-09T17:21:25+02:00",
    "2004-06-09T17:25:33+02:00",
    "2004-06-09T18:55:59+02:00",
    "2004-06-09T20:18:21+02:00",
    "2004-06-09T21:29:16+02:00",
    "2004-06-09T21:31:45+02:00",
    "2004-06-10T16:04:29+02:00",
    "2004-06-11T13:32:39+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "java.lang.System.arraycopy",
          "source": "Native Method"
        },
        {
          "method": "java.lang.StringBuffer.append",
          "source": "StringBuffer.java:499"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder$SortMultipleFieldDeclaration.generateSource",
          "source": "SortElementBuilder.java:603"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder$SortType.generateSource",
          "source": "SortElementBuilder.java:801"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder$SortAbstractMethodDeclaration.generateSource",
          "source": "SortElementBuilder.java:207"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder$SortType.generateSource",
          "source": "SortElementBuilder.java:801"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder$SortCompilationUnit.generateSource",
          "source": "SortElementBuilder.java:896"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementBuilder.getSource",
          "source": "SortElementBuilder.java:948"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementsOperation.processElement",
          "source": "SortElementsOperation.java:117"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SortElementsOperation.executeOperation",
          "source": "SortElementsOperation.java:74"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:700"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1673"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:744"
        },
        {
          "method": "org.eclipse.jdt.core.util.CompilationUnitSorter.sort",
          "source": "CompilationUnitSorter.java:174"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.codemanipulation.SortMembersOperation.run",
          "source": "SortMembersOperation.java:248"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BatchOperation.executeOperation",
          "source": "BatchOperation.java:34"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:700"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1673"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.run",
          "source": "JavaCore.java:3246"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.actions.WorkbenchRunnableAdapter.run",
          "source": "WorkbenchRunnableAdapter.java:65"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext$BusyRunnable.internalRun",
          "source": "BusyIndicatorRunnableContext.java:113"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext$BusyRunnable.run",
          "source": "BusyIndicatorRunnableContext.java:80"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.BusyIndicatorRunnableContext.run",
          "source": "BusyIndicatorRunnableContext.java:126"
        },
        {
          "method": "org.eclipse.ui.internal.progress.ProgressManager$5.run",
          "source": "ProgressManager.java:980"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.ui.internal.progress.ProgressManager.runInUI",
          "source": "ProgressManager.java:976"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SortMembersAction.run",
          "source": "SortMembersAction.java:205"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SortMembersAction.run",
          "source": "SortMembersAction.java:138"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:212"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:188"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:881"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:915"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:866"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$7.handleEvent",
          "source": "ActionContributionItem.java:785"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:796"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2716"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2382"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1363"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1334"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:253"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:141"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:96"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:334"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:273"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:128"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:185"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:638"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:622"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "66216",
      "date": "2004-06-08T22:08:43+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "66216",
  "bugId": "66216",
  "date": "2004-06-08T22:08:43+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}