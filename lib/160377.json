{
  "comments": [
    "java.lang.NullPointerException\n  at org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.PrinterGraphics.dispose(PrinterGraphics.java:73)\n  at org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.DiagramPrinter.dispose(DiagramPrinter.java:533)\n  at org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.DiagramPrinter.run(DiagramPrinter.java:213)\n  at org.eclipse.gmf.runtime.diagram.ui.printing.util.DiagramPrinterUtil.printDiagrams(DiagramPrinterUtil.java:66)\netc....\n\nyou won\u0027t see an exception in the log, but the exception does occur.\n\nThe problem can contribute to a SWT handle leak. In org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.PrinterGraphics#dispose the code tries to dispose all the images in collapseImageCache, but if any are already disposed there hashCode has changed and HashMap#get will return null. A better approach is to iterate over the values which will never be null. An image can safely be disposed twice. The suggested code below is similar to that found in the base class.\n\n\tpublic void dispose() {\n\n\t\tfor (Iterator it \u003d collapseImageCache.values().iterator(); it.hasNext();) {\n\t\t\tImage img \u003d (Image) it.next();\n\t\t\timg.dispose();\n\t\t}\n\n\t\tcollapseImageCache.clear();\n\n\t\tsuper.dispose();\n\t}",
    "This issue is not specific to PC hardware or the Windows OS:\nboth should be \u0027all\u0027 but I can\u0027t change those fields.",
    "Created an attachment (id\u003d53376)\npatch\n\nAttached patch.\n\nVerified that exception no longer occurs in dispose method.",
    "Reviewed and committed the patch.",
    "Reviewed and committed the patch."
  ],
  "commentCreationDates": [
    "2006-10-10T22:56:33+02:00",
    "2006-10-11T14:03:18+02:00",
    "2006-11-07T16:05:25+01:00",
    "2006-11-21T22:56:16+01:00",
    "2006-11-21T22:57:01+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.PrinterGraphics.dispose",
          "source": "PrinterGraphics.java:73"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.DiagramPrinter.dispose",
          "source": "DiagramPrinter.java:533"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.DiagramPrinter.run",
          "source": "DiagramPrinter.java:213"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.printing.util.DiagramPrinterUtil.printDiagrams",
          "source": "DiagramPrinterUtil.java:66"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "160377",
      "date": "2006-10-10T22:56:33+02:00",
      "product": "GMF",
      "component": "Runtime",
      "severity": "normal"
    }
  ],
  "groupId": "160377",
  "bugId": "160377",
  "date": "2006-10-10T22:56:33+02:00",
  "product": "GMF",
  "component": "Runtime",
  "severity": "normal"
}