{
  "comments": [
    "I20071107-1300\n\nRun org.eclipse.jdt.ui.tests.performance.views.TypeHierarchyPerfTest with -consolelog. Also an error dialog opens and the test DNF.\n\nIs:\njava.lang.reflect.InvocationTargetException\n\tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:350)\n\tat org.eclipse.jface.window.ApplicationWindow$1.run(ApplicationWindow.java:758)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n\tat org.eclipse.jface.window.ApplicationWindow.run(ApplicationWindow.java:755)\n\tat org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2451)\n\tat org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyLifeCycle.ensureRefreshedTypeHierarchy(TypeHierarchyLifeCycle.java:107)\n\tat org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyViewPart.updateInput(TypeHierarchyViewPart.java:520)\n\tat org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyViewPart.setInputElement(TypeHierarchyViewPart.java:483)\n\tat org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.openInViewPart(OpenTypeHierarchyUtil.java:96)\n\tat org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.open(OpenTypeHierarchyUtil.java:73)\n\tat org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.open(OpenTypeHierarchyUtil.java:50)\n\tat org.eclipse.jdt.ui.tests.performance.views.TypeHierarchyPerfTest.measureOpenHierarchy(TypeHierarchyPerfTest.java:88)\n\tat org.eclipse.jdt.ui.tests.performance.views.TypeHierarchyPerfTest.testOpenObjectHierarchy(TypeHierarchyPerfTest.java:69)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat junit.framework.TestCase.runTest(TestCase.java:164)\n\tat junit.framework.TestCase.runBare(TestCase.java:130)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:120)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:230)\n\tat junit.framework.TestSuite.run(TestSuite.java:225)\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:21)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.extensions.TestSetup.run(TestSetup.java:25)\n\tat org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run(UITestApplication.java:122)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:130)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3721)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3358)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2395)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2359)\n\tat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2225)\n\tat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:468)\n\tat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:463)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication.start(UITestApplication.java:52)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:362)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:175)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:515)\n\tat org.eclipse.equinox.launcher.Main.basicRun(Main.java:455)\n\tat org.eclipse.equinox.launcher.Main.run(Main.java:1193)\n\tat org.eclipse.equinox.launcher.Main.main(Main.java:1169)\nCaused by: java.lang.StackOverflowError\nRoot exception:\njava.lang.StackOverflowError",
    "The rest of the stacktrace is:\n\nCaused by: java.lang.StackOverflowError\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat \n....\n\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1069)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectSuperclass(ClassScope.java:840)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectTypeHierarchyWithoutMembers(ClassScope.java:1005)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1111)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1025)\n\tat org.eclipse.jdt.internal.compiler.ast.SingleTypeReference.getTypeBinding(SingleTypeReference.java:47)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType(TypeReference.java:163)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveSuperType(TypeReference.java:114)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.findSupertype(ClassScope.java:1125)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectSuperclass(ClassScope.java:843)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectTypeHierarchyWithoutMembers(ClassScope.java:1005)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1111)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle(ClassScope.java:1025)\n\tat org.eclipse.jdt.internal.compiler.ast.SingleTypeReference.getTypeBinding(SingleTypeReference.java:47)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType(TypeReference.java:163)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveSuperType(TypeReference.java:114)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.findSupertype(ClassScope.java:1125)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectSuperclass(ClassScope.java:843)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectTypeHierarchy(ClassScope.java:968)\n\tat org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.connectTypeHierarchy(CompilationUnitScope.java:290)\n\tat org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.completeTypeBindings(LookupEnvironment.java:276)\n\tat org.eclipse.jdt.internal.core.hierarchy.HierarchyResolver.resolve(HierarchyResolver.java:718)\n\tat org.eclipse.jdt.internal.core.hierarchy.IndexBasedHierarchyBuilder.buildForProject(IndexBasedHierarchyBuilder.java:226)\n\tat org.eclipse.jdt.internal.core.hierarchy.IndexBasedHierarchyBuilder.buildFromPotentialSubtypes(IndexBasedHierarchyBuilder.java:328)\n\tat org.eclipse.jdt.internal.core.hierarchy.IndexBasedHierarchyBuilder.build(IndexBasedHierarchyBuilder.java:131)\n\tat org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.compute(TypeHierarchy.java:300)\n\tat org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.refresh(TypeHierarchy.java:1241)\n\tat org.eclipse.jdt.internal.core.CreateTypeHierarchyOperation.executeOperation(CreateTypeHierarchyOperation.java:90)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:720)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:780)\n\tat org.eclipse.jdt.internal.core.BinaryType.newTypeHierarchy(BinaryType.java:863)\n\tat org.eclipse.jdt.internal.core.BinaryType.newTypeHierarchy(BinaryType.java:882)\n\tat org.eclipse.jdt.internal.core.BinaryType.newTypeHierarchy(BinaryType.java:852)\n\tat org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyLifeCycle.createTypeHierarchy(TypeHierarchyLifeCycle.java:118)\n",
    "Created an attachment (id\u003d82739)\nNaive patch\n\nIt seems that HierarchyBinaryType superclass should be null for \u0027java.lang.Object\u0027 as already done for bindings and dom. Fixing this makes the StackOverflow vanishing but not sure it will be the real solution for this issue.\n\nUnfortunately I was unable to reproduce the StackOverflow exception in a real workspace and so had no chance to find the exact reason why this happens for the JDT/UI JUnit perf test... It explains why I didn\u0027t have any specific test case for this fix and make me doubt about it!\n",
    "(In reply to comment #2)\n\u003e Unfortunately I was unable to reproduce the StackOverflow exception in a real\n\u003e workspace\n\nNeither am I able to reproduce it in a real workspace.\n",
    "Created an attachment (id\u003d82950)\nProposed fix and regression test\n\nProblem can be reproduced only if javaProject.findType(\"java.lang.Object\") is called before creating the hierarchy (which doesn\u0027t happen if using the UI only). In this case, the internal jar type cache is filled but the corresponding IClassFile is not opened. As a consequence we use a HierarchyBinaryType for Object which causes the infinite recursion.\nFix consists in using the ClassFileReader cached in the jar type cache. HierarchyBinaryType still has a potential problem but it will never be used for Object.",
    "Fix and test released for 3.4M4",
    "testFindObject does not fail for I20071211-0010 (expected), but it does not fail either for I20071107-1300 (unexpected). J?r?me, any comments?",
    "Released a new version of the test that fails in all conditions without the fix.",
    "Verified for 3.4 M4 using build I20071211-0010.\n(We now have a test that fails with I20071107-1300 and succeeds with I20071211-0010, which failure is convincingly close enough to the reported one, hence I assume everything is now OK.)"
  ],
  "commentCreationDates": [
    "2007-11-08T17:39:20+01:00",
    "2007-11-12T17:33:37+01:00",
    "2007-11-13T09:14:58+01:00",
    "2007-11-13T10:52:05+01:00",
    "2007-11-15T09:37:20+01:00",
    "2007-11-15T15:29:47+01:00",
    "2007-12-12T08:37:53+01:00",
    "2007-12-12T10:44:10+01:00",
    "2007-12-12T13:49:46+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.reflect.InvocationTargetException",
      "elements": [
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:350"
        },
        {
          "method": "org.eclipse.jface.window.ApplicationWindow$1.run",
          "source": "ApplicationWindow.java:758"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.jface.window.ApplicationWindow.run",
          "source": "ApplicationWindow.java:755"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.run",
          "source": "WorkbenchWindow.java:2451"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyLifeCycle.ensureRefreshedTypeHierarchy",
          "source": "TypeHierarchyLifeCycle.java:107"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyViewPart.updateInput",
          "source": "TypeHierarchyViewPart.java:520"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.typehierarchy.TypeHierarchyViewPart.setInputElement",
          "source": "TypeHierarchyViewPart.java:483"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.openInViewPart",
          "source": "OpenTypeHierarchyUtil.java:96"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.open",
          "source": "OpenTypeHierarchyUtil.java:73"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.util.OpenTypeHierarchyUtil.open",
          "source": "OpenTypeHierarchyUtil.java:50"
        },
        {
          "method": "org.eclipse.jdt.ui.tests.performance.views.TypeHierarchyPerfTest.measureOpenHierarchy",
          "source": "TypeHierarchyPerfTest.java:88"
        },
        {
          "method": "org.eclipse.jdt.ui.tests.performance.views.TypeHierarchyPerfTest.testOpenObjectHierarchy",
          "source": "TypeHierarchyPerfTest.java:69"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "junit.framework.TestCase.runTest",
          "source": "TestCase.java:164"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:130"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:106"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:109"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:120"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:230"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:225"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:24"
        },
        {
          "method": "junit.extensions.TestSetup$1.protect",
          "source": "TestSetup.java:21"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.extensions.TestSetup.run",
          "source": "TestSetup.java:25"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run",
          "source": "JUnit3TestReference.java:130"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.TestExecution.run",
          "source": "TestExecution.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:460"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:673"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:386"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main",
          "source": "RemotePluginTestRunner.java:58"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run",
          "source": "UITestApplication.java:122"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:130"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3721"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3358"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2395"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2359"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2225"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:468"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:288"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:463"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication.start",
          "source": "UITestApplication.java:52"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:193"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:362"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:175"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:515"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:455"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1193"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1169"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "209222",
      "date": "2007-11-08T17:39:20+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.StackOverflowError",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle",
          "source": "ClassScope.java:1069"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle",
          "source": "ClassScope.java:1069"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle",
          "source": "ClassScope.java:1069"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.detectHierarchyCycle",
          "source": "ClassScope.java:1069"
        }
      ],
      "number": 1,
      "commentIndex": 1,
      "bugId": "209222",
      "date": "2007-11-12T17:33:37+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "209222",
  "bugId": "209222",
  "date": "2007-11-08T17:39:20+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}