{
  "comments": [
    "3.0\n\nThe RCP browser shouldn\u0027t need a workspace, but I encountered a few errors when \ntrying to run that way.  One of the errors seems to be related to the \nPreferenceForwarder.\n\n- load the org.eclipse.ui.examples.rcp.browser project\n- create a launch configuration with:\n  - only the browser and its required plugins\n  - the \"Location:\" field set to \"@none\"\n- run\n\nThe problem seems to be with the line that the default scope for a plugin is \n\"instance\".  Since there is no instance area in this case...\n\nHere\u0027s the stack:\n\njava.lang.ExceptionInInitializerError\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown \nSource)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat java.lang.Class.newInstance0(Unknown Source)\n\tat java.lang.Class.newInstance(Unknown Source)\n\tat org.eclipse.core.internal.registry.ConfigurationElement.\ncreateExecutableExtension(ConfigurationElement.java:141)\n\tat org.eclipse.core.internal.registry.ConfigurationElement.\ncreateExecutableExtension(ConfigurationElement.java:124)\n\tat org.eclipse.core.internal.registry.ConfigurationElement.\ncreateExecutableExtension(ConfigurationElement.java:113)\n\tat org.eclipse.core.internal.preferences.PreferencesService.\ncreateNode(PreferencesService.java:340)\n\tat org.eclipse.core.internal.preferences.RootPreferences.\ngetChild(RootPreferences.java:63)\n\tat org.eclipse.core.internal.preferences.RootPreferences.\nnode(RootPreferences.java:90)\n\tat org.eclipse.core.internal.preferences.PreferenceForwarder.\n\u003cinit\u003e(PreferenceForwarder.java:36)\n\tat org.eclipse.core.runtime.Plugin.getPluginPreferences(Plugin.java:330)\n\tat org.eclipse.ui.plugin.AbstractUIPlugin$CompatibilityPreferenceStore.\ninitialize(AbstractUIPlugin.java:193)\n\tat org.eclipse.ui.plugin.AbstractUIPlugin.\ngetPreferenceStore(AbstractUIPlugin.java:614)\n\tat org.eclipse.ui.internal.ActivityPersistanceHelper.\nloadEnabledStates(ActivityPersistanceHelper.java:75)\n\tat org.eclipse.ui.internal.ActivityPersistanceHelper.\n\u003cinit\u003e(ActivityPersistanceHelper.java:57)\n\tat org.eclipse.ui.internal.ActivityPersistanceHelper.\ngetInstance(ActivityPersistanceHelper.java:47)\n\tat org.eclipse.ui.internal.Workbench.init(Workbench.java:763)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1325)\n...",
    "Bug 69387 describes the problem I found after working around this one.",
    "What is the intended behaviour if someone tries to access/store instance-based\npreferences for a bundle when the user is running with no instance location?",
    "that is pretty much up to the preference service but I would expect some sort \nof failure.  The configruatoin says there is no instance area so there can \ntherefore not be any instance data (e.g., instance preferences).",
    "Jeff/Pascal, can you explain the stack trace? I would expect an error when\ntrying to save the preferences. Or maybe there is a nested exception that we\u0027re\nnot seeing?",
    "createExecutableExtension is trying to instantiate some class.  That \nconstructor is throwing an error of some kind.  It appears either to have been \neaten or is just not in the stack trace.  Suspect something like an NPE (i.e., \nruntime exceptoin or error).",
    "Opps, looks like I cut off the exception too soon.  I still have the log file, \nhere is the tail of that exception and the stack for the original:\n\n...\n\tat org.eclipse.core.launcher.Main.main(Main.java:628)\nCaused by: java.lang.IllegalStateException: No instance data can be specified.\n\tat org.eclipse.core.internal.runtime.DataArea.\nassertLocationInitialized(DataArea.java:38)\n\tat org.eclipse.core.internal.runtime.DataArea.getStateLocation(DataArea.\njava:81)\n\tat org.eclipse.core.internal.preferences.InstancePreferences.\n\u003cclinit\u003e(InstancePreferences.java:36)\n\t... 34 more\n",
    "The error is an IllegalStateException thrown by getStateLocation().\nThe exception is thrown during the initialization of the class \nInstancePreferences (static initializer line 36).",
    "Also, the problem is caused by line 36 of PreferenceForwarder, where it tries to \nload the default node for the plugin (instance scope).  I was able to work \naround this problem by making that line look like line 37 (i.e., I changed the \ndefault to SCOPE).  Obviously that\u0027s not the real solution, but it did get me \npast this point so that I was able to find the next problem in this area (bug \n69387).",
    "Need to decide:\n- the right behaviour\n- whether or not something should be changed for 3.0.1",
    "Released changes to HEAD which check to see if the instance location has been\nset. Tested with RCP app and got to the same point that Andrew notes. (described\nin bug 69387)\n\nCreated bug 73164 to address the issue of the instance location changing during\na session.\n\nJeff, let me know if you feel this is important enough to back-port to the 3.0.1\nmaintenance stream. Fix is low-risk.",
    "Re-opening for inclusion in 3.0.1. Will attach patch for review.\n\nWe have decided that the current behaviour is good. Instance preferences will be\navailable all the time but if you don\u0027t have a data location set, then nothing\nwill happen when you call #flush().\n",
    "Created an attachment (id\u003d14367)\npatch\n\nPatch for InstancePreferences (1.22).",
    "Reviewed by JA + PR. Released to 3.0.1 stream."
  ],
  "commentCreationDates": [
    "2004-07-06T17:49:31+02:00",
    "2004-07-06T17:56:02+02:00",
    "2004-07-06T18:14:15+02:00",
    "2004-07-06T23:03:16+02:00",
    "2004-07-07T14:29:27+02:00",
    "2004-07-07T15:45:41+02:00",
    "2004-07-07T15:51:37+02:00",
    "2004-07-07T15:52:31+02:00",
    "2004-07-07T15:54:58+02:00",
    "2004-07-14T17:22:09+02:00",
    "2004-09-02T17:38:16+02:00",
    "2004-09-02T22:17:22+02:00",
    "2004-09-02T22:20:45+02:00",
    "2004-09-07T20:43:05+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ExceptionInInitializerError",
      "elements": [
        {
          "method": "sun.reflect.NativeConstructorAccessorImpl.newInstance0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeConstructorAccessorImpl.newInstance",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingConstructorAccessorImpl.newInstance",
          "source": "Unknown  Source"
        },
        {
          "method": "java.lang.reflect.Constructor.newInstance",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.Class.newInstance0",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.Class.newInstance",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:141"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:124"
        },
        {
          "method": "org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension",
          "source": "ConfigurationElement.java:113"
        },
        {
          "method": "org.eclipse.core.internal.preferences.PreferencesService.createNode",
          "source": "PreferencesService.java:340"
        },
        {
          "method": "org.eclipse.core.internal.preferences.RootPreferences.getChild",
          "source": "RootPreferences.java:63"
        },
        {
          "method": "org.eclipse.core.internal.preferences.RootPreferences.node",
          "source": "RootPreferences.java:90"
        },
        {
          "method": "org.eclipse.core.internal.preferences.PreferenceForwarder.\u003cinit\u003e",
          "source": "PreferenceForwarder.java:36"
        },
        {
          "method": "org.eclipse.core.runtime.Plugin.getPluginPreferences",
          "source": "Plugin.java:330"
        },
        {
          "method": "org.eclipse.ui.plugin.AbstractUIPlugin$CompatibilityPreferenceStore.initialize",
          "source": "AbstractUIPlugin.java:193"
        },
        {
          "method": "org.eclipse.ui.plugin.AbstractUIPlugin.getPreferenceStore",
          "source": "AbstractUIPlugin.java:614"
        },
        {
          "method": "org.eclipse.ui.internal.ActivityPersistanceHelper.loadEnabledStates",
          "source": "ActivityPersistanceHelper.java:75"
        },
        {
          "method": "org.eclipse.ui.internal.ActivityPersistanceHelper.\u003cinit\u003e",
          "source": "ActivityPersistanceHelper.java:57"
        },
        {
          "method": "org.eclipse.ui.internal.ActivityPersistanceHelper.getInstance",
          "source": "ActivityPersistanceHelper.java:47"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.init",
          "source": "Workbench.java:763"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1325"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "69386",
      "date": "2004-07-06T17:49:31+02:00",
      "product": "Platform",
      "component": "Runtime",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "No instance data can be specified.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.runtime.DataArea.assertLocationInitialized",
          "source": "DataArea.java:38"
        },
        {
          "method": "org.eclipse.core.internal.runtime.DataArea.getStateLocation",
          "source": "DataArea. java:81"
        },
        {
          "method": "org.eclipse.core.internal.preferences.InstancePreferences.\u003cclinit\u003e",
          "source": "InstancePreferences.java:36"
        }
      ],
      "number": 1,
      "commentIndex": 6,
      "bugId": "69386",
      "date": "2004-07-07T15:51:37+02:00",
      "product": "Platform",
      "component": "Runtime",
      "severity": "normal"
    }
  ],
  "groupId": "69386",
  "bugId": "69386",
  "date": "2004-07-06T17:49:31+02:00",
  "product": "Platform",
  "component": "Runtime",
  "severity": "normal"
}