{
  "comments": [
    "Using 20060427-1600, I got this exception.\n\n1) New Java Project \"A\" with default settings\nNew Java Class \"B\" in package jkohen.\nAdd method \"void m1()\" to class B.\nExport Project A to \"lib.jar\" JAR File with default settings.\n\nWhen I exported the lib.jar contained a structure like:\nA/jkohen/B.class\n\n2) New Java Project \"B\" with default settings\nAdd lib.jar to Project B\u0027s Build Path (as an external jar).\nNew Java Class \"C\" in package jkohen.impl extending class B.\n\nGot an error saying that the import jkohen.B cannot be resolved. This is when I found out that the structure in lib.jar was wrong.\n\n3) I went to the file system. Zipped jkohen.B.class myself inside lib.jar and refreshed the project B. Then I got this error.\n\njava.lang.ClassCastException: org.eclipse.jdt.internal.core.CompilationUnit\n\tat org.eclipse.jdt.internal.core.hierarchy.HierarchyBuilder.getHandle(HierarchyBuilder.java:202)\n\tat org.eclipse.jdt.internal.core.hierarchy.HierarchyResolver.reportHierarchy(HierarchyResolver.java:464)\n\tat org.eclipse.jdt.internal.core.hierarchy.HierarchyResolver.resolve(HierarchyResolver.java:509)\n\tat org.eclipse.jdt.internal.core.hierarchy.HierarchyBuilder.buildSupertypes(HierarchyBuilder.java:113)\n\tat org.eclipse.jdt.internal.core.hierarchy.IndexBasedHierarchyBuilder.build(IndexBasedHierarchyBuilder.java:133)\n\tat org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.compute(TypeHierarchy.java:300)\n\tat org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.refresh(TypeHierarchy.java:1235)\n\tat org.eclipse.jdt.internal.core.CreateTypeHierarchyOperation.executeOperation(CreateTypeHierarchyOperation.java:90)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:720)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:779)\n\tat org.eclipse.jdt.internal.core.BinaryType.newSupertypeHierarchy(BinaryType.java:816)\n\tat org.eclipse.jdt.internal.core.BinaryType.newSupertypeHierarchy(BinaryType.java:768)\n\tat org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getTypeHierarchy(SuperTypeHierarchyCache.java:120)\n\tat org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getTypeHierarchy(SuperTypeHierarchyCache.java:80)\n\tat org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getMethodOverrideTester(SuperTypeHierarchyCache.java:89)\n\tat org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.getOverrideIndicators(OverrideIndicatorLabelDecorator.java:162)\n\tat org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.computeAdornmentFlags(OverrideIndicatorLabelDecorator.java:129)\n\tat org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.decorate(OverrideIndicatorLabelDecorator.java:261)\n\tat org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate(LightweightDecoratorDefinition.java:259)\n\tat org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run(LightweightDecoratorManager.java:71)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:843)\n\tat org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate(LightweightDecoratorManager.java:336)\n\tat org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations(LightweightDecoratorManager.java:322)\n\tat org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached(DecorationScheduler.java:338)\n\tat org.eclipse.ui.internal.decorators.DecorationScheduler$1.run(DecorationScheduler.java:308)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)",
    "Forgot to mention that the lib.jar contains the source and the binary for jkohen.B.",
    "I\u0027m not sure how to make the JAR export have a structure like A/jkohen/B.class.\nWhen I export with default setting, the structure is jkohen/B.class.",
    "Created an attachment (id\u003d39907)\nLibrary with the structure A/jkohen/B.class\n\n",
    "Sorry I still cannot reproduce. Starting with a fresh workspace, and following your steps, I don\u0027t get the CCE.\n\nCan you reproduce ? If you can, do you have more details ?",
    "Could not reproduce today. I got it twice on Friday.\nCould it be possible that the source file (B.java) inside the lib.jar is returned instead of the binary file (B.class)? The library lib.jar contains both B.java and B.class.",
    "To reproduce A must be a prereq of B.\n\nExact steps are:\n1. Unzip lib,jar from comment 3 in workspace dir\n2. New Java Project \"A\" (it uses the sources that were just unzipped)\n3. New Java Project \"B\" with project \"A\" and \"lib.jar\" on the classpath\n4. Drill down to \"B.class\" in lib.jar an open it\nObserve: You get the reported ClassCastException in the .log file",
    "Created an attachment (id\u003d40027)\nProposed patch and regression test\n\n",
    "+1 for 3.2RC3\n\nMarkus - pls cast your vote",
    "+1 for 3.2 RC3",
    "Released patch and regression test",
    "Verified using N20060503-0010 for 3.2RC3",
    "Double-checked using build N20060504-0010"
  ],
  "commentCreationDates": [
    "2006-04-28T21:10:36+02:00",
    "2006-04-28T21:45:09+02:00",
    "2006-04-29T16:23:45+02:00",
    "2006-04-30T21:20:16+02:00",
    "2006-05-01T12:51:18+02:00",
    "2006-05-01T15:38:36+02:00",
    "2006-05-02T15:06:31+02:00",
    "2006-05-02T15:08:28+02:00",
    "2006-05-02T16:15:14+02:00",
    "2006-05-02T16:46:34+02:00",
    "2006-05-02T17:07:45+02:00",
    "2006-05-03T17:07:25+02:00",
    "2006-05-04T13:57:06+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.jdt.internal.core.CompilationUnit",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.HierarchyBuilder.getHandle",
          "source": "HierarchyBuilder.java:202"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.HierarchyResolver.reportHierarchy",
          "source": "HierarchyResolver.java:464"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.HierarchyResolver.resolve",
          "source": "HierarchyResolver.java:509"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.HierarchyBuilder.buildSupertypes",
          "source": "HierarchyBuilder.java:113"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.IndexBasedHierarchyBuilder.build",
          "source": "IndexBasedHierarchyBuilder.java:133"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.compute",
          "source": "TypeHierarchy.java:300"
        },
        {
          "method": "org.eclipse.jdt.internal.core.hierarchy.TypeHierarchy.refresh",
          "source": "TypeHierarchy.java:1235"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CreateTypeHierarchyOperation.executeOperation",
          "source": "CreateTypeHierarchyOperation.java:90"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:720"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:779"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BinaryType.newSupertypeHierarchy",
          "source": "BinaryType.java:816"
        },
        {
          "method": "org.eclipse.jdt.internal.core.BinaryType.newSupertypeHierarchy",
          "source": "BinaryType.java:768"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getTypeHierarchy",
          "source": "SuperTypeHierarchyCache.java:120"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getTypeHierarchy",
          "source": "SuperTypeHierarchyCache.java:80"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.util.SuperTypeHierarchyCache.getMethodOverrideTester",
          "source": "SuperTypeHierarchyCache.java:89"
        },
        {
          "method": "org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.getOverrideIndicators",
          "source": "OverrideIndicatorLabelDecorator.java:162"
        },
        {
          "method": "org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.computeAdornmentFlags",
          "source": "OverrideIndicatorLabelDecorator.java:129"
        },
        {
          "method": "org.eclipse.jdt.ui.OverrideIndicatorLabelDecorator.decorate",
          "source": "OverrideIndicatorLabelDecorator.java:261"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate",
          "source": "LightweightDecoratorDefinition.java:259"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run",
          "source": "LightweightDecoratorManager.java:71"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:843"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate",
          "source": "LightweightDecoratorManager.java:336"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations",
          "source": "LightweightDecoratorManager.java:322"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached",
          "source": "DecorationScheduler.java:338"
        },
        {
          "method": "org.eclipse.ui.internal.decorators.DecorationScheduler$1.run",
          "source": "DecorationScheduler.java:308"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "139279",
      "date": "2006-04-28T21:10:36+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "139279",
  "bugId": "139279",
  "date": "2006-04-28T21:10:36+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}