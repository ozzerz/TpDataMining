{
  "comments": [
    "Steps to reproduce:\n- create a new Dynamic web project and call is \"testweb\"\n- create a new file in the WebContent directory and call it \"test.jsp\"\n- open the file and paste (ctrl+v) the following:\n\u003cjsp:root version\u003d\"2.0\" xmlns:jsp\u003d\"http://java.sun.com/JSP/Page\"\nxmlns:ou\u003d\"urn:jsptagdir:/WEB-INF/tags/test\"\u003e\n\na dialog box is displayed with an IllegalArgumentException: path must include\nproject and resource name /testweb\n\nThis often happens when pasting code into the jsp editor (note that the\nexistence of the tag dir doesn\u0027t influence the error).\n\nAfter pasting the code you can also try:\n- put the cursor after the open jsp:root declaration and press return\n- type (don\u0027t paste and don\u0027t use autocomplete) \"\u003c/jsp:root\u003e\"\n\noften while doing this the jsp editor start writing from right to left: the\ntyped character shows up BEFORE the cursor and text scroll to right\n\nfor example I get:\n\u003c/jsp:\u003etoor -\u003e all ok for \"\u003c/jsp:\", then all the characters are shifted right\nwhile typing.\n\nThe | indicates the cursor position in the editor while typing:\n|\n\u003c|\n\u003c/|\n\u003c/j|\n\u003c/js|\n\u003c/jsp|\n\u003c/jsp:|\n\u003c/jsp:|r\n\u003c/jsp:|or\n\u003c/jsp:|oor\n\u003c/jsp:|toor\n\u003c/jsp:|\u003etoor\n\n\nI saw this crazy behavior many times, in different projects, on different\nmachines (always win xp), with different versions of wtp till version 0.7 (which\nstill shows the problem). Sometimes the jsp editor becomes totally useless\nbecause it starts writing RTL at the first \"\u003c\" typed.\nJust for reference: this only happens with jsp pages (never seen this with xml\nfiles, for example) and I am using UTF8 encoding (both as the standard editor\nencoding and the xml/jsp encoding)",
    "Created an attachment (id\u003d26608)\nerror displayed during paste\n",
    "full stacktrace from the log:\n\n!ENTRY org.eclipse.wst.sse.core 4 4 2005-08-29 23:14:19.716\n!MESSAGE Program Error: invalid structured document event\n\n!ENTRY org.eclipse.ui 4 4 2005-08-29 23:14:19.716\n!MESSAGE Unhandled event loop exception\n\n!ENTRY org.eclipse.ui 4 0 2005-08-29 23:14:19.716\n!MESSAGE java.lang.IllegalArgumentException: Path must include project and\nresource name: /testweb\n!STACK 0\njava.lang.RuntimeException: java.lang.IllegalArgumentException: Path must\ninclude project and resource name: /testweb\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText(JobSafeStructuredDocument.java:118)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText(BasicStructuredDocument.java:2293)\n\tat\norg.eclipse.wst.sse.ui.internal.StructuredDocumentToTextAdapter.replaceTextRange(StructuredDocumentToTextAdapter.java:1187)\n\tat org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:5787)\n\tat org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:6625)\n\tat org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2592)\n\tat org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5098)\n\tat org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:5124)\n\tat org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4857)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:867)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:852)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:880)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:876)\n\tat org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1190)\n\tat org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:3135)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3038)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:3706)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1656)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2711)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:367)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:163)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n\tat org.eclipse.core.launcher.Main.run(Main.java:973)\n\tat org.eclipse.core.launcher.Main.main(Main.java:948)\nCaused by: java.lang.IllegalArgumentException: Path must include project and\nresource name: /testweb\n\tat org.eclipse.core.internal.utils.Assert.isLegal(Assert.java:60)\n\tat org.eclipse.core.internal.resources.Workspace.newResource(Workspace.java:1560)\n\tat org.eclipse.core.internal.resources.Container.getFile(Container.java:125)\n\tat\norg.eclipse.wst.common.componentcore.internal.resources.VirtualFile.getUnderlyingFile(VirtualFile.java:90)\n\tat\norg.eclipse.wst.common.componentcore.internal.util.ComponentResolver.resolve(ComponentResolver.java:135)\n\tat\norg.eclipse.wst.common.uriresolver.internal.ExtensibleURIResolver.resolve(ExtensibleURIResolver.java:71)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.loadTaglib(TLDCMDocumentManager.java:988)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.getCMDocument(TLDCMDocumentManager.java:747)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.enableTaglibFromURI(TLDCMDocumentManager.java:114)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot(TLDCMDocumentManager.java:326)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot(TLDCMDocumentManager.java:297)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.nodeParsed(TLDCMDocumentManager.java:211)\n\tat\norg.eclipse.wst.xml.core.internal.parser.XMLSourceParser.fireNodeParsed(XMLSourceParser.java:117)\n\tat\norg.eclipse.jst.jsp.core.internal.parser.JSPSourceParser.parseNodes(JSPSourceParser.java:299)\n\tat\norg.eclipse.wst.xml.core.internal.parser.XMLSourceParser.getDocumentRegions(XMLSourceParser.java:149)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser._core_reparse_text(StructuredDocumentReParser.java:309)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.core_reparse(StructuredDocumentReParser.java:708)\n\tat\norg.eclipse.jst.jsp.core.internal.parser.JSPReParser.reparse(JSPReParser.java:144)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.reparse(StructuredDocumentReParser.java:1284)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.updateModel(BasicStructuredDocument.java:2603)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.internalReplaceText(BasicStructuredDocument.java:1828)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText(BasicStructuredDocument.java:2297)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.access$0(JobSafeStructuredDocument.java:1)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument$1.run(JobSafeStructuredDocument.java:100)\n\tat\norg.eclipse.wst.sse.ui.internal.editor.EditorExecutionContext.execute(EditorExecutionContext.java:43)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText(JobSafeStructuredDocument.java:110)\n\t... 37 more",
    "Thanks for this detailed report. \nI could reproduce as described on 0.7. \nI could not reproduce on \u0027head\u0027 version. \nWe will investigate on what source of problem\n(and fix) is and consider \"back porting\" to 0.7.1\nversion if \"safe\". \nPlus, I believe there are two errors here for us to address. \nThe error causing the illegal Argument exception. \nAnd ... even then, the \"back wards typing\" problem \nappears to be a second problem, that we do not have \nsome code bullet proofed enough. \n\nThanks again. \n\n",
    "I\u0027ve opened bug 108333 to continue to track that this is a good test case to\nreproduce the \"back wards typing\" problem if the parse exception is not caught\nat a low level ...  but, since I couldn\u0027t easily fix that fundamental problem,\nhave committed and released a fix that always catches any parse exception at a\n\"low level\" so as to not interfere with UI thread. \n\n",
    "Fixed the \"ugly problem\" in M builds \u003e 8/30, by catching any parse exception \nin parseNodes in JSPSourceParser, and merely logging it, instead of letting it\ninterfere with UI thread. \n\nThere\u0027s several \"synch\" problems that exists (on UI thread, and getting the\nlibrary resolved in the first place) but this fix prevents the odd errors and\ndialogs from coming up. Oddly enough, when the exception is caught and only\nlogged at low level, highlighting works (I think because re-parsed in a more\nreasonable way, right after the paste). I did not check other funciton, such as\ncontent assit, etc., since this fix was intended just to prevent the \"blocking\"\nproblem of the editor becoming completely non-functional. Other improvements, if\nany needed, can be reported and fixed in future release. \n\n",
    "updaing for improved summmary and accurate tartget milestone. \n(fix has been in for a while). ",
    "*** Bug 111096 has been marked as a duplicate of this bug. ***",
    "Reopening due to report in bug 88966. (and several other bugs I\u0027ve \nseen open). \n\nIn looking at the code, this \"fix\" missed a spot or two where \n\"foriegn code\" was called. The better fix is to put the \"catch all Exceptions\" \ncheck right in the \u0027fireNodesParsed\u0027 method, instead of surrounding each of \nthose calls. \n\n",
    "*** Bug 108333 has been marked as a duplicate of this bug. ***",
    "released improved fix for RC1 build on 11/30. ",
    "I\u0027m marking as verified, as component owner. If origantor disagrees, or sees other similar bugs, please open new ones (with reference to this one). \n",
    "This is part of a mass update to close out all stale WTP defects already verified by the reporter but awaiting closure by the assignee.  If you feel this defect was closed inappropriately, please reopen.\n\nThanks, John Lanuti"
  ],
  "commentCreationDates": [
    "2005-08-29T23:25:47+02:00",
    "2005-08-29T23:26:30+02:00",
    "2005-08-29T23:31:06+02:00",
    "2005-08-30T00:41:12+02:00",
    "2005-08-30T06:52:31+02:00",
    "2005-08-30T07:03:37+02:00",
    "2005-09-21T04:34:34+02:00",
    "2005-10-19T17:44:11+02:00",
    "2005-11-30T03:35:42+01:00",
    "2005-11-30T03:42:43+01:00",
    "2005-11-30T04:39:35+01:00",
    "2005-12-19T07:51:46+01:00",
    "2006-11-28T20:36:56+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Path must include project and resource name: /testweb",
      "elements": [
        {
          "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText",
          "source": "JobSafeStructuredDocument.java:118"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText",
          "source": "BasicStructuredDocument.java:2293"
        },
        {
          "method": "org.eclipse.wst.sse.ui.internal.StructuredDocumentToTextAdapter.replaceTextRange",
          "source": "StructuredDocumentToTextAdapter.java:1187"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.modifyContent",
          "source": "StyledText.java:5787"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.sendKeyEvent",
          "source": "StyledText.java:6625"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.doContent",
          "source": "StyledText.java:2592"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKey",
          "source": "StyledText.java:5098"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKeyDown",
          "source": "StyledText.java:5124"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$7.handleEvent",
          "source": "StyledText.java:4857"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:867"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:852"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:880"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:876"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.wmChar",
          "source": "Widget.java:1190"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_CHAR",
          "source": "Control.java:3135"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3038"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3706"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1656"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2711"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1699"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1663"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:367"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:163"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "causedBy": {
        "exceptionType": "java.lang.IllegalArgumentException",
        "message": "Path must include project and resource name: /testweb",
        "elements": [
          {
            "method": "org.eclipse.core.internal.utils.Assert.isLegal",
            "source": "Assert.java:60"
          },
          {
            "method": "org.eclipse.core.internal.resources.Workspace.newResource",
            "source": "Workspace.java:1560"
          },
          {
            "method": "org.eclipse.core.internal.resources.Container.getFile",
            "source": "Container.java:125"
          },
          {
            "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualFile.getUnderlyingFile",
            "source": "VirtualFile.java:90"
          },
          {
            "method": "org.eclipse.wst.common.componentcore.internal.util.ComponentResolver.resolve",
            "source": "ComponentResolver.java:135"
          },
          {
            "method": "org.eclipse.wst.common.uriresolver.internal.ExtensibleURIResolver.resolve",
            "source": "ExtensibleURIResolver.java:71"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.loadTaglib",
            "source": "TLDCMDocumentManager.java:988"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.getCMDocument",
            "source": "TLDCMDocumentManager.java:747"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.enableTaglibFromURI",
            "source": "TLDCMDocumentManager.java:114"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot",
            "source": "TLDCMDocumentManager.java:326"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot",
            "source": "TLDCMDocumentManager.java:297"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.nodeParsed",
            "source": "TLDCMDocumentManager.java:211"
          },
          {
            "method": "org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.fireNodeParsed",
            "source": "XMLSourceParser.java:117"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.parser.JSPSourceParser.parseNodes",
            "source": "JSPSourceParser.java:299"
          },
          {
            "method": "org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.getDocumentRegions",
            "source": "XMLSourceParser.java:149"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser._core_reparse_text",
            "source": "StructuredDocumentReParser.java:309"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.core_reparse",
            "source": "StructuredDocumentReParser.java:708"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.parser.JSPReParser.reparse",
            "source": "JSPReParser.java:144"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.reparse",
            "source": "StructuredDocumentReParser.java:1284"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.updateModel",
            "source": "BasicStructuredDocument.java:2603"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.internalReplaceText",
            "source": "BasicStructuredDocument.java:1828"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText",
            "source": "BasicStructuredDocument.java:2297"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.access$0",
            "source": "JobSafeStructuredDocument.java:1"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument$1.run",
            "source": "JobSafeStructuredDocument.java:100"
          },
          {
            "method": "org.eclipse.wst.sse.ui.internal.editor.EditorExecutionContext.execute",
            "source": "EditorExecutionContext.java:43"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText",
            "source": "JobSafeStructuredDocument.java:110"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 2,
      "bugId": "108325",
      "date": "2005-08-29T23:31:06+02:00",
      "product": "Web Tools",
      "component": "jst.jsp",
      "severity": "critical"
    }
  ],
  "groupId": "108325",
  "bugId": "108325",
  "date": "2005-08-29T23:25:47+02:00",
  "product": "Web Tools",
  "component": "jst.jsp",
  "severity": "critical"
}