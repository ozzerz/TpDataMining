{
  "comments": [
    "Created an attachment (id\u003d80462)\n Eclipse project demonstrating this bug  \n\nBuild ID: M20070921-1145\n\nSteps To Reproduce:\n1.Build Eclipse from source.\n2.Create a project, put a simple JUnit test case in it.\n3.Set the project to use a 1.4 JVM.\n\nEclipse throws the following exception:\n\nException in thread \"main\" java.lang.UnsupportedClassVersionError: org/eclipse/jdt/internal/junit/runner/RemoteTestRunner (Unsupported major.minor version 50.0)\n\tat java.lang.ClassLoader.defineClass0(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:539)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:123)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:251)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:55)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:194)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:187)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:289)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:274)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:235)\n\tat java.lang.ClassLoader.loadClassInternal(ClassLoader.java:302)\n\n\n\nMore information:\nSee bug 153087 (https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d153087) for more detail.  I recently tried to reopen that bug, but markus_keller@ch.ibm.com refused to look into it, saying:\n\n\"Sorry, the people CCd on this bug are not too familiar with how the releng scripts work.\n...\nIf you think the Eclipse build scripts have a bug, please file a new bug for Platform/Releng.\"\n\nSigh.\n\nSo here I go, re-entering all the bug info all over again.\n\n-----\n\nThe problem is this:\n\nI am working with one of the package maintainers for a Linux distro.  (Arch Linux).  I assist him in building the package for Eclipse.  I ran into a problem in the past whereby when we built Eclipse using only JDK5 or 6, I would encounter the error I described in the \"steps to reproduce\".  (i.e., when trying to run a JUnit test case in a project designated as using JDK1.4, I would get a UnsupportedClassVersionError.)\n\nThis apparently occurred because Eclipse was not being built using a combination of JDK 1.4 and JDK 5.  When we corrected the package build script to build it using JDK1.4 in conjunction with the \"-java5home\" parameter, the package would then get built correctly and the UnsupportedClassVersionError would go away.  This fix worked fine through Eclipse 3.2.\n\nHowever, we recently have been trying to upgrade Arch\u0027s Eclipse package to 3.3(.1) and suddenly this same problem is happening again.  The reason is that the \"-java5home\" parameter appears to have been removed from the 3.3.1 build script.  As a result, it seems like there is no way to properly build Eclipse with JDK1.4 support any longer.  And when I build it with just JDK 6, attempting to run a JUnit test case in a project that uses JDK 1.4 again causes the same UnsupportedClassVersionError.\n\n\nHow is it possible to fix this situation?  Is it still possible to build Eclipse with the JDK1.4/JDK6 combination?  If so, how?\n\nI realize that the current Java release from Sun is now JDK6, but there are still many organizations that use JDK1.4, and we would still like to support this.\n\nAnd, in fact, since Eclipse clearly supports JDK1.4 (since it allows you to mark a project as being a 1.4 project) then it should not cause an error in this situation.  If 1.4 is disallowed, then it should not be available as a choice - it should never cause an error in the IDE.",
    "Sorry - left out a reproduce step.  S/b:\n\n1.Build Eclipse from source.\n2.Create a project, put a simple JUnit test case in it.\n3.Set the project to use a 1.4 JVM.\n4.Try to run the test case by right-clicking on it and selecting Run as -\u003e JUnit test\n\nEclipse throws the following exception:",
    "The reference platforms for Eclipse 3.3.1 are listed below\n\nhttp://www.eclipse.org/eclipse/development/eclipse_project_plan_3_3.html#TargetOperatingEnvironments\n\nYes, the source build is simplified from the real build.  We actually use seven vms during our build process and replicating that is just too complicated for the average person trying to build the source build.  \n\n\n\n",
    "Appreciate the response, but ...  I don\u0027t think it addresses my issue.\n\nHow can we build the Eclipse package so that it won\u0027t throw the UnsupportedClassVersionError when a project uses a 1.4 VM?",
    "I would suggest talking to the Linux distros project.  They have custom scripts and patches used to build the various eclipse projects from source.\n\nhttp://wiki.eclipse.org/index.php/Linux_Distributions_Project",
    "OK, cool.  Will follow up with them.  Thanks much for the pointer.",
    "Hmmm ... that list was not much help, unfortunately.  Apparently, neither Fedora nor Gentoo builds Eclipse with JDK1.4 support anymore.\n\nCan you please provide some further assistance here?\n\nThe issue, I\u0027m guessing, is how to build org.eclipse.jdt.junit.runtime with JDK1.4 support.  How can I do that?\n\nAlso, I don\u0027t think I ever saw any answers to my earlier questions:\n\nWhy was the \"-java5home\" parameter removed from the build script?\n\nAnd how does one go about building Eclipse with JDK1.4 support without it?",
    "Are you using PDE-Build to build the bundles? \n\nI have seen errors like this in the past when building bundles which require a 1.5 VM because the default class file version is set to a 5.0 level. You can set properties in your build.properties file which set the class file level. For instance:\n\njavacSource\u003d1.3\njavacTarget\u003d1.1\n\nHere is a help topic that talks about it:\n\nhttp://help.eclipse.org/help33/index.jsp?topic\u003d/org.eclipse.pde.doc.user/guide/tasks/pde_compilation_env.htm\n",
    "This isn\u0027t a plugin I\u0027m building.  I\u0027m trying to build the entire Eclipse IDE.\n\nAs I mentioned in the bug description, I\u0027m assisting a package maintainer in trying to build and package the new Eclipse 3.3.1 for our distro.  (Arch Linux)",
    "Do you have a 1.3 vm in your list that you are building with? The org.eclipse.jdt.junit.runtime bundle specifies that it requires a 1.3 VM but if you don\u0027t have one perhaps it is using the 1.5 and then setting the class file version too high? I\u0027m not sure how this default selection works, perhaps Kim does.\n\nYou could also try adding the 2 lines that I put in comment #7 in the build.properties file for that bundle and see if that works.\n",
    "\u003e Do you have a 1.3 vm in your list that you are building with?\n\nNot sure I understand.  What list are you referring to?  Perhaps you\u0027re referring to something needed when building plugins.\n\nAs I mentioned, I\u0027m building the full Eclipse.  I\u0027m using the build \u0026 build.xml scripts that ship with eclipse-sourceBuild-srcIncluded-3.3.1.zip.\n\nIn the past, in order to build Eclipse with proper JDK 1.4 support, I just needed to patch the build script to set \"-java5home\" to the JDK5/6 directory and then run the build script using a JDK1.4 VM.\n\nThe Eclipse build process was apparently smart enough to figure out when it needed to switch to use the JDK5/6 VM and when to use 1.4.  But with the \"java5home\" parm removed, that appears to no longer be possible.  (Or at least not obvious.)",
    "?  Does anyone have any solution to this?"
  ],
  "commentCreationDates": [
    "2007-10-16T17:20:13+02:00",
    "2007-10-16T17:22:33+02:00",
    "2007-10-16T20:32:31+02:00",
    "2007-10-16T21:22:51+02:00",
    "2007-10-19T14:45:14+02:00",
    "2007-10-19T16:45:55+02:00",
    "2007-10-22T19:44:23+02:00",
    "2007-10-22T20:01:44+02:00",
    "2007-10-22T21:15:22+02:00",
    "2007-10-22T21:24:13+02:00",
    "2007-10-22T22:08:31+02:00",
    "2007-11-12T15:22:50+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.UnsupportedClassVersionError",
      "message": "org/eclipse/jdt/internal/junit/runner/RemoteTestRunner (Unsupported major.minor version 50.0)",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClass0",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:539"
        },
        {
          "method": "java.security.SecureClassLoader.defineClass",
          "source": "SecureClassLoader.java:123"
        },
        {
          "method": "java.net.URLClassLoader.defineClass",
          "source": "URLClassLoader.java:251"
        },
        {
          "method": "java.net.URLClassLoader.access$100",
          "source": "URLClassLoader.java:55"
        },
        {
          "method": "java.net.URLClassLoader$1.run",
          "source": "URLClassLoader.java:194"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "java.net.URLClassLoader.findClass",
          "source": "URLClassLoader.java:187"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:289"
        },
        {
          "method": "sun.misc.Launcher$AppClassLoader.loadClass",
          "source": "Launcher.java:274"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:235"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:302"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "206479",
      "date": "2007-10-16T17:20:13+02:00",
      "product": "Platform",
      "component": "Releng",
      "severity": "normal"
    }
  ],
  "groupId": "206479",
  "bugId": "206479",
  "date": "2007-10-16T17:20:13+02:00",
  "product": "Platform",
  "component": "Releng",
  "severity": "normal"
}