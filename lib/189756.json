{
  "comments": [
    "Using I20070529-0010, this project cannot be successfully exported as a plugin using the export mechanism.\nIt fails because the processors are not found on the classpath when compiling the apttestprocessors.jar.\nThe error reported in a .log file is:\n\n# 07-05-29 15:13:40 EDT\n# Eclipse Java Compiler 0.766, 3.3.0 release candidate-2, Copyright IBM Corp 2000, 2007. All rights reserved.\n----------\n1. ERROR in D:\\eclipse\\workspaces\\head\\org.eclipse.jdt.compiler.apt.tests\\processors\\org\\eclipse\\jdt\\compiler\\apt\\tests\\processors\\visitors\\VisitorProc.java (at line 0)\n\t/*******************************************************************************\n\t^\nInternal compiler error\njava.util.ServiceConfigurationError: javax.annotation.processing.Processor: Provider org.eclipse.jdt.compiler.apt.tests.processors.genclass.GenClassProc not found\n\tat java.util.ServiceLoader.fail(ServiceLoader.java:214)\n\tat java.util.ServiceLoader.access$400(ServiceLoader.java:164)\n\tat java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:350)\n\tat java.util.ServiceLoader$1.next(ServiceLoader.java:421)\n\tat org.eclipse.jdt.internal.compiler.apt.dispatch.BatchAnnotationProcessorManager.discoverNextProcessor(BatchAnnotationProcessorManager.java:139)\n\tat org.eclipse.jdt.internal.compiler.apt.dispatch.RoundDispatcher.round(RoundDispatcher.java:70)\n\tat org.eclipse.jdt.internal.compiler.apt.dispatch.BaseAnnotationProcessorManager.processAnnotations(BaseAnnotationProcessorManager.java:148)\n\tat org.eclipse.jdt.internal.compiler.Compiler.processAnnotations(Compiler.java:663)\n\tat org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:374)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.performCompilation(Main.java:3343)\n\tat org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1545)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.eclipse.jdt.core.JDTCompilerAdapter.execute(JDTCompilerAdapter.java:79)\n\tat org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:997)\n\tat org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:820)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)\n\tat org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets(EclipseSingleCheckExecutor.java:30)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:416)\n\tat org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:105)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)\n\tat org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets(EclipseSingleCheckExecutor.java:30)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:416)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)\n\tat org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets(EclipseSingleCheckExecutor.java:30)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:416)\n\tat org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:105)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.eclipse.ant.internal.core.ant.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run(InternalAntRunner.java:623)\n\tat org.eclipse.ant.internal.core.ant.InternalAntRunner.run(InternalAntRunner.java:456)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.eclipse.ant.core.AntRunner.run(AntRunner.java:377)\n\tat org.eclipse.pde.internal.core.exports.FeatureExportOperation.runScript(FeatureExportOperation.java:327)\n\tat org.eclipse.pde.internal.core.exports.FeatureExportOperation.doExport(FeatureExportOperation.java:217)\n\tat org.eclipse.pde.internal.core.exports.FeatureBasedExportOperation.run(FeatureBasedExportOperation.java:45)\n\tat org.eclipse.pde.internal.ui.build.FeatureExportJob.run(FeatureExportJob.java:59)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\n\n----------\n1 problem (1 error)\n\nLooking at this test plugin, there is several things we might want to change:\n1) Use two output folders. One for the source folder \"src\" and one for the source folder \"processors\".\n2) Find a way to add \"-proc:none\" in the compiler args of the batch compiler when compiling the code for apttestprocessors.jar.\n\nSince this is a test plugin, this is not a priority for 3.3, but it should be addressed for 3.3.1.",
    "Hmm, this is interesting.  It is an unexpected consequence of the (spec-required) behavior that we default to searching the classpath for META-INF/services entries, and the source directory is on the classpath.\n\nI\u0027ll investigate what javac does in this case.  It seems like it would always be a problem when trying to compile a project that contains processor source (but that does not itself involve any processing).",
    "As I said, we should improve this for 3.3.1. I think we might want to use the messager interface to report the problem. AbortCompilation seems to be a little too strong in this case, but this seems to be a known issue since there is a TODO tag :-).",
    "javac also fails in this case:\n\nerror: Bad service configuration file, or exception thrown while constructing Pr\nocessor object: javax.annotation.processing.Processor: Provider org.example.java\n6processors.internal.Processor not found\n\nAdding the -proc:none flag makes compilation succeed.",
    "For 3.3.1 we should:\n\n1. Make this failure more graceful (e.g., use Messager as Olivier suggests).\n2. Modify this particular plug-in project to not fail, e.g., use -proc:none in its compiler options when compiling the \"processors\" source folder.",
    "1. seems to be easy.\nFor 2., I could not find a way to add this compiler option in the build.xml file used by the export mechanism.\nAndrew, any idea? Can we achieve this by modifying the build.properties file ?\n",
    "There is no way to set compiler arguments from the build.properties file.  (I\u0027m suprised we don\u0027t have this and that noone has asked for it).\n\nThe closest thing we have is a global compiler argument property for all calls to javac.\n\nThe only way I can see to get the compiler argument in is a bit of an ugly hack:\npde.build is generating a file \"javaCompiler.lib_apttestprocessors.jar.args\" (used for access rules and file encoding).  It is passed as an argument file.  You could write custom ant callbacks and in the target pre.lib/apttestprecessors.jar you could append your arguments to the end of the javaCompiler args file.",
    "Changing target to 3.4; the object where the exception is thrown doesn\u0027t have access to a Messager, so fixing this will require a bit more plumbing than I was willing to do by the time I got to it.\n\nIf I find a simple and graceful solution in time for 3.3.2 (or if it appears in the field) perhaps we should fix this for 3.3.2."
  ],
  "commentCreationDates": [
    "2007-05-29T21:17:31+02:00",
    "2007-05-29T22:09:55+02:00",
    "2007-05-29T22:17:56+02:00",
    "2007-05-29T22:34:09+02:00",
    "2007-05-29T22:47:39+02:00",
    "2007-05-29T22:56:14+02:00",
    "2007-05-29T23:45:11+02:00",
    "2007-09-05T01:57:06+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.util.ServiceConfigurationError",
      "message": "javax.annotation.processing.Processor: Provider org.eclipse.jdt.compiler.apt.tests.processors.genclass.GenClassProc not found",
      "elements": [
        {
          "method": "java.util.ServiceLoader.fail",
          "source": "ServiceLoader.java:214"
        },
        {
          "method": "java.util.ServiceLoader.access$400",
          "source": "ServiceLoader.java:164"
        },
        {
          "method": "java.util.ServiceLoader$LazyIterator.next",
          "source": "ServiceLoader.java:350"
        },
        {
          "method": "java.util.ServiceLoader$1.next",
          "source": "ServiceLoader.java:421"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.apt.dispatch.BatchAnnotationProcessorManager.discoverNextProcessor",
          "source": "BatchAnnotationProcessorManager.java:139"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.apt.dispatch.RoundDispatcher.round",
          "source": "RoundDispatcher.java:70"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.apt.dispatch.BaseAnnotationProcessorManager.processAnnotations",
          "source": "BaseAnnotationProcessorManager.java:148"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.processAnnotations",
          "source": "Compiler.java:663"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:374"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.performCompilation",
          "source": "Main.java:3343"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:1545"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.eclipse.jdt.core.JDTCompilerAdapter.execute",
          "source": "JDTCompilerAdapter.java:79"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.Javac.compile",
          "source": "Javac.java:997"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.Javac.execute",
          "source": "Javac.java:820"
        },
        {
          "method": "org.apache.tools.ant.UnknownElement.execute",
          "source": "UnknownElement.java:288"
        },
        {
          "method": "sun.reflect.GeneratedMethodAccessor8.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.apache.tools.ant.dispatch.DispatchUtils.execute",
          "source": "DispatchUtils.java:105"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:348"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:357"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:385"
        },
        {
          "method": "org.apache.tools.ant.Project.executeSortedTargets",
          "source": "Project.java:1329"
        },
        {
          "method": "org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets",
          "source": "SingleCheckExecutor.java:38"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets",
          "source": "EclipseSingleCheckExecutor.java:30"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:1181"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.Ant.execute",
          "source": "Ant.java:416"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.CallTarget.execute",
          "source": "CallTarget.java:105"
        },
        {
          "method": "org.apache.tools.ant.UnknownElement.execute",
          "source": "UnknownElement.java:288"
        },
        {
          "method": "sun.reflect.GeneratedMethodAccessor8.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.apache.tools.ant.dispatch.DispatchUtils.execute",
          "source": "DispatchUtils.java:105"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:348"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:357"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:385"
        },
        {
          "method": "org.apache.tools.ant.Project.executeSortedTargets",
          "source": "Project.java:1329"
        },
        {
          "method": "org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets",
          "source": "SingleCheckExecutor.java:38"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets",
          "source": "EclipseSingleCheckExecutor.java:30"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:1181"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.Ant.execute",
          "source": "Ant.java:416"
        },
        {
          "method": "org.apache.tools.ant.UnknownElement.execute",
          "source": "UnknownElement.java:288"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.apache.tools.ant.dispatch.DispatchUtils.execute",
          "source": "DispatchUtils.java:105"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:348"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:357"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:385"
        },
        {
          "method": "org.apache.tools.ant.Project.executeSortedTargets",
          "source": "Project.java:1329"
        },
        {
          "method": "org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets",
          "source": "SingleCheckExecutor.java:38"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.EclipseSingleCheckExecutor.executeTargets",
          "source": "EclipseSingleCheckExecutor.java:30"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:1181"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.Ant.execute",
          "source": "Ant.java:416"
        },
        {
          "method": "org.apache.tools.ant.taskdefs.CallTarget.execute",
          "source": "CallTarget.java:105"
        },
        {
          "method": "org.apache.tools.ant.UnknownElement.execute",
          "source": "UnknownElement.java:288"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.apache.tools.ant.dispatch.DispatchUtils.execute",
          "source": "DispatchUtils.java:105"
        },
        {
          "method": "org.apache.tools.ant.Task.perform",
          "source": "Task.java:348"
        },
        {
          "method": "org.apache.tools.ant.Target.execute",
          "source": "Target.java:357"
        },
        {
          "method": "org.apache.tools.ant.Target.performTasks",
          "source": "Target.java:385"
        },
        {
          "method": "org.apache.tools.ant.Project.executeSortedTargets",
          "source": "Project.java:1329"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTarget",
          "source": "Project.java:1298"
        },
        {
          "method": "org.apache.tools.ant.helper.DefaultExecutor.executeTargets",
          "source": "DefaultExecutor.java:41"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.EclipseDefaultExecutor.executeTargets",
          "source": "EclipseDefaultExecutor.java:32"
        },
        {
          "method": "org.apache.tools.ant.Project.executeTargets",
          "source": "Project.java:1181"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.InternalAntRunner.run",
          "source": "InternalAntRunner.java:623"
        },
        {
          "method": "org.eclipse.ant.internal.core.ant.InternalAntRunner.run",
          "source": "InternalAntRunner.java:456"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:597"
        },
        {
          "method": "org.eclipse.ant.core.AntRunner.run",
          "source": "AntRunner.java:377"
        },
        {
          "method": "org.eclipse.pde.internal.core.exports.FeatureExportOperation.runScript",
          "source": "FeatureExportOperation.java:327"
        },
        {
          "method": "org.eclipse.pde.internal.core.exports.FeatureExportOperation.doExport",
          "source": "FeatureExportOperation.java:217"
        },
        {
          "method": "org.eclipse.pde.internal.core.exports.FeatureBasedExportOperation.run",
          "source": "FeatureBasedExportOperation.java:45"
        },
        {
          "method": "org.eclipse.pde.internal.ui.build.FeatureExportJob.run",
          "source": "FeatureExportJob.java:59"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "189756",
      "date": "2007-05-29T21:17:31+02:00",
      "product": "JDT",
      "component": "APT",
      "severity": "normal"
    }
  ],
  "groupId": "189756",
  "bugId": "189756",
  "date": "2007-05-29T21:17:31+02:00",
  "product": "JDT",
  "component": "APT",
  "severity": "normal"
}