{
  "comments": [
    "I get an exception when I query the datacenter repository for machines, os.windows and tomcat records.  The following is the snippet of code I use.  It seems the graph response returned does not conform to the CMDBf spec.\n\n\nISMLRepository repository \u003d new FileSystemSMLRepository();\nMap attributes \u003d new Hashtable();\nattributes.put(IFileSystemSMLProperties.ROOT_DIRECTORY, \"org.eclipse.cosmos.rm.example.datacenter\");\nattributes.put(IFileSystemSMLProperties.ROOT_CONTEXT_NODE, \"machine, os.windows, tomcat\");\nrepository.connect(attributes);\t\t\t\t\n\nISMLOperation operation \u003d repository.getOperation(ICMDBfQueryOperation.ID);\nURL url \u003d NavigatorOutputter.class.getClassLoader().getResource(\"org/eclipse/cosmos/dr/drs/service/internal/query/sml/Navigator.query\").toURI().toURL();\n\t\t\noperation.addArgument(url.openStream());\noperation.run();\nInputStream cdmfResult\u003d (InputStream)operation.getOutput();\nQueryResult qr \u003d QueryOutputTransformer.transform(cdmfResult);\n\n\nAfter executing this code I get the following exception:\n\norg.eclipse.cosmos.dc.cmdbf.query.transform.QueryTransformerException: org.xml.sax.SAXParseException: cvc-complex-type.2.4.b: The content of element \u0027item\u0027 is not complete. One of \u0027{\"http://schemas.cmdbf.org/0-9-5/datamodel\":record, \"http://schemas.cmdbf.org/0-9-5/datamodel\":instanceId}\u0027 is expected.\n\tat org.eclipse.cosmos.dc.cmdbf.query.transform.QueryOutputTransformer.transform(QueryOutputTransformer.java:54)\n\tat org.eclipse.cosmos.dr.drs.service.handler.sml.NavigatorOutputter.renderCMDBfOutput(NavigatorOutputter.java:66)\n\tat org.eclipse.cosmos.dr.drs.service.handler.sml.NavigatorOutputter.printModel(NavigatorOutputter.java:139)\n\tat org.eclipse.cosmos.dr.drs.service.handler.sml.JSONSMLOutputterTest.navigator(JSONSMLOutputterTest.java:89)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat junit.framework.TestCase.runTest(TestCase.java:164)\n\tat junit.framework.TestCase.runBare(TestCase.java:130)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:120)\n\tat org.eclipse.hyades.test.common.junit.HyadesTestCase.run(HyadesTestCase.java:172)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:230)\n\tat org.eclipse.hyades.test.common.junit.HyadesTestSuite.runTest(HyadesTestSuite.java:452)\n\tat junit.framework.TestSuite.run(TestSuite.java:225)\n\tat org.eclipse.hyades.test.common.junit.HyadesTestSuite.doRun(HyadesTestSuite.java:420)\n\tat org.eclipse.hyades.test.common.junit.HyadesTestSuite.run(HyadesTestSuite.java:333)\n\tat org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)\nCaused by: org.xml.sax.SAXParseException: cvc-complex-type.2.4.b: The content of element \u0027item\u0027 is not complete. One of \u0027{\"http://schemas.cmdbf.org/0-9-5/datamodel\":record, \"http://schemas.cmdbf.org/0-9-5/datamodel\":instanceId}\u0027 is expected.\n\tat com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator$XSIErrorReporter.reportError(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.reportSchemaError(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidComplexType(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidType(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.processElementContent(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.handleEndElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.endElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat javax.xml.parsers.SAXParser.parse(Unknown Source)\n\tat javax.xml.parsers.SAXParser.parse(Unknown Source)\n\tat org.eclipse.cosmos.dc.cmdbf.query.transform.QueryOutputTransformer.transform(QueryOutputTransformer.java:52)\n\t... 25 more",
    "Created an attachment (id\u003d79512)\ngraph response that is produced from the cmdbf query\n\n",
    "Created an attachment (id\u003d79513)\ncmdbf query that was used.\n\n",
    "For whatever reason, the queryResult being returned does not contain the required instanceId elements inside an item element.  I need to investigate whether this is happening in the transformer, or if the POJO structure isn\u0027t being constructed correctly by the CMDBf query operation.",
    "In org.eclipse.cosmos.rm.repository.internal.resource.SMLFileInstanceDocument.toItem(IGraphElementCollection) we are not calling item.addInstanceId().  All \u003citem\u003e elements must have an \u003cinstanceId\u003e, which uniquely identifies the item and the MDR that contains it.  This instanceId is used also in relationships to identify the source and target items.",
    "I added the following lines right before the end of the method, and that makes the CMDBf data model schema happy:\n\n\t\t\tInstanceId instanceId \u003d new InstanceId(ISMLRepositoryConstants.SML_MDR_ID, getMetadata().getId());\n\t\t\titem.addInstanceId(instanceId);\n\nDoes that look right to you, Ali?\n\nHowever, I am now getting another error:\n\nCaused by: org.xml.sax.SAXParseException: s4s-elt-character: Non-whitespace characters are not allowed in schema elements other than \u0027xs:appinfo\u0027 and \u0027xs:documentation\u0027. Saw \u0027window.location \u003d \"main?AddInType\u003dBdns\u0027.\n\tat org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)\n\tat org.apache.xerces.util.ErrorHandlerWrapper.error(Unknown Source)\n\tat org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\n\nStill investigating...",
    "Created an attachment (id\u003d79755)\npatch to address exception\n\nSheldon, please apply this patch and let me know if this fixes the problem for you.",
    "Fix in CVS-HEAD.  Sheldon, please verify.",
    "Assuming this is fixed as needed..."
  ],
  "commentCreationDates": [
    "2007-10-01T21:59:42+02:00",
    "2007-10-01T22:04:31+02:00",
    "2007-10-01T22:05:13+02:00",
    "2007-10-03T21:02:31+02:00",
    "2007-10-03T23:27:11+02:00",
    "2007-10-03T23:36:54+02:00",
    "2007-10-04T19:35:29+02:00",
    "2007-10-04T20:38:06+02:00",
    "2007-11-21T18:47:19+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.xml.sax.SAXParseException",
      "message": "cvc-complex-type.2.4.b: The content of element \u0027item\u0027 is not complete. One of \u0027{\"http://schemas.cmdbf.org/0-9-5/datamodel\":record, \"http://schemas.cmdbf.org/0-9-5/datamodel\":instanceId}\u0027 is expected.",
      "elements": [
        {
          "method": "org.eclipse.cosmos.dc.cmdbf.query.transform.QueryOutputTransformer.transform",
          "source": "QueryOutputTransformer.java:54"
        },
        {
          "method": "org.eclipse.cosmos.dr.drs.service.handler.sml.NavigatorOutputter.renderCMDBfOutput",
          "source": "NavigatorOutputter.java:66"
        },
        {
          "method": "org.eclipse.cosmos.dr.drs.service.handler.sml.NavigatorOutputter.printModel",
          "source": "NavigatorOutputter.java:139"
        },
        {
          "method": "org.eclipse.cosmos.dr.drs.service.handler.sml.JSONSMLOutputterTest.navigator",
          "source": "JSONSMLOutputterTest.java:89"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "junit.framework.TestCase.runTest",
          "source": "TestCase.java:164"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:130"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:106"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:109"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:120"
        },
        {
          "method": "org.eclipse.hyades.test.common.junit.HyadesTestCase.run",
          "source": "HyadesTestCase.java:172"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:230"
        },
        {
          "method": "org.eclipse.hyades.test.common.junit.HyadesTestSuite.runTest",
          "source": "HyadesTestSuite.java:452"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:225"
        },
        {
          "method": "org.eclipse.hyades.test.common.junit.HyadesTestSuite.doRun",
          "source": "HyadesTestSuite.java:420"
        },
        {
          "method": "org.eclipse.hyades.test.common.junit.HyadesTestSuite.run",
          "source": "HyadesTestSuite.java:333"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run",
          "source": "JUnit3TestReference.java:130"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.TestExecution.run",
          "source": "TestExecution.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:460"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:673"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:386"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main",
          "source": "RemoteTestRunner.java:196"
        }
      ],
      "causedBy": {
        "exceptionType": "org.xml.sax.SAXParseException",
        "message": "cvc-complex-type.2.4.b: The content of element \u0027item\u0027 is not complete. One of \u0027{\"http://schemas.cmdbf.org/0-9-5/datamodel\":record, \"http://schemas.cmdbf.org/0-9-5/datamodel\":instanceId}\u0027 is expected.",
        "elements": [
          {
            "method": "com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator$XSIErrorReporter.reportError",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.reportSchemaError",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidComplexType",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.elementLocallyValidType",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.processElementContent",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.handleEndElement",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaValidator.endElement",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.parsers.XMLParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "javax.xml.parsers.SAXParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "javax.xml.parsers.SAXParser.parse",
            "source": "Unknown Source"
          },
          {
            "method": "org.eclipse.cosmos.dc.cmdbf.query.transform.QueryOutputTransformer.transform",
            "source": "QueryOutputTransformer.java:52"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 0,
      "bugId": "205119",
      "date": "2007-10-01T21:59:42+02:00",
      "product": "Cosmos",
      "component": "ResourceModeling",
      "severity": "critical"
    },
    {
      "exceptionType": "org.xml.sax.SAXParseException",
      "message": "s4s-elt-character: Non-whitespace characters are not allowed in schema elements other than \u0027xs:appinfo\u0027 and \u0027xs:documentation\u0027. Saw \u0027window.location \u003d \"main?AddInType\u003dBdns\u0027.",
      "elements": [
        {
          "method": "org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.util.ErrorHandlerWrapper.error",
          "source": "Unknown Source"
        },
        {
          "method": "org.apache.xerces.impl.XMLErrorReporter.reportError",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 5,
      "bugId": "205119",
      "date": "2007-10-03T23:36:54+02:00",
      "product": "Cosmos",
      "component": "ResourceModeling",
      "severity": "critical"
    }
  ],
  "groupId": "205119",
  "bugId": "205119",
  "date": "2007-10-01T21:59:42+02:00",
  "product": "Cosmos",
  "component": "ResourceModeling",
  "severity": "critical"
}