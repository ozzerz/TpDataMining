{
  "comments": [
    "Build ID: org.eclipse.wst.common.emfworkbench.integration_1.1.2.v200610182223\n\nSteps To Reproduce:\n1. Declare an edit model using the org.eclipse.wst.common.emfworkbench.integration.editModel extension point.  Insert some resourceExtension elements in this declaration.  For example : \n \u003cresourceExtension \n   name\u003d\"component\"/\u003e\n \u003cresourceExtension\n   name\u003d\"import\"/\u003e\n \u003cresourceExtension\n   name\u003d\"export\"/\u003e\n2. Obtain an instance of the EditModel by calling :\nEMFWorkbenchContext context \u003d (EMFWorkbenchContext) WorkbenchResourceHelper.createEMFContext(project,null);\nEditModel editModel\u003d null;\neditModel\u003d(EditModel)context.getEditModelForWrite(EDIT_MODEL_ID,accessorInstance);\n3. NPE with the following stack trace is thrown :\njava.lang.NullPointerException\n\tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.initializeKnownResourceUris(EditModel.java:512)\n\tat com.ibm.wbit.sca.model.manager.SCAEditModel.initializeKnownResourceUris(SCAEditModel.java:725)\n\tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.\u003cinit\u003e(EditModel.java:130)\n\tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.\u003cinit\u003e(EditModel.java:136)\n\tat org.eclipse.wst.common.componentcore.internal.ArtifactEditModel.\u003cinit\u003e(ArtifactEditModel.java:133)\n\tat org.eclipse.wst.common.componentcore.internal.ArtifactEditModel.\u003cinit\u003e(ArtifactEditModel.java:102)\n\tat org.eclipse.jst.common.jdt.internal.integration.JavaArtifactEditModel.\u003cinit\u003e(JavaArtifactEditModel.java:54)\n\tat com.ibm.wbit.sca.model.manager.SCAEditModel.\u003cinit\u003e(SCAEditModel.java:718)\n\tat com.ibm.wbit.sca.model.manager.ui.SCAEditModel.\u003cinit\u003e(SCAEditModel.java:101)\n\tat com.ibm.wbit.sca.model.manager.ui.util.SCAEditModelFactory.createEditModelForWrite(SCAEditModelFactory.java:45)\n\tat org.eclipse.wst.common.internal.emfworkbench.edit.EditModelRegistry.createEditModelForWrite(EditModelRegistry.java:106)\n\tat org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.createEditModelForWrite(EMFWorkbenchContext.java:205)\n\tat org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelForWrite(EMFWorkbenchContext.java:102)\n\tat org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelForWrite(EMFWorkbenchContext.java:162)\n\tat com.ibm.wbit.sca.model.manager.util.internal.SCAEditModelUtils.getSCAEditModelInstance(SCAEditModelUtils.java:515)\n\tat com.ibm.wbit.sca.model.manager.util.internal.SCAEditModelUtils.getSCAEditModelInstance(SCAEditModelUtils.java:488)\n\tat com.ibm.wbit.sca.model.manager.SCAEditModel.getSCAEditModelForWrite(SCAEditModel.java:591)\n\tat com.ibm.wbit.sca.model.manager.junit.test.scamm.SCAModelManagerTest.testInstantiate(SCAModelManagerTest.java:57)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:615)\n\tat junit.framework.TestCase.runTest(TestCase.java:164)\n\tat junit.framework.TestCase.runBare(TestCase.java:130)\n\tat junit.framework.TestResult$1.protect(TestResult.java:110)\n\tat junit.framework.TestResult.runProtected(TestResult.java:128)\n\tat junit.framework.TestResult.run(TestResult.java:113)\n\tat junit.framework.TestCase.run(TestCase.java:120)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:228)\n\tat junit.framework.TestSuite.run(TestSuite.java:223)\n\tat org.junit.internal.runners.OldTestClassRunner.run(OldTestClassRunner.java:35)\n\tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n\tat org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run(UITestApplication.java:105)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3325)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication.run(UITestApplication.java:45)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:615)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\n\tat org.eclipse.core.launcher.Main.run(Main.java:977)\n\tat org.eclipse.core.launcher.Main.main(Main.java:952)\n\n\n\n\nMore information:\nThe culprit of the above problem is in EditModel.initializeKnownResourceUris() :\n\nCollection resourceExtensions \u003d EditModelRegistry.getInstance().getEditModelExtensions(getEditModelID());\nif (resourceExtensions.isEmpty()) {\n\tknownResourceExtensions \u003d Collections.EMPTY_LIST;\n} else {\n\tknownResourceExtensions.addAll(resourceExtensions);\n\nNotice that knownResourceExtensions is never initialized and thus is null at this point.  As such, a NPE will be thrown if resourceExtensions is not empty.\n\nIn addition, the following section of EditModel.initializeKnownResourceUris() also causes problems  :\nIterator it \u003d resourceExtensions.iterator();\nResourceSetWorkbenchEditSynchronizer sync \u003d (ResourceSetWorkbenchEditSynchronizer)getEmfContext().getResourceSet().getSynchronizer();\nwhile (it.hasNext()) {\n\tString extension \u003d (String) iter.next();\n\tsync.enableAutoload(extension);\n}\n\nI believe iter.next() should be it.next() instead.  This causes a NoSuchElementException to be thrown while iterating through the list of resourceExtensions",
    "Ned to investigate for 1.5.3",
    "Carl can you take a look?  ",
    "Good catch.\nI don\u0027t see how this code could have ever worked before if there are known extensions (unless a super initialized that List... but that is a bad practice to expect).\nThis is also important since the only workaround is to override the entire method and do what is necessary (and avoid calling the super.initializeKnownResourceUris() since it will throw exceptions).",
    "Created an attachment (id\u003d57741)\ninitialize knownResourceExtensions if necessary, and change reference from iter to it\n\nThe reference to Iterator iter must be changed to reference Iterator it (since iter has already iterated through its elements, and they are of the wrong type).\nI also chose to switch an empty knownResourceExtensions to an ArrayList instead of Collections.EMPTY_LIST, so that other code could possibly add known extensions to it (without having to check to see if it is modifiable first).",
    "approved - fix looks good.\n\nCarl can you describe the testing you have done?  The PMC will want to ensure this is well tested.",
    "I ran through scenarios (both with WTP alone and with an IBM product that contributes EditModels), and mocked up an edit model extension that had the resourceExtensions from comment #1.",
    "+1 (on behalf of Arthur)",
    "checked into both 1.5.3 and 2.0 streams; please mark as resolved fixed.",
    "Dropped to 153 build",
    "+1 looks good, and looks to have adequate testing. \n",
    "Closing verified defects."
  ],
  "commentCreationDates": [
    "2007-01-18T19:29:22+01:00",
    "2007-01-22T18:54:21+01:00",
    "2007-01-24T15:35:45+01:00",
    "2007-01-29T21:58:04+01:00",
    "2007-01-29T22:02:17+01:00",
    "2007-01-30T15:00:46+01:00",
    "2007-01-30T17:19:17+01:00",
    "2007-01-31T17:20:34+01:00",
    "2007-01-31T21:51:13+01:00",
    "2007-01-31T22:03:05+01:00",
    "2007-01-31T22:04:34+01:00",
    "2007-02-08T21:24:36+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.initializeKnownResourceUris",
          "source": "EditModel.java:512"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.SCAEditModel.initializeKnownResourceUris",
          "source": "SCAEditModel.java:725"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.\u003cinit\u003e",
          "source": "EditModel.java:130"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.\u003cinit\u003e",
          "source": "EditModel.java:136"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ArtifactEditModel.\u003cinit\u003e",
          "source": "ArtifactEditModel.java:133"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ArtifactEditModel.\u003cinit\u003e",
          "source": "ArtifactEditModel.java:102"
        },
        {
          "method": "org.eclipse.jst.common.jdt.internal.integration.JavaArtifactEditModel.\u003cinit\u003e",
          "source": "JavaArtifactEditModel.java:54"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.SCAEditModel.\u003cinit\u003e",
          "source": "SCAEditModel.java:718"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.ui.SCAEditModel.\u003cinit\u003e",
          "source": "SCAEditModel.java:101"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.ui.util.SCAEditModelFactory.createEditModelForWrite",
          "source": "SCAEditModelFactory.java:45"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.edit.EditModelRegistry.createEditModelForWrite",
          "source": "EditModelRegistry.java:106"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.createEditModelForWrite",
          "source": "EMFWorkbenchContext.java:205"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelForWrite",
          "source": "EMFWorkbenchContext.java:102"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelForWrite",
          "source": "EMFWorkbenchContext.java:162"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.util.internal.SCAEditModelUtils.getSCAEditModelInstance",
          "source": "SCAEditModelUtils.java:515"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.util.internal.SCAEditModelUtils.getSCAEditModelInstance",
          "source": "SCAEditModelUtils.java:488"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.SCAEditModel.getSCAEditModelForWrite",
          "source": "SCAEditModel.java:591"
        },
        {
          "method": "com.ibm.wbit.sca.model.manager.junit.test.scamm.SCAModelManagerTest.testInstantiate",
          "source": "SCAModelManagerTest.java:57"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "junit.framework.TestCase.runTest",
          "source": "TestCase.java:164"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:130"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:110"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:128"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:113"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:120"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:228"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:223"
        },
        {
          "method": "org.junit.internal.runners.OldTestClassRunner.run",
          "source": "OldTestClassRunner.java:35"
        },
        {
          "method": "org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run",
          "source": "JUnit4TestReference.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.TestExecution.run",
          "source": "TestExecution.java:38"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:460"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:673"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:386"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main",
          "source": "RemotePluginTestRunner.java:58"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run",
          "source": "UITestApplication.java:105"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3325"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2971"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1914"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1878"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:419"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication.run",
          "source": "UITestApplication.java:45"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:400"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:177"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "170960",
      "date": "2007-01-18T19:29:22+01:00",
      "product": "Web Tools",
      "component": "wst.common",
      "severity": "normal"
    }
  ],
  "groupId": "170960",
  "bugId": "170960",
  "date": "2007-01-18T19:29:22+01:00",
  "product": "Web Tools",
  "component": "wst.common",
  "severity": "normal"
}