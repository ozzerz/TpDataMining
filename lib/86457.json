{
  "comments": [
    "I tried to save JPEG with ImageData 24 bit depth, height 240 pixels, width 1\npixel and it thrown this exception:\norg.eclipse.swt.SWTException: i/o error\n(java.lang.ArrayIndexOutOfBoundsException: -1)\n        at org.eclipse.swt.SWT.error(SWT.java:2691)\n        at org.eclipse.swt.SWT.error(SWT.java:2616)\n        at\norg.eclipse.swt.internal.image.FileFormat.unloadIntoStream(FileFormat.java:111)\n        at org.eclipse.swt.internal.image.FileFormat.save(FileFormat.java:99)\n        at org.eclipse.swt.graphics.ImageLoader.save(ImageLoader.java:194)",
    "Can you please attach the image to this bug report? Thanks!",
    "It is not dependent on particular image, so I\u0027ve created test snippet instead.\nAnd I\u0027ve found that on Windows it doesn\u0027t work too.\n\nimport java.io.*;\n\nimport org.eclipse.swt.*;\nimport org.eclipse.swt.events.*;\nimport org.eclipse.swt.graphics.*;\nimport org.eclipse.swt.layout.*;\nimport org.eclipse.swt.widgets.*;\n\n\npublic class Main {\n    public static void main(String[] args) {\n        final Shell shell \u003d new Shell(SWT.SHELL_TRIM);\n        shell.setLayout(new GridLayout(5, true));\n\n        new Label(shell, SWT.NONE).setText(\"Width\");\n\n        final Text width \u003d new Text(shell, SWT.BORDER);\n        width.setText(\"1\");\n        width.setLayoutData(new GridData(GridData.HORIZONTAL_ALIGN_FILL));\n        new Label(shell, SWT.NONE).setText(\"Height\");\n\n        final Text height \u003d new Text(shell, SWT.BORDER);\n        height.setText(\"240\");\n        height.setLayoutData(new GridData(GridData.HORIZONTAL_ALIGN_FILL));\n\n        Button b \u003d new Button(shell, SWT.NONE);\n        b.setText(\"Test\");\n\n        shell.setDefaultButton(b);\n\n        final Display d \u003d shell.getDisplay();\n        b.addSelectionListener(new SelectionAdapter() {\n            public void widgetSelected(SelectionEvent e) {\n                int w;\n                int h;\n\n                try {\n                    w \u003d Integer.parseInt(width.getText().trim());\n                    h \u003d Integer.parseInt(height.getText().trim());\n                } catch (NumberFormatException exc) {\n                    exc.printStackTrace();\n                    e.doit \u003d false;\n\n                    return;\n                }\n\n                Image i \u003d new Image(d, w, h);\n                i.setBackground(d.getSystemColor(SWT.COLOR_RED));\n\n                ImageLoader il \u003d new ImageLoader();\n                il.data \u003d new ImageData[] {i.getImageData()};\n\n                try {\n                    il.save(new ByteArrayOutputStream(), SWT.IMAGE_JPEG);\n                } catch (Exception exc) {\n                    exc.printStackTrace();\n\n                    MessageBox mb \u003d new MessageBox(shell, SWT.ICON_ERROR);\n                    mb.setMessage(\"error\");\n                    mb.open();\n                }\n            }\n        });\n\n        shell.pack(true);\n        shell.open();\n\n        while (!shell.isDisposed()) {\n            if (!d.readAndDispatch()) {\n                d.sleep();\n            }\n        }\n    }\n}"
  ],
  "commentCreationDates": [
    "2005-02-24T12:11:29+01:00",
    "2005-02-28T01:15:48+01:00",
    "2005-02-28T08:09:13+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "-1)",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2691"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2616"
        },
        {
          "method": "org.eclipse.swt.internal.image.FileFormat.unloadIntoStream",
          "source": "FileFormat.java:111"
        },
        {
          "method": "org.eclipse.swt.internal.image.FileFormat.save",
          "source": "FileFormat.java:99"
        },
        {
          "method": "org.eclipse.swt.graphics.ImageLoader.save",
          "source": "ImageLoader.java:194"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "86457",
      "date": "2005-02-24T12:11:29+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "86457",
  "bugId": "86457",
  "date": "2005-02-24T12:11:29+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}