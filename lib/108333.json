{
  "comments": [
    "see Bug 108325 for good reproducible case for getting text typing to get \nreal hosed up. The immeidate problem in bug 108325 can be fixed by fixing the \nparse error (or catching all parse exceptions at a lower level, which should be \ndone anyway). But ... its a good test case to reproduce the \"back wards typing\"\nthat is sometimes reported. \n\nI think the fundamental problem is in the (lack of) concurrancy control in\nStructuredTextToDocumentAdapter ... but, not easy to trace down and that whole\nclass should be fixed/replaced someday. So ... for now, am just documenting that\nto reproduce, load R0_7 version and try the case in bug 108325 ... \n- create a new Dynamic web project and call is \"testweb\"\n- create a new file in the WebContent directory and call it \"test.jsp\"\n- open the file and paste (ctrl+v) the following:\n\u003cjsp:root version\u003d\"2.0\" xmlns:jsp\u003d\"http://java.sun.com/JSP/Page\"\nxmlns:ou\u003d\"urn:jsptagdir:/WEB-INF/tags/test\"\u003e",
    "just a comment: after the fix for bug 108325 backwards typing now doesn\u0027t show\nup frequently (I had jsp tag dirs declared in any jsp, so that was probably the\nmain cause), but it still happens now and then.\nThis time I wasn\u0027t able to find any recurring or reproducible pattern, but the\nerror is still there...\n",
    "Another hint:\nI get the backward typing again in WTP M8 while trying to format a jsp page.\nThis time it seems related to the parsing of a tld, but unfortunately it\u0027s not\nso easy to reproduce (formatting again the same page doesn\u0027t lead to the same\nerror anymore).\n\nAnyway, this is the log containing the root NPE which can mess up the editor:\n\n\n\n!ENTRY org.eclipse.wst.sse.core 4 4 2005-09-25 11:11:03.037\n!MESSAGE Program Error: invalid structured document event\n\n!ENTRY org.eclipse.ui 4 4 2005-09-25 11:11:03.037\n!MESSAGE Unhandled event loop exception\n\n!ENTRY org.eclipse.ui 4 0 2005-09-25 11:11:03.037\n!MESSAGE java.lang.NullPointerException\n!STACK 0\njava.lang.RuntimeException: java.lang.NullPointerException\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText(JobSafeStructuredDocument.java:118)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText(BasicStructuredDocument.java:2299)\n\tat\norg.eclipse.wst.sse.ui.internal.StructuredDocumentToTextAdapter.replaceTextRange(StructuredDocumentToTextAdapter.java:1187)\n\tat org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:5773)\n\tat org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:6591)\n\tat org.eclipse.swt.custom.StyledText.doBackspace(StyledText.java:2516)\n\tat org.eclipse.swt.custom.StyledText.invokeAction(StyledText.java:5654)\n\tat org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5091)\n\tat org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:5113)\n\tat org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4849)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:884)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:908)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:893)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:921)\n\tat org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:917)\n\tat org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1231)\n\tat org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:3157)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3058)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:3830)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1679)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2821)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1755)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1719)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:368)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:377)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:164)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\n\tat org.eclipse.core.launcher.Main.run(Main.java:977)\n\tat org.eclipse.core.launcher.Main.main(Main.java:952)\nCaused by: java.lang.NullPointerException\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.getContainedText(CMDocumentFactoryTLD.java:491)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.createElementDeclaration(CMDocumentFactoryTLD.java:320)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.loadDocument(CMDocumentFactoryTLD.java:527)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.buildCMDocumentFromFile(CMDocumentFactoryTLD.java:109)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.createCMDocument(CMDocumentFactoryTLD.java:614)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.loadTaglib(TLDCMDocumentManager.java:988)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.getCMDocument(TLDCMDocumentManager.java:755)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.enableTaglibFromURI(TLDCMDocumentManager.java:114)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot(TLDCMDocumentManager.java:334)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot(TLDCMDocumentManager.java:305)\n\tat\norg.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.nodeParsed(TLDCMDocumentManager.java:211)\n\tat\norg.eclipse.wst.xml.core.internal.parser.XMLSourceParser.fireNodeParsed(XMLSourceParser.java:117)\n\tat\norg.eclipse.jst.jsp.core.internal.parser.JSPSourceParser.parseNodes(JSPSourceParser.java:300)\n\tat\norg.eclipse.wst.xml.core.internal.parser.XMLSourceParser.getDocumentRegions(XMLSourceParser.java:149)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser._core_reparse_text(StructuredDocumentReParser.java:309)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.core_reparse(StructuredDocumentReParser.java:708)\n\tat\norg.eclipse.jst.jsp.core.internal.parser.JSPReParser.reparse(JSPReParser.java:144)\n\tat\norg.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.reparse(StructuredDocumentReParser.java:1284)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.updateModel(BasicStructuredDocument.java:2609)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.internalReplaceText(BasicStructuredDocument.java:1834)\n\tat\norg.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText(BasicStructuredDocument.java:2303)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.access$0(JobSafeStructuredDocument.java:1)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument$1.run(JobSafeStructuredDocument.java:100)\n\tat\norg.eclipse.wst.sse.ui.internal.editor.EditorExecutionContext.execute(EditorExecutionContext.java:43)\n\tat\norg.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText(JobSafeStructuredDocument.java:110)\n\t... 38 more",
    "Ok, I think I\u0027ve found why 108325 was \"improved but not fixed\". And complete fix should be in RC1, on 11/30. \n\n\n\n\n*** This bug has been marked as a duplicate of 108325 ***",
    "Confirming fixed. ",
    "This is part of a mass update to close out all stale WTP defects already verified by the reporter but awaiting closure by the assignee.  If you feel this defect was closed inappropriately, please reopen.\n\nThanks, John Lanuti"
  ],
  "commentCreationDates": [
    "2005-08-30T06:49:42+02:00",
    "2005-09-16T19:11:10+02:00",
    "2005-09-25T11:20:47+02:00",
    "2005-11-30T03:42:43+01:00",
    "2005-12-18T20:14:56+01:00",
    "2006-11-28T20:37:41+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText",
          "source": "JobSafeStructuredDocument.java:118"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText",
          "source": "BasicStructuredDocument.java:2299"
        },
        {
          "method": "org.eclipse.wst.sse.ui.internal.StructuredDocumentToTextAdapter.replaceTextRange",
          "source": "StructuredDocumentToTextAdapter.java:1187"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.modifyContent",
          "source": "StyledText.java:5773"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.sendKeyEvent",
          "source": "StyledText.java:6591"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.doBackspace",
          "source": "StyledText.java:2516"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.invokeAction",
          "source": "StyledText.java:5654"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKey",
          "source": "StyledText.java:5091"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleKeyDown",
          "source": "StyledText.java:5113"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$7.handleEvent",
          "source": "StyledText.java:4849"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:884"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:908"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:893"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:921"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendKeyEvent",
          "source": "Widget.java:917"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.wmChar",
          "source": "Widget.java:1231"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_CHAR",
          "source": "Control.java:3157"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3058"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:3830"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:1679"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2821"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1755"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1719"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:368"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:377"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:164"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "causedBy": {
        "exceptionType": "java.lang.NullPointerException",
        "elements": [
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.getContainedText",
            "source": "CMDocumentFactoryTLD.java:491"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.createElementDeclaration",
            "source": "CMDocumentFactoryTLD.java:320"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.loadDocument",
            "source": "CMDocumentFactoryTLD.java:527"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.buildCMDocumentFromFile",
            "source": "CMDocumentFactoryTLD.java:109"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.CMDocumentFactoryTLD.createCMDocument",
            "source": "CMDocumentFactoryTLD.java:614"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.loadTaglib",
            "source": "TLDCMDocumentManager.java:988"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager.getCMDocument",
            "source": "TLDCMDocumentManager.java:755"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.enableTaglibFromURI",
            "source": "TLDCMDocumentManager.java:114"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot",
            "source": "TLDCMDocumentManager.java:334"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.processJSPRoot",
            "source": "TLDCMDocumentManager.java:305"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.contentmodel.tld.TLDCMDocumentManager$DirectiveStructuredDocumentRegionHandler.nodeParsed",
            "source": "TLDCMDocumentManager.java:211"
          },
          {
            "method": "org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.fireNodeParsed",
            "source": "XMLSourceParser.java:117"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.parser.JSPSourceParser.parseNodes",
            "source": "JSPSourceParser.java:300"
          },
          {
            "method": "org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.getDocumentRegions",
            "source": "XMLSourceParser.java:149"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser._core_reparse_text",
            "source": "StructuredDocumentReParser.java:309"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.core_reparse",
            "source": "StructuredDocumentReParser.java:708"
          },
          {
            "method": "org.eclipse.jst.jsp.core.internal.parser.JSPReParser.reparse",
            "source": "JSPReParser.java:144"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.StructuredDocumentReParser.reparse",
            "source": "StructuredDocumentReParser.java:1284"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.updateModel",
            "source": "BasicStructuredDocument.java:2609"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.internalReplaceText",
            "source": "BasicStructuredDocument.java:1834"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.BasicStructuredDocument.replaceText",
            "source": "BasicStructuredDocument.java:2303"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.access$0",
            "source": "JobSafeStructuredDocument.java:1"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument$1.run",
            "source": "JobSafeStructuredDocument.java:100"
          },
          {
            "method": "org.eclipse.wst.sse.ui.internal.editor.EditorExecutionContext.execute",
            "source": "EditorExecutionContext.java:43"
          },
          {
            "method": "org.eclipse.wst.sse.core.internal.text.JobSafeStructuredDocument.replaceText",
            "source": "JobSafeStructuredDocument.java:110"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 2,
      "bugId": "108333",
      "duplicateId": "108325",
      "date": "2005-09-25T11:20:47+02:00",
      "product": "Web Tools",
      "component": "jst.jsp",
      "severity": "normal"
    }
  ],
  "groupId": "108325",
  "bugId": "108333",
  "duplicateId": "108325",
  "date": "2005-08-30T06:49:42+02:00",
  "product": "Web Tools",
  "component": "jst.jsp",
  "severity": "normal"
}