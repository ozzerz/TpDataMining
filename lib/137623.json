{
  "comments": [
    "Version: 3.2.0\nBuild id: I20060413-1718\n\nWhile trying to activate content assist, i got the attached exception.  Try activating code assist after \"int.\" in the following sample:\n\npublic class Test {\n\n\tpublic boolean foo() {\n\t\tboolean retValue;\n\t\tClass fieldClass \u003d null;\n\t\tObject value \u003d null;\n\n\t\tif(fieldClass.isPrimitive())\n\t\t{\n\t\t\tif(((fieldClass\u003d\u003dint.) \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Integer\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"char\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Character\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"short\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Short\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"boolean\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Boolean\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"byte\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Byte\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"long\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Long\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"double\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Double\")) \n\t\t\t\t\t|| ((fieldClass.getName()\u003d\u003d\"float\") \u0026\u0026 (value.getClass().getName() \u003d\u003d \"java.lang.Float\")) \n\t\t\t)\n\t\t\t{\n\t\t\t\tretValue\u003dtrue;\n\t\t\t}\n\n\t\t}\n\t\treturn retValue;\n\t}\n}\n\n\njava.lang.NegativeArraySizeException\nat org.eclipse.jdt.internal.compiler.parser.Parser.getUnspecifiedReferenceOptimized(Parser.java:8306)\nat org.eclipse.jdt.internal.codeassist.impl.AssistParser.getUnspecifiedReferenceOptimized(AssistParser.java:961)\nat org.eclipse.jdt.internal.codeassist.complete.CompletionParser.getUnspecifiedReferenceOptimized(CompletionParser.java:3422)\nat org.eclipse.jdt.internal.codeassist.complete.CompletionParser.buildMoreCompletionContext(CompletionParser.java:663)\nat org.eclipse.jdt.internal.codeassist.complete.CompletionParser.attachOrphanCompletionNode(CompletionParser.java:424)\nat org.eclipse.jdt.internal.codeassist.complete.CompletionParser.updateRecoveryState(CompletionParser.java:3772)\nat org.eclipse.jdt.internal.compiler.parser.Parser.resumeOnSyntaxError(Parser.java:9915)\nat org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:8784)\nat org.eclipse.jdt.internal.codeassist.impl.AssistParser.parseBlockStatements(AssistParser.java:1313)\nat org.eclipse.jdt.internal.codeassist.impl.AssistParser.parseBlockStatements(AssistParser.java:1166)\nat org.eclipse.jdt.internal.codeassist.impl.Engine.parseBlockStatements(Engine.java:292)\nat org.eclipse.jdt.internal.codeassist.impl.Engine.parseBlockStatements(Engine.java:255)\nat org.eclipse.jdt.internal.codeassist.CompletionEngine.complete(CompletionEngine.java:1747)\nat org.eclipse.jdt.internal.core.Openable.codeComplete(Openable.java:123)\nat org.eclipse.jdt.internal.core.CompilationUnit.codeComplete(CompilationUnit.java:313)\nat org.eclipse.jdt.internal.core.CompilationUnit.codeComplete(CompilationUnit.java:306)\nat org.eclipse.jdt.internal.ui.text.java.JavaCompletionProposalComputer.internalComputeCompletionProposals(JavaCompletionProposalComputer.java:213)\nat org.eclipse.jdt.internal.ui.text.java.JavaCompletionProposalComputer.computeCompletionProposals(JavaCompletionProposalComputer.java:193)\nat org.eclipse.jdt.internal.ui.text.java.JavaTypeCompletionProposalComputer.computeCompletionProposals(JavaTypeCompletionProposalComputer.java:73)\nat org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.computeCompletionProposals(CompletionProposalComputerDescriptor.java:285)\nat org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.computeCompletionProposals(CompletionProposalCategory.java:252)\nat org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor.collectProposals(ContentAssistProcessor.java:212)\nat org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor.computeCompletionProposals(ContentAssistProcessor.java:181)\nat org.eclipse.jface.text.contentassist.ContentAssistant.computeCompletionProposals(ContentAssistant.java:1577)\nat org.eclipse.jface.text.contentassist.CompletionProposalPopup.computeProposals(CompletionProposalPopup.java:448)\nat org.eclipse.jface.text.contentassist.CompletionProposalPopup.access$15(CompletionProposalPopup.java:445)\nat org.eclipse.jface.text.contentassist.CompletionProposalPopup$2.run(CompletionProposalPopup.java:380)\nat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\nat org.eclipse.jface.text.contentassist.CompletionProposalPopup.showProposals(CompletionProposalPopup.java:374)\nat org.eclipse.jface.text.contentassist.ContentAssistant$2.run(ContentAssistant.java:346)\nat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\nat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\nat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3323)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2969)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Smaller test case:\n\npublic class Test {\n        public boolean foo() {\n                if(this.equals(null))\n                {\n                        (zzz\u003d\u003dint.\n                }\n        }\n}\n   ",
    "Created an attachment (id\u003d39149)\nProposed fix\n\n",
    "Philippe - Do you want this fix for 3.2RC2 ?\n\nA negative value is in the identifierLengthStack stack. This negative value mean a base type. CompletionParser try to use this value as an array index.",
    "+1 for 3.2RC2",
    "Fix released and test added\n  CompletionParserTest2#test0166()",
    "Verified with I20060427-1600 for 3.2RC2"
  ],
  "commentCreationDates": [
    "2006-04-20T00:57:43+02:00",
    "2006-04-20T14:09:32+02:00",
    "2006-04-21T10:42:04+02:00",
    "2006-04-21T10:47:24+02:00",
    "2006-04-21T14:45:32+02:00",
    "2006-04-21T14:59:52+02:00",
    "2006-04-28T20:58:41+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NegativeArraySizeException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.getUnspecifiedReferenceOptimized",
          "source": "Parser.java:8306"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.impl.AssistParser.getUnspecifiedReferenceOptimized",
          "source": "AssistParser.java:961"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.complete.CompletionParser.getUnspecifiedReferenceOptimized",
          "source": "CompletionParser.java:3422"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.complete.CompletionParser.buildMoreCompletionContext",
          "source": "CompletionParser.java:663"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.complete.CompletionParser.attachOrphanCompletionNode",
          "source": "CompletionParser.java:424"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.complete.CompletionParser.updateRecoveryState",
          "source": "CompletionParser.java:3772"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.resumeOnSyntaxError",
          "source": "Parser.java:9915"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.parser.Parser.parse",
          "source": "Parser.java:8784"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.impl.AssistParser.parseBlockStatements",
          "source": "AssistParser.java:1313"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.impl.AssistParser.parseBlockStatements",
          "source": "AssistParser.java:1166"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.impl.Engine.parseBlockStatements",
          "source": "Engine.java:292"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.impl.Engine.parseBlockStatements",
          "source": "Engine.java:255"
        },
        {
          "method": "org.eclipse.jdt.internal.codeassist.CompletionEngine.complete",
          "source": "CompletionEngine.java:1747"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.codeComplete",
          "source": "Openable.java:123"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.codeComplete",
          "source": "CompilationUnit.java:313"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.codeComplete",
          "source": "CompilationUnit.java:306"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaCompletionProposalComputer.internalComputeCompletionProposals",
          "source": "JavaCompletionProposalComputer.java:213"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaCompletionProposalComputer.computeCompletionProposals",
          "source": "JavaCompletionProposalComputer.java:193"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaTypeCompletionProposalComputer.computeCompletionProposals",
          "source": "JavaTypeCompletionProposalComputer.java:73"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.computeCompletionProposals",
          "source": "CompletionProposalComputerDescriptor.java:285"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.computeCompletionProposals",
          "source": "CompletionProposalCategory.java:252"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor.collectProposals",
          "source": "ContentAssistProcessor.java:212"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor.computeCompletionProposals",
          "source": "ContentAssistProcessor.java:181"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.ContentAssistant.computeCompletionProposals",
          "source": "ContentAssistant.java:1577"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.computeProposals",
          "source": "CompletionProposalPopup.java:448"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.access$15",
          "source": "CompletionProposalPopup.java:445"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup$2.run",
          "source": "CompletionProposalPopup.java:380"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.CompletionProposalPopup.showProposals",
          "source": "CompletionProposalPopup.java:374"
        },
        {
          "method": "org.eclipse.jface.text.contentassist.ContentAssistant$2.run",
          "source": "ContentAssistant.java:346"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3323"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2969"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1914"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1878"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:419"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "137623",
      "date": "2006-04-20T00:57:43+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "137623",
  "bugId": "137623",
  "date": "2006-04-20T00:57:43+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}