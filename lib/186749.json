{
  "comments": [
    "20070512-0010\n\n- change to a 6.0 JDK as workspace JRE\n- create a project with 6.0 compliance and the following content:\n\npackage a;\npublic class Try {\n    void m(Object var) {\n        if (1\u003d\u003d1 \u0026\u0026 var.equals(1)) {\n\n        }\n    }\n}\n\n- select \u0027var.equals(1)\u0027 and invoke \u0027refactor \u003e introduce indirection\u0027\n\njava.lang.ClassCastException: org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.findMemberType(Scope.java:954)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.getTypeOrPackage(Scope.java:2408)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.getPackage(Scope.java:2088)\n\tat org.eclipse.jdt.internal.compiler.ast.QualifiedTypeReference.getTypeBinding(QualifiedTypeReference.java:69)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType(TypeReference.java:163)\n\tat org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveSuperType(TypeReference.java:114)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.findSupertype(ClassScope.java:1116)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectSuperInterfaces(ClassScope.java:909)\n\tat org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectTypeHierarchy(ClassScope.java:955)\n\tat org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.connectTypeHierarchy(CompilationUnitScope.java:290)\n\tat org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.completeTypeBindings(LookupEnvironment.java:220)\n\tat org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1012)\n\tat org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1078)\n\tat org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1199)\n\tat org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:94)\n\tat org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:217)\n\tat org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:502)\n\tat org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:550)\n\tat org.eclipse.jdt.internal.corext.refactoring.RefactoringSearchEngine2.searchPattern(RefactoringSearchEngine2.java:473)\n\tat org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.findAllDeclarations(RippleMethodFinder2.java:295)\n\tat org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.getAllRippleMethods(RippleMethodFinder2.java:144)\n\tat org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.getRelatedMethods(RippleMethodFinder2.java:132)\n\tat org.eclipse.jdt.internal.corext.refactoring.code.IntroduceIndirectionRefactoring.updateReferences(IntroduceIndirectionRefactoring.java:605)\n\tat org.eclipse.jdt.internal.corext.refactoring.code.IntroduceIndirectionRefactoring.checkFinalConditions(IntroduceIndirectionRefactoring.java:499)",
    "Looking at the trace, it seems the problem comes from a distinct unit (which has a qualified super type reference). \n\n",
    "In runtime workbench, the refactoring action took minutes to perform, and didn\u0027t crash in the end.",
    "Reproduced only if using a JRE 6.0 lib on the buildpath.\ni.e.\njava version \"1.6.0_02-ea\"\nJava(TM) SE Runtime Environment (build 1.6.0_02-ea-b02)\nJava HotSpot(TM) Client VM (build 1.6.0_02-ea-b02, mixed mode)",
    "Offending unit is Font.class (from searching with source attached).\n",
    "java.awt.Font is trying to connect super-interface \"java.io.Serializable\"\n\nIt tries to look for a member type \"java\" through static import:\nimport : sun.font.EAttribute.*\n\n",
    "Created an attachment (id\u003d67056)\nProposed patch\n\n",
    "Could reproduce original issue (using refactoring), but unable to write a regression test. \n\n",
    "Kent - once patch is reviewed, please release it.\n\nStill need to produce some regression test.",
    "Released change to Scope in HEAD",
    "Had no luck trying to narrow down a testcase, but the fix is obviously necessary.",
    "Verified for 3.3 RC1 using build I20070516-0010"
  ],
  "commentCreationDates": [
    "2007-05-14T10:11:22+02:00",
    "2007-05-14T12:31:59+02:00",
    "2007-05-14T12:34:12+02:00",
    "2007-05-14T12:38:45+02:00",
    "2007-05-14T12:39:59+02:00",
    "2007-05-14T12:55:41+02:00",
    "2007-05-14T16:14:00+02:00",
    "2007-05-14T16:15:18+02:00",
    "2007-05-14T18:33:43+02:00",
    "2007-05-14T18:48:31+02:00",
    "2007-05-15T17:07:38+02:00",
    "2007-05-16T12:22:03+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.findMemberType",
          "source": "Scope.java:954"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.getTypeOrPackage",
          "source": "Scope.java:2408"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.getPackage",
          "source": "Scope.java:2088"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.QualifiedTypeReference.getTypeBinding",
          "source": "QualifiedTypeReference.java:69"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveType",
          "source": "TypeReference.java:163"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeReference.resolveSuperType",
          "source": "TypeReference.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.findSupertype",
          "source": "ClassScope.java:1116"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectSuperInterfaces",
          "source": "ClassScope.java:909"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.ClassScope.connectTypeHierarchy",
          "source": "ClassScope.java:955"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.connectTypeHierarchy",
          "source": "CompilationUnitScope.java:290"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.completeTypeBindings",
          "source": "LookupEnvironment.java:220"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches",
          "source": "MatchLocator.java:1012"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches",
          "source": "MatchLocator.java:1078"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches",
          "source": "MatchLocator.java:1199"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches",
          "source": "JavaSearchParticipant.java:94"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches",
          "source": "BasicSearchEngine.java:217"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.BasicSearchEngine.search",
          "source": "BasicSearchEngine.java:502"
        },
        {
          "method": "org.eclipse.jdt.core.search.SearchEngine.search",
          "source": "SearchEngine.java:550"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.RefactoringSearchEngine2.searchPattern",
          "source": "RefactoringSearchEngine2.java:473"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.findAllDeclarations",
          "source": "RippleMethodFinder2.java:295"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.getAllRippleMethods",
          "source": "RippleMethodFinder2.java:144"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.rename.RippleMethodFinder2.getRelatedMethods",
          "source": "RippleMethodFinder2.java:132"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.code.IntroduceIndirectionRefactoring.updateReferences",
          "source": "IntroduceIndirectionRefactoring.java:605"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.code.IntroduceIndirectionRefactoring.checkFinalConditions",
          "source": "IntroduceIndirectionRefactoring.java:499"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "186749",
      "date": "2007-05-14T10:11:22+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "186749",
  "bugId": "186749",
  "date": "2007-05-14T10:11:22+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}