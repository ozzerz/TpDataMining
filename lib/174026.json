{
  "comments": [
    "Build ID: 3.3M4\n\nSteps To Reproduce:\n\nN.B. I will attach a simple test feature signed with our code signing cert that reproduces the issue reliably for us to the bug as well as a screen capture of the error reported by eclipse.\n\n1. Generate test feature\n2. Sign the feature with our code signing cert from Thawte\n3. Attempt to install signed feature in 3.3M4 (or later) with the \"Check digital signatures of downloaded archives\" enabled\n\nThe error is displayed by eclipse, and the feature fails to get past the verification step (More details on the debugging we did included below).\n\nMore information:\nWe have a java code signing certificate from Thawte that uses a chained root (Thawte Premium CA \u003d\u003e Thawte Code Signing CA \u003d\u003e Our code signing certificate).\n\n    Signing features/plugins with this certificate has worked with releases from the 3.1.x and 3.2.x streams,  but no longer works with the 3.3 M4 (or the one nightly build I tried).\n\n    Using a 3.3 M4 instance to debug the installation of a signed feature (example feature attached), the issue appears to manifest itself in PKCS7Processor,in the validateCerts method;  It passes the call to currentX509Cert.checkValidity without issue,  but it\u0027s the next check on line 191 that is causing the issue,  the call \"currentX509Cert.verify(nextX509Cert.getPublicKey())\"\n\n    Inspecting the variables shows that when the error occurs (first pass through the for loop) the currentX509 cert is the Thawte Code Signing CA certificate, and nextX509Cert is our code signing certificate.  The verify \nmethod is suppose to validate the certificate (thwate code signing CA) was signed with the private key for the pubic key provided (Our code signing cert public key).  Rather obviously we did not sign the Thawte certificate, so the call fails and causes a SingatureException to be thrown, and the feature installation to fail.\n\n    At the time of execution, the certificates array has the certificates in the following order: Thawte Code Signing CA cert, Our cert, Thawte Premium CA cert\n\n    The code (at least the code in M4) seems to be assuming that the certificates array will be ordered such that nextX509Cert will always have signed currentX509Cert.",
    "Created an attachment (id\u003d58867)\nError Screenshot\n\nError screenshot",
    "Created an attachment (id\u003d58868)\nExample signed feature\n\nExample signed feature that reproduces the feature (This is a simple, empty test feature, but it triggers the problem)",
    "Created an attachment (id\u003d63282)\nError dialog\n\n",
    "(From update of attachment 63282)\nStack trace for null pointer exception:\n!SUBENTRY 1 org.eclipse.update.core 4 0 2007-04-09 15:09:43.664\n!MESSAGE Verification of feature unsuccessful. Installation cancelled. [java.lang.NullPointerException]\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.update.internal.verifier.CertVerifier.alreadyValidated(CertVerifier.java:221)\n\tat org.eclipse.update.internal.verifier.CertVerifier.verify(CertVerifier.java:152)\n\tat org.eclipse.update.internal.verifier.CertVerifier.verify(CertVerifier.java:133)\n\tat org.eclipse.update.core.Feature.verifyReferences(Feature.java:967)\n\tat org.eclipse.update.core.Feature.install(Feature.java:377)\n\tat org.eclipse.update.internal.core.SiteFile.install(SiteFile.java:96)\n\tat org.eclipse.update.internal.core.ConfiguredSite.install(ConfiguredSite.java:155)\n\tat org.eclipse.update.internal.core.ConfiguredSite.install(ConfiguredSite.java:119)\n\tat org.eclipse.update.internal.operations.InstallOperation.execute(InstallOperation.java:92)\n\tat org.eclipse.update.internal.operations.BatchInstallOperation.execute(BatchInstallOperation.java:84)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2.install(InstallWizard2.java:375)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2.access$1(InstallWizard2.java:372)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2$1.run(InstallWizard2.java:485)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)",
    "(From update of attachment 63282)\n\u003e\u003cHTML\u003e\u003cBODY\u003e\u003cIMG src\u003d\"https://bugs.eclipse.org/bugs/attachment.cgi?id\u003d63282\" alt\u003d\"https://bugs.eclipse.org/bugs/attachment.cgi?id\u003d63282\" style\u003d\"cursor: -moz-zoom-out;\"/\u003e\n\u003ccode\u003e\nStack trace for null pointer exception:\n!SUBENTRY 1 org.eclipse.update.core 4 0 2007-04-09 15:09:43.664\n!MESSAGE Verification of feature unsuccessful. Installation cancelled. [java.lang.NullPointerException]\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.update.internal.verifier.CertVerifier.alreadyValidated(CertVerifier.java:221)\n\tat org.eclipse.update.internal.verifier.CertVerifier.verify(CertVerifier.java:152)\n\tat org.eclipse.update.internal.verifier.CertVerifier.verify(CertVerifier.java:133)\n\tat org.eclipse.update.core.Feature.verifyReferences(Feature.java:967)\n\tat org.eclipse.update.core.Feature.install(Feature.java:377)\n\tat org.eclipse.update.internal.core.SiteFile.install(SiteFile.java:96)\n\tat org.eclipse.update.internal.core.ConfiguredSite.install(ConfiguredSite.java:155)\n\tat org.eclipse.update.internal.core.ConfiguredSite.install(ConfiguredSite.java:119)\n\tat org.eclipse.update.internal.operations.InstallOperation.execute(InstallOperation.java:92)\n\tat org.eclipse.update.internal.operations.BatchInstallOperation.execute(BatchInstallOperation.java:84)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2.install(InstallWizard2.java:375)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2.access$1(InstallWizard2.java:372)\n\tat org.eclipse.update.internal.ui.wizards.InstallWizard2$1.run(InstallWizard2.java:485)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)\n\u003c/code\u003e\n\u003c/BODY\u003e\u003c/HTML\u003e\n\n",
    "Created an attachment (id\u003d63283)\nStackTrace\n\n",
    "(From update of attachment 63282)\n\u003e\u003cHTML\u003e\u003cBODY\u003e\u003cIMG src\u003d\"https://bugs.eclipse.org/bugs/attachment.cgi?id\u003d63282\" alt\u003d\"https://bugs.eclipse.org/bugs/attachment.cgi?id\u003d63282\" style\u003d\"cursor: -moz-zoom-out;\"/\u003e\u003c/BODY\u003e\u003c/HTML\u003e\n\n"
  ],
  "commentCreationDates": [
    "2007-02-13T17:06:01+01:00",
    "2007-02-13T17:06:40+01:00",
    "2007-02-13T17:07:54+01:00",
    "2007-04-09T21:09:26+02:00",
    "2007-04-09T21:12:49+02:00",
    "2007-04-09T21:14:21+02:00",
    "2007-04-09T21:16:45+02:00",
    "2007-04-09T21:18:59+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.alreadyValidated",
          "source": "CertVerifier.java:221"
        },
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.verify",
          "source": "CertVerifier.java:152"
        },
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.verify",
          "source": "CertVerifier.java:133"
        },
        {
          "method": "org.eclipse.update.core.Feature.verifyReferences",
          "source": "Feature.java:967"
        },
        {
          "method": "org.eclipse.update.core.Feature.install",
          "source": "Feature.java:377"
        },
        {
          "method": "org.eclipse.update.internal.core.SiteFile.install",
          "source": "SiteFile.java:96"
        },
        {
          "method": "org.eclipse.update.internal.core.ConfiguredSite.install",
          "source": "ConfiguredSite.java:155"
        },
        {
          "method": "org.eclipse.update.internal.core.ConfiguredSite.install",
          "source": "ConfiguredSite.java:119"
        },
        {
          "method": "org.eclipse.update.internal.operations.InstallOperation.execute",
          "source": "InstallOperation.java:92"
        },
        {
          "method": "org.eclipse.update.internal.operations.BatchInstallOperation.execute",
          "source": "BatchInstallOperation.java:84"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2.install",
          "source": "InstallWizard2.java:375"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2.access$1",
          "source": "InstallWizard2.java:372"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2$1.run",
          "source": "InstallWizard2.java:485"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 4,
      "bugId": "174026",
      "date": "2007-04-09T21:12:49+02:00",
      "product": "Platform",
      "component": "Update",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.alreadyValidated",
          "source": "CertVerifier.java:221"
        },
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.verify",
          "source": "CertVerifier.java:152"
        },
        {
          "method": "org.eclipse.update.internal.verifier.CertVerifier.verify",
          "source": "CertVerifier.java:133"
        },
        {
          "method": "org.eclipse.update.core.Feature.verifyReferences",
          "source": "Feature.java:967"
        },
        {
          "method": "org.eclipse.update.core.Feature.install",
          "source": "Feature.java:377"
        },
        {
          "method": "org.eclipse.update.internal.core.SiteFile.install",
          "source": "SiteFile.java:96"
        },
        {
          "method": "org.eclipse.update.internal.core.ConfiguredSite.install",
          "source": "ConfiguredSite.java:155"
        },
        {
          "method": "org.eclipse.update.internal.core.ConfiguredSite.install",
          "source": "ConfiguredSite.java:119"
        },
        {
          "method": "org.eclipse.update.internal.operations.InstallOperation.execute",
          "source": "InstallOperation.java:92"
        },
        {
          "method": "org.eclipse.update.internal.operations.BatchInstallOperation.execute",
          "source": "BatchInstallOperation.java:84"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2.install",
          "source": "InstallWizard2.java:375"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2.access$1",
          "source": "InstallWizard2.java:372"
        },
        {
          "method": "org.eclipse.update.internal.ui.wizards.InstallWizard2$1.run",
          "source": "InstallWizard2.java:485"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 1,
      "commentIndex": 5,
      "bugId": "174026",
      "date": "2007-04-09T21:14:21+02:00",
      "product": "Platform",
      "component": "Update",
      "severity": "normal"
    }
  ],
  "groupId": "174026",
  "bugId": "174026",
  "date": "2007-02-13T17:06:01+01:00",
  "product": "Platform",
  "component": "Update",
  "severity": "normal"
}