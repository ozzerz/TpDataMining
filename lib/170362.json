{
  "comments": [
    "I\u0027m busy working away on my Windows Debugger using the CDT. I am getting the odd NPE. Here\u0027s an example:\n\njava.lang.NullPointerException\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.evictChunk(Database.java:576)\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.pageIn(Database.java:543)\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.getChunk(Database.java:245)\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.getInt(Database.java:395)\n\tat org.eclipse.cdt.internal.core.pdom.dom.PDOMNode.getNodeType(PDOMNode.java:85)\n\tat org.eclipse.cdt.internal.core.pdom.dom.cpp.PDOMCPPLinkage.getNode(PDOMCPPLinkage.java:328)\n\tat org.eclipse.cdt.internal.core.pdom.dom.FindBindingsInBTree.compare(FindBindingsInBTree.java:26)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:548)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:551)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:551)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:560)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:524)\n\tat org.eclipse.cdt.internal.core.pdom.dom.PDOMLinkage.findInGlobalScope(PDOMLinkage.java:225)\n\tat org.eclipse.cdt.internal.core.pdom.PDOM.findInGlobalScope(PDOM.java:599)\n\tat org.eclipse.cdt.internal.core.index.CIndex.findInGlobalScope(CIndex.java:334)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPScope.getBinding(CPPScope.java:93)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPSemantics.lookup(CPPSemantics.java:1013)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPSemantics.resolveBinding(CPPSemantics.java:613)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPVisitor.resolveBinding(CPPVisitor.java:943)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPVisitor.createBinding(CPPVisitor.java:187)\n\tat org.eclipse.cdt.internal.core.dom.parser.cpp.CPPASTName.resolveBinding(CPPASTName.java:71)\n\tat org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.addSymbols(PDOMIndexerTask.java:354)\n\tat org.eclipse.cdt.internal.core.pdom.indexer.fast.PDOMFastIndexerJob.doParseTU(PDOMFastIndexerJob.java:115)\n\tat org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.parseTU(PDOMIndexerTask.java:236)\n\tat org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.parseTUs(PDOMIndexerTask.java:191)\n\tat org.eclipse.cdt.internal.core.pdom.indexer.fast.PDOMFastHandleDelta.run(PDOMFastHandleDelta.java:68)\n\tat org.eclipse.cdt.internal.core.pdom.PDOMIndexerJob.run(PDOMIndexerJob.java:67)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)",
    "CPPScope.getBinding() doesn\u0027t obtain a read lock on the index so more than one thread is modifying the page table at the same time.\n\nI\u0027ll write a patch.",
    "(In reply to comment #1)\n\u003e CPPScope.getBinding() doesn\u0027t obtain a read lock on the index so more than one\n\u003e thread is modifying the page table at the same time.\n\u003e I\u0027ll write a patch.\n\nBecause the AST holds on to objects from the index, it would not be sufficient to obtain read locks during the name resolution. Rather than that the index has to be locked before creating an index-based AST and must not be released as long as the AST is used. This is done in PDOMFastIndexerJob.doParseTU(...).\n\nHowever, holding a read-lock does not prevent multiple threads from simultaneously accessing the index!",
    "Hmmm... if that\u0027s the case, the safest way out is synchronizing access to the page table.  Hopefully it won\u0027t incur too much of a performance hit.",
    "The idea right now is that only one writer or many readers are allowed to access the Index at one time. Are we saying that we now should allow only one reader/writer, i.e. serialize all access? In particular since reads now cause changes to the underlying data structures.\n\nThat probably wouldn\u0027t be an issue since generally only one thing would be reading at a time. But the scenario I am running into, and it\u0027s happening quite often now, is when you have save on build turned on. When I quickly edit code and then hit build (Ctrl-B), I get three things kick in:\n\n1) The indexer to index the changed file (writer)\n2) The semantic analyzer to color the code in the editor (reader)\n3) The dependency analyzer for the internal builder (reader)\n\nI guess what\u0027s happening is the two readers colliding with eachother.",
    "I have considered this when fixing bug 165451 and bug 170542."
  ],
  "commentCreationDates": [
    "2007-01-12T21:20:22+01:00",
    "2007-01-12T21:38:18+01:00",
    "2007-01-15T08:57:58+01:00",
    "2007-01-15T14:45:36+01:00",
    "2007-01-15T15:04:47+01:00",
    "2007-03-23T12:35:11+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.evictChunk",
          "source": "Database.java:576"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.pageIn",
          "source": "Database.java:543"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.getChunk",
          "source": "Database.java:245"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.getInt",
          "source": "Database.java:395"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.dom.PDOMNode.getNodeType",
          "source": "PDOMNode.java:85"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.dom.cpp.PDOMCPPLinkage.getNode",
          "source": "PDOMCPPLinkage.java:328"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.dom.FindBindingsInBTree.compare",
          "source": "FindBindingsInBTree.java:26"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:548"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:551"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:551"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:560"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:524"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.dom.PDOMLinkage.findInGlobalScope",
          "source": "PDOMLinkage.java:225"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.PDOM.findInGlobalScope",
          "source": "PDOM.java:599"
        },
        {
          "method": "org.eclipse.cdt.internal.core.index.CIndex.findInGlobalScope",
          "source": "CIndex.java:334"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPScope.getBinding",
          "source": "CPPScope.java:93"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPSemantics.lookup",
          "source": "CPPSemantics.java:1013"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPSemantics.resolveBinding",
          "source": "CPPSemantics.java:613"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPVisitor.resolveBinding",
          "source": "CPPVisitor.java:943"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPVisitor.createBinding",
          "source": "CPPVisitor.java:187"
        },
        {
          "method": "org.eclipse.cdt.internal.core.dom.parser.cpp.CPPASTName.resolveBinding",
          "source": "CPPASTName.java:71"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.addSymbols",
          "source": "PDOMIndexerTask.java:354"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.indexer.fast.PDOMFastIndexerJob.doParseTU",
          "source": "PDOMFastIndexerJob.java:115"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.parseTU",
          "source": "PDOMIndexerTask.java:236"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.indexer.PDOMIndexerTask.parseTUs",
          "source": "PDOMIndexerTask.java:191"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.indexer.fast.PDOMFastHandleDelta.run",
          "source": "PDOMFastHandleDelta.java:68"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.PDOMIndexerJob.run",
          "source": "PDOMIndexerJob.java:67"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "170362",
      "date": "2007-01-12T21:20:22+01:00",
      "product": "CDT",
      "component": "cdt-core",
      "severity": "normal"
    }
  ],
  "groupId": "170362",
  "bugId": "170362",
  "date": "2007-01-12T21:20:22+01:00",
  "product": "CDT",
  "component": "cdt-core",
  "severity": "normal"
}