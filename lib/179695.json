{
  "comments": [
    "3.3M6\n\nI\u0027m using the Eclipse Preferences API in a server environment where I don\u0027t have the concept of a \"product\". When using the API I get the following NPE which indicates that the Preferences API is trying to load default product preferences which aren\u0027t available.\n\n \njava.lang.NullPointerException\nat org.eclipse.core.internal.preferences.DefaultPreferences.applyDefaults(DefaultPreferences.java:126)\nat org.eclipse.core.internal.preferences.DefaultPreferences.applyProductDefaults(DefaultPreferences.java:190)\nat org.eclipse.core.internal.preferences.DefaultPreferences.loadDefaults(DefaultPreferences.java:233)\nat org.eclipse.core.internal.preferences.DefaultPreferences.load(DefaultPreferences.java:227)\nat org.eclipse.core.internal.preferences.EclipsePreferences.create(EclipsePreferences.java:307)\nat org.eclipse.core.internal.preferences.EclipsePreferences.internalNode(EclipsePreferences.java:543)\nat org.eclipse.core.internal.preferences.EclipsePreferences.node(EclipsePreferences.java:662)\nat org.eclipse.core.internal.preferences.PreferencesService.getNodes(PreferencesService.java:588)\nat org.eclipse.core.internal.preferences.PreferencesService.getString(PreferencesService.java:635)\nat yada.yada.MyServlet.getSomethingFromIPreferencesService(MyServlet.java:78)\nat yada.yada.MyServlet.doGet(MyServlet.java:48)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:596)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\nat org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:91)\nat org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:110)\nat org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:60)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\nat org.eclipse.equinox.http.jetty.internal.HttpServerManager$InternalHttpServiceServlet.service(HttpServerManager.java:275)\nat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:428)\nat org.mortbay.jetty.servlet.ServletHandler.dispatch(ServletHandler.java:677)\nat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:568)\nat org.mortbay.http.HttpContext.handle(HttpContext.java:1530)\nat org.mortbay.http.HttpContext.handle(HttpContext.java:1482)\nat org.mortbay.http.HttpServer.service(HttpServer.java:909)\nat org.mortbay.http.HttpConnection.service(HttpConnection.java:820)\nat org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:986)\nat org.mortbay.http.HttpConnection.handle(HttpConnection.java:837)\nat org.mortbay.http.SocketListener.handleConnection(SocketListener.java:245)\nat org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)\nat org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)",
    "Created an attachment (id\u003d62199)\nPatch for org.eclipse.equinox.preferences\n\nThe fix for the actual NPE might be as simple as in this patch. \n\nHowever, I wonder about the performance overhead of applyProductDefaults in an environment where no IProductPreferencesService is available. It\u0027s called by loadDefaults which is called by load. How often might load get called? If it\u0027s not very frequent then this might be ok, otherwise there might be room for performance optimizations here.",
    "Its called once per bundle who accesses their default preferences. I have released a change that sets the field to an empty table if one doesn\u0027t exist, and the check is now table.isEmpty().\n\nThanks for the patch. \n\nReleased to HEAD.\n"
  ],
  "commentCreationDates": [
    "2007-03-28T11:35:06+02:00",
    "2007-03-28T11:45:08+02:00",
    "2007-04-04T21:56:26+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.applyDefaults",
          "source": "DefaultPreferences.java:126"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.applyProductDefaults",
          "source": "DefaultPreferences.java:190"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.loadDefaults",
          "source": "DefaultPreferences.java:233"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.load",
          "source": "DefaultPreferences.java:227"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.create",
          "source": "EclipsePreferences.java:307"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.internalNode",
          "source": "EclipsePreferences.java:543"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.node",
          "source": "EclipsePreferences.java:662"
        },
        {
          "method": "org.eclipse.core.internal.preferences.PreferencesService.getNodes",
          "source": "PreferencesService.java:588"
        },
        {
          "method": "org.eclipse.core.internal.preferences.PreferencesService.getString",
          "source": "PreferencesService.java:635"
        },
        {
          "method": "yada.yada.MyServlet.getSomethingFromIPreferencesService",
          "source": "MyServlet.java:78"
        },
        {
          "method": "yada.yada.MyServlet.doGet",
          "source": "MyServlet.java:48"
        },
        {
          "method": "javax.servlet.http.HttpServlet.service",
          "source": "HttpServlet.java:596"
        },
        {
          "method": "javax.servlet.http.HttpServlet.service",
          "source": "HttpServlet.java:689"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest",
          "source": "ServletRegistration.java:91"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias",
          "source": "ProxyServlet.java:110"
        },
        {
          "method": "org.eclipse.equinox.http.servlet.internal.ProxyServlet.service",
          "source": "ProxyServlet.java:60"
        },
        {
          "method": "javax.servlet.http.HttpServlet.service",
          "source": "HttpServlet.java:689"
        },
        {
          "method": "org.eclipse.equinox.http.jetty.internal.HttpServerManager$InternalHttpServiceServlet.service",
          "source": "HttpServerManager.java:275"
        },
        {
          "method": "org.mortbay.jetty.servlet.ServletHolder.handle",
          "source": "ServletHolder.java:428"
        },
        {
          "method": "org.mortbay.jetty.servlet.ServletHandler.dispatch",
          "source": "ServletHandler.java:677"
        },
        {
          "method": "org.mortbay.jetty.servlet.ServletHandler.handle",
          "source": "ServletHandler.java:568"
        },
        {
          "method": "org.mortbay.http.HttpContext.handle",
          "source": "HttpContext.java:1530"
        },
        {
          "method": "org.mortbay.http.HttpContext.handle",
          "source": "HttpContext.java:1482"
        },
        {
          "method": "org.mortbay.http.HttpServer.service",
          "source": "HttpServer.java:909"
        },
        {
          "method": "org.mortbay.http.HttpConnection.service",
          "source": "HttpConnection.java:820"
        },
        {
          "method": "org.mortbay.http.HttpConnection.handleNext",
          "source": "HttpConnection.java:986"
        },
        {
          "method": "org.mortbay.http.HttpConnection.handle",
          "source": "HttpConnection.java:837"
        },
        {
          "method": "org.mortbay.http.SocketListener.handleConnection",
          "source": "SocketListener.java:245"
        },
        {
          "method": "org.mortbay.util.ThreadedServer.handle",
          "source": "ThreadedServer.java:357"
        },
        {
          "method": "org.mortbay.util.ThreadPool$PoolThread.run",
          "source": "ThreadPool.java:534"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "179695",
      "date": "2007-03-28T11:35:06+02:00",
      "product": "Equinox",
      "component": "Bundles",
      "severity": "normal"
    }
  ],
  "groupId": "179695",
  "bugId": "179695",
  "date": "2007-03-28T11:35:06+02:00",
  "product": "Equinox",
  "component": "Bundles",
  "severity": "normal"
}