{
  "comments": [
    "Summary: \nDBCS3.2: NullPointerException by setting the element type with DBCS named XSD file\n\nDescription:\n  When setting the element type with DBCS named XSD file, \n  it failed with Java NullPointerException occurs. \n  If doing the same scenarion with SBCS named XSD file, then \n  it succeeded without any error. \n\n Build date: org.eclipse.wst.xsd.core  1.01.101.v200603012030\n                 wtp-sdk-S-1.5M5-200603022222.zip\n                 xsd-SDK-2.2.0M5.zip\n\n OS:   Windows XP Professional SP2 Japanese     \n\n Steps to recreate problem:\n        1- Create a general project with \"New Project\" wizard with any name\n        2- Import DBCS named XSD file (The test sample file is attached)\n        3- Open XSD file on XML Schema Editor\n        4- With Graph mode, right click with \u0027Elements\" Section and choose \"Add Element\"\n        5- Select added element and open General tab on properties view\n        6- Click [...] button for Type and open \"Set Type\" dialog\n        7- Select any user defined type, such as PublicationType, MagazineType, etc which is defined in this XSD file\n        8- Confirm that the selected type is referred to DBCS named XSD file in the Qualifier, and click OK button to set.\n        9- Then, nothing can be set and Java NullPointerException is recorded in the .log file\n\n Expected output:\n    The element type can be set without any exception. \n\n Error logs: \n\n!SESSION 2006-03-08 18:38:15.187 -----------------------------------------------\n\neclipse.buildId\u003dI20060223-1656\njava.fullversion\u003dJ2RE 1.5.0 IBM J9 2.3 Windows XP x86-32 j9vmwi3223ifx-20060124\n(JIT enabled)\nJ9VM - 20051027_03723_lHdSMR\nJIT  - 20051027_1437_r8\nGC   - 20051020_AA\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003dja_JP\nCommand-line arguments:  -data E:\\XML\\FP4 -os win32 -ws win32 -arch x86 -console\nlog\n\n!ENTRY org.eclipse.ui 4 4 2006-03-08 18:39:47.562\n!MESSAGE Unhandled event loop exception\n\n!ENTRY org.eclipse.ui 4 0 2006-03-08 18:39:47.562\n!MESSAGE java.lang.NullPointerException\n!STACK 0\njava.lang.NullPointerException\n        at org.eclipse.wst.xsd.ui.internal.dialogs.types.xsd.XSDSetTypeHelper.addImportIfNecessary(XSDSetTypeHelper.java:102)\n        at org.eclipse.wst.xsd.ui.internal.dialogs.types.xsd.XSDSetTypeHelper.setType(XSDSetTypeHelper.java:51)\n        at org.eclipse.wst.xsd.ui.internal.properties.section.TypesSection.widgetSelected(TypesSection.java:315)\n        at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:90)\n        at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n        at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:925)\n        at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3287)\n        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2907)\n        at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1899)\n        at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1863)\n        at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:417)\n        at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n        at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\n        at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:99)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374)\n        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:615)\n        at org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\n        at org.eclipse.core.launcher.Main.basicRun(Main.java:282)\n        at org.eclipse.core.launcher.Main.run(Main.java:977)\n        at org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Created an attachment (id\u003d35897)\nXSD file which I use to recreate this problem\n\nThis file is generated by copying Catalogue.xsd which is provided by XML example\n\"Editing and validating XML files\"",
    "Created an attachment (id\u003d35898)\nError log for this project\n\n.log file located under .metadata directory for the project with this problem.",
    "I talked with our leader in our test team, and changed the prilority \nfrom normal to major, since we need this fix in 1.5 release. ",
    "I got the same problem under JDK1.5, but it works well under JDK1.4.\n\nBy investigation, I found, when XSD filename is DBCS, the SAXParser throws MalformedURLException caused by unknown protocol. That leads to null schema. Since the schema is NULL, the statement ?schema.getTargetNamespace()? in XSDSetTypeHelper throws NullPointerException.\n\nSuggestion:\nIf the URI does not have protocol part, add protocol ?file? to the URI before sending to SAXParser.\n",
    "Created an attachment (id\u003d36865)\nPatch\n\nAdd protocol part (file) to URI before sending to SAXParser",
    "Keith, can you review the patch? Thanks.",
    "Hi, thanks for submitting the patch.   However, the XSD editor no longer uses this XSDSetTypeHelper and now uses the Search APIs to populate the list of types.  This no longer applies.",
    "Confirmed that this problem is no longer recreatable with   \n    eclipse-SDK-3.2M6-win32\n    wtp-sdk-I-I200603302119-200603302119\n    xsd-SDK-I200603300000\n\n    "
  ],
  "commentCreationDates": [
    "2006-03-08T10:02:28+01:00",
    "2006-03-08T10:05:05+01:00",
    "2006-03-08T10:06:15+01:00",
    "2006-03-16T09:17:24+01:00",
    "2006-03-24T03:47:02+01:00",
    "2006-03-24T03:52:00+01:00",
    "2006-03-29T17:32:10+02:00",
    "2006-03-31T18:47:42+02:00",
    "2006-04-04T16:03:25+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.xsd.ui.internal.dialogs.types.xsd.XSDSetTypeHelper.addImportIfNecessary",
          "source": "XSDSetTypeHelper.java:102"
        },
        {
          "method": "org.eclipse.wst.xsd.ui.internal.dialogs.types.xsd.XSDSetTypeHelper.setType",
          "source": "XSDSetTypeHelper.java:51"
        },
        {
          "method": "org.eclipse.wst.xsd.ui.internal.properties.section.TypesSection.widgetSelected",
          "source": "TypesSection.java:315"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:90"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:925"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3287"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2907"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1899"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1863"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:417"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:99"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:374"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "130877",
      "date": "2006-03-08T10:02:28+01:00",
      "product": "Web Tools",
      "component": "wst.xsd",
      "severity": "major"
    }
  ],
  "groupId": "130877",
  "bugId": "130877",
  "date": "2006-03-08T10:02:28+01:00",
  "product": "Web Tools",
  "component": "wst.xsd",
  "severity": "major"
}