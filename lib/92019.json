{
  "comments": [
    "build I20050419-1200\n\nSaw the following in the (linux-gtk) console output for this build.\nThere are some earlier exceptions (reported separately), so this may be a\nsecondary effect.\n\n  [java] !ENTRY org.eclipse.ui.workbench 4 2 2005-04-19 14:35:14.491\n     [java] !MESSAGE Problems occurred when invoking code from plug-in:\n\"org.eclipse.ui.workbench\".\n     [java] !STACK 0\n     [java] java.lang.IllegalArgumentException: Argument not valid\n     [java] \tat org.eclipse.swt.SWT.error(SWT.java:2924)\n     [java] \tat org.eclipse.swt.SWT.error(SWT.java:2863)\n     [java] \tat org.eclipse.swt.SWT.error(SWT.java:2834)\n     [java] \tat org.eclipse.swt.graphics.TextStyle.\u003cinit\u003e(TextStyle.java:73)\n     [java] \tat\norg.eclipse.swt.custom.StyledTextRenderer.getTextLayout(StyledTextRenderer.java:437)\n     [java] \tat org.eclipse.swt.custom.StyledText.getXAtOffset(StyledText.java:4731)\n     [java] \tat\norg.eclipse.swt.custom.StyledText.getLocationAtOffset(StyledText.java:3884)\n     [java] \tat\norg.eclipse.jface.text.CursorLinePainter.drawHighlightLine(CursorLinePainter.java:182)\n     [java] \tat\norg.eclipse.jface.text.CursorLinePainter.deactivate(CursorLinePainter.java:200)\n     [java] \tat\norg.eclipse.jface.text.PaintManager.removePainter(PaintManager.java:214)\n     [java] \tat\norg.eclipse.jface.text.TextViewer.removePainter(TextViewer.java:4746)\n     [java] \tat\norg.eclipse.ui.texteditor.SourceViewerDecorationSupport.hideCursorLine(SourceViewerDecorationSupport.java:736)\n     [java] \tat\norg.eclipse.ui.texteditor.SourceViewerDecorationSupport.updateTextDecorations(SourceViewerDecorationSupport.java:316)\n     [java] \tat\norg.eclipse.ui.texteditor.SourceViewerDecorationSupport.dispose(SourceViewerDecorationSupport.java:399)\n     [java] \tat\norg.eclipse.ui.texteditor.AbstractDecoratedTextEditor.dispose(AbstractDecoratedTextEditor.java:232)\n     [java] \tat org.eclipse.ui.editors.text.TextEditor.dispose(TextEditor.java:101)\n     [java] \tat\norg.eclipse.pde.internal.ui.editor.PDESourcePage.dispose(PDESourcePage.java:171)\n     [java] \tat\norg.eclipse.pde.internal.ui.editor.XMLSourcePage.dispose(XMLSourcePage.java:43)\n     [java] \tat\norg.eclipse.ui.part.MultiPageEditorPart$3.run(MultiPageEditorPart.java:541)\n     [java] \tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1026)\n     [java] \tat org.eclipse.core.runtime.Platform.run(Platform.java:757)\n     [java] \tat\norg.eclipse.ui.part.MultiPageEditorPart.disposePart(MultiPageEditorPart.java:534)\n     [java] \tat\norg.eclipse.ui.part.MultiPageEditorPart.dispose(MultiPageEditorPart.java:268)\n     [java] \tat org.eclipse.ui.forms.editor.FormEditor.dispose(FormEditor.java:338)\n     [java] \tat\norg.eclipse.pde.internal.ui.editor.PDEFormEditor.dispose(PDEFormEditor.java:422)\n     [java] \tat\norg.eclipse.ui.internal.WorkbenchPartReference.dispose(WorkbenchPartReference.java:527)\n     [java] \tat\norg.eclipse.ui.internal.EditorReference.dispose(EditorReference.java:235)\n     [java] \tat\norg.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:1153)\n     [java] \tat\norg.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:1176)\n     [java] \tat\norg.eclipse.ui.internal.CloseEditorAction.run(CloseEditorAction.java:40)\n     [java] \tat org.eclipse.jface.action.Action.runWithEvent(Action.java:996)\n     [java] \tat\norg.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:538)\n     [java] \tat\norg.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n     [java] \tat\norg.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n     [java] \tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n     [java] \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1012)\n     [java] \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1036)\n     [java] \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1021)\n     [java] \tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:891)\n     [java] \tat\norg.eclipse.pde.internal.ui.tests.macro.BooleanSelectionCommand.doClick(BooleanSelectionCommand.java:140)\n     [java] \tat\norg.eclipse.pde.internal.ui.tests.macro.BooleanSelectionCommand.playback(BooleanSelectionCommand.java:130)\n     [java] \tat\norg.eclipse.pde.internal.ui.tests.macro.MacroCommandShell$4.run(MacroCommandShell.java:509)\n     [java] \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n     [java] \tat\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n     [java] \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2755)\n     [java] \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2475)\n     [java] \tat\norg.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:153)\n     [java] \tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:303)\n     [java] \tat\norg.eclipse.jface.window.ApplicationWindow$1.run(ApplicationWindow.java:624)\n     [java] \tat\norg.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n     [java] \tat\norg.eclipse.jface.window.ApplicationWindow.run(ApplicationWindow.java:621)\n     [java] \tat\norg.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2133)\n     [java] \tat\norg.eclipse.pde.internal.ui.tests.macro.MacroManager.play(MacroManager.java:228)\n     [java] \tat org.eclipse.pde.ui.tests.PDETestCase.playScript(PDETestCase.java:55)\n     [java] \tat\norg.eclipse.pde.ui.tests.wizards.plugin.SimplePluginTestCase.testSimplePluginWithoutManifest(SimplePluginTestCase.java:39)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] \tat java.lang.reflect.Method.invoke(Method.java:324)\n     [java] \tat junit.framework.TestCase.runTest(TestCase.java:154)\n     [java] \tat junit.framework.TestCase.runBare(TestCase.java:127)\n     [java] \tat junit.framework.TestResult$1.protect(TestResult.java:106)\n     [java] \tat junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java] \tat junit.framework.TestResult.run(TestResult.java:109)\n     [java] \tat junit.framework.TestCase.run(TestCase.java:118)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n     [java] \tat junit.framework.TestSuite.run(TestSuite.java:203)\n     [java] \tat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:313)\n     [java] \tat org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:199)\n     [java] \tat org.eclipse.test.UITestApplication$3.run(UITestApplication.java:188)\n     [java] \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n     [java] \tat\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n     [java] \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2755)\n     [java] \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2475)\n     [java] \tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1570)\n     [java] \tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1534)\n     [java] \tat\norg.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:306)\n     [java] \tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n     [java] \tat\norg.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n     [java] \tat\norg.eclipse.test.UITestApplication.runApplication(UITestApplication.java:131)\n     [java] \tat org.eclipse.test.UITestApplication.run(UITestApplication.java:58)\n     [java] \tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:228)\n     [java] \tat\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)\n     [java] \tat\norg.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:156)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] \tat java.lang.reflect.Method.invoke(Method.java:324)\n     [java] \tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:319)\n     [java] \tat org.eclipse.core.launcher.Main.basicRun(Main.java:272)\n     [java] \tat org.eclipse.core.launcher.Main.run(Main.java:951)\n     [java] \tat org.eclipse.core.launcher.Main.main(Main.java:935)",
    "This problem occurs every time a plugin editor is open and closed in I-\n20050419-1200\n\nThe problem does not occur when I use the latest pde.ui code against the \nplatform/text code from last week.\n\nMoving to Platform/Text.",
    "Wassim are you 100% sure that the only change you made to your workspace/runtime\nwas exchanging Platform Text? Strange - when I run with our newest code on top\nof I20050413-0910 I do not see the problem.\n\nI suspect that the Workbench changes that went into the I-build surface that bug\nand that we either get disposed twice or get a dispose event that we didn\u0027t get\nbefore and we don\u0027t handle it correctly. We also have failing test cases that\nworked when submitting our build but now with newest Platform UI code fail.\n",
    "PDE disposes the color manager before the widget. The widget accesses the color\nand hence fails since it is disposed.\n\nWorks for me if after swapping the two lines in XMLSourcePage.dispose().\n\nThe really interesting question remains: why wasn\u0027t that a problem?",
    "Thanks dani.  I made the swap and it fixed the problem, but this is all so \nvery disconcerting.",
    "In I20050413-0910 (and older) the StyledText widget was already disposed when\nSourceViewerDecorationSupport.dispose() was called and hence we did not update\nthe text presentation (see SourceViewerDecorationSupport.updateTextDecorations()).\n\nIn I20050413-0910 PartPane.dispose() disposed the control (StyledText widget)\nbefore dispose was called on the part (WorkbenchPartReference.dispose()). Now in\nI20050419-1200 the part is disposed before the widget.\n\nAbove comments are valid for any text-based editor, maybe even for any workbench\npart.\n\nFixing XMLSourcePage.dispose() was a good idea in any case but I think this bug\nshould be reopened and moved to Platform UI to investigate whether the change\nwas intended. Other clients might be broken by this life-cycle change as well.\n\nNick please do so, if you think I\u0027m right. Thanks.\n",
    "Reopening as per Dani\u0027s suggestion.\nStefan, can you comment on the change to the ordering of dispose?\nIt seems very risky to change this at this point.\n",
    "IWorkbenchPart.dispose() states:\n\n     * This is the last method called on the \u003ccode\u003eIWorkbenchPart\u003c/code\u003e.  At this\n     * point the part controls (if they were ever created) have been disposed as\npart \n     * of an SWT composite.  There is no guarantee that createPartControl() has\nbeen \n     * called, so the part controls may never have been created.\n\nNote that the optional creation of the controls no longer occurs (since at least\n3.0).  If the part is instantiated, its controls are created.\nBut the controls should still be disposed before the part.\n\n",
    "Agreed: the old disposal order was correct. This is a major bug.",
    "Created an attachment (id\u003d20169)\nPatch for o.e.ui.tests\n\nAdds regression tests for the timing of widget disposal and\nsetInitializationData",
    "Fixed in head",
    "As a workaround for this bug, I had reversed an order of disposal in the PDE \neditors.  Do I need to undo the reversal now?",
    "No. This was not a workaround but actually the correct code ;-)",
    "*** Bug 92552 has been marked as a duplicate of this bug. ***",
    "Verified in I20050510-0010"
  ],
  "commentCreationDates": [
    "2005-04-20T04:32:46+02:00",
    "2005-04-20T05:41:11+02:00",
    "2005-04-20T11:32:56+02:00",
    "2005-04-20T12:27:09+02:00",
    "2005-04-20T12:53:10+02:00",
    "2005-04-20T13:12:06+02:00",
    "2005-04-20T15:43:40+02:00",
    "2005-04-20T15:49:40+02:00",
    "2005-04-21T05:47:53+02:00",
    "2005-04-21T06:59:46+02:00",
    "2005-04-21T07:29:08+02:00",
    "2005-04-21T15:21:24+02:00",
    "2005-04-21T15:28:22+02:00",
    "2005-04-25T10:15:35+02:00",
    "2005-05-11T04:59:08+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Argument not valid      [java]",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2924"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "92019",
      "date": "2005-04-20T04:32:46+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "major"
    }
  ],
  "groupId": "92019",
  "bugId": "92019",
  "date": "2005-04-20T04:32:46+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "major"
}