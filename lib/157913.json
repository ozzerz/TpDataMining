{
  "comments": [
    "Affiliation: IBM\n\nThis is a hot bug because it is a regression; this worked in WTP 1.0.2\n\nOur headless tool imports an ear file as a project, and projects are created for any contained ejb jar files, but any other files are left as binary jars/wars etc. in the ear project.\n\nThe tool needs to update the manifest classpaths of any of these binary modules which contain ejb refs.  The tool finds the refs by calling\n\n    \tearFile \u003d (EARFile)earEdit.asArchive(true);\n    \tejbRefsMap \u003d earFile.getEJBReferences(true, false);\n\nand it then uses common archive to update the binary modules.\n\nThis worked in WTP 1.0.2, but in WTP 1.5, an error is reported when we try to save the changes we have made:\n\norg.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureException: IWAE0017E Unable to replace original archive: C:\\eclipse\\ws\\runtime-ejbdeploy\\1d941be5\\EarContent\\TransferJMSClient.jar\n\tat org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.cleanupAfterTempSave(ArchiveImpl.java:322)\n\tat org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.saveAsNoReopen(ArchiveImpl.java:1182)\n\tat org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.saveNoReopen(ArchiveImpl.java:1206)\n\nAfter setting breakpoints at various locations in common archive, it looks like the call to earFile.getEJBReferences(true, false) is leaving the archive open, which is causing this error.",
    "Jason can you take a look?",
    "This bug is because the EAR file is opening archives for the modules.  When the EAR file is closed the file locks on the modules will also be closed.  This is working as designed.  I spoke with John and suggested a workaround to fix his code.",
    "closing."
  ],
  "commentCreationDates": [
    "2006-09-19T23:51:24+02:00",
    "2006-09-19T23:56:27+02:00",
    "2006-09-20T20:03:40+02:00",
    "2006-09-26T21:20:22+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureException",
      "message": "IWAE0017E Unable to replace original archive: C:\\eclipse\\ws\\runtime-ejbdeploy\\1d941be5\\EarContent\\TransferJMSClient.jar",
      "elements": [
        {
          "method": "org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.cleanupAfterTempSave",
          "source": "ArchiveImpl.java:322"
        },
        {
          "method": "org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.saveAsNoReopen",
          "source": "ArchiveImpl.java:1182"
        },
        {
          "method": "org.eclipse.jst.j2ee.commonarchivecore.internal.impl.ArchiveImpl.saveNoReopen",
          "source": "ArchiveImpl.java:1206"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "157913",
      "date": "2006-09-19T23:51:24+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "normal"
    }
  ],
  "groupId": "157913",
  "bugId": "157913",
  "date": "2006-09-19T23:51:24+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "normal"
}