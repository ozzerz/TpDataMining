{
  "comments": [
    "Hi...\n\nI got one question regarding org.eclipse.core.runtime.jobs.Job and org.eclipse.equinox.registry. While I issued a feature distribution job from DM server, the feature did installed in client side successfully, but follow-up exception will appear. Could you please help me identify what\u0027s wrong it is ? If I missed anything?\nThanks a lot.\n\nThe exception is as below: \norg.eclipse.osgi SEVERE: An unexpected runtime error has occurred.\njava.lang.NoClassDefFoundError: org.eclipse.core.runtime.jobs.Job\n\tat java.lang.ClassLoader.defineClassImpl(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:246)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass(DefaultClassLoader.java:160)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass(ClasspathManager.java:498)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl(ClasspathManager.java:468)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl(ClasspathManager.java:427)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:410)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:188)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:339)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:391)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:352)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:83)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:582)\n\tat org.eclipse.core.internal.registry.osgi.EquinoxRegistryStrategy.scheduleChangeEvent(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.fireRegistryChangeEvent(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.add(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.addContribution(Unknown Source)\n\tat org.eclipse.core.internal.registry.osgi.EclipseBundleListener.addBundle(Unknown Source)\n\tat org.eclipse.core.internal.registry.osgi.EclipseBundleListener.bundleChanged(Unknown Source)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:1206)\n\tat org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:189)\n\tat org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:141)\n\tat org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged(Framework.java:1481)\n\tat org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1432)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl.processDelta(PackageAdminImpl.java:420)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl.doResolveBundles(PackageAdminImpl.java:194)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl$1.run(PackageAdminImpl.java:140)\n\tat java.lang.Thread.run(Thread.java:823)\n\norg.eclipse.equinox.registry SEVERE: FrameworkEvent.ERROR\njava.lang.NoClassDefFoundError: org.eclipse.core.runtime.jobs.Job\n\tat java.lang.ClassLoader.defineClassImpl(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:246)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass(DefaultClassLoader.java:160)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass(ClasspathManager.java:498)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl(ClasspathManager.java:468)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl(ClasspathManager.java:427)\n\tat org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:410)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:188)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:339)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:391)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:352)\n\tat org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:83)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:582)\n\tat org.eclipse.core.internal.registry.osgi.EquinoxRegistryStrategy.scheduleChangeEvent(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.fireRegistryChangeEvent(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.add(Unknown Source)\n\tat org.eclipse.core.internal.registry.ExtensionRegistry.addContribution(Unknown Source)\n\tat org.eclipse.core.internal.registry.osgi.EclipseBundleListener.addBundle(Unknown Source)\n\tat org.eclipse.core.internal.registry.osgi.EclipseBundleListener.bundleChanged(Unknown Source)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:1206)\n\tat org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:189)\n\tat org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:141)\n\tat org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged(Framework.java:1481)\n\tat org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1432)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl.processDelta(PackageAdminImpl.java:420)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl.doResolveBundles(PackageAdminImpl.java:194)\n\tat org.eclipse.osgi.framework.internal.core.PackageAdminImpl$1.run(PackageAdminImpl.java:140)\n\tat java.lang.Thread.run(Thread.java:823)",
    "Could you describe what\u0027s in the executable - what are the bundles included in the application and how you launch it (osgi.bundles contents)?\n\n(If you are running some sub-set of Eclipse runtime, the problem is likely related to the usage of EquinoxRegistryStrategy. This startegy needs a few Eclipse-specific things to work properly. Mainly it needs the Eclipse OSGi plugin installed and started, and, if I remember correctly, few environment variables set.)\n",
    "The base code is eRCP RC1 (available at www.eclipse.org/ercp). Here is the config.ini we are using:\n\nosgi.bundles\u003dorg.eclipse.equinox.common@2:start, org.eclipse.update.configurator@3:start, org.eclipse.core.runtime@start, com.ibm.rcp.osgiagent.scheduler@start, org.eclipse.osgi.services@start, org.eclipse.equinox.registry@2:start, com.ibm.osg.service.cm@start, org.eclipse.ercp.swt@3:start, org.eclipse.equinox.log@start\nosgi.bundles.defaultStartLevel\u003d4\n\n\n##embedded options\n#the XML parser\nosgi.framework.extensions\u003dorg.eclipse.ercp.xml, org.eclipse.ercp.xmlParserAPIs, com.ibm.jxesupport, com.ibm.rcp.internal.frameworkhook\n#No locking required if only one instance of OSGi running on a given configuration\nosgi.locking\u003dnone\n#Use reliableFiles for critical data\nosgi.useReliableFiles\u003dtrue\n#Clean any temp files from file system\nosgi.embedded.cleanTempFiles\u003dtrue\n#allow standalone, run w/o core.runtime\nosgi.standalone\u003dtrue\n#enable stateSaver outside of shutdown, bug #106393\neclipse.enableStateSaver\u003dtrue\n#don\u0027t register optional eclipse services that eRCP doesn\u0027t need\neclipse.minimalRuntimeServices\u003dtrue\n#don\u0027t register optional eclipse services for OSGi only\n#eclipse.minimalServices\u003dtrue\n\n#set these for quicker startup performance, eg. PPC\n#osgi.configuration.area.default\u003dfile:/eRCP/configuration/\n#osgi.user.area.default\u003dfile:/My Documents/user/\n#osgi.instance.area.default\u003dfile:/workspace/\n#osgi.install.area\u003d\\eRCP\n\n#skip the system bundle check for updated framework at startup, must be false if org.eclipse.osgi has been updated\n#osgi.skipSystemBundleStartupCheck\u003dtrue\n\n# The build identifier\neclipse.buildId\u003deRCP-v20060828-1907\n\njava.specification.version\u003dJCLDEVICE-1.0\n\neof\u003deof\nosgi.os\u003dwin32\nosgi.ws\u003dwin32\nosgi.name\u003dEclipse\nosgi.hook.configurators.exclude\u003dorg.eclipse.core.runtime.internal.adaptor.EclipseLogHook\n\nJVM\u003d\\\\eclipse\\\\plugins\\\\com.ibm.pvc.wece.device.win32.arm_6.1.0\\\\jre\\\\bin\\\\j9.exe\nJVM_PROFILE\u003d-jcl\\:max\nJVM_ARG\u003d-Xint -Dcom.ibm.oti.nio.ignoreLocking\\\u003dtrue \"-Dorg.eclipse.ercp.update.runtimeName\\\u003dLotus Expeditor\"\nosgi.arch\u003darm\n",
    "Notice that org.eclipse.core.runtime.jobs is not included on the osgi.bundles list.  The org.eclipse.equinox.registry imports some packages from jobs using the resolution:\u003d\"optional\" directive.  Does the registry not work without jobs?\n\nThere may also be an issue if jobs is installed later by org.eclipse.update.configurator.  The registry will not be bound to the jobs package until it is refreshed.\n\nSeems like your osgi.bundles list has an awefully lot of bundles on it:\n\nosgi.bundles\u003d\n org.eclipse.equinox.common@2:start,\n org.eclipse.update.configurator@3:start,\n org.eclipse.core.runtime@start,\n com.ibm.rcp.osgiagent.scheduler@start,\n org.eclipse.osgi.services@start,\n org.eclipse.equinox.registry@2:start,\n com.ibm.osg.service.cm@start,\n org.eclipse.ercp.swt@3:start,\n org.eclipse.equinox.log@start\n\nCan you have some of these bundles be installed by update.configurator instead?  I think you can safely remove registry and swt from the list and have them be installed with the rest of your bundles.  This will allow the registry to be installed at the same time jobs is installed.  Your other option is to add org.eclipse.core.jobs to the osgi.bundles list.\n\nActually that is something we need you to confirm, do you have org.eclipse.core.jobs included in your configuration?",
    "One way to check the state of bundles:\n- run with \"-console\" as a program argument;\n- type \"ss\" in the console window\n- attach the output\n- type \"diag org.eclipse.core.jobs\" in the console window\n- copy the output\n\nI second the suggestion to think about osgi.bundles. Here is the line that 3.2 is using:\nosgi.bundles\u003d\n org.eclipse.equinox.common@2:start, \n org.eclipse.update.configurator@3:start, \n org.eclipse.core.runtime@start\n\nRegistry in this case is started by the runtime.\n",
    "Eric, please try Oleg\u0027s debug suggestion. You can also try adding the jobs bundle to osgi.bundles to see if that helps. You can also try removing registry and let update configurator start it together with jobs.\n\nTom is right that we have a lot of bundles listed for early startup. I know some of these were added to resolve problems. For instance, plugins with DLLs have a better chance of getting address space for the DLLs if they load early. I don\u0027t recall the reasons for the others though. We should probably collect this information for future reference and look for ways to resolve these w/o early startup. Please poll the team to collect this information and send it to me. Thanks.",
    "Yes, I would suggest to try to remove the registry bundle from the osgi.bundles; it should be picked up automatically by the configurator and activated by the runtime.\n\n\n",
    "Thank you all. yes, our build lacks of org.eclipse.core.runtime.jobs active mechanism. The fix is included in our build. Thanks "
  ],
  "commentCreationDates": [
    "2006-09-15T18:16:17+02:00",
    "2006-09-15T19:18:24+02:00",
    "2006-09-15T20:55:47+02:00",
    "2006-09-15T21:23:53+02:00",
    "2006-09-15T21:33:13+02:00",
    "2006-09-15T21:44:07+02:00",
    "2006-09-15T22:04:07+02:00",
    "2006-09-27T05:34:15+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org.eclipse.core.runtime.jobs.Job",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClassImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:246"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass",
          "source": "DefaultClassLoader.java:160"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass",
          "source": "ClasspathManager.java:498"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl",
          "source": "ClasspathManager.java:468"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl",
          "source": "ClasspathManager.java:427"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass",
          "source": "ClasspathManager.java:410"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass",
          "source": "DefaultClassLoader.java:188"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:339"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:391"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:352"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass",
          "source": "DefaultClassLoader.java:83"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:582"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EquinoxRegistryStrategy.scheduleChangeEvent",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.fireRegistryChangeEvent",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.add",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.addContribution",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EclipseBundleListener.addBundle",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EclipseBundleListener.bundleChanged",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent",
          "source": "BundleContextImpl.java:1206"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent",
          "source": "EventManager.java:189"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous",
          "source": "ListenerQueue.java:141"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged",
          "source": "Framework.java:1481"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent",
          "source": "Framework.java:1432"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl.processDelta",
          "source": "PackageAdminImpl.java:420"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl.doResolveBundles",
          "source": "PackageAdminImpl.java:194"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl$1.run",
          "source": "PackageAdminImpl.java:140"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:823"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "157497",
      "date": "2006-09-15T18:16:17+02:00",
      "product": "Equinox",
      "component": "Bundles",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.NoClassDefFoundError",
      "message": "org.eclipse.core.runtime.jobs.Job",
      "elements": [
        {
          "method": "java.lang.ClassLoader.defineClassImpl",
          "source": "Native Method"
        },
        {
          "method": "java.lang.ClassLoader.defineClass",
          "source": "ClassLoader.java:246"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineClass",
          "source": "DefaultClassLoader.java:160"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass",
          "source": "ClasspathManager.java:498"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl",
          "source": "ClasspathManager.java:468"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl",
          "source": "ClasspathManager.java:427"
        },
        {
          "method": "org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass",
          "source": "ClasspathManager.java:410"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass",
          "source": "DefaultClassLoader.java:188"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:339"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:391"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:352"
        },
        {
          "method": "org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass",
          "source": "DefaultClassLoader.java:83"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:582"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EquinoxRegistryStrategy.scheduleChangeEvent",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.fireRegistryChangeEvent",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.add",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.ExtensionRegistry.addContribution",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EclipseBundleListener.addBundle",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.internal.registry.osgi.EclipseBundleListener.bundleChanged",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent",
          "source": "BundleContextImpl.java:1206"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent",
          "source": "EventManager.java:189"
        },
        {
          "method": "org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous",
          "source": "ListenerQueue.java:141"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged",
          "source": "Framework.java:1481"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent",
          "source": "Framework.java:1432"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl.processDelta",
          "source": "PackageAdminImpl.java:420"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl.doResolveBundles",
          "source": "PackageAdminImpl.java:194"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.PackageAdminImpl$1.run",
          "source": "PackageAdminImpl.java:140"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:823"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "157497",
      "date": "2006-09-15T18:16:17+02:00",
      "product": "Equinox",
      "component": "Bundles",
      "severity": "normal"
    }
  ],
  "groupId": "157497",
  "bugId": "157497",
  "date": "2006-09-15T18:16:17+02:00",
  "product": "Equinox",
  "component": "Bundles",
  "severity": "normal"
}