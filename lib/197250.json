{
  "comments": [
    "Build ID: I20070625-1500\n\nSteps To Reproduce:\n1.In a plugin, add an extension to the point org.eclipse.help.contexts. In the referenced xml file, use an empty description like that : \u003cdescription\u003e\u003c/description\u003e in the description of your context\n2. Associate this context with a widget of your choice\n3. Launch eclipse, put the focus on the chosen widget\n4. Press F1\n5. In the error log you have a stak like the one in the \"More information field\n\n\nMore information:\nThe stack : \njava.lang.NullPointerException\nat org.eclipse.help.internal.context.Context.getText(Context.java:88)\nat org.eclipse.help.internal.context.Context.\u003cinit\u003e(Context.java:39)\nat org.eclipse.help.internal.context.ContextManager.getContext(ContextManager.java:81)\nat org.eclipse.help.HelpSystem.getContext(HelpSystem.java:49)\nat org.eclipse.ui.internal.help.WorkbenchHelpSystem.displayHelp(WorkbenchHelpSystem.java:921)\n\nThis happends becomes the code of the help plugin does not protect itself form that case.\n\nThe patch :\nIn Class org.eclipse.help.internal.context.Context, in method String getText() at line 88 replace the line :\n\nif (text.getNodeType() \u003d\u003d Node.TEXT_NODE) {\n\nby :\n\nif ((text !\u003d null ) \u0026\u0026 (text.getNodeType() \u003d\u003d Node.TEXT_NODE)) {\n\nWorkaround :\n - remove the tag description\n - put a space between the opening and closing description tag (probably not a good way since I suppose the descption is not shown with the first workaround and is with this one \u003d\u003e need check)",
    "I get NPEs with both Denis\u0027 workarounds.\n\nIs the description tag required now?\n\nThe documentation doesn\u0027t say so.\nPlatform Plug-in Developer Guide \u003e Reference \u003e Extension Points Reference \u003e org.eclipse.help.contexts:\n\u003c!ELEMENT context (description?,topic*) \u003e\n\nPlatform Plug-in Developer Guide \u003e Programmer\u0027s Guide \u003e User assistance support \u003e Help \u003e Context-sensitive help \u003e Describing and packaging context-sensitive help content:\n\"... Each context element can have an optional \u003cdescription\u003e element which is used to describe the UI object ...\"",
    "Pierre is right, \n\nIf there is no description, it is added somewhere in code and empty in the DOM tree\nIf the description only contains a space, the DOM Text Node is removed by the line node.normalize(); in org.eclipse.help.internal.context.Context.getText() at line 86\n\nAs a consequence the tag description is now mandatory as opposed to what is described in the DTD fragment of the documentation.",
    "This seems to be a regression - the documentation states that the description is optional. Targeting 3.4, if the fix is low risk I will include it in  Eclipse 3.3.1 also.",
    "Created an attachment (id\u003d74376)\nProposed patch\n\nHere\u0027s a patch which fixes the NPE and allows the context help to display without writing any errors to the log for either a missing or empty description. \n\nI found myself in full agreement with the original description, but was surprised by comments 1 and 2. For me Denis\u0027s workaround worked fine and the code change he made is very similar to the patch I just created.",
    "(In reply to comment #4)\n\u003e I found myself in full agreement with the original description, but was\n\u003e surprised by comments 1 and 2. For me Denis\u0027s workaround worked fine and the\n\u003e code change he made is very similar to the patch I just created.\n\nHi Chris,\nthe workarounds I was referring to in comment #1 were the ones involving the modification of the xml contexts files, ie:\n- remove the tag description\nor\n- put a space between the opening and closing description tag\n\nI didn\u0027t try applying Denis\u0027 patch. Was that the misunderstanding?\n",
    "OK that clarifies things a little.\n\nHere\u0027s what I observed using Eclipse 3.3.\n\nNo description - fails with NPE.\nEmpty Description - writes an error message to the log but no NPE\nSingle space as description - seems to work\n\nThe patch makes all three cases work, I have committed this to head and will also apply to the 3.3 maintenance stream.",
    "Fixed in 3.3 Maintenance stream.",
    "Chris,\n\nI made the same observation as you did with a *brand new* workspace.\nWith one on which the bug had manifested itself, the workaround of the space stopped to work.\nI think your patch solves the problem in both cases.\nThanks for the quick fix.\n",
    "*** Bug 199306 has been marked as a duplicate of this bug. ***",
    "*** Bug 202675 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2007-07-20T09:31:43+02:00",
    "2007-07-20T15:02:47+02:00",
    "2007-07-23T14:04:44+02:00",
    "2007-07-23T17:57:36+02:00",
    "2007-07-23T19:44:55+02:00",
    "2007-07-24T09:49:21+02:00",
    "2007-07-24T20:12:58+02:00",
    "2007-07-24T20:36:06+02:00",
    "2007-07-25T11:16:03+02:00",
    "2007-08-10T19:01:07+02:00",
    "2007-09-11T23:58:08+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.help.internal.context.Context.getText",
          "source": "Context.java:88"
        },
        {
          "method": "org.eclipse.help.internal.context.Context.\u003cinit\u003e",
          "source": "Context.java:39"
        },
        {
          "method": "org.eclipse.help.internal.context.ContextManager.getContext",
          "source": "ContextManager.java:81"
        },
        {
          "method": "org.eclipse.help.HelpSystem.getContext",
          "source": "HelpSystem.java:49"
        },
        {
          "method": "org.eclipse.ui.internal.help.WorkbenchHelpSystem.displayHelp",
          "source": "WorkbenchHelpSystem.java:921"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "197250",
      "date": "2007-07-20T09:31:43+02:00",
      "product": "Platform",
      "component": "User Assistance",
      "severity": "major"
    }
  ],
  "groupId": "197250",
  "bugId": "197250",
  "date": "2007-07-20T09:31:43+02:00",
  "product": "Platform",
  "component": "User Assistance",
  "severity": "major"
}