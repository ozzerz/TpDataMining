{
  "comments": [
    "I am running on top of some plugins that are on top of the 01/25 \nWorkbench 2.0 driver.  We are migrating from Workbench 1.0 to\nWorkbench 2.0.  I am getting an ArrayIndexOutOfBoundsException.  I have an\neditor (MultiPageEditorPart) which is registered to open on .egl files.  I\ncan open the editor fine, but when I try to close the last tab of the\nfolder, I get this exception.  What makes this problem particularly bad is\nthe runtime Workbench closes with no warning when it happens.  It only\nhappens when closing the last tab.  If I give the last tab focus first and\nthen close the tab, there is no problem.  It looks like focus is being\ngiven to the page which was just removed.\n\nThe problem happens in org.eclipse.swt.custom.CTabFolder:\n\nprivate void redrawTabArea(int index) {\n      int x \u003d 0, y \u003d 0, width \u003d 0, height \u003d 0;\n      if (index \u003d\u003d -1) {\n            Rectangle area \u003d super.getClientArea();\n            if (area.width \u003d\u003d 0 || area.height \u003d\u003d 0) return;\n            width \u003d area.x + area.width - borderLeft - borderRight;\n            height \u003d getTabHeight() + 1; // +1 causes top line between\ncontent and tabs to be redrawn\n            x \u003d area.x + borderLeft;\n            y \u003d area.y + borderTop;\n            if (onBottom) {\n                  y \u003d Math.max(0, area.y + area.height - borderBottom -\nheight);\n            }\n      } else {\n            CTabItem item \u003d items[index];  \u003c\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nIn my case index is 2 (0 based), but there are only 2 pages left (the third\nwas just removed).  Looking at the debug stack, it looks like a native\nmethod is called\n      at org.eclipse.swt.widgets.Control.WM_SETFOCUS(Control.java:3638)\n      at org.eclipse.swt.widgets.Control.windowProc(Control.java:2666)\n      at org.eclipse.swt.widgets.Display.windowProc(Display.java:1799)\n      at org.eclipse.swt.internal.win32.OS.ShowWindow(Native Method)\n\u003c\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n      at org.eclipse.swt.widgets.Control.setVisible(Control.java:2193)\nand then I am seeing setFocus call (coming from the native call???)\n\nI haven\u0027t had a chance to reproduce this on plain WSWB without all my\nrequired plugins. Before I do so, can you tell me if this problem\nlooks like a defect in WSWB, or is it due to one of\nthe plugins I\u0027m dependent upon misusing the framework?\nThe runtime Workbench is using JRE 1.4.\n\nI have coded a temp work around to always have an invisible last page which\ncan not be closed.  The workaround is effective, but ugly.  It does show\nthrough to the user when the pointer hovers over the invisible tab.  At\nthis time, since I have a workaround, I would classify this as a severity 3\nproblem.  However, it needs to be fixed before shipping our product.  We\nare currently looking at an end of April code cut-off.  A fix would be\nappreciated well before this so we can make sure it works for us.\nThanks!!!\n\n--------------------------------------------------------------------------------\n--------------------------------------------------------------------------------\n-----------------------\n\nLog: Mon Feb 11 06:52:47 EST 2002\n1 org.eclipse.core.resources 4 Unhandled exception caught in event loop.\nLog: Mon Feb 11 06:52:47 EST 2002\n4 org.eclipse.ui 0 Failed to execute runnable\n(java.lang.NullPointerException)\norg.eclipse.swt.SWTException: Failed to execute runnable\n(java.lang.NullPointerException)\n      at org.eclipse.swt.SWT.error(SWT.java:1887)\n      at\norg.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:96)\n      at\norg.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:1390)\n      at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1208)\n      at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:844)\n      at org.eclipse.ui.internal.Workbench.run(Workbench.java:827)\n      at\norg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:87\n8)\n      at org.eclipse.core.boot.BootLoader.run(BootLoader.java:321)\n      at SlimLauncher.main(SlimLauncher.java:14)\nLog: Mon Feb 11 06:58:57 EST 2002\n1 org.eclipse.core.resources 4 Unhandled exception caught in event loop.\nLog: Mon Feb 11 06:58:57 EST 2002\n4 org.eclipse.ui 0 java.lang.ArrayIndexOutOfBoundsException\njava.lang.ArrayIndexOutOfBoundsException\n      at\norg.eclipse.swt.custom.CTabFolder.redrawTabArea(CTabFolder.java:906)\n      at org.eclipse.swt.custom.CTabFolder.onFocus(CTabFolder.java:522)\n      at\norg.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:176)\n      at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:74)\n      at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:841)\n      at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:827)\n      at org.eclipse.swt.widgets.Control.WM_SETFOCUS(Control.java:3638)\n      at org.eclipse.swt.widgets.Control.windowProc(Control.java:2666)\n      at org.eclipse.swt.widgets.Display.windowProc(Display.java:1799)\n      at org.eclipse.swt.internal.win32.OS.ShowWindow(Native Method)\n      at org.eclipse.swt.widgets.Control.setVisible(Control.java:2193)\n      at org.eclipse.swt.custom.CTabFolder.destroyItem(CTabFolder.java:455)\n      at org.eclipse.swt.custom.CTabItem.dispose(CTabItem.java:50)\n      at\norg.eclipse.ui.part.MultiPageEditorPart.removePage(MultiPageEditorPart.java:425)\n      at\ncom.ibm.etools.egl.parteditor.EGLPartEditor.removeViewer(EGLPartEditor.java:1517\n)\n      at\ncom.ibm.etools.egl.parteditor.EGLPartEditor.removeViewer(EGLPartEditor.java:1548\n)\n      at\ncom.ibm.etools.egl.parteditor.EGLPartEditor$2.itemClosed(EGLPartEditor.java:604)\n      at org.eclipse.swt.custom.CTabFolder.closeNotify(CTabFolder.java:275)\n      at org.eclipse.swt.custom.CTabFolder.access$12(CTabFolder.java:265)\n      at\norg.eclipse.swt.custom.CTabFolder$4.handleEvent(CTabFolder.java:394)\n      at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:74)\n      at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:637)\n      at\norg.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1413)\n      at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1205)\n      at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:844)\n      at org.eclipse.ui.internal.Workbench.run(Workbench.java:827)\n      at\norg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:87\n8)\n      at org.eclipse.core.boot.BootLoader.run(BootLoader.java:321)\n      at SlimLauncher.main(SlimLauncher.java:14)",
    "I believe this bug is fixed.  Are you still working with your workaround?\n\nSignificant changes were made to CTabFolder for the post M5 build (As of today, \nApril 16 2002 it is not included in any build but the changes should appear in \n20020418-I.\n\nCould you please try this problem again when this build becomes available and \nlet me know if I can close this report?\n\nThank you.",
    "No response from reporter.  Closing."
  ],
  "commentCreationDates": [
    "2002-02-12T20:56:36+01:00",
    "2002-04-16T22:45:49+02:00",
    "2002-05-27T22:19:40+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Failed to execute runnable (java.lang.NullPointerException)",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:1887"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:96"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:1390"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1208"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:844"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:827"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:87 8"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:321"
        },
        {
          "method": "SlimLauncher.main",
          "source": "SlimLauncher.java:14"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "9491",
      "date": "2002-02-12T20:56:36+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    },
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "org.eclipse.swt.custom.CTabFolder.redrawTabArea",
          "source": "CTabFolder.java:906"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onFocus",
          "source": "CTabFolder.java:522"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:176"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:74"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:841"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:827"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_SETFOCUS",
          "source": "Control.java:3638"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2666"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:1799"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.ShowWindow",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setVisible",
          "source": "Control.java:2193"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.destroyItem",
          "source": "CTabFolder.java:455"
        },
        {
          "method": "org.eclipse.swt.custom.CTabItem.dispose",
          "source": "CTabItem.java:50"
        },
        {
          "method": "org.eclipse.ui.part.MultiPageEditorPart.removePage",
          "source": "MultiPageEditorPart.java:425"
        },
        {
          "method": "com.ibm.etools.egl.parteditor.EGLPartEditor.removeViewer",
          "source": "EGLPartEditor.java:1517 "
        },
        {
          "method": "com.ibm.etools.egl.parteditor.EGLPartEditor.removeViewer",
          "source": "EGLPartEditor.java:1548 "
        },
        {
          "method": "com.ibm.etools.egl.parteditor.EGLPartEditor$2.itemClosed",
          "source": "EGLPartEditor.java:604"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.closeNotify",
          "source": "CTabFolder.java:275"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.access$12",
          "source": "CTabFolder.java:265"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$4.handleEvent",
          "source": "CTabFolder.java:394"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:74"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:637"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1413"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1205"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:844"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:827"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:87 8"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:321"
        },
        {
          "method": "SlimLauncher.main",
          "source": "SlimLauncher.java:14"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "9491",
      "date": "2002-02-12T20:56:36+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "9491",
  "bugId": "9491",
  "date": "2002-02-12T20:56:36+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}