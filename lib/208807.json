{
  "comments": [
    "Since AST supports stand-alone environments, it seems puzzling that JavaCore.getDefaultOptions() throws an exception when there is no workspace.\n\nThe actual culprit, as indicated by the stack trace below, is ResourcesPlugin.getWorkspace().  It is interesting to notice that the null check on JavaCore.getEncoding() doesn\u0027t do much (so a possible way of avoiding the exception is to change it to a try/catch).\n\nException in thread \"main\" java.lang.IllegalStateException: Workspace is closed.\n\tat org.eclipse.core.resources.ResourcesPlugin.getWorkspace(ResourcesPlugin.java:326)\n\tat org.eclipse.jdt.core.JavaCore.getEncoding(JavaCore.java:2893)\n\tat org.eclipse.jdt.internal.core.JavaModelManager.getDefaultOptions(JavaModelManager.java:1685)\n\tat org.eclipse.jdt.core.JavaCore.getDefaultOptions(JavaCore.java:2880)\n...",
    "Given that ResourcesPlugin.getWorkspace is like this:\n\n\tpublic static IWorkspace getWorkspace() {\n\t\tif (workspace \u003d\u003d null)\n\t\t\tthrow new IllegalStateException(Messages.resources_workspaceClosed);\n\t\treturn workspace;\n\t}\n\n\nIt seems impossible for the null guard in this code to ever have the intended consequence of returning the default encoding instead of the workspace charset.\n\n\tpublic static String getEncoding() {\n\t\t// Verify that workspace is not shutting down (see bug https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d60687)\n\t\tIWorkspace workspace \u003d ResourcesPlugin.getWorkspace();\n\t\tif (workspace !\u003d null) {\n\t\t\ttry {\n\t\t\t\treturn workspace.getRoot().getDefaultCharset();\n\t\t\t} catch (CoreException e) {\n\t\t\t\t// fails silently and return plugin global encoding if core exception occurs\n\t\t\t}\n\t\t}\n\t\treturn ResourcesPlugin.getEncoding();\n\t}",
    "Created an attachment (id\u003d82185)\nProposed patch\n\n",
    "Released for 3.4M4 in HEAD stream.\n",
    "Thanks!",
    "Verified for 3.4 M4 using build I20071210-1800"
  ],
  "commentCreationDates": [
    "2007-11-05T20:14:35+01:00",
    "2007-11-05T20:28:09+01:00",
    "2007-11-06T10:59:32+01:00",
    "2007-11-06T11:11:58+01:00",
    "2007-11-07T01:34:55+01:00",
    "2007-12-11T15:17:57+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "Workspace is closed.",
      "elements": [
        {
          "method": "org.eclipse.core.resources.ResourcesPlugin.getWorkspace",
          "source": "ResourcesPlugin.java:326"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getEncoding",
          "source": "JavaCore.java:2893"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getDefaultOptions",
          "source": "JavaModelManager.java:1685"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getDefaultOptions",
          "source": "JavaCore.java:2880"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "208807",
      "date": "2007-11-05T20:14:35+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "208807",
  "bugId": "208807",
  "date": "2007-11-05T20:14:35+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}