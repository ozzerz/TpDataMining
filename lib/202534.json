{
  "comments": [
    "Build ID: I20070625-1500\n\nSteps To Reproduce:\n1. Run the JDT.\n2. Launch a wizard: New \u003e Project.\n3. Choose \"Java Project\".\n4. Enter enough data to enable the \"Finish\" button.\n5. Bring up the dialog\u0027s help using the \"?\" button in the lower left.\n6. Press the \"Finish\" button.\n7. Proceed through any \"perspective\" dialog.\n\nAt this point the \"New Java Project\" dialog remains, but with white rectangles where the controls were.  The controls are redrawn when they are clicked on.\n\nMore information:\nI found this in my own Eclipse 3.3 project as well.  The following stack trace is printed when I come at the dialog via a cheat sheet:\n\n!ENTRY org.eclipse.ui 4 0 2007-09-06 14:29:33.445\n!MESSAGE Unhandled event loop exception\n!STACK 0\norg.eclipse.swt.SWTException: Graphic is disposed\n\tat org.eclipse.swt.SWT.error(SWT.java:3563)\n\tat org.eclipse.swt.SWT.error(SWT.java:3481)\n\tat org.eclipse.swt.SWT.error(SWT.java:3452)\n\tat org.eclipse.swt.graphics.Image.getBounds(Image.java:609)\n\tat org.eclipse.swt.widgets.Label.drawWidget(Label.java:163)\n\tat org.eclipse.swt.widgets.Widget.kEventControlDraw(Widget.java:1029)\n\tat org.eclipse.swt.widgets.Widget.controlProc(Widget.java:363)\n\tat org.eclipse.swt.widgets.Display.controlProc(Display.java:835)\n\tat org.eclipse.swt.internal.carbon.OS.StillDown(Native Method)\n\tat org.eclipse.swt.widgets.Display.runEnterExit(Display.java:3310)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2953)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\n\tat org.eclipse.jface.window.Window.open(Window.java:796)\n\tat org.eclipse.ui.internal.handlers.WizardHandler.execute(WizardHandler.java:146)\n\tat org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:239)\n\tat org.eclipse.core.commands.Command.executeWithChecks(Command.java:475)\n\tat org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:429)\n\tat org.eclipse.ui.internal.cheatsheets.CommandRunner.executeCommand(CommandRunner.java:83)\n\tat org.eclipse.ui.internal.cheatsheets.data.CheatSheetCommand.execute(CheatSheetCommand.java:44)\n\tat org.eclipse.ui.internal.cheatsheets.views.CoreItem.runExecutable(CoreItem.java:497)\n\tat org.eclipse.ui.internal.cheatsheets.views.CoreItem.runExecutable(CoreItem.java:492)\n\tat org.eclipse.ui.internal.cheatsheets.views.CheatSheetViewer.runPerformExecutable(CheatSheetViewer.java:1041)\n\tat org.eclipse.ui.internal.cheatsheets.views.CoreItem$1.linkActivated(CoreItem.java:89)\n\tat org.eclipse.ui.forms.widgets.AbstractHyperlink.handleActivate(AbstractHyperlink.java:228)\n\tat org.eclipse.ui.forms.widgets.ImageHyperlink.handleActivate(ImageHyperlink.java:177)\n\tat org.eclipse.ui.forms.widgets.AbstractHyperlink.handleMouseUp(AbstractHyperlink.java:316)\n\tat org.eclipse.ui.forms.widgets.AbstractHyperlink.access$2(AbstractHyperlink.java:300)\n\tat org.eclipse.ui.forms.widgets.AbstractHyperlink$4.handleEvent(AbstractHyperlink.java:119)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1495)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1519)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1504)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1295)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2952)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2389)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2353)\n\tat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2219)\n\tat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n\tat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:504)\n\tat org.eclipse.equinox.launcher.Main.basicRun(Main.java:443)\n\tat org.eclipse.equinox.launcher.Main.run(Main.java:1169)\n\tat org.eclipse.equinox.launcher.Main.main(Main.java:1144)\n\nI am using a Wizard with just one WizardPage.  If I don\u0027t add my wizard page in Wizard.addPages(), then the error does not occur.  If I comment out the code that constructs my wizard page, I still get the error.  Hence it seems that the offending label might be in the banner region of the wizard.",
    "I can\u0027t reproduce this on Windows.",
    "(In reply to comment #1)\n\u003e I can\u0027t reproduce this on Windows.\n\u003e \n\nWe only see this on the Mac.",
    "I have a possible fix for this. The problem is the following:\n\n1. When the user presses Finish or Cancel in a Wizard, then org.eclipse.jface.wizard.WizardDialog.hardClose() is called. This disposes of all wizards owned by the WizardDialog. The currentPage (owned by one of these wizards) then disposes of the wizard title bar image.\n2. org.eclipse.help.ui.internal.views.HelpTray has a dispose method which adds a one-time listener, to re-set the wizard shell size to be the size it was without the HelpTray.\n3. On the Mac, setting the shell size causes a redraw. Other platforms don\u0027t do this for some reason.\n4. This redraw tries to draw the wizard title bar image, which has already been disposed, but the wizard label was never informed that the image was disposed.\n\nThe solution:\nIn org.eclipse.jface.wizard.WizardDialog#hardClose(), after disposing of the wizards, set the title image to null. The code would look like:\n\nprivate boolean hardClose() {\n\t// inform wizards\n\tfor (int i \u003d 0; i \u003c createdWizards.size(); i++) {\n\t ...\n\t}\n\t// One of our wizards might have disposed of our title image,\n\t// so be sure to inform the title label.\n\tsetTitleImage(null);\n\treturn super.close();\n}\n"
  ],
  "commentCreationDates": [
    "2007-09-06T22:49:06+02:00",
    "2007-09-12T17:01:50+02:00",
    "2007-09-12T17:17:57+02:00",
    "2007-10-21T22:15:16+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Graphic is disposed",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3563"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3481"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3452"
        },
        {
          "method": "org.eclipse.swt.graphics.Image.getBounds",
          "source": "Image.java:609"
        },
        {
          "method": "org.eclipse.swt.widgets.Label.drawWidget",
          "source": "Label.java:163"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.kEventControlDraw",
          "source": "Widget.java:1029"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.controlProc",
          "source": "Widget.java:363"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.controlProc",
          "source": "Display.java:835"
        },
        {
          "method": "org.eclipse.swt.internal.carbon.OS.StillDown",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runEnterExit",
          "source": "Display.java:3310"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2953"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:820"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:796"
        },
        {
          "method": "org.eclipse.ui.internal.handlers.WizardHandler.execute",
          "source": "WizardHandler.java:146"
        },
        {
          "method": "org.eclipse.ui.internal.handlers.HandlerProxy.execute",
          "source": "HandlerProxy.java:239"
        },
        {
          "method": "org.eclipse.core.commands.Command.executeWithChecks",
          "source": "Command.java:475"
        },
        {
          "method": "org.eclipse.core.commands.ParameterizedCommand.executeWithChecks",
          "source": "ParameterizedCommand.java:429"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.CommandRunner.executeCommand",
          "source": "CommandRunner.java:83"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.data.CheatSheetCommand.execute",
          "source": "CheatSheetCommand.java:44"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.views.CoreItem.runExecutable",
          "source": "CoreItem.java:497"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.views.CoreItem.runExecutable",
          "source": "CoreItem.java:492"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.views.CheatSheetViewer.runPerformExecutable",
          "source": "CheatSheetViewer.java:1041"
        },
        {
          "method": "org.eclipse.ui.internal.cheatsheets.views.CoreItem$1.linkActivated",
          "source": "CoreItem.java:89"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.AbstractHyperlink.handleActivate",
          "source": "AbstractHyperlink.java:228"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.ImageHyperlink.handleActivate",
          "source": "ImageHyperlink.java:177"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.AbstractHyperlink.handleMouseUp",
          "source": "AbstractHyperlink.java:316"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.AbstractHyperlink.access$2",
          "source": "AbstractHyperlink.java:300"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.AbstractHyperlink$4.handleEvent",
          "source": "AbstractHyperlink.java:119"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1495"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1519"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:1504"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:1295"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3348"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2952"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2389"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2353"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2219"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:504"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:443"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1169"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1144"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "202534",
      "date": "2007-09-06T22:49:06+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "critical"
    }
  ],
  "groupId": "202534",
  "bugId": "202534",
  "date": "2007-09-06T22:49:06+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "critical"
}