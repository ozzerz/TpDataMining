{
  "comments": [
    "In the recent M8 + patches based AST builds, the following exception is \noccurring, blocking all of mapping:\n\njava.lang.IllegalStateException: Program Error: modelStateChanging was less \nthan zero\n\tat \norg.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.internalModelCha\nnged(AbstractStructuredModel.java:870)\n\tat \norg.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.changedModel\n(AbstractStructuredModel.java:391)\n\tat org.eclipse.wst.xml.core.internal.document.DOMModelImpl.changedModel\n(DOMModelImpl.java:165)\n\tat \norg.eclipse.wst.common.emfworkbench.internal.emf2xml.sse.EMF2DOMSSERenderer.setB\natchMode(EMF2DOMSSERenderer.java:413)\n\tat org.eclipse.jst.j2ee.ejb.internal.impl.EJBResourceImpl.setBatchMode\n(EJBResourceImpl.java:147)\n\tat com.ibm.etools.ejbrdbmapping.command.MapEditModel.\u003cinit\u003e\n(MapEditModel.java:65)\n\tat \ncom.ibm.etools.ejbrdbmapping.command.MapEditModelFactory.createEditModelForWrite\n(MapEditModelFactory.java:34)\n\tat \norg.eclipse.wst.common.internal.emfworkbench.edit.EditModelRegistry.createEditMo\ndelForWrite(EditModelRegistry.java:99)\n\tat \norg.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.createEditModel\nForWrite(EMFWorkbenchContext.java:199)\n\tat \norg.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelFor\nWrite(EMFWorkbenchContext.java:102)\n\tat \ncom.ibm.etools.ejbdeploy.core.utils.MappingUtil.getMappingEditModelForWrite\n(MappingUtil.java:42)\n\tat \ncom.ibm.etools.ejbrdbmapping.presentation.MappingWizard.initializeEditModel\n(MappingWizard.java:463)\n\tat com.ibm.etools.ejbrdbmapping.presentation.MappingWizard.init\n(MappingWizard.java:455)\n\tat \ncom.ibm.etools.ejbrdbmapping.action.CreateMappingAction.createAndOpenWizardDialo\ng(CreateMappingAction.java:65)\n\tat com.ibm.etools.ejbrdbmapping.action.CreateMappingAction.run\n(CreateMappingAction.java:113)\n\tat org.eclipse.ui.internal.PluginAction.runWithEvent\n(PluginAction.java:246)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection\n(ActionContributionItem.java:538)\n\tat org.eclipse.jface.action.ActionContributionItem.access$2\n(ActionContributionItem.java:488)\n\tat org.eclipse.jface.action.ActionContributionItem$5.handleEvent\n(ActionContributionItem.java:400)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench\n(Workbench.java:367)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run\n(IDEApplication.java:103)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:163)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n\tat org.eclipse.core.launcher.Main.run(Main.java:973)\n\tat org.eclipse.core.launcher.Main.main(Main.java:948)",
    "Forwarding to your team although we understand this API call may be misused by\ndefect originator.",
    "When initializing our edit model, calling setBatchMode(true) right before \nsetBatchMode(false) solves the problem.  Will also look into not doing a forced \nfalse, since the default setting is false.\n\nAll other uses of this api always does a:\nsetBatchMode(true)\n\u003cdo stuff\u003e\nsetBatchMode(false)\n\nSo the only problem to be looked into is why this error occurs if set false is \ncalled initially.  If that is the intended behaviour, then please cancel this \ndefect",
    "Yes, these methods are not well documented, or named, but the intent is to\nalwasy call in the following way: \n\nsetBatchMode(true);\ntry {\n \u003c do stuff \u003e\n}\nfinally {\n  setBatchMode(false); \n}\n\nthe finally is important because this is some \"thread locking\" code, \nand so is dangerous to call beginBatch without calling endBatch .. that\u0027s the\nsame reason we throw illegal state exception, to help \ncatch mis-paired use. For example, the paired batchmode calls can be \"nested\"\n... some code on \u003c do stuff \u003e might itself use same construct ... in which case\nyou might prematurely end someone\u0027s previoulsy \"beginBatch\" mode (or .. someone\ndo it to you :) \n\nChuck, can we rename those mthods to be clearer, without too much disruption this \nlate in R1? I\u0027d suggest beginBatchMode() and endBatchMode(). \n\n",
    "This is part of a mass update to close out all stale WTP resolved bugs from the 1.0.x and 1.5.0 timeframe.  If you feel this bug was closed inappropriately, please reopen.\n\nThanks, John Lanuti"
  ],
  "commentCreationDates": [
    "2005-11-01T01:13:33+01:00",
    "2005-11-01T16:31:11+01:00",
    "2005-11-01T18:28:16+01:00",
    "2005-11-12T06:31:28+01:00",
    "2006-11-28T20:59:46+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "Program Error: modelStateChanging was less  than zero",
      "elements": [
        {
          "method": "org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.internalModelChanged",
          "source": "AbstractStructuredModel.java:870"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.changedModel",
          "source": "AbstractStructuredModel.java:391"
        },
        {
          "method": "org.eclipse.wst.xml.core.internal.document.DOMModelImpl.changedModel",
          "source": "DOMModelImpl.java:165"
        },
        {
          "method": "org.eclipse.wst.common.emfworkbench.internal.emf2xml.sse.EMF2DOMSSERenderer.setBatchMode",
          "source": "EMF2DOMSSERenderer.java:413"
        },
        {
          "method": "org.eclipse.jst.j2ee.ejb.internal.impl.EJBResourceImpl.setBatchMode",
          "source": "EJBResourceImpl.java:147"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.command.MapEditModel.\u003cinit\u003e",
          "source": "MapEditModel.java:65"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.command.MapEditModelFactory.createEditModelForWrite",
          "source": "MapEditModelFactory.java:34"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.edit.EditModelRegistry.createEditModelForWrite",
          "source": "EditModelRegistry.java:99"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.createEditModelForWrite",
          "source": "EMFWorkbenchContext.java:199"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.EMFWorkbenchContext.getEditModelForWrite",
          "source": "EMFWorkbenchContext.java:102"
        },
        {
          "method": "com.ibm.etools.ejbdeploy.core.utils.MappingUtil.getMappingEditModelForWrite",
          "source": "MappingUtil.java:42"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.presentation.MappingWizard.initializeEditModel",
          "source": "MappingWizard.java:463"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.presentation.MappingWizard.init",
          "source": "MappingWizard.java:455"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.action.CreateMappingAction.createAndOpenWizardDialog",
          "source": "CreateMappingAction.java:65"
        },
        {
          "method": "com.ibm.etools.ejbrdbmapping.action.CreateMappingAction.run",
          "source": "CreateMappingAction.java:113"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.runWithEvent",
          "source": "PluginAction.java:246"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:538"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:400"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1699"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1663"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:367"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:163"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "114449",
      "date": "2005-11-01T01:13:33+01:00",
      "product": "Web Tools",
      "component": "wst.sse",
      "severity": "major"
    }
  ],
  "groupId": "114449",
  "bugId": "114449",
  "date": "2005-11-01T01:13:33+01:00",
  "product": "Web Tools",
  "component": "wst.sse",
  "severity": "major"
}