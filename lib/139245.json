{
  "comments": [
    "Using the 4/27 I-build\n\nJohn - sending your way - I\u0027m going to look at it more today...\n\nHere\u0027s the scenario:\n\n-create a dynamic web project and associate w/ an EAR\n-rename the web project (verify that refs in the component file, .project and application.xml are all updated)\n-rename it again (verify again), etc.\n-restart Eclipse\n-rename the web project and the following is triggered (nothing gets updated in the EAR):\n\n*** ERROR ***: Fri Apr 28 12:43:58 EDT 2006    java.lang.NullPointerException\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource(ModuleStructuralModel.java:192)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:204)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:101)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:437)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:466)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:909)\n    \tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getDeployedName(VirtualComponent.java:69)\n    \tat org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModuleDelegates(J2EEDeployableFactory.java:72)\n    \tat org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModule(J2EEDeployableFactory.java:56)\n    \tat org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModule(J2EEDeployableFactory.java:45)\n    \tat org.eclipse.wst.server.core.util.ProjectModuleFactoryDelegate.cacheModules(ProjectModuleFactoryDelegate.java:60)\n    \tat org.eclipse.wst.server.core.util.ProjectModuleFactoryDelegate.getModules(ProjectModuleFactoryDelegate.java:88)\n    \tat org.eclipse.wst.server.core.internal.ModuleFactory.getModules(ModuleFactory.java:133)\n    \tat org.eclipse.wst.server.core.ServerUtil.getModules(ServerUtil.java:247)\n    \tat org.eclipse.wst.server.core.ServerUtil.getModule(ServerUtil.java:47)\n    \tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorMetadata.computeMetadata(ProjectRefactorMetadata.java:85)\n    \tat org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.cacheDeletedProjectMetadata(ProjectRefactoringListener.java:124)\n    \tat org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.resourceChanged(ProjectRefactoringListener.java:111)\n    \tat org.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:280)\n    \tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n    \tat org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:274)\n    \tat org.eclipse.core.internal.events.NotificationManager.handleEvent(NotificationManager.java:258)\n    \tat org.eclipse.core.internal.resources.Workspace.broadcastEvent(Workspace.java:250)\n    \tat org.eclipse.core.internal.resources.Project.move(Project.java:789)\n    \tat org.eclipse.ui.actions.RenameResourceAction.invokeOperation(RenameResourceAction.java:379)\n    \tat org.eclipse.ui.actions.WorkspaceAction.execute(WorkspaceAction.java:134)\n    \tat org.eclipse.ui.actions.WorkspaceAction$1.execute(WorkspaceAction.java:295)\n    \tat org.eclipse.ui.actions.WorkspaceModifyOperation$1.run(WorkspaceModifyOperation.java:101)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.java:113)\n    \tat org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)",
    "note: all of the initial renames are unnecessary (they just work) - you can create the projects then restart and it will be triggered on the rename",
    "Couple other things to note after the failed rename:\n\n-the navigator view is hosed (shows non-matching resource tree of just icons, no names)\n-in the project explorer view, an icon for the old project name still appears",
    "John... line 192 should be:   \t\tif (res \u003d\u003d null || !res.isLoaded()) {",
    "Dropped fix",
    "The original NPE is gone, however, it looks like something more complex is going on here (the refactoring logic itself may be involved, not certain since it is executing correctly in other contexts...)\n\n-the rename operation executed right on startup is now failing to remove the references for the original component but is adding new refs\n-debugging into the code it looks like the IVirtualComponent created for the EAR is returning an empty array from getReferences(), however, a subsequent rename succeeds without problem\n-I tried first adding a module to that EAR after starting and then renaming an existing module and the project explorer showed both the old and none of the refactoring actions completed and the project explorer displayed both the new and old projects",
    "I think this may be due to something in the refactoring so I\u0027ll take it for now.",
    "Sending this back; although the refactoring use case (a call to retrieve this dependency data for a previously created project during a PRE_DELETE event) is clearly triggering this, I don\u0027t believe it is at fault and it does succeed for the case where the rename is executed for a project that has been created during the same session - here is some more info:\n\n-I am able to correctly detect that the EAR is one of the referencing components of the child module component (a web project in my tests)\n-A call to get the references for the IVirtualComponent created from the EAR\u0027s IProject is returning an empty array\n-I believe this is because of the NPE originally associated with the bug that is triggered when retrieving the Resource for the EAR project:\n\n...\n\tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource(ModuleStructuralModel.java:194)\n\tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:206)\n\tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:101)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:437)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:466)\n\tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:909)\n\tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.exists(VirtualComponent.java:91)\n\tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getReferences(VirtualComponent.java:306)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorMetadata$RefCachingVirtualComponent.\u003cinit\u003e(ProjectRefactorMetadata.java:288)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorMetadata.computeMetadata(ProjectRefactorMetadata.java:78)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorMetadata.computeDependentMetadata(ProjectRefactorMetadata.java:109)\n\tat org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.cacheDeletedProjectMetadata(ProjectRefactoringListener.java:127)\n\tat org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.resourceChanged(ProjectRefactoringListener.java:111)\n\tat org.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:280)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:274)\n\tat org.eclipse.core.internal.events.NotificationManager.handleEvent(NotificationManager.java:258)\n\tat org.eclipse.core.internal.resources.Workspace.broadcastEvent(Workspace.java:250)\n\tat org.eclipse.core.internal.resources.Project.move(Project.java:789)\n\tat org.eclipse.ui.actions.RenameResourceAction.invokeOperation(RenameResourceAction.java:379)\n\tat org.eclipse.ui.actions.WorkspaceAction.execute(WorkspaceAction.java:134)\n\tat org.eclipse.ui.actions.WorkspaceAction$1.execute(WorkspaceAction.java:295)\n\tat org.eclipse.ui.actions.WorkspaceModifyOperation$1.run(WorkspaceModifyOperation.java:101)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n\tat org.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.java:113)\n\tat org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:113)\n... \n\n-I believe that the resource retrieved from the new component URI should in fact be non-null since it exists in this project\n-debugging in the code is looks like the culprit is ProjectResourceSetImpl.getResource(URI, boolean): it is immediately returning null since \"isReleasing\" is set to true\n\nDefinitely let me know if you think the refactoring logic needs to be altered in this case.\n",
    "Actually the problem here, which is working as designed, is that for getReferences on VirtualComponent, we filter out any references which can\u0027t be resolved, so for this case, the target component no longer exists, so we ignore that referenced component and ignore that reference.  I added code to the addReference method to always verify the list is clean, that is, remove any obsolete references.  This will ensure the old .component referencedComponent instance is removed when you add the new one.\n\nThis is released for the 050406 WTP 1.5 RC2 build.",
    "hmmm, at the time the call was made, all of the relevant components still exist (i.e. it was during PRE_DELETE event handling); also, it worked in some contexts (i.e. if I executed the rename during the same session that the project was created) but not if the rename was executed after a shutdown/restart\n\ndoes the fact that the the EAR is correctly retrieved as a referencing component for the web project but not vice-versa fit into your understanding of things?\n\n\n",
    "Everything with the virtual components is still showing up as set up properly.  However, we try to get the underlying project in our exists() method and we call exists() on the target component when we retrieve references and at the time we get called, the project is already deleted.\n\nI am not sure why the session status matters in the ordering of events.",
    "Hmmm, why is the resource for the new component XML file returning null for the EAR project (which is not being renamed) in this case? - here\u0027s the stack for that:\n\norg.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource(ModuleStructuralModel.java:194)\n        at\norg.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:206)\n        at\norg.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:101)\n        at\norg.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:437)\n        at\norg.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:466)\n        at\norg.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:909)\n        at\norg.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.exists(VirtualComponent.java:91)\n        at\norg.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getReferences(VirtualComponent.java:306)",
    "Reopening this; both the EAR and web project in this case exist at the time the virtual component calls are made and therefore I think the call to retrieve the references for the EAR\u0027s IVirtualComponent should be returning an IVirtualReference for the web project.\n\nBased on earlier debugging, it looks like the VirtualComponent.exists() tests is failing due to a failure to load the Resource for the component xml file (rather than an issue with the project not existing) and that is due to ProjectResourceSetImpl.getResource(URI, boolean) returning before it called load() because \"isReleasing\" is set to true (this is getting set during the PRE_DELETE event for the project by ResourceSetWorkbenchSynchronizer; perhaps the restart is impacting the ordering of resource change listeners?). \n\nWhat happens now on the rename is that the project ref is not cleaned up (RemoveReferenceComponentOperation never populates the target project list because the ref is null - the component metadata does get cleaned up because of VirtualComponent.cleanUpReferences()). So, this issue needs to be resolved.\n\nHow to fix it? We can\u0027t control resource change listener ordering so I see a couple of options:\n\n1) Make VirtualComponent.getReferences() less restrictive in the type of filtering it performs for IVirtualComponent existence (since I can retrieve metadata directly from the \"non-existent\" virtual component it is somewhat inconsistent that it is getting filtered out in this case).\n\n2) We add a new IVirtualComponent.getReferences() method that accepts a boolean flag which allows the caller to get the full unfiltered set of refs (the no-arg method will have the current behavior).\n\nThoughts?",
    "Couple of other options:\n\n3) Change the logic in RemoveReferenceComponentOperation to attempt to delete the project ref if it exists regardless of whether the reference can be retrieved\n4) Add the necessary special purpose logic to the refactoring code under the assumption that the call to IVirtualComponent.getReferences() may not correctly return the refs (if there is other code that also calls getReferences() in such a context, this is much less desirable)\n\n#2 may be the most appealing option (note: RemoveReferenceComponentOperation would also need to use that altered call) ",
    "Ok, I guess need to debug and see why the project was null, I thought it was due to the delete, but it may be because of the loading issue you are reporting.\n\nThat aside, #2 does seem like the easiest and safest solution at this point. It does not add any performance costs or affect any other paths.  ",
    "Rob, I was also noticing what we are seeing seems to be a duplicate of https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d128491\n\nHave you seen that defect?",
    "Yeah, had seen that one go by but forgot about it; yes, this is due to the exact same issue (i.e. the  ResourceSetWorkBenchEditSynchronizer is hosing the refactoring listener by setting the isReleased flag) - if that one is fixed it will also fix this issue; note: the work-arounds are different if that can\u0027t be fixed so we should keep this one open as well. ",
    "This bug in JEM has been resolved, and supposedly made the integration build for 511 which WTP is now building with.  So, this defect should be fixed as well for WTP 1.5 RC3.",
    "Actually, now I see this exception:\n\n*** ERROR ***: Tue May 16 13:51:21 EDT 2006    Java Model Exception: Core Exception [code 380] The resource tree is locked for modifications.\n    \tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:796)\n    \tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:3016)\n    \tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:3032)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeFromClasspath(J2EEComponentClasspathUpdater.java:239)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeContainerFromModuleIfNecessary(J2EEComponentClasspathUpdater.java:209)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.updateModule(J2EEComponentClasspathUpdater.java:164)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdateModule(J2EEComponentClasspathUpdater.java:134)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdate(J2EEComponentClasspathUpdater.java:121)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.editModelChanged(J2EEComponentClasspathUpdater.java:111)\n    \tat org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.notifyListeners(GlobalComponentChangeNotifier.java:83)\n    \tat org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.editModelChanged(GlobalComponentChangeNotifier.java:43)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.notifyListeners(EditModel.java:305)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.resourceIsLoadedChanged(EditModel.java:681)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel$ResourceAdapter.notifyChanged(EditModel.java:109)\n    \tat org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:230)\n    \tat org.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.eNotify(ReferencedXMIResourceImpl.java:379)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.load(ResourceImpl.java:1109)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.load(ResourceImpl.java:895)\n    \tat org.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.load(TranslatorResourceImpl.java:378)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoad(ResourceSetImpl.java:249)\n    \tat org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.demandLoad(ProjectResourceSetImpl.java:83)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoadHelper(ResourceSetImpl.java:264)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.getResource(ResourceSetImpl.java:390)\n    \tat org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.getResource(ProjectResourceSetImpl.java:262)\n    \tat org.eclipse.wst.common.internal.emfworkbench.WorkbenchResourceHelper.getOrCreateResource(WorkbenchResourceHelper.java:307)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.getResource(EditModel.java:688)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource(ModuleStructuralModel.java:193)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:210)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:103)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:444)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:473)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:916)\n    \tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getReferences(VirtualComponent.java:294)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.update(J2EEComponentClasspathContainer.java:67)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.\u003cinit\u003e(J2EEComponentClasspathContainer.java:59)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathInitializer.initialize(J2EEComponentClasspathInitializer.java:22)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1900)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager$7.run(JavaModelManager.java:1846)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:1853)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1265)\n    \tat org.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1470)\n    \tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:2169)\n    \tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:2073)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessor.createExternalArchiveDelta(DeltaProcessor.java:734)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged(DeltaProcessor.java:1807)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged(DeltaProcessingState.java:444)\n    \tat org.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:280)\n    \tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n    \tat org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:274)\n    \tat org.eclipse.core.internal.events.NotificationManager.broadcastChanges(NotificationManager.java:148)\n    \tat org.eclipse.core.internal.resources.Workspace.broadcastPostChange(Workspace.java:256)\n    \tat org.eclipse.core.internal.resources.Workspace.checkpoint(Workspace.java:305)\n    \tat org.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run(PerformChangeOperation.java:237)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1719)\n    \tat org.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange(PerformChangeOperation.java:280)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.access$1(UIPerformChangeOperation.java:1)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$1.run(UIPerformChangeOperation.java:66)\n    \tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$2.run(UIPerformChangeOperation.java:84)\n    \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n    \tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n    \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3325)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971)\n    \tat org.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:158)\n    \tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:326)\n    \tat org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run(RefactoringWizardDialog2.java:304)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizard.internalPerformFinish(RefactoringWizard.java:545)\n    \tat org.eclipse.ltk.ui.refactoring.UserInputWizardPage.performFinish(UserInputWizardPage.java:154)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizard.performFinish(RefactoringWizard.java:611)\n    \tat org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.okPressed(RefactoringWizardDialog2.java:433)\n    \tat org.eclipse.jface.dialogs.Dialog.buttonPressed(Dialog.java:508)\n    \tat org.eclipse.jface.dialogs.Dialog$3.widgetSelected(Dialog.java:660)\n    \tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:90)\n    \tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n    \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\n    \tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\n    \tat org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\n    \tat org.eclipse.jface.window.Window.open(Window.java:796)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:132)\n    \tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:145)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate(RefactoringStarter.java:40)\n    \tat org.eclipse.jdt.internal.ui.refactoring.UserInterfaceStarter.activate(UserInterfaceStarter.java:56)\n    \tat org.eclipse.jdt.internal.ui.refactoring.reorg.RenameUserInterfaceStarter.activate(RenameUserInterfaceStarter.java:151)\n    \tat org.eclipse.jdt.ui.refactoring.RenameSupport.openDialog(RenameSupport.java:114)\n    \tat org.eclipse.jdt.internal.corext.refactoring.RefactoringExecutionStarter.startRenameRefactoring(RefactoringExecutionStarter.java:382)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:172)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:102)\n    \tat org.eclipse.jdt.ui.actions.RenameAction.run(RenameAction.java:108)\n    \tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:267)\n    \tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:243)\n    \tat org.eclipse.jface.action.Action.runWithEvent(Action.java:499)\n    \tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:539)\n    \tat org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n    \tat org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n    \tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n    \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\n    \tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\n    \tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914)\n    \tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878)\n    \tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\n    \tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n    \tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\n    \tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n    \tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n    \tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n    \tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\n    \tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n    \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n    \tat java.lang.reflect.Method.invoke(Method.java:391)\n    \tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\n    \tat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\n    \tat org.eclipse.core.launcher.Main.run(Main.java:977)\n    \tat org.eclipse.core.launcher.Main.main(Main.java:952)\n    Caused by: org.eclipse.core.internal.resources.ResourceException: The resource tree is locked for modifications.\n    \tat org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:94)\n    \tat org.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1684)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1732)\n    \tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:784)\n    \tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:3016)\n    \tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:3032)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeFromClasspath(J2EEComponentClasspathUpdater.java:239)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeContainerFromModuleIfNecessary(J2EEComponentClasspathUpdater.java:209)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.updateModule(J2EEComponentClasspathUpdater.java:164)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdateModule(J2EEComponentClasspathUpdater.java:134)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdate(J2EEComponentClasspathUpdater.java:121)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.editModelChanged(J2EEComponentClasspathUpdater.java:111)\n    \tat org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.notifyListeners(GlobalComponentChangeNotifier.java:83)\n    \tat org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.editModelChanged(GlobalComponentChangeNotifier.java:43)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.notifyListeners(EditModel.java:305)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.resourceIsLoadedChanged(EditModel.java:681)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel$ResourceAdapter.notifyChanged(EditModel.java:109)\n    \tat org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:230)\n    \tat org.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.eNotify(ReferencedXMIResourceImpl.java:379)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.load(ResourceImpl.java:1109)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceImpl.load(ResourceImpl.java:895)\n    \tat org.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.load(TranslatorResourceImpl.java:378)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoad(ResourceSetImpl.java:249)\n    \tat org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.demandLoad(ProjectResourceSetImpl.java:83)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoadHelper(ResourceSetImpl.java:264)\n    \tat org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.getResource(ResourceSetImpl.java:390)\n    \tat org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.getResource(ProjectResourceSetImpl.java:262)\n    \tat org.eclipse.wst.common.internal.emfworkbench.WorkbenchResourceHelper.getOrCreateResource(WorkbenchResourceHelper.java:307)\n    \tat org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.getResource(EditModel.java:688)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource(ModuleStructuralModel.java:193)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary(ModuleStructuralModel.java:210)\n    \tat org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject(ModuleStructuralModel.java:103)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot(StructureEdit.java:444)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules(StructureEdit.java:473)\n    \tat org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent(StructureEdit.java:916)\n    \tat org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getReferences(VirtualComponent.java:294)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.update(J2EEComponentClasspathContainer.java:67)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.\u003cinit\u003e(J2EEComponentClasspathContainer.java:59)\n    \tat org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathInitializer.initialize(J2EEComponentClasspathInitializer.java:22)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer(JavaModelManager.java:1900)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager$7.run(JavaModelManager.java:1846)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:1853)\n    \tat org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1265)\n    \tat org.eclipse.jdt.core.JavaCore.getClasspathContainer(JavaCore.java:1470)\n    \tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:2169)\n    \tat org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath(JavaProject.java:2073)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessor.createExternalArchiveDelta(DeltaProcessor.java:734)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged(DeltaProcessor.java:1807)\n    \tat org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged(DeltaProcessingState.java:444)\n    \tat org.eclipse.core.internal.events.NotificationManager$2.run(NotificationManager.java:280)\n    \tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n    \tat org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:274)\n    \tat org.eclipse.core.internal.events.NotificationManager.broadcastChanges(NotificationManager.java:148)\n    \tat org.eclipse.core.internal.resources.Workspace.broadcastPostChange(Workspace.java:256)\n    \tat org.eclipse.core.internal.resources.Workspace.checkpoint(Workspace.java:305)\n    \tat org.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run(PerformChangeOperation.java:237)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1737)\n    \tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1719)\n    \tat org.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange(PerformChangeOperation.java:280)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.access$1(UIPerformChangeOperation.java:1)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$1.run(UIPerformChangeOperation.java:66)\n    \tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n    \tat org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$2.run(UIPerformChangeOperation.java:84)\n    \tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n    \tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n    \tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3325)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2971)\n    \tat org.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:158)\n    \tat org.eclipse.jface.operation.ModalContext.run(ModalContext.java:326)\n    \tat org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run(RefactoringWizardDialog2.java:304)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizard.internalPerformFinish(RefactoringWizard.java:545)\n    \tat org.eclipse.ltk.ui.refactoring.UserInputWizardPage.performFinish(UserInputWizardPage.java:154)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizard.performFinish(RefactoringWizard.java:611)\n    \tat org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.okPressed(RefactoringWizardDialog2.java:433)\n    \tat org.eclipse.jface.dialogs.Dialog.buttonPressed(Dialog.java:508)\n    \tat org.eclipse.jface.dialogs.Dialog$3.widgetSelected(Dialog.java:660)\n    \tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:90)\n    \tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n    \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\n    \tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\n    \tat org.eclipse.jface.window.Window.runEventLoop(Window.java:820)\n    \tat org.eclipse.jface.window.Window.open(Window.java:796)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:132)\n    \tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n    \tat org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:145)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate(RefactoringStarter.java:40)\n    \tat org.eclipse.jdt.internal.ui.refactoring.UserInterfaceStarter.activate(UserInterfaceStarter.java:56)\n    \tat org.eclipse.jdt.internal.ui.refactoring.reorg.RenameUserInterfaceStarter.activate(RenameUserInterfaceStarter.java:151)\n    \tat org.eclipse.jdt.ui.refactoring.RenameSupport.openDialog(RenameSupport.java:114)\n    \tat org.eclipse.jdt.internal.corext.refactoring.RefactoringExecutionStarter.startRenameRefactoring(RefactoringExecutionStarter.java:382)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:172)\n    \tat org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run(RenameJavaElementAction.java:102)\n    \tat org.eclipse.jdt.ui.actions.RenameAction.run(RenameAction.java:108)\n    \tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:267)\n    \tat org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:243)\n    \tat org.eclipse.jface.action.Action.runWithEvent(Action.java:499)\n    \tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:539)\n    \tat org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n    \tat org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n    \tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n    \tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\n    \tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\n    \tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\n    \tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914)\n    \tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878)\n    \tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419)\n    \tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n    \tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\n    \tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n    \tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n    \tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n    \tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\n    \tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n    \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n    \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n    \tat java.lang.reflect.Method.invoke(Method.java:391)\n    \tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\n    \tat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\n    \tat org.eclipse.core.launcher.Main.run(Main.java:977)\n    \tat org.eclipse.core.launcher.Main.main(Main.java:952)\n",
    "Chuck: looks like you recently added J2EEComponentClasspathUpdater",
    "Created an attachment (id\u003d41796)\nfix for 139245\n\nAdded a check to see if TreeNode is locked. Calling classpath update only if it is unlocked.",
    "Patch applied...\n\n",
    "The original issue still exists; bug 128491 was fixed on 5/11 and I\u0027ve got the v20060511_I version of the jem plugins, however, it indicates that the fix will be in JEM 1.2 RC1 which was declared on 5/18 so I\u0027m not certain if I actually have the right JEM code; also, Chuck, it\u0027s not clear to me from the bugzilla comment but is it now necessary for other resource change listeners to extend ISynchronizerExtender to avoid the behavior of ResourceSetWorkbenchSynchronizer? ",
    "Hi Rob,    Can I get a summary of the issues you are still seeing?   This is a case of a long running bug that has morphed a couple times....\n\nThe other defect has to do with EMF cleanup on Project delete... really not sure if this is the case here.....",
    "Here\u0027s a recap of my current understanding:\n\n-During the PRE_DELETE processing done by the refactoring logic, a call to retrieve the references for the EAR\u0027s IVirtualComponent is not returning the IVirtualComponent for the soon to be renamed (or deleted) child project\n-I tracked this back to the fact that \"isReleasing\" had been set to true by another listener (see comment #12)\n-The old component file reference is being cleaned up in the rename case when the new reference is added due some logic John included that cleans up stale references (note: if you just delete a project, then this logic is not executed and the component file also contains stale refs)\n\nPinged Rich and he thinks the JEM fix is in the 511 integration build but is not 100% certain.",
    "Rob - regarding your comment(In reply to comment #24)\n\n\u003e -During the PRE_DELETE processing done by the refactoring logic, a call to\n\u003e retrieve the references for the EAR\u0027s IVirtualComponent is not returning the\n\u003e IVirtualComponent for the soon to be renamed (or deleted) child project\n\nBecause the other listener needs to cleanup, or unload the EMF resources, the I mentioned that the ISynchronizerExtender is available to cleanup these resources further - details here: https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d128491#c8\n\n\u003e -The old component file reference is being cleaned up in the rename case when\n\u003e the new reference is added due some logic John included that cleans up stale\n\u003e references (note: if you just delete a project, then this logic is not executed\n\u003e and the component file also contains stale refs)\n\u003e \n\nIs this part still true?   Just trying to determine what to do here....\n\n",
    "Yes, as of my latest testing - let\u0027s chat today and determine the right fix for this. ",
    "Created an attachment (id\u003d42737)\nPatch for component refs\n\nThis patch allows retrieving references to possibly deleted components.\nAdded internal api, which the refactoring operation can use.",
    "Patch looks good - I think this is the right solution - thanks Chuck",
    "Dropped to build....",
    "This has regressed; the entry for the old project name is now not being removed from application.xml - need to investigate more to see why this is happening...",
    "The problem is distinct; this issue has not regressed",
    "Verified that this issue is fixed with 6/16 RC5 build.",
    "Closing."
  ],
  "commentCreationDates": [
    "2006-04-28T19:35:04+02:00",
    "2006-04-28T19:44:55+02:00",
    "2006-04-28T19:50:10+02:00",
    "2006-04-28T20:21:46+02:00",
    "2006-04-30T20:42:07+02:00",
    "2006-05-01T23:43:48+02:00",
    "2006-05-02T15:29:34+02:00",
    "2006-05-02T17:39:15+02:00",
    "2006-05-03T22:45:12+02:00",
    "2006-05-03T22:56:25+02:00",
    "2006-05-03T23:10:17+02:00",
    "2006-05-04T05:38:25+02:00",
    "2006-05-04T16:03:44+02:00",
    "2006-05-04T16:29:04+02:00",
    "2006-05-04T18:35:40+02:00",
    "2006-05-04T19:49:37+02:00",
    "2006-05-04T20:02:19+02:00",
    "2006-05-16T19:44:26+02:00",
    "2006-05-16T19:49:10+02:00",
    "2006-05-16T20:04:51+02:00",
    "2006-05-17T22:36:53+02:00",
    "2006-05-17T23:52:01+02:00",
    "2006-05-22T17:12:44+02:00",
    "2006-05-22T17:30:46+02:00",
    "2006-05-22T18:09:26+02:00",
    "2006-05-25T01:57:48+02:00",
    "2006-05-25T21:11:31+02:00",
    "2006-05-26T18:47:08+02:00",
    "2006-05-26T20:16:15+02:00",
    "2006-05-26T20:16:36+02:00",
    "2006-06-20T19:48:14+02:00",
    "2006-06-20T20:28:40+02:00",
    "2006-06-20T20:29:18+02:00",
    "2006-09-26T16:03:24+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource",
          "source": "ModuleStructuralModel.java:192"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary",
          "source": "ModuleStructuralModel.java:204"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject",
          "source": "ModuleStructuralModel.java:101"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot",
          "source": "StructureEdit.java:437"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules",
          "source": "StructureEdit.java:466"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent",
          "source": "StructureEdit.java:909"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getDeployedName",
          "source": "VirtualComponent.java:69"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModuleDelegates",
          "source": "J2EEDeployableFactory.java:72"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModule",
          "source": "J2EEDeployableFactory.java:56"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.deployables.J2EEDeployableFactory.createModule",
          "source": "J2EEDeployableFactory.java:45"
        },
        {
          "method": "org.eclipse.wst.server.core.util.ProjectModuleFactoryDelegate.cacheModules",
          "source": "ProjectModuleFactoryDelegate.java:60"
        },
        {
          "method": "org.eclipse.wst.server.core.util.ProjectModuleFactoryDelegate.getModules",
          "source": "ProjectModuleFactoryDelegate.java:88"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.ModuleFactory.getModules",
          "source": "ModuleFactory.java:133"
        },
        {
          "method": "org.eclipse.wst.server.core.ServerUtil.getModules",
          "source": "ServerUtil.java:247"
        },
        {
          "method": "org.eclipse.wst.server.core.ServerUtil.getModule",
          "source": "ServerUtil.java:47"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorMetadata.computeMetadata",
          "source": "ProjectRefactorMetadata.java:85"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.cacheDeletedProjectMetadata",
          "source": "ProjectRefactoringListener.java:124"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener.resourceChanged",
          "source": "ProjectRefactoringListener.java:111"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager$2.run",
          "source": "NotificationManager.java:280"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.notify",
          "source": "NotificationManager.java:274"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.handleEvent",
          "source": "NotificationManager.java:258"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.broadcastEvent",
          "source": "Workspace.java:250"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.move",
          "source": "Project.java:789"
        },
        {
          "method": "org.eclipse.ui.actions.RenameResourceAction.invokeOperation",
          "source": "RenameResourceAction.java:379"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceAction.execute",
          "source": "WorkspaceAction.java:134"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceAction$1.execute",
          "source": "WorkspaceAction.java:295"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceModifyOperation$1.run",
          "source": "WorkspaceModifyOperation.java:101"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceModifyOperation.run",
          "source": "WorkspaceModifyOperation.java:113"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.java:113"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "139245",
      "date": "2006-04-28T19:35:04+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "critical"
    },
    {
      "exceptionType": "org.eclipse.core.internal.resources.ResourceException",
      "message": "The resource tree is locked for modifications.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.resources.WorkManager.checkIn",
          "source": "WorkManager.java:94"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.prepareOperation",
          "source": "Workspace.java:1684"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1732"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:784"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setRawClasspath",
          "source": "JavaProject.java:3016"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setRawClasspath",
          "source": "JavaProject.java:3032"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeFromClasspath",
          "source": "J2EEComponentClasspathUpdater.java:239"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.removeContainerFromModuleIfNecessary",
          "source": "J2EEComponentClasspathUpdater.java:209"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.updateModule",
          "source": "J2EEComponentClasspathUpdater.java:164"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdateModule",
          "source": "J2EEComponentClasspathUpdater.java:134"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.queueUpdate",
          "source": "J2EEComponentClasspathUpdater.java:121"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathUpdater.editModelChanged",
          "source": "J2EEComponentClasspathUpdater.java:111"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.notifyListeners",
          "source": "GlobalComponentChangeNotifier.java:83"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.GlobalComponentChangeNotifier.editModelChanged",
          "source": "GlobalComponentChangeNotifier.java:43"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.notifyListeners",
          "source": "EditModel.java:305"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.resourceIsLoadedChanged",
          "source": "EditModel.java:681"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel$ResourceAdapter.notifyChanged",
          "source": "EditModel.java:109"
        },
        {
          "method": "org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify",
          "source": "BasicNotifierImpl.java:230"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.ReferencedXMIResourceImpl.eNotify",
          "source": "ReferencedXMIResourceImpl.java:379"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceImpl.load",
          "source": "ResourceImpl.java:1109"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceImpl.load",
          "source": "ResourceImpl.java:895"
        },
        {
          "method": "org.eclipse.wst.common.internal.emf.resource.TranslatorResourceImpl.load",
          "source": "TranslatorResourceImpl.java:378"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoad",
          "source": "ResourceSetImpl.java:249"
        },
        {
          "method": "org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.demandLoad",
          "source": "ProjectResourceSetImpl.java:83"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.demandLoadHelper",
          "source": "ResourceSetImpl.java:264"
        },
        {
          "method": "org.eclipse.emf.ecore.resource.impl.ResourceSetImpl.getResource",
          "source": "ResourceSetImpl.java:390"
        },
        {
          "method": "org.eclipse.jem.internal.util.emf.workbench.ProjectResourceSetImpl.getResource",
          "source": "ProjectResourceSetImpl.java:262"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.WorkbenchResourceHelper.getOrCreateResource",
          "source": "WorkbenchResourceHelper.java:307"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModel.getResource",
          "source": "EditModel.java:688"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryResource",
          "source": "ModuleStructuralModel.java:193"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.prepareProjectModulesIfNecessary",
          "source": "ModuleStructuralModel.java:210"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.ModuleStructuralModel.getPrimaryRootObject",
          "source": "ModuleStructuralModel.java:103"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponentModelRoot",
          "source": "StructureEdit.java:444"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getWorkbenchModules",
          "source": "StructureEdit.java:473"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getComponent",
          "source": "StructureEdit.java:916"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.getReferences",
          "source": "VirtualComponent.java:294"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.update",
          "source": "J2EEComponentClasspathContainer.java:67"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathContainer.\u003cinit\u003e",
          "source": "J2EEComponentClasspathContainer.java:59"
        },
        {
          "method": "org.eclipse.jst.j2ee.internal.common.classpath.J2EEComponentClasspathInitializer.initialize",
          "source": "J2EEComponentClasspathInitializer.java:22"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeContainer",
          "source": "JavaModelManager.java:1900"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager$7.run",
          "source": "JavaModelManager.java:1846"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers",
          "source": "JavaModelManager.java:1853"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer",
          "source": "JavaModelManager.java:1265"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.getClasspathContainer",
          "source": "JavaCore.java:1470"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:2169"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.getResolvedClasspath",
          "source": "JavaProject.java:2073"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.createExternalArchiveDelta",
          "source": "DeltaProcessor.java:734"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessor.resourceChanged",
          "source": "DeltaProcessor.java:1807"
        },
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessingState.resourceChanged",
          "source": "DeltaProcessingState.java:444"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager$2.run",
          "source": "NotificationManager.java:280"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.notify",
          "source": "NotificationManager.java:274"
        },
        {
          "method": "org.eclipse.core.internal.events.NotificationManager.broadcastChanges",
          "source": "NotificationManager.java:148"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.broadcastPostChange",
          "source": "Workspace.java:256"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.checkpoint",
          "source": "Workspace.java:305"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run",
          "source": "PerformChangeOperation.java:237"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1737"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1719"
        },
        {
          "method": "org.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange",
          "source": "PerformChangeOperation.java:280"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.access$1",
          "source": "UIPerformChangeOperation.java:1"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$1.run",
          "source": "UIPerformChangeOperation.java:66"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation$2.run",
          "source": "UIPerformChangeOperation.java:84"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3325"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2971"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.block",
          "source": "ModalContext.java:158"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext.run",
          "source": "ModalContext.java:326"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.run",
          "source": "RefactoringWizardDialog2.java:304"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizard.internalPerformFinish",
          "source": "RefactoringWizard.java:545"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.UserInputWizardPage.performFinish",
          "source": "UserInputWizardPage.java:154"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizard.performFinish",
          "source": "RefactoringWizard.java:611"
        },
        {
          "method": "org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.okPressed",
          "source": "RefactoringWizardDialog2.java:433"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.buttonPressed",
          "source": "Dialog.java:508"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog$3.widgetSelected",
          "source": "Dialog.java:660"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:90"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3348"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2968"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:820"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:796"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run",
          "source": "RefactoringWizardOpenOperation.java:132"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run",
          "source": "RefactoringWizardOpenOperation.java:145"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RefactoringStarter.activate",
          "source": "RefactoringStarter.java:40"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.UserInterfaceStarter.activate",
          "source": "UserInterfaceStarter.java:56"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.reorg.RenameUserInterfaceStarter.activate",
          "source": "RenameUserInterfaceStarter.java:151"
        },
        {
          "method": "org.eclipse.jdt.ui.refactoring.RenameSupport.openDialog",
          "source": "RenameSupport.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.RefactoringExecutionStarter.startRenameRefactoring",
          "source": "RefactoringExecutionStarter.java:382"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:172"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.refactoring.actions.RenameJavaElementAction.run",
          "source": "RenameJavaElementAction.java:102"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.RenameAction.run",
          "source": "RenameAction.java:108"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun",
          "source": "SelectionDispatchAction.java:267"
        },
        {
          "method": "org.eclipse.jdt.ui.actions.SelectionDispatchAction.run",
          "source": "SelectionDispatchAction.java:243"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:499"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:539"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:400"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3348"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2968"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1914"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1878"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:419"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:400"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:177"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 1,
      "commentIndex": 18,
      "bugId": "139245",
      "date": "2006-05-16T19:49:10+02:00",
      "product": "Web Tools",
      "component": "jst.j2ee",
      "severity": "critical"
    }
  ],
  "groupId": "139245",
  "bugId": "139245",
  "date": "2006-04-28T19:35:04+02:00",
  "product": "Web Tools",
  "component": "jst.j2ee",
  "severity": "critical"
}