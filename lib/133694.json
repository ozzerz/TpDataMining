{
  "comments": [
    "I20060328-0010\n\nIf you run an infocenter or standalone mode help, the command links still appear, but they do nothing. Actually they try to run but fail because the workbench isn\u0027t started. The links need to be disabled in infocenter and standalone modes.\n\n!ENTRY org.eclipse.help.base 4 0 2006-03-28 15:42:46.031\n!MESSAGE Failed to execute runnable (java.lang.IllegalStateException: Workbench has not been created yet.)\n!STACK 0\norg.eclipse.swt.SWTException: Failed to execute runnable (java.lang.IllegalStateException: Workbench has not been created yet.)\n\tat org.eclipse.swt.SWT.error(SWT.java:3374)\n\tat org.eclipse.swt.SWT.error(SWT.java:3297)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:126)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3323)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2969)\n\tat org.eclipse.help.ui.internal.HelpUIEventLoop.run(HelpUIEventLoop.java:40)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.help.internal.base.DisplayUtils.invoke(DisplayUtils.java:45)\n\tat org.eclipse.help.internal.base.DisplayUtils.runUI(DisplayUtils.java:27)\n\tat org.eclipse.help.internal.base.HelpApplication.run(HelpApplication.java:76)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\n\tat org.eclipse.core.launcher.Main.run(Main.java:975)\n\tat org.eclipse.core.launcher.Main.main(Main.java:950)\nCaused by: java.lang.IllegalStateException: Workbench has not been created yet.\n\tat org.eclipse.ui.PlatformUI.getWorkbench(PlatformUI.java:92)\n\tat org.eclipse.help.ui.internal.ExecuteCommandAction.forceDialogsOnTop(ExecuteCommandAction.java:65)\n\tat org.eclipse.help.ui.internal.ExecuteCommandAction.access$0(ExecuteCommandAction.java:64)\n\tat org.eclipse.help.ui.internal.ExecuteCommandAction$1.run(ExecuteCommandAction.java:53)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\t... 25 more",
    "Chris D., could you investigate? This might be tricky.",
    "As I rememeber from active help docs, active help links should open a dialog or otherwise inform the user that active help is only available from a running workbench. Similar behaviour should be used for linkability commands.",
    "I agree with Dejan, go to the page below and click the link that says \"Click here for a message\"\n\nhttp://help.eclipse.org/help31/index.jsp?topic\u003d/org.eclipse.platform.doc.isv/guide/help_active.htm\n\nYou should see a dialog that says, \"you need to run help locally....\".  We should do the same for command links.\n\nI\u0027ll look into this....",
    "Sounds good to me.",
    "Well I thought this would be easy, but I\u0027m actually stuck on two fronts.\n\nFirst, I don\u0027t know how to run help as infocenter/standalone so I basically don\u0027t know how to reproduce the problem and test a fix (if I had one).\n\nSecond, I\u0027m surprised and can\u0027t explain why these command links don\u0027t exhibit the same behavior as the active help example I linked above.  Both active help and command links use javascript.   The active help calls javascript:liveAction(...) and the command links call javascript:executeCommand(...).  Both of those functions are defined in livehelp.js and if you look at the definition of executeCommand you see it just calls liveAction, so in both cases the code flows through very similar paths.  So basically I can\u0027t see why the error dialog appears in the active help case but not in the command link case.  I\u0027m also not sure who creates that error dialog for the active help case.  I think if we I could find where the error dialog is created it would help.\n\nDejan and/or Curtis, do you have any insight on either of these questions?",
    "It is puzzling indeed. \n\nKonrad, we have a live help action that is not supposed to work outside of the WORKBENCH mode (as any other live help action). When we try the sample live action specified above from the info center, the warning dialog opens up. However, when we follow our own live help action, we don\u0027t get the dialog. Why is that?",
    "To run infocenter:\n\nhttp://help.eclipse.org/help31/topic/org.eclipse.platform.doc.isv/reference/misc/help_infocenter.html\n\nTo run standalone:\n\nhttp://help.eclipse.org/help31/topic/org.eclipse.platform.doc.isv/reference/misc/help_standalone.html\n\n",
    "First, I see your stack if from standalone help scenario and you compare the behavior to the infocenter.  The infocenter and standalone scenarios are not the same.  Live help does not apply to infocenter, due to executing on the server, multi user, and security reasons.  However it is perfectly valid to execute live help actions in standalone help.  The action does not need need to require IDE or workbench or SWT, it may perform project creation, installation, execute external scripts, or other non UI, or non IDE tasks.\n\nThe text from the error dialog that appears in the infocter scenario is comiing from proprties, so simple text search of the webapp will reveal the properties file and the key used.  Search for the key will return place with the logic for displaying the dialog:  livehelp_js.jsp:\nif(data.getMode() \u003d\u003d RequestData.MODE_INFOCENTER){\n\talert(\"\u003c%\u003dUrlUtil.JavaScriptEncode(ServletResources.getString(\"noLiveHelpInInfocenter\", request))%\u003e\");\n\treturn;\n}else if(!prefs.isActiveHelp()){\n\talert(\"\u003c%\u003dUrlUtil.JavaScriptEncode(ServletResources.getString(\"noLiveHelp\", request))%\u003e\");\n\nSince some people need to run livehelp in standalone, but most would rather disable them, notice there is a preference that that can be set when launching standalone and live help will not work.\n\nIn particular case of this bug, I think no changes are needed to the live help framework.  The action implementation should check its prerequisites, like if the workbench exists if it needs it.  If the workbench is not up, the action can even display an SWT dialog (if SWT exists), and I see from the stack the SWT loop is well running.",
    "Thanks, Konrad. I missed the standalone/infocenter mismatch.",
    "Created an attachment (id\u003d37580)\nopens error dialog when command link executed in standalone help mode\n\nHere is a patch that causes an error dialog to open when command links are executed in standalone mode.\n\nNotes:\n1) In infocenter mode the proper dialog was already appearing as Konrad pointed out.\n\n2) Curtis, you might want to tweak the error message text if you can think of something better.\n\n3) This patch fixes command links, which all filter through the same ILiveHelpAction implementation class (ExecuteCommandAction).  But it doesn\u0027t fix the similar problem with the lone active help link in the PDE developer guide, or any other active links.\n",
    "One more thing about note (3) in the previous comment.  The ILiveHelpAction run() is called from BaseHelpSystem.runLiveHelp() which is in org.eclipse.help.base.  You couldn\u0027t open a dialog from there (right?) so I think instrumenting each ILiveHelpAction, or introducing some abstract base class (AbstractLiveHelpAction) with the checks is how this has to be handled.\n",
    "Applied."
  ],
  "commentCreationDates": [
    "2006-03-28T21:44:58+02:00",
    "2006-03-28T21:46:01+02:00",
    "2006-03-28T22:20:31+02:00",
    "2006-03-29T00:10:49+02:00",
    "2006-03-29T00:16:33+02:00",
    "2006-03-29T06:59:35+02:00",
    "2006-03-29T15:57:25+02:00",
    "2006-03-29T16:51:30+02:00",
    "2006-03-29T18:12:23+02:00",
    "2006-03-29T20:30:39+02:00",
    "2006-04-04T08:57:14+02:00",
    "2006-04-04T09:09:52+02:00",
    "2006-04-04T21:44:25+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "Workbench has not been created yet.)",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3374"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3297"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:126"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3323"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2969"
        },
        {
          "method": "org.eclipse.help.ui.internal.HelpUIEventLoop.run",
          "source": "HelpUIEventLoop.java:40"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.help.internal.base.DisplayUtils.invoke",
          "source": "DisplayUtils.java:45"
        },
        {
          "method": "org.eclipse.help.internal.base.DisplayUtils.runUI",
          "source": "DisplayUtils.java:27"
        },
        {
          "method": "org.eclipse.help.internal.base.HelpApplication.run",
          "source": "HelpApplication.java:76"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:169"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:975"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:950"
        }
      ],
      "causedBy": {
        "exceptionType": "java.lang.IllegalStateException",
        "message": "Workbench has not been created yet.",
        "elements": [
          {
            "method": "org.eclipse.ui.PlatformUI.getWorkbench",
            "source": "PlatformUI.java:92"
          },
          {
            "method": "org.eclipse.help.ui.internal.ExecuteCommandAction.forceDialogsOnTop",
            "source": "ExecuteCommandAction.java:65"
          },
          {
            "method": "org.eclipse.help.ui.internal.ExecuteCommandAction.access$0",
            "source": "ExecuteCommandAction.java:64"
          },
          {
            "method": "org.eclipse.help.ui.internal.ExecuteCommandAction$1.run",
            "source": "ExecuteCommandAction.java:53"
          },
          {
            "method": "org.eclipse.swt.widgets.RunnableLock.run",
            "source": "RunnableLock.java:35"
          },
          {
            "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
            "source": "Synchronizer.java:123"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 0,
      "bugId": "133694",
      "date": "2006-03-28T21:44:58+02:00",
      "product": "Platform",
      "component": "User Assistance",
      "severity": "normal"
    }
  ],
  "groupId": "133694",
  "bugId": "133694",
  "date": "2006-03-28T21:44:58+02:00",
  "product": "Platform",
  "component": "User Assistance",
  "severity": "normal"
}