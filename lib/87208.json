{
  "comments": [
    "java.lang.ClassCastException: org.eclipse.ui.actions.RetargetAction\n\tat org.eclipse.ui.actions.RetargetAction.propagateChange(RetargetAction.java:197)\n\tat org.eclipse.ui.actions.RetargetAction$1.propertyChange(RetargetAction.java:60)\n\tat org.eclipse.jface.action.Action.firePropertyChange(Action.java:597)\n\tat org.eclipse.jface.action.Action.firePropertyChange(Action.java:582)\n\tat org.eclipse.ui.actions.RetargetAction.setActionHandler(RetargetAction.java:265)\n\tat org.eclipse.ui.actions.RetargetAction.partActivated(RetargetAction.java:146)\n\tat org.eclipse.ui.internal.PartListenerList$1.run(PartListenerList.java:52)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1015)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:757)\n\tat\norg.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:50)\n\tat\norg.eclipse.ui.internal.WWinPartService.firePartActivated(WWinPartService.java:209)\n\tat org.eclipse.ui.internal.WWinPartService.access$0(WWinPartService.java:206)\n\tat org.eclipse.ui.internal.WWinPartService$1.partActivated(WWinPartService.java:36)\n\tat org.eclipse.ui.internal.PartListenerList2$1.run(PartListenerList2.java:48)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1015)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:757)\n\tat\norg.eclipse.ui.internal.PartListenerList2.firePartActivated(PartListenerList2.java:46)\n\tat org.eclipse.ui.internal.WorkbenchPage.firePartActivated(WorkbenchPage.java:1501)\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:2821)\n\tat org.eclipse.ui.internal.WorkbenchPage.requestActivation(WorkbenchPage.java:2479)\n\tat org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:314)\n\tat org.eclipse.ui.internal.PartPane.setFocus(PartPane.java:356)\n\tat\norg.eclipse.ui.internal.PartStack.presentationSelectionChanged(PartStack.java:728)\n\tat org.eclipse.ui.internal.PartStack.access$0(PartStack.java:711)\n\tat org.eclipse.ui.internal.PartStack$1.selectPart(PartStack.java:93)\n\tat\norg.eclipse.ui.internal.presentations.newapi.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:116)\n\tat\norg.eclipse.ui.internal.presentations.newapi.AbstractTabFolder.fireEvent(AbstractTabFolder.java:263)\n\tat\norg.eclipse.ui.internal.presentations.newapi.AbstractTabFolder.fireEvent(AbstractTabFolder.java:272)\n\tat\norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1(DefaultTabFolder.java:1)\n\tat\norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$2.handleEvent(DefaultTabFolder.java:81)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:866)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:851)\n\tat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:659)\n\tat org.eclipse.swt.custom.CTabFolder.setSelection(CTabFolder.java:3141)\n\tat org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:1925)\n\tat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:287)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2908)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2541)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1612)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1578)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:293)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:144)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:102)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:228)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:333)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:150)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:268)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:260)\n\tat org.eclipse.core.launcher.Main.run(Main.java:887)\n\tat org.eclipse.core.launcher.Main.main(Main.java:871)",
    "Seems to be a result of the 3.0.1 fix for bug 70503.\n\nThe same propertyChangeListener is being hooked on both the handling action and\nthe IActionBars of the active part.  RetargetAction expects P_ACTION_HANDLERS\nnotifications to come only from the IActionBars, and for this to be the source\nof the event.\n",
    "I disagree.  The line at which the exception occurs seems to have been in since\nrevision 1.1 of RetargetAction.  I believe the line he\u0027s referring to is:\n\n    setActionHandler(((IActionBars)\nevent.getSource()).getGlobalActionHandler(getId()));\n\nIf I\u0027ve got the line wrong, please let me know which line it is....",
    "Dmitri, are you instantiating the RetargetAction (either directly or via\nActionFactory)?  It looks like you\u0027re setting a RetargetAction as the handler of\nanother RetargetAction.\n\n",
    "Although the CCE occurs at line 197, the property change event is being\ntriggered by the fix for bug 70503 at line 265.\n\nRather than reuse SubActionBars.P_ACTION_HANDLERS to notify the ActionHandler of\na change to the RetargetAction\u0027s handler, it would be better to define a new\nproperty P_HANDLER in RetargetAction.\n\nDmitri, could you please describe the setup that lead to this (that is, how\nyou\u0027re creating actions and setting handlers)?\nWe\u0027re trying to assess the severity of this bug, and whether a fix needs to go\ninto 3.0.2.\n",
    "I have to handle rename action in my custom view part. The requirements are to\nenable workbench menu (File-\u003eRename), to provide the same item in context menu\n(with F2 shortcut visible!) and to handle keyboard shortcut with inplace editor. \n\nI can\u0027t use org.eclipse.ui.popupMenus extension point since the same objects\nappear in GEF editor and require another action handler. When I\u0027ve provided a\ncouple of object contributions there was a conflict that was resolved by\nworkbench so keyboard shortcut was disabled (((.\n\nThe solution was to set my custom action as global action handler for the view\u0027s\naction bars and to register it in keybinding service:\n\nactionBars.setGlobalActionHandler(actionId, newAction); // \u0027rename\u0027\ngetViewSite().getKeyBindingService().registerAction(newAction);\n\nTo populate context menu I create RetargetAction instance\n(ActionFactory.RENAME.create(window)) and add it to the context menu\n(menu.appendToGroup(StandardMenuGroups.GROUP_MANIPULATION, action)).\n\nThe requirements are met but sometimes(!) this exception is thrown on context\nmenu invocation.",
    "Dmitri, please try adding your handling action (newAction) to the context menu,\ninstead of a RetargetAction.  To get the key binding to show up, ensure that\nnewAction\u0027s actionDefinitionId is \"org.eclipse.ui.edit.rename\".\n\nThere is still a bug here, but this is the recommended way of both hooking an\naction as a global action handler and putting it in the context menu.\n",
    "\u003e There is still a bug here.\n\nThat was probably confusing.  To clarify, if you do as I suggest, you should not\nhit this bug.\n",
    "Actually, since this requires new API, it needs to be done for M6.\n\nI\u0027ve added a RetargetAction.HANDLER property, which is now used in ActionHandler\ninstead of SubActionBars.P_ACTION_HANDLERS.\n\nI\u0027ve also added an instanceof check in RetargetAction.propagateChange.\n\nPatch reviewed by Doug.  The tests pass.\n\nWill write a regression test for this case.  See bug 88889.\n"
  ],
  "commentCreationDates": [
    "2005-03-05T10:24:43+01:00",
    "2005-03-07T18:55:59+01:00",
    "2005-03-07T19:10:02+01:00",
    "2005-03-07T19:37:11+01:00",
    "2005-03-07T20:37:43+01:00",
    "2005-03-10T10:46:02+01:00",
    "2005-03-23T16:57:41+01:00",
    "2005-03-23T16:58:15+01:00",
    "2005-03-23T17:25:13+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.ui.actions.RetargetAction",
      "elements": [
        {
          "method": "org.eclipse.ui.actions.RetargetAction.propagateChange",
          "source": "RetargetAction.java:197"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction$1.propertyChange",
          "source": "RetargetAction.java:60"
        },
        {
          "method": "org.eclipse.jface.action.Action.firePropertyChange",
          "source": "Action.java:597"
        },
        {
          "method": "org.eclipse.jface.action.Action.firePropertyChange",
          "source": "Action.java:582"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction.setActionHandler",
          "source": "RetargetAction.java:265"
        },
        {
          "method": "org.eclipse.ui.actions.RetargetAction.partActivated",
          "source": "RetargetAction.java:146"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$1.run",
          "source": "PartListenerList.java:52"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1015"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:757"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartActivated",
          "source": "PartListenerList.java:50"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.firePartActivated",
          "source": "WWinPartService.java:209"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:206"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partActivated",
          "source": "WWinPartService.java:36"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$1.run",
          "source": "PartListenerList2.java:48"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1015"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:757"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartActivated",
          "source": "PartListenerList2.java:46"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.firePartActivated",
          "source": "WorkbenchPage.java:1501"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:2821"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.requestActivation",
          "source": "WorkbenchPage.java:2479"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.requestActivation",
          "source": "PartPane.java:314"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.setFocus",
          "source": "PartPane.java:356"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.presentationSelectionChanged",
          "source": "PartStack.java:728"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.access$0",
          "source": "PartStack.java:711"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack$1.selectPart",
          "source": "PartStack.java:93"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.newapi.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.newapi.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:263"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.newapi.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:272"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1",
          "source": "DefaultTabFolder.java:1"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$2.handleEvent",
          "source": "DefaultTabFolder.java:81"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:842"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:866"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:851"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:659"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.setSelection",
          "source": "CTabFolder.java:3141"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouse",
          "source": "CTabFolder.java:1925"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:287"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:82"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:842"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:2908"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2541"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1612"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1578"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:293"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:144"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:102"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:228"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:333"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:150"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:268"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:260"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:887"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:871"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "87208",
      "date": "2005-03-05T10:24:43+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "87208",
  "bugId": "87208",
  "date": "2005-03-05T10:24:43+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}