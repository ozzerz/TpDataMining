{
  "comments": [
    "I20060428-1315\n\nCreate a working set that contains one managed project and one unmanaged project. Notice that if you select the working set, all of the team actions are disabled. Boo!",
    "*** Bug 159166 has been marked as a duplicate of this bug. ***",
    "Krzysztof, can you investigate this. If the fix is trivial, we can consider it for 3.3.",
    "Here are my findings\n\n1. When working set is selected, org.eclipse.team.internal.ccvs.ui.actions.WorkspaceAction.isEnabled() method sees it as a selection of multiple projects. If the action is not available for any of them, is not available for all. The first thing that should be changed, is passing information, that we are working with sets. This seems to be trivial.\n\n2. When a project in Working set is closed, it should be skipped (info displayed optionally).\n\n3. When a project is unshared, it should be skipped for all actions except commit and synchronize, which should prompt if the project should be shared. If we do not want to annoy the user, the prompt has to be skippable (additional preference). For commit action commit wizard should be launched.\n\nShould this be considered for 3.3?",
    "I don\u0027t think we should do anything that is Working Set specific. It is possible that other model providers could have cross project model elements. For 3.3, I wonder if we could get away with just ignoring the resources from any projects that are either not shared or closed. By \"not shared\", I mean that \"RepositoryProvider.getProvider(resource.getProject())\" returns null. If there is another provider on the project (e.g Subversion), we need the action to be disabled.\n\nAs you say, modifying the isEnabled looks trivial. However, we would probably also need to make some modifications in the CVSOperation hierarchy to ignore the resources. Another option would be to modify what is returned by getSelection to include only the resources in projects that are shared (or have the execute method of each of the subclasses of WorkspaceAction call a different method to obtain the selected resources to ensure that resources from unshared and closed projects are not passed to the operation.\n\nI agree that having Commit and Synchronize offer to share any unshared projects would be a nice touch but it is beyond the scope of this request. I think that modify the actions to work on a selection that contains resources from unshared or closed projects should be safe enough to put in 3.3.",
    "But if the Action does not know that it is working set, it may work in the same way, when multiple project are selected (one shared, and one unshared). Now in that situation, Team Actions are disabled.",
    "I understand your concern. It turns out that the action doesn\u0027t appear in the context menu in this case due to the enablement rule that is used but the actions still appear in the CVS main menu.\n\nPerhaps it would be enough for 3.3 to have the Team/Synchronize with Repository enabled for working sets only. There is already logic in the execute of SyncAction for handling working sets so you could override isEnabled to enable if the inherited isEnabled is true or if the selection is a working set that contains at least one CVS project and doesn\u0027t contain any projects mapped to other repositories. How does that sound?",
    "Created an attachment (id\u003d66835)\nPatch\n\nSyncronize action works for working sets containing shared, unshared and closed projects. Only shared are synchronized.",
    "Seems to work but I get the following exception in the log. I think you\u0027re breakout condition a few lines above this is wrong. Also, I don\u0027t think we need to restrict it to a single set (i.e. the execute seems to handle multiple sets). Finally, instead of making sure there is only one provider, you could compare the id to CVSProviderPlugin.getTypeId() to ensure the projects are mapped to CVS.\n\njava.lang.NullPointerException\n\tat org.eclipse.team.internal.ccvs.ui.actions.SyncAction.isEnabled(SyncAction.java:243)\n\tat org.eclipse.team.internal.ui.actions.TeamAction.setActionEnablement(TeamAction.java:284)\n\tat org.eclipse.team.internal.ccvs.ui.actions.CVSAction.setActionEnablement(CVSAction.java:202)\n\tat org.eclipse.team.internal.ccvs.ui.actions.WorkspaceAction.setActionEnablement(WorkspaceAction.java:211)\n\tat org.eclipse.team.internal.ui.actions.TeamAction.selectionChanged(TeamAction.java:269)\n\tat org.eclipse.team.internal.ccvs.ui.actions.CVSAction.selectionChanged(CVSAction.java:194)\n\tat org.eclipse.ui.internal.PluginAction.refreshEnablement(PluginAction.java:211)\n\tat org.eclipse.ui.internal.PluginAction.selectionChanged(PluginAction.java:282)\n\tat org.eclipse.ui.internal.PluginAction.selectionChanged(PluginAction.java:304)\n\tat org.eclipse.ui.internal.AbstractSelectionService.fireSelection(AbstractSelectionService.java:156)\n\tat org.eclipse.ui.internal.AbstractSelectionService.setActivePart(AbstractSelectionService.java:282)\n\tat org.eclipse.ui.internal.WWinPartService.updateActivePart(WWinPartService.java:125)\n\tat org.eclipse.ui.internal.WWinPartService.access$0(WWinPartService.java:115)\n\tat org.eclipse.ui.internal.WWinPartService$1.partDeactivated(WWinPartService.java:48)\n\tat org.eclipse.ui.internal.PartListenerList2$4.run(PartListenerList2.java:113)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:850)\n\tat org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:53)\n\tat org.eclipse.ui.internal.PartListenerList2.firePartDeactivated(PartListenerList2.java:111)\n\tat org.eclipse.ui.internal.PartService.firePartDeactivated(PartService.java:116)\n\tat org.eclipse.ui.internal.PartService.setActivePart(PartService.java:165)\n\tat org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged(WorkbenchPagePartList.java:56)\n\tat org.eclipse.ui.internal.PartList.setActivePart(PartList.java:126)\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3288)\n\tat org.eclipse.ui.internal.WorkbenchPage.requestActivation(WorkbenchPage.java:2832)\n\tat org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:265)\n\tat org.eclipse.ui.internal.PartPane.handleEvent(PartPane.java:229)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:962)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:943)\n\tat org.eclipse.swt.widgets.Shell.setActiveControl(Shell.java:1272)\n\tat org.eclipse.swt.widgets.Shell.WM_MOUSEACTIVATE(Shell.java:2014)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3705)\n\tat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1584)\n\tat org.eclipse.swt.widgets.Shell.windowProc(Shell.java:1752)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2255)\n\tat org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:77)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3752)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2255)\n\tat org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:77)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3752)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2255)\n\tat org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:77)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3752)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2255)\n\tat org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:77)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3752)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2255)\n\tat org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:1397)\n\tat org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5237)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4355)\n\tat org.eclipse.swt.internal.win32.OS.PeekMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.PeekMessage(OS.java:2764)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3279)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2365)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2329)\n\tat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2204)\n\tat org.eclipse.ui.internal.Workbench$4.run(Workbench.java:466)\n\tat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:289)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:461)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:106)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:153)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:497)\n\tat org.eclipse.equinox.launcher.Main.basicRun(Main.java:436)\n\tat org.eclipse.equinox.launcher.Main.run(Main.java:1162)\n\tat org.eclipse.equinox.launcher.Main.main(Main.java:1137)\n",
    "Created an attachment (id\u003d67011)\nPatch 2\n\n",
    "I\u0027ve closed bug 165673 since it requested Team\u003cSynchronize. We\u0027ll leave this bug open since it contains the discussion of what a more general fix would involve."
  ],
  "commentCreationDates": [
    "2006-05-02T19:46:33+02:00",
    "2006-10-02T20:01:36+02:00",
    "2007-05-04T18:17:42+02:00",
    "2007-05-08T12:54:19+02:00",
    "2007-05-08T19:31:03+02:00",
    "2007-05-09T12:10:37+02:00",
    "2007-05-09T15:34:54+02:00",
    "2007-05-11T13:01:09+02:00",
    "2007-05-11T17:02:28+02:00",
    "2007-05-14T09:39:09+02:00",
    "2007-05-14T21:23:48+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.SyncAction.isEnabled",
          "source": "SyncAction.java:243"
        },
        {
          "method": "org.eclipse.team.internal.ui.actions.TeamAction.setActionEnablement",
          "source": "TeamAction.java:284"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.CVSAction.setActionEnablement",
          "source": "CVSAction.java:202"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.WorkspaceAction.setActionEnablement",
          "source": "WorkspaceAction.java:211"
        },
        {
          "method": "org.eclipse.team.internal.ui.actions.TeamAction.selectionChanged",
          "source": "TeamAction.java:269"
        },
        {
          "method": "org.eclipse.team.internal.ccvs.ui.actions.CVSAction.selectionChanged",
          "source": "CVSAction.java:194"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.refreshEnablement",
          "source": "PluginAction.java:211"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.selectionChanged",
          "source": "PluginAction.java:282"
        },
        {
          "method": "org.eclipse.ui.internal.PluginAction.selectionChanged",
          "source": "PluginAction.java:304"
        },
        {
          "method": "org.eclipse.ui.internal.AbstractSelectionService.fireSelection",
          "source": "AbstractSelectionService.java:156"
        },
        {
          "method": "org.eclipse.ui.internal.AbstractSelectionService.setActivePart",
          "source": "AbstractSelectionService.java:282"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.updateActivePart",
          "source": "WWinPartService.java:125"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:115"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partDeactivated",
          "source": "WWinPartService.java:48"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$4.run",
          "source": "PartListenerList2.java:113"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:850"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.fireEvent",
          "source": "PartListenerList2.java:53"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartDeactivated",
          "source": "PartListenerList2.java:111"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartDeactivated",
          "source": "PartService.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:165"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged",
          "source": "WorkbenchPagePartList.java:56"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.setActivePart",
          "source": "PartList.java:126"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:3288"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.requestActivation",
          "source": "WorkbenchPage.java:2832"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.requestActivation",
          "source": "PartPane.java:265"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.handleEvent",
          "source": "PartPane.java:229"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:962"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:943"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.setActiveControl",
          "source": "Shell.java:1272"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.WM_MOUSEACTIVATE",
          "source": "Shell.java:2014"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3705"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1584"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.windowProc",
          "source": "Shell.java:1752"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2255"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3752"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2255"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3752"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2255"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3752"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2255"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3752"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2255"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.callWindowProc",
          "source": "Tree.java:1397"
        },
        {
          "method": "org.eclipse.swt.widgets.Tree.windowProc",
          "source": "Tree.java:5237"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4355"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.PeekMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.PeekMessage",
          "source": "OS.java:2764"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3279"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:2365"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:2329"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$4",
          "source": "Workbench.java:2204"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$4.run",
          "source": "Workbench.java:466"
        },
        {
          "method": "org.eclipse.core.databinding.observable.Realm.runWithDefault",
          "source": "Realm.java:289"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:461"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.application.IDEApplication.start",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:153"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:106"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:76"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:363"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:176"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.invokeFramework",
          "source": "Main.java:497"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.basicRun",
          "source": "Main.java:436"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.run",
          "source": "Main.java:1162"
        },
        {
          "method": "org.eclipse.equinox.launcher.Main.main",
          "source": "Main.java:1137"
        }
      ],
      "number": 0,
      "commentIndex": 8,
      "bugId": "139775",
      "date": "2007-05-11T17:02:28+02:00",
      "product": "Platform",
      "component": "CVS",
      "severity": "normal"
    }
  ],
  "groupId": "139775",
  "bugId": "139775",
  "date": "2006-05-02T19:46:33+02:00",
  "product": "Platform",
  "component": "CVS",
  "severity": "normal"
}