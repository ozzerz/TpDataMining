{
  "comments": [
    "Build 20021218\n\nAfter a crash, I cannot restart my workbench. I get the following exception in \nthe console:\norg.eclipse.swt.SWTException: Invalid thread access\n        at org.eclipse.swt.SWT.error(SWT.java:2180)\n        at org.eclipse.swt.SWT.error(SWT.java:2110)\n        at org.eclipse.swt.widgets.Display.checkDisplay(Display.java:433)\n        at org.eclipse.swt.widgets.Display.create(Display.java:493)\n        at org.eclipse.swt.graphics.Device.\u003cinit\u003e(Device.java:89)\n        at org.eclipse.swt.widgets.Display.\u003cinit\u003e(Display.java:287)\n        at org.eclipse.swt.widgets.Display.\u003cinit\u003e(Display.java:283)\n        at org.eclipse.ui.internal.Workbench.run(Workbench.java:1410)\n        at org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:845)\n        at org.eclipse.core.boot.BootLoader.run(BootLoader.java:462)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.eclipse.core.launcher.Main.basicRun(Main.java:247)\n        at org.eclipse.core.launcher.Main.run(Main.java:703)\n        at org.eclipse.core.launcher.Main.main(Main.java:539)\n\nNothing else is written to the .log file.\n\nI have zipped the .metadata if it can be of any use.",
    "Moving to SWT for comment. \nHow can we get a \"Invalid thread access\" creating the display?",
    "You are creating a display in a thread that already has a display.  The error \nmessage is strictly correct but misleading.  After you fix your problem, send \nthis PR back to remind us to give a better error message.",
    "Jerome, could you send me the workspace you zipped. I want to reproduce the \nproblem. I can\u0027t see how we would be creating a second Display.",
    "Seems like a CVS problem. See the stack trace: CVS core is activating CVS UI \nbefore the Workbench UI is initialized. The CVS UI is calling \nDisplay.getDefault() which ends up creating a display. When the workbench is \ninitialized, it tries to create its display and fails because a display was \nalready created on that thread.\n\nPS: Should plugins (cvs core) be activated before the main application \n(WorkbenchUI in this case)?\n\nThread [main] (Suspended (breakpoint at line 287 in \norg.eclipse.swt.widgets.Display))\n\torg.eclipse.swt.widgets.Display.\u003cinit\u003e\n(org.eclipse.swt.graphics.DeviceData) line: 287\n\torg.eclipse.swt.widgets.Display.\u003cinit\u003e() line: 283\n\torg.eclipse.swt.widgets.Display.getDefault() line: 755\n\torg.eclipse.team.internal.ccvs.ui.CVSUIPlugin\n(org.eclipse.ui.plugin.AbstractUIPlugin).refreshPluginActions() line: 744\n\torg.eclipse.team.internal.ccvs.ui.CVSUIPlugin\n(org.eclipse.ui.plugin.AbstractUIPlugin).startup() line: 793\n\torg.eclipse.team.internal.ccvs.ui.CVSUIPlugin.startup() line: 546\n\torg.eclipse.core.internal.plugins.PluginDescriptor$1.run() line: 705\n\torg.eclipse.core.internal.runtime.InternalPlatform.run\n(org.eclipse.core.runtime.ISafeRunnable) line: 852\n\torg.eclipse.core.internal.plugins.PluginDescriptor.internalDoPluginActi\nvation() line: 717\n\torg.eclipse.core.internal.plugins.PluginDescriptor.doPluginActivation\n() line: 188\n\torg.eclipse.core.internal.plugins.PluginClassLoader.activatePlugin\n(java.lang.String) line: 114\n\torg.eclipse.core.internal.plugins.PluginClassLoader.internalFindClassPa\nrentsSelf(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, boolean) line: 192\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).findClassParentsSelf\n(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, boolean) line: 499\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).loadClass\n(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, java.util.Vector, \nboolean) line: 891\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).loadClass\n(java.lang.String, boolean) line: 871\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(java.lang.ClassLoader).loadClass(java.lang.String) line: 511\n\torg.eclipse.core.internal.plugins.PluginDescriptor.createExecutableExte\nnsion(java.lang.String, java.lang.Object, \norg.eclipse.core.runtime.IConfigurationElement, java.lang.String) line: 130\n\torg.eclipse.core.internal.plugins.PluginDescriptor.createExecutableExte\nnsion(java.lang.String, java.lang.String, java.lang.Object, \norg.eclipse.core.runtime.IConfigurationElement, java.lang.String) line: 167\n\torg.eclipse.core.internal.plugins.ConfigurationElement.createExecutable\nExtension(java.lang.String) line: 103\n\torg.eclipse.team.internal.ccvs.core.CVSTeamProvider.getPluggedInValidat\nor() line: 139\n\torg.eclipse.team.internal.ccvs.core.CVSTeamProvider.getFileModification\nValidator() line: 1131\n\torg.eclipse.team.internal.core.FileModificationValidatorManager.validat\neSave(org.eclipse.core.resources.IFile) line: 94\n\torg.eclipse.core.internal.resources.Workspace$5.run() line: 2074\n\torg.eclipse.core.internal.runtime.InternalPlatform.run\n(org.eclipse.core.runtime.ISafeRunnable) line: 852\n\torg.eclipse.core.runtime.Platform.run\n(org.eclipse.core.runtime.ISafeRunnable) line: 413\n\torg.eclipse.core.internal.resources.Workspace.validateSave\n(org.eclipse.core.resources.IFile) line: 2080\n\torg.eclipse.core.internal.resources.File.setContents\n(java.io.InputStream, int, org.eclipse.core.runtime.IProgressMonitor) line: 264\n\torg.eclipse.core.internal.localstore.FileSystemResourceManager.internal\nWrite(org.eclipse.core.resources.IProject, \norg.eclipse.core.resources.IProjectDescription, int) line: 259\n\torg.eclipse.core.internal.resources.Project.writeDescription\n(org.eclipse.core.resources.IProjectDescription, int) line: 886\n\torg.eclipse.core.internal.resources.Project.writeDescription(int) \nline: 875\n\torg.eclipse.core.internal.resources.Folder\n(org.eclipse.core.internal.resources.Resource).deleteResource(boolean, \norg.eclipse.core.runtime.MultiStatus) line: 663\n\torg.eclipse.core.internal.resources.ResourceTree.deletedFolder\n(org.eclipse.core.resources.IFolder) line: 330\n\torg.eclipse.core.internal.resources.ResourceTree.standardDeleteFolder\n(org.eclipse.core.resources.IFolder, int, \norg.eclipse.core.runtime.IProgressMonitor) line: 522\n\torg.eclipse.core.internal.resources.Folder\n(org.eclipse.core.internal.resources.Resource).delete(int, \norg.eclipse.core.runtime.IProgressMonitor) line: 576\n\torg.eclipse.core.internal.resources.Project.reconcileLinks\n(org.eclipse.core.internal.resources.ProjectDescription) line: 728\n\torg.eclipse.core.internal.resources.Project.updateDescription() line: \n865\n\torg.eclipse.core.internal.resources.File.updateProjectDescription() \nline: 289\n\torg.eclipse.core.internal.localstore.RefreshLocalAliasVisitor\n(org.eclipse.core.internal.localstore.RefreshLocalVisitor).visit\n(org.eclipse.core.internal.localstore.UnifiedTreeNode) line: 253\n\torg.eclipse.core.internal.localstore.UnifiedTree.accept\n(org.eclipse.core.internal.localstore.IUnifiedTreeVisitor, int) line: 71\n\torg.eclipse.core.internal.localstore.FileSystemResourceManager.refreshR\nesource(org.eclipse.core.resources.IResource, int, boolean, \norg.eclipse.core.runtime.IProgressMonitor) line: 512\n\torg.eclipse.core.internal.localstore.FileSystemResourceManager.refresh\n(org.eclipse.core.resources.IResource, int, boolean, \norg.eclipse.core.runtime.IProgressMonitor) line: 498\n\torg.eclipse.core.internal.localstore.FileSystemResourceManager.refreshR\noot(org.eclipse.core.resources.IWorkspaceRoot, int, boolean, \norg.eclipse.core.runtime.IProgressMonitor) line: 542\n\torg.eclipse.core.internal.localstore.FileSystemResourceManager.refresh\n(org.eclipse.core.resources.IResource, int, boolean, \norg.eclipse.core.runtime.IProgressMonitor) line: 491\n\torg.eclipse.core.internal.resources.WorkspaceRoot\n(org.eclipse.core.internal.resources.Resource).refreshLocal(int, \norg.eclipse.core.runtime.IProgressMonitor) line: 1088\n\torg.eclipse.core.internal.resources.Workspace.open\n(org.eclipse.core.runtime.IProgressMonitor) line: 1528\n\torg.eclipse.core.resources.ResourcesPlugin.startup() line: 254\n\torg.eclipse.core.internal.plugins.PluginDescriptor$1.run() line: 705\n\torg.eclipse.core.internal.runtime.InternalPlatform.run\n(org.eclipse.core.runtime.ISafeRunnable) line: 852\n\torg.eclipse.core.internal.plugins.PluginDescriptor.internalDoPluginActi\nvation() line: 717\n\torg.eclipse.core.internal.plugins.PluginDescriptor.doPluginActivation\n() line: 188\n\torg.eclipse.core.internal.plugins.PluginClassLoader.activatePlugin\n(java.lang.String) line: 114\n\torg.eclipse.core.internal.plugins.PluginClassLoader.internalFindClassPa\nrentsSelf(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, boolean) line: 192\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).findClassParentsSelf\n(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, boolean) line: 499\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).loadClass\n(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, java.util.Vector, \nboolean) line: 891\n\torg.eclipse.core.internal.boot.DelegatingURLClassLoader.access$0\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader, java.lang.String, \nboolean, org.eclipse.core.internal.boot.DelegatingURLClassLoader, \njava.util.Vector, boolean) line: 885\n\torg.eclipse.core.internal.boot.DelegatingURLClassLoader$DelegateLoader.\nloadClass(java.lang.String, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, java.util.Vector) \nline: 93\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).findClassPrerequisite\ns(java.lang.String, org.eclipse.core.internal.boot.DelegatingURLClassLoader, \njava.util.Vector) line: 563\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).loadClass\n(java.lang.String, boolean, \norg.eclipse.core.internal.boot.DelegatingURLClassLoader, java.util.Vector, \nboolean) line: 899\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(org.eclipse.core.internal.boot.DelegatingURLClassLoader).loadClass\n(java.lang.String, boolean) line: 871\n\torg.eclipse.core.internal.plugins.PluginClassLoader\n(java.lang.ClassLoader).loadClass(java.lang.String) line: 511\n\torg.eclipse.ui.internal.Workbench.\u003cinit\u003e() line: 137\n\tjava.lang.Class.newInstanceImpl() line: not available [native method]\n\tjava.lang.Class.newInstance() line: 1421\n\torg.eclipse.core.internal.plugins.PluginDescriptor.createExecutableExte\nnsion(java.lang.String, java.lang.Object, \norg.eclipse.core.runtime.IConfigurationElement, java.lang.String) line: 138\n\torg.eclipse.core.internal.plugins.PluginDescriptor.createExecutableExte\nnsion(java.lang.String, java.lang.String, java.lang.Object, \norg.eclipse.core.runtime.IConfigurationElement, java.lang.String) line: 167\n\torg.eclipse.core.internal.plugins.ConfigurationElement.createExecutable\nExtension(java.lang.String) line: 103\n\torg.eclipse.core.internal.runtime.InternalPlatform.loaderGetRunnable\n(java.lang.String) line: 468\n\tjava.lang.reflect.Method(java.lang.reflect.AccessibleObject).invokeImpl\n(java.lang.Object, java.lang.Object[], java.lang.Object) line: not available \n[native method]\n\tjava.lang.reflect.Method(java.lang.reflect.AccessibleObject).invokeL\n(java.lang.Object, java.lang.Object[]) line: 203\n\tjava.lang.reflect.Method.invoke(java.lang.Object, java.lang.Object[]) \nline: 271\n\torg.eclipse.core.internal.boot.InternalBootLoader.getRunnable\n(java.lang.String) line: 471\n\torg.eclipse.core.internal.boot.InternalBootLoader.run\n(java.lang.String, java.net.URL, java.lang.String, java.lang.String[], \njava.lang.Runnable) line: 841\n\torg.eclipse.core.boot.BootLoader.run(java.lang.String, java.net.URL, \njava.lang.String, java.lang.String[], java.lang.Runnable) line: 462\n\tjava.lang.reflect.Method(java.lang.reflect.AccessibleObject).invokeImpl\n(java.lang.Object, java.lang.Object[], java.lang.Object) line: not available \n[native method]\n\tjava.lang.reflect.Method(java.lang.reflect.AccessibleObject).invokeL\n(java.lang.Object, java.lang.Object[]) line: 203\n\tjava.lang.reflect.Method.invoke(java.lang.Object, java.lang.Object[]) \nline: 271\n\torg.eclipse.core.launcher.Main.basicRun(java.lang.String[]) line: 247\n\torg.eclipse.core.launcher.Main.run(java.lang.String[]) line: 703\n\torg.eclipse.core.launcher.Main.main(java.lang.String[]) line: 539\n",
    "See bug 30342. This workspace took 12 minutes to startup.\nUsed the steps described in 30342 but I added breakpoints to the contructors \nin Display. The above stack trace opened after 2 or 3 minutes.",
    "Core should avoid creating exectuable extensions during its startup.  This is\ngenerally bad (can cause deadlock, ClassCircularityErrors).  I will investigate.\n\nEduardo, can you send me the workspace or tell me where to get it?",
    "Jerome, it looks like you once had a linked folder called:\n\norg.eclipse.jdt.core.tests.support/jck\n\nbut the record of the link has been deleted from the .project file.\n\nDoes this sound familiar?",
    "Yes I remember creating such a link folder. However I don\u0027t remember if I \nedited the .project file to remove it. It might be possible though.",
    "Created an attachment (id\u003d3204)\nProposed fix\n",
    "Jerome\u0027s workspace comes up with the proposed patch applied.  Will test further\ntomorrow before releasing.",
    "Fix applied.  The fix was to prevent writing the .project file after discovering\nit had changed in refreshLocal.  This avoids calling the file modification\nvalidator, which was causing CVS UI to load, and the second display to be created."
  ],
  "commentCreationDates": [
    "2002-12-19T16:41:57+01:00",
    "2003-01-06T16:31:35+01:00",
    "2003-01-06T21:32:24+01:00",
    "2003-01-14T17:08:46+01:00",
    "2003-01-27T23:11:44+01:00",
    "2003-01-27T23:22:20+01:00",
    "2003-01-28T14:50:07+01:00",
    "2003-01-28T22:31:19+01:00",
    "2003-01-28T22:53:55+01:00",
    "2003-01-28T23:27:04+01:00",
    "2003-01-28T23:51:51+01:00",
    "2003-01-29T15:17:11+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Invalid thread access",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2180"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2110"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.checkDisplay",
          "source": "Display.java:433"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.create",
          "source": "Display.java:493"
        },
        {
          "method": "org.eclipse.swt.graphics.Device.\u003cinit\u003e",
          "source": "Device.java:89"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.\u003cinit\u003e",
          "source": "Display.java:287"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.\u003cinit\u003e",
          "source": "Display.java:283"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1410"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:845"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:462"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:247"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:703"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:539"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "28678",
      "date": "2002-12-19T16:41:57+01:00",
      "product": "Platform",
      "component": "Resources",
      "severity": "critical"
    }
  ],
  "groupId": "28678",
  "bugId": "28678",
  "date": "2002-12-19T16:41:57+01:00",
  "product": "Platform",
  "component": "Resources",
  "severity": "critical"
}