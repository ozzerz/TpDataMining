{
  "comments": [
    "This is similar, but not equal to bug 171359 and bug 161577 . \nIn my dev workspace , I choose the \u0027open type\u0027 button in the toolbar then start typing in the search field and an error pops up with the message:  An internal error occurred during: \"Items filtering\".\n\nThe error pops out only for some types (it works if I start typing \u0027f\u0027 but not with \u0027s\u0027 or \u0027d\u0027 ) and it depends on what projects are open in my workspace ( I suspect that some specific class names cause trouble ... I will update the bug if I find which class name is causing the problem ). \n\nThis is the error stack trace : \njava.lang.NullPointerException\n\tat org.eclipse.jdt.internal.core.search.JavaSearchScope.packageFragmentRoot(JavaSearchScope.java:592)\n\tat org.eclipse.jdt.internal.core.search.TypeNameMatchRequestorWrapper.createTypeFromPath(TypeNameMatchRequestorWrapper.java:156)\n\tat org.eclipse.jdt.internal.core.search.TypeNameMatchRequestorWrapper.acceptType(TypeNameMatchRequestorWrapper.java:107)\n\tat org.eclipse.jdt.internal.core.search.BasicSearchEngine$2.acceptIndexMatch(BasicSearchEngine.java:768)\n\tat org.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.acceptMatch(InternalSearchPattern.java:45)\n\tat org.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.findIndexMatches(InternalSearchPattern.java:89)\n\tat org.eclipse.jdt.internal.core.search.matching.MatchLocator.findIndexMatches(MatchLocator.java:325)\n\tat org.eclipse.jdt.internal.core.search.PatternSearchJob.search(PatternSearchJob.java:114)\n\tat org.eclipse.jdt.internal.core.search.PatternSearchJob.execute(PatternSearchJob.java:64)\n\tat org.eclipse.jdt.internal.core.search.processing.JobManager.performConcurrentJob(JobManager.java:265)\n\tat org.eclipse.jdt.internal.core.search.BasicSearchEngine.searchAllTypeNames(BasicSearchEngine.java:779)\n\tat org.eclipse.jdt.core.search.SearchEngine.searchAllTypeNames(SearchEngine.java:781)\n\tat org.eclipse.jdt.internal.ui.dialogs.FilteredTypesSelectionDialog.fillContentProvider(FilteredTypesSelectionDialog.java:479)\n\tat org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.filterContent(FilteredItemsSelectionDialog.java:1945)\n\tat org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.internalRun(FilteredItemsSelectionDialog.java:1882)\n\tat org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.doRun(FilteredItemsSelectionDialog.java:1853)\n\tat org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.run(FilteredItemsSelectionDialog.java:1840)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)\n\nThese are the session data : \neclipse.buildId\u003dI20070323-1616\njava.version\u003d1.6.0-dp\njava.vendor\u003dApple Computer, Inc.\nBootLoader constants: OS\u003dmacosx, ARCH\u003dx86, WS\u003dcarbon, NL\u003den_US\nFramework arguments:  -startup /Users/battlehorse/bin/eclipse3.3/Eclipse.app/Contents/MacOS/../../../plugins/org.eclipse.equinox.launcher_1.0.0.v20070319.jar -keyring /Users/battlehorse/.eclipse_keyring -showlocation\nCommand-line arguments:  -os macosx -ws carbon -arch x86 -startup /Users/battlehorse/bin/eclipse3.3/Eclipse.app/Contents/MacOS/../../../plugins/org.eclipse.equinox.launcher_1.0.0.v20070319.jar -keyring /Users/battlehorse/.eclipse_keyring -consoleLog -showlocation",
    "The element returned by JavaCore.create(IResource) might be null as specified in the javadoc comment. I should have take this possibility into account and protect the line after in JavaSearchScope (ie. line 593) for such a case...\n\nHowever, I really would like to know which kind of resource can make this happen. It would be really helpful if you found the offending one or if you could send me the workspace for debugging...\n",
    "Can you also run Eclipse with the -debug option and put a .options file in your Eclipse install directory with the following content:\n\n# Turn on debug tracing for org.eclipse.jdt.core plugin\norg.eclipse.jdt.core/debug\u003dtrue\n# Reports java search activity\norg.eclipse.jdt.core/debug/search\u003dtrue\n\nYou should get a trace in the console of the search engine activity.\n",
    "I was able to reproduce the NPE using the wksp you sent me, thanks for your time.\n\nProblem comes from your project classpath which both defines the \u0027bin\u0027 folder as the output and as a class folder. This is not supposed to be a valid build path and you cannot set it using the Java Build Path preference page...\n\nHowever, as user can modify .classpath by hand, we obviously should not trap into a NPE when this configuration is set. I will fix that issue and will also open a separate bug to add a marker for this specific problem while validating the classpath...\n\nThe good news is that you have an easy workaround to avoid this NPE, just remove the unnecessary class folder \u0027bin\u0027 entry. I tried it and it works well after :-)\n",
    "You are right, removing the additional entry in the classpath fixes the problem. \nHowever, the statement \u0027you cannot set it using the Java Build Path preference page\u0027 is not entirely right. Even if I can set it from the preference page, I can still do it from plugin.xml/MANIFEST.MF editor (adding the bin/ folder in the classpath section of the \u0027Runtime\u0027 tab ) and no errors nor warnings are raised.\n\nThanks for your (extremely rapid) help . ",
    "(In reply to comment #4)\n\u003e You are right, removing the additional entry in the classpath fixes the\n\u003e problem. \n\u003e However, the statement \u0027you cannot set it using the Java Build Path preference\n\u003e page\u0027 is not entirely right. Even if I can set it from the preference page, I\n\u003e can still do it from plugin.xml/MANIFEST.MF editor (adding the bin/ folder in\n\u003e the classpath section of the \u0027Runtime\u0027 tab ) and no errors nor warnings are\n\u003e raised.\n\u003e \nIt\u0027s not exactly the same configuration than the project in your workspace, as doing this you add the output location as a source folder. This configuration is valid (same as when your project has not explicit source folder, project folder is both source folder and output location).\n\nBut I agree that doing this, you get the NPE as well, so we now have a simple scenario to reproduce the bug:\n1) Create a new Plug-in project, let\u0027s say \u0027P\u0027\n2) Create a new class in source folder, let\u0027s say \u0027Test\u0027\n3) Switch off auto build or if it was already OFF, then build the project \u0027P\u0027\n4) Delete the source file Test.java in src\n5) Open project properties, select \u0027Java Build Path\u0027 page and \u0027Source Folder\u0027\n   tab and add the bin folder as source folder\n6) Open Type dialog and enter \u0027T\u0027\n   \u003d\u003e you get the NPE!\n\n\u003e Thanks for your (extremely rapid) help . \n\u003e \nYou\u0027re welcome\n",
    "Sorry, the scenario was boggus, as I finally do not get the NPE with it.\n\nStep 5 should be instead:\n5) Open .classpath, add following line and save it:\n\t\u003cclasspathentry kind\u003d\"lib\" path\u003d\"bin\"/\u003e\n\n",
    "Released for 3.3 M7 in HEAD stream.\n\nChange was done in JavaModelManager.create(IFolder, IJavaProject): remove final test to see if the folder confilcts with output location.\n\nTest case added in JavaSearchScopeTests#testBug179199()\n",
    "*** Bug 182372 has been marked as a duplicate of this bug. ***",
    "Verified for 3.3M7 with I20070427-0010"
  ],
  "commentCreationDates": [
    "2007-03-25T19:16:28+02:00",
    "2007-03-25T21:04:50+02:00",
    "2007-03-26T11:02:50+02:00",
    "2007-03-26T16:06:06+02:00",
    "2007-03-26T17:09:30+02:00",
    "2007-03-26T19:22:39+02:00",
    "2007-03-26T19:28:10+02:00",
    "2007-03-28T10:49:44+02:00",
    "2007-04-16T10:51:45+02:00",
    "2007-04-27T16:16:44+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.search.JavaSearchScope.packageFragmentRoot",
          "source": "JavaSearchScope.java:592"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.TypeNameMatchRequestorWrapper.createTypeFromPath",
          "source": "TypeNameMatchRequestorWrapper.java:156"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.TypeNameMatchRequestorWrapper.acceptType",
          "source": "TypeNameMatchRequestorWrapper.java:107"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.BasicSearchEngine$2.acceptIndexMatch",
          "source": "BasicSearchEngine.java:768"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.acceptMatch",
          "source": "InternalSearchPattern.java:45"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.InternalSearchPattern.findIndexMatches",
          "source": "InternalSearchPattern.java:89"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.matching.MatchLocator.findIndexMatches",
          "source": "MatchLocator.java:325"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.PatternSearchJob.search",
          "source": "PatternSearchJob.java:114"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.PatternSearchJob.execute",
          "source": "PatternSearchJob.java:64"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.processing.JobManager.performConcurrentJob",
          "source": "JobManager.java:265"
        },
        {
          "method": "org.eclipse.jdt.internal.core.search.BasicSearchEngine.searchAllTypeNames",
          "source": "BasicSearchEngine.java:779"
        },
        {
          "method": "org.eclipse.jdt.core.search.SearchEngine.searchAllTypeNames",
          "source": "SearchEngine.java:781"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.dialogs.FilteredTypesSelectionDialog.fillContentProvider",
          "source": "FilteredTypesSelectionDialog.java:479"
        },
        {
          "method": "org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.filterContent",
          "source": "FilteredItemsSelectionDialog.java:1945"
        },
        {
          "method": "org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.internalRun",
          "source": "FilteredItemsSelectionDialog.java:1882"
        },
        {
          "method": "org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.doRun",
          "source": "FilteredItemsSelectionDialog.java:1853"
        },
        {
          "method": "org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$FilterJob.run",
          "source": "FilteredItemsSelectionDialog.java:1840"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:58"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "179199",
      "date": "2007-03-25T19:16:28+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "179199",
  "bugId": "179199",
  "date": "2007-03-25T19:16:28+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}