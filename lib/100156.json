{
  "comments": [
    "Consider the following setup: there is a tree viewer that contains\nTreeElementWrapper instances. TreeElementWrapper class is an IAdaptable and may\nsometimes adapt to IResource instance.\n\n   When RenameResourceAction receives selectionChanged() it enables itself\n(since wrapper adapts to resource) but in runWithInlineEditor() method it\nqueries raw selection instead of adapted resources list - thus CCE.\n\njava.lang.ClassCastException: com.xcom.TreeElementWrapper\n        at\norg.eclipse.ui.actions.RenameResourceAction.runWithInlineEditor(RenameResourceAction.java:462)\n        at\norg.eclipse.ui.actions.RenameResourceAction.run(RenameResourceAction.java:454)\n        at\norg.eclipse.ui.actions.BaseSelectionListenerAction.runWithEvent(BaseSelectionListenerAction.java:167)\n        at com.xcom.CompositeAction.runWithEvent(CompositeAction.java:26)\n        at org.eclipse.ui.commands.ActionHandler.execute(ActionHandler.java:182)\n        at\norg.eclipse.ui.internal.handlers.LegacyHandlerWrapper.execute(LegacyHandlerWrapper.java:108)\n        at org.eclipse.core.commands.Command.execute(Command.java:311)\n        at\norg.eclipse.core.commands.ParameterizedCommand.execute(ParameterizedCommand.java:396)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand(WorkbenchKeyboard.java:452)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard.press(WorkbenchKeyboard.java:722)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent(WorkbenchKeyboard.java:766)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings(WorkbenchKeyboard.java:543)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard.access$3(WorkbenchKeyboard.java:486)\n        at\norg.eclipse.ui.internal.keys.WorkbenchKeyboard$KeyDownFilter.handleEvent(WorkbenchKeyboard.java:110)",
    "Tod can you investigate?",
    "Correct - (IResource) getStructuredSelection().getFirstElement() will throw a\nCastCastException because TreeElementWrapper is not an IResource.\n\nAll of the code in RenameResourceAction assumes that it is an IResource being\nused. This action should be not used for viewers that are not showing resources.\n\nWe should be more explicit about this in the javadoc for this type. Renaming to\nreflect this.",
    "I think that you should not take it that radically - this is a minor\ninconsistency problem; this action works with resources or (!) objects adaptable\nto resources, so every time you need selected resources you have to call\ngetSelectedResources() method and direct access to the structured selection here\nis an inconsitency that have led to the problem; just call\ngetSelectedResources() in the reported line.",
    "You so your point is more that we should use getAdapter(IResource) rather than\ncasting? That is a reasonable idea.\n\nDoes com.xcom.TreeElementWrapper adapt to IResource?",
    "Sure! That\u0027s how that action got enabled.",
    "Renaming an upping proirity. Thanks for the clarification. If you have a\nsuggested patch (and a test case if you have one) I would be happy to review it.",
    "Just call getSelectedResources() at the line 462; run() actually does this!\nCan you fix it in release?",
    "It\u0027s too close to the 3.1 release now for us to do this (3 days away) but we\ncould consider it for 3.1.1.\n\nUpping priority",
    "Fixed for build \u003e20050630.",
    "Verified in 20050808"
  ],
  "commentCreationDates": [
    "2005-06-15T14:37:40+02:00",
    "2005-06-15T19:27:28+02:00",
    "2005-06-15T20:07:09+02:00",
    "2005-06-16T09:26:20+02:00",
    "2005-06-16T14:48:25+02:00",
    "2005-06-16T14:53:42+02:00",
    "2005-06-16T15:00:25+02:00",
    "2005-06-21T12:31:23+02:00",
    "2005-06-21T12:43:22+02:00",
    "2005-06-30T19:50:04+02:00",
    "2005-08-09T20:33:17+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "com.xcom.TreeElementWrapper",
      "elements": [
        {
          "method": "org.eclipse.ui.actions.RenameResourceAction.runWithInlineEditor",
          "source": "RenameResourceAction.java:462"
        },
        {
          "method": "org.eclipse.ui.actions.RenameResourceAction.run",
          "source": "RenameResourceAction.java:454"
        },
        {
          "method": "org.eclipse.ui.actions.BaseSelectionListenerAction.runWithEvent",
          "source": "BaseSelectionListenerAction.java:167"
        },
        {
          "method": "com.xcom.CompositeAction.runWithEvent",
          "source": "CompositeAction.java:26"
        },
        {
          "method": "org.eclipse.ui.commands.ActionHandler.execute",
          "source": "ActionHandler.java:182"
        },
        {
          "method": "org.eclipse.ui.internal.handlers.LegacyHandlerWrapper.execute",
          "source": "LegacyHandlerWrapper.java:108"
        },
        {
          "method": "org.eclipse.core.commands.Command.execute",
          "source": "Command.java:311"
        },
        {
          "method": "org.eclipse.core.commands.ParameterizedCommand.execute",
          "source": "ParameterizedCommand.java:396"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand",
          "source": "WorkbenchKeyboard.java:452"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.press",
          "source": "WorkbenchKeyboard.java:722"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent",
          "source": "WorkbenchKeyboard.java:766"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings",
          "source": "WorkbenchKeyboard.java:543"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$3",
          "source": "WorkbenchKeyboard.java:486"
        },
        {
          "method": "org.eclipse.ui.internal.keys.WorkbenchKeyboard$KeyDownFilter.handleEvent",
          "source": "WorkbenchKeyboard.java:110"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "100156",
      "date": "2005-06-15T14:37:40+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "100156",
  "bugId": "100156",
  "date": "2005-06-15T14:37:40+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}