{
  "comments": [
    "I\u0027ve defined an AspectJ InPath with a JAR file.  I get the following exception:\n\nError 2005-08-20 15:51:46.823 NullPointerException thrown: null\njava.lang.NullPointerException\nat org.aspectj.weaver.ResolvedType.addAndRecurse(ResolvedType.java:246)\nat org.aspectj.weaver.ResolvedType.addAndRecurse(ResolvedType.java:257)\nat org.aspectj.weaver.ResolvedType.addAndRecurse(ResolvedType.java:263)\nat org.aspectj.weaver.ResolvedType.getMethodsWithoutIterator(ResolvedType.java:241)\nat org.aspectj.weaver.ResolvedType.lookupResolvedMember(ResolvedType.java:332)\nat\norg.aspectj.weaver.ResolvedMemberImpl.accumulateMembersMatching(ResolvedMemberImpl.java:213)\nat\norg.aspectj.weaver.ResolvedMemberImpl.getJoinPointSignatures(ResolvedMemberImpl.java:167)\nat org.aspectj.weaver.MemberImpl.getJoinPointSignatures(MemberImpl.java:917)\nat org.aspectj.weaver.patterns.SignaturePattern.matches(SignaturePattern.java:150)\nat org.aspectj.weaver.patterns.KindedPointcut.matchInternal(KindedPointcut.java:112)\nat org.aspectj.weaver.patterns.Pointcut.match(Pointcut.java:151)\nat org.aspectj.weaver.patterns.AndPointcut.matchInternal(AndPointcut.java:61)\nat org.aspectj.weaver.patterns.Pointcut.match(Pointcut.java:151)\nat org.aspectj.weaver.ShadowMunger.match(ShadowMunger.java:62)\nat org.aspectj.weaver.Advice.match(Advice.java:102)\nat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1724)\nat\norg.aspectj.weaver.bcel.BcelClassWeaver.matchInvokeInstruction(BcelClassWeaver.java:1713)\nat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1526)\nat org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1355)\nat org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:381)\nat org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:96)\nat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1368)\nat org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:1333)\nat org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:1110)\nat org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:997)\nat\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:286)\nat\norg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:165)\nat\norg.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)\nat org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:367)\nat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:728)\nat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:207)\nat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:167)\nat\norg.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild(AjBuildManager.java:148)\nat org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:116)\nat\norg.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)",
    "Can you provide a testcase?\nAlso, what is the full version ID of the AJDT build you are using?\n",
    "(In reply to comment #1)\n\u003e Can you provide a testcase?\n\u003e Also, what is the full version ID of the AJDT build you are using?\n\u003e \n\nUnfortunately, no.  It seems to be sporadic. I\u0027ll work on it, though.\n\nThe version is 1.3.0.20050824130753",
    "The exception is down in the weaver, so passing over to AspectJ.",
    "if the bug is sporadic, that suggests an incremental compilation type issue -\ndoes a full build always resolve the issue? \n\nLooking at the line of code involved, this NPE can only happen when the\ngetSuperclass() call on a ResolvedType is returning null. This may be caused by\na superclass type that cannot be found on the classpath (resolving to a\nResolvedType.Missing, which if then asked for *it\u0027s* superclass will return null).\n\nI\u0027m going to put in some extra defences to catch that situation and put out a\n\"can\u0027t find type\" message. It probably shouldn\u0027t be that the type can\u0027t be found\n- that\u0027s the underlying incremental bug I suspect, but at least this will give a\n non-crashing build and a sensible error message that further problems could be\ndiagnosed from.",
    "Extra defences checked in. Compiler will now give a normal error message in this\nsituation saying that the supertype of {0} could not be found. I\u0027m going to\nassign the bug the \"REMIND\" status as there is some underlying problem here that\nstill needs to be resolved. If you see any unexpected \"can\u0027t find type\" messages\nafter picking up and AJDT with this fix in, please attach the details to this\nbug and reopen it.\n\nThanks, A.",
    "Now that I understand more about the error, it occurs to me that the following\nmay be the problem:\n\nI am libraries for which I only have the binary jar files.  These libraries have\nreferences to types that aren\u0027t available on my classpath.  This doesn\u0027t affect\nnormal Java operations because I don\u0027t execute the codepaths requiring the\nmissing types.  However, AspectJ seems to need a complete closure over types. \nThis manifests in all sorts of warning/errors in the Problems view and I bet\nthis is somehow related to the NullPointerException.\n\nIt would be very nice if AspectJ didn\u0027t need all the types.  Right now, I create\nstubbed types just to make it happy.",
    "That makes sense. We would very much like to reduce the number of situations in\nwhich AspectJ tries to find all types in the world (or at least it feels like\nthat ;) ), and it\u0027s something we continually try to chip away at...."
  ],
  "commentCreationDates": [
    "2005-08-21T00:54:07+02:00",
    "2005-08-23T14:53:14+02:00",
    "2005-08-25T04:40:28+02:00",
    "2005-08-29T19:20:30+02:00",
    "2005-08-30T13:42:45+02:00",
    "2005-08-30T15:05:38+02:00",
    "2005-08-30T21:11:19+02:00",
    "2005-08-31T10:14:25+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.aspectj.weaver.ResolvedType.addAndRecurse",
          "source": "ResolvedType.java:246"
        },
        {
          "method": "org.aspectj.weaver.ResolvedType.addAndRecurse",
          "source": "ResolvedType.java:257"
        },
        {
          "method": "org.aspectj.weaver.ResolvedType.addAndRecurse",
          "source": "ResolvedType.java:263"
        },
        {
          "method": "org.aspectj.weaver.ResolvedType.getMethodsWithoutIterator",
          "source": "ResolvedType.java:241"
        },
        {
          "method": "org.aspectj.weaver.ResolvedType.lookupResolvedMember",
          "source": "ResolvedType.java:332"
        },
        {
          "method": "org.aspectj.weaver.ResolvedMemberImpl.accumulateMembersMatching",
          "source": "ResolvedMemberImpl.java:213"
        },
        {
          "method": "org.aspectj.weaver.ResolvedMemberImpl.getJoinPointSignatures",
          "source": "ResolvedMemberImpl.java:167"
        },
        {
          "method": "org.aspectj.weaver.MemberImpl.getJoinPointSignatures",
          "source": "MemberImpl.java:917"
        },
        {
          "method": "org.aspectj.weaver.patterns.SignaturePattern.matches",
          "source": "SignaturePattern.java:150"
        },
        {
          "method": "org.aspectj.weaver.patterns.KindedPointcut.matchInternal",
          "source": "KindedPointcut.java:112"
        },
        {
          "method": "org.aspectj.weaver.patterns.Pointcut.match",
          "source": "Pointcut.java:151"
        },
        {
          "method": "org.aspectj.weaver.patterns.AndPointcut.matchInternal",
          "source": "AndPointcut.java:61"
        },
        {
          "method": "org.aspectj.weaver.patterns.Pointcut.match",
          "source": "Pointcut.java:151"
        },
        {
          "method": "org.aspectj.weaver.ShadowMunger.match",
          "source": "ShadowMunger.java:62"
        },
        {
          "method": "org.aspectj.weaver.Advice.match",
          "source": "Advice.java:102"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java:1724"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.matchInvokeInstruction",
          "source": "BcelClassWeaver.java:1713"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java:1526"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.match",
          "source": "BcelClassWeaver.java:1355"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:381"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelClassWeaver.weave",
          "source": "BcelClassWeaver.java:96"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:1368"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump",
          "source": "BcelWeaver.java:1333"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify",
          "source": "BcelWeaver.java:1110"
        },
        {
          "method": "org.aspectj.weaver.bcel.BcelWeaver.weave",
          "source": "BcelWeaver.java:997"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave",
          "source": "AjCompilerAdapter.java:286"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling",
          "source": "AjCompilerAdapter.java:165"
        },
        {
          "method": "org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$org_aspectj_ajdt_internal_compiler_CompilerAdapter$2$f9cc9ca0",
          "source": "CompilerAdapter.aj:70"
        },
        {
          "method": "org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:367"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation",
          "source": "AjBuildManager.java:728"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:207"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild",
          "source": "AjBuildManager.java:167"
        },
        {
          "method": "org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild",
          "source": "AjBuildManager.java:148"
        },
        {
          "method": "org.aspectj.ajde.internal.CompilerAdapter.compile",
          "source": "CompilerAdapter.java:116"
        },
        {
          "method": "org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run",
          "source": "AspectJBuildManager.java:191"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "107530",
      "date": "2005-08-21T00:54:07+02:00",
      "product": "AspectJ",
      "component": "Compiler",
      "severity": "normal"
    }
  ],
  "groupId": "107530",
  "bugId": "107530",
  "date": "2005-08-21T00:54:07+02:00",
  "product": "AspectJ",
  "component": "Compiler",
  "severity": "normal"
}