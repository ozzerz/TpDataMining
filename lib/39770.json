{
  "comments": [
    "When workbench closes an editor it sends WM_DESTROY to client window before it \nnotifies the client about closing. It make impossible for a client to do any \nkind of cleanup which needs to be done BEFORE client window is destroyed. \nRelevant code from WorkbenchPage.java looks like:\n    getEditorManager().closeEditor(ref);\n    firePartClosed(ref);\n    disposePart(ref);\n\nWorkbench must notify client about closing before it does \"getEditorManager\n().closeEditor(ref);\" which destroys client window.",
    "What type of things would you need to do before the editor widget is destroyed?",
    "My editor window contains AWT/Swing base application,\nsee https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d39401 for discussion\nabout how it is done. It has to be disposed before parent window receives\nWM_DESTROY message. Otherwise AWT native code throws an exception:\n\njava.lang.NullPointerException: null pData\n at sun.awt.windows.WComponentPeer.removeNativeDropTarget(Native Method)\n at sun.awt.windows.WComponentPeer.removeDropTarget(WComponentPeer.java:642)\n at java.awt.dnd.DropTarget.removeNotify(DropTarget.java:492)\n at java.awt.Component.removeNotify(Component.java:5543)\n at java.awt.Container.removeNotify(Container.java:2069)\n at javax.swing.JComponent.removeNotify(JComponent.java:4299)\n at com.ddi.awt.TextEditorComponent.removeNotify(TextEditorComponent.java:1075)\n at java.awt.Container.removeNotify(Container.java:2064)\n at javax.swing.JComponent.removeNotify(JComponent.java:4299)\n at java.awt.Container.removeNotify(Container.java:2064)\n at javax.swing.JComponent.removeNotify(JComponent.java:4299)\n at com.ddi.awt.ScrollerPanel.removeNotify(ScrollerPanel.java:155)\n at java.awt.Container.removeNotify(Container.java:2064)\n at javax.swing.JComponent.removeNotify(JComponent.java:4299)\n at java.awt.Container.remove(Container.java:713)\n at java.awt.Container.remove(Container.java:766)\n at com.windriver.rb.eclipse.fm.RiverBedPlugin$PartHandler.partClosed\n(RiverBedPlugin.java:328)\n at org.eclipse.ui.internal.PartListenerList2$3.run(PartListenerList2.java:85)\n at org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:889)\n at org.eclipse.core.runtime.Platform.run(Platform.java:413)\n at org.eclipse.ui.internal.PartListenerList2.firePartClosed\n(PartListenerList2.java:83)\n at org.eclipse.ui.internal.WorkbenchPage.firePartClosed\n(WorkbenchPage.java:1238)\n at org.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:832)\n at org.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:795)\n at org.eclipse.ui.internal.EditorPane.doHide(EditorPane.java:93)\n at org.eclipse.ui.internal.EditorWorkbook$1.itemClosed(EditorWorkbook.java:161)\n at org.eclipse.swt.custom.CTabFolder.closeNotify(CTabFolder.java:307)\n at org.eclipse.swt.custom.CTabFolder.access$13(CTabFolder.java:297)\n at org.eclipse.swt.custom.CTabFolder$4.handleEvent(CTabFolder.java:438)\n at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:81)\n at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:840)\n at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1882)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1591)\n at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1431)\n at org.eclipse.ui.internal.Workbench.run(Workbench.java:1414)\n at org.eclipse.core.internal.boot.InternalBootLoader$1.run\n(InternalBootLoader.java:854)\n at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:171)\n at java.awt.EventQueue.dispatchEvent(EventQueue.java:448)\n at java.awt.EventDispatchThread.pumpOneEventForHierarchy\n(EventDispatchThread.java:197)\n at java.awt.EventDispatchThread.pumpEventsForHierarchy\n(EventDispatchThread.java:150)\n at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:144)\n at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:136)\n at java.awt.EventDispatchThread.run(EventDispatchThread.java:99)\n\n",
    "We have no API to allow you to do this.\n\nNick, can you comment on this - that is, will there be time to address this \nissue in 3.0 by someone on the UI team?",
    "If you hook a dispose listener on the view\u0027s control in its createPartControl \nmethod, this will get called before the control\u0027s handle is actually \ndestroyed.  See Widget.dispose(), which does:\n\treleaseChild ();\n\treleaseWidget ();\n\tdestroyWidget ();\n\nThe Dispose notification is sent in releaseWidget.  The handle is actually \ndestroyed in destroyWidget.",
    "Please reopen if this proposed solution does not meet your needs.",
    "Yes, the dispose listener does solve the problem.\nThanks!"
  ],
  "commentCreationDates": [
    "2003-07-08T20:53:34+02:00",
    "2003-07-10T23:21:01+02:00",
    "2003-07-11T18:46:03+02:00",
    "2003-07-11T20:50:16+02:00",
    "2003-07-11T22:17:22+02:00",
    "2003-07-14T17:05:59+02:00",
    "2003-07-14T19:27:44+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "message": "null pData",
      "elements": [
        {
          "method": "sun.awt.windows.WComponentPeer.removeNativeDropTarget",
          "source": "Native Method"
        },
        {
          "method": "sun.awt.windows.WComponentPeer.removeDropTarget",
          "source": "WComponentPeer.java:642"
        },
        {
          "method": "java.awt.dnd.DropTarget.removeNotify",
          "source": "DropTarget.java:492"
        },
        {
          "method": "java.awt.Component.removeNotify",
          "source": "Component.java:5543"
        },
        {
          "method": "java.awt.Container.removeNotify",
          "source": "Container.java:2069"
        },
        {
          "method": "javax.swing.JComponent.removeNotify",
          "source": "JComponent.java:4299"
        },
        {
          "method": "com.ddi.awt.TextEditorComponent.removeNotify",
          "source": "TextEditorComponent.java:1075"
        },
        {
          "method": "java.awt.Container.removeNotify",
          "source": "Container.java:2064"
        },
        {
          "method": "javax.swing.JComponent.removeNotify",
          "source": "JComponent.java:4299"
        },
        {
          "method": "java.awt.Container.removeNotify",
          "source": "Container.java:2064"
        },
        {
          "method": "javax.swing.JComponent.removeNotify",
          "source": "JComponent.java:4299"
        },
        {
          "method": "com.ddi.awt.ScrollerPanel.removeNotify",
          "source": "ScrollerPanel.java:155"
        },
        {
          "method": "java.awt.Container.removeNotify",
          "source": "Container.java:2064"
        },
        {
          "method": "javax.swing.JComponent.removeNotify",
          "source": "JComponent.java:4299"
        },
        {
          "method": "java.awt.Container.remove",
          "source": "Container.java:713"
        },
        {
          "method": "java.awt.Container.remove",
          "source": "Container.java:766"
        },
        {
          "method": "com.windriver.rb.eclipse.fm.RiverBedPlugin$PartHandler.partClosed",
          "source": "RiverBedPlugin.java:328"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$3.run",
          "source": "PartListenerList2.java:85"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:889"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:413"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartClosed",
          "source": "PartListenerList2.java:83"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.firePartClosed",
          "source": "WorkbenchPage.java:1238"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditor",
          "source": "WorkbenchPage.java:832"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditor",
          "source": "WorkbenchPage.java:795"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.doHide",
          "source": "EditorPane.java:93"
        },
        {
          "method": "org.eclipse.ui.internal.EditorWorkbook$1.itemClosed",
          "source": "EditorWorkbook.java:161"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.closeNotify",
          "source": "CTabFolder.java:307"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.access$13",
          "source": "CTabFolder.java:297"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$4.handleEvent",
          "source": "CTabFolder.java:438"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:81"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:840"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1882"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1591"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1431"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1414"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader$1.run",
          "source": "InternalBootLoader.java:854"
        },
        {
          "method": "java.awt.event.InvocationEvent.dispatch",
          "source": "InvocationEvent.java:171"
        },
        {
          "method": "java.awt.EventQueue.dispatchEvent",
          "source": "EventQueue.java:448"
        },
        {
          "method": "java.awt.EventDispatchThread.pumpOneEventForHierarchy",
          "source": "EventDispatchThread.java:197"
        },
        {
          "method": "java.awt.EventDispatchThread.pumpEventsForHierarchy",
          "source": "EventDispatchThread.java:150"
        },
        {
          "method": "java.awt.EventDispatchThread.pumpEvents",
          "source": "EventDispatchThread.java:144"
        },
        {
          "method": "java.awt.EventDispatchThread.pumpEvents",
          "source": "EventDispatchThread.java:136"
        },
        {
          "method": "java.awt.EventDispatchThread.run",
          "source": "EventDispatchThread.java:99"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "39770",
      "date": "2003-07-11T18:46:03+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "critical"
    }
  ],
  "groupId": "39770",
  "bugId": "39770",
  "date": "2003-07-08T20:53:34+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "critical"
}