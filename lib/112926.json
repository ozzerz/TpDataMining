{
  "comments": [
    "Eclipse SDK\nVersion: 3.1.1\nBuild id: M20050914-1235\n\nSteps:\n1. Create a Java Project and add a Java Class C1 (using Java Class Wizard)\n2. Open C1.java Editor and modify teh C1 class code (can add only a comment) to \nmake the file dirty\n\n3. select the C1.java in package explorer and choose Replace With -\u003ePrevious \nfrom Local History\nActual: The C1. java editor is still opened and dirtied and teh changes made to \nthe class are still theer (e.g the comment)\nExpected: Since File was not saved once we should get a message that \u0027There is \nno Local History \u0027 for this class (same as I get if I repeat the steps with a \ntext file created under Java Project\n\n4. Now Try to close dirtied Java Editor.\nActual: You get a message that \u0027The File Has  been changed on the file \nsystem...\u0027 and some exceptions in log (see below the error log)\nExpected: no exceptions\n\n\nError log:\n!ENTRY org.eclipse.ui.workbench 4 0 2005-10-17 14:17:51.890\n!MESSAGE WARNING: Blocked recursive attempt to close part \norg.eclipse.jdt.ui.CompilationUnitEditor while still in the middle of \nactivating it\n!STACK 0\njava.lang.RuntimeException: WARNING: Blocked recursive attempt to close part \norg.eclipse.jdt.ui.CompilationUnitEditor while still in the middle of \nactivating it\n\tat org.eclipse.ui.internal.WorkbenchPage.closeEditors\n(WorkbenchPage.java:1151)\n\tat org.eclipse.ui.internal.WorkbenchPage.closeEditor\n(WorkbenchPage.java:1279)\n\tat org.eclipse.ui.internal.EditorPane.doHide(EditorPane.java:54)\n\tat org.eclipse.ui.internal.PartStack.close(PartStack.java:495)\n\tat org.eclipse.ui.internal.EditorStack.close(EditorStack.java:197)\n\tat org.eclipse.ui.internal.PartStack$1.close(PartStack.java:102)\n\tat \norg.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent\n(TabbedStackPresentation.java:81)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:267)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:276)\n\tat \norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.acces\ns$1(DefaultTabFolder.java:1)\n\tat \norg.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.clo\nseButtonPressed(DefaultTabFolder.java:67)\n\tat org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners\n(PaneFolder.java:584)\n\tat org.eclipse.ui.internal.presentations.PaneFolder$3.close\n(PaneFolder.java:190)\n\tat org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:2075)\n\tat org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:292)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:809)\n\tat org.eclipse.jface.window.Window.open(Window.java:787)\n\tat org.eclipse.jface.dialogs.MessageDialog.openQuestion\n(MessageDialog.java:368)\n\tat org.eclipse.ui.texteditor.AbstractTextEditor.handleEditorInputChanged\n(AbstractTextEditor.java:3445)\n\tat org.eclipse.ui.texteditor.StatusTextEditor.handleEditorInputChanged\n(StatusTextEditor.java:203)\n\tat org.eclipse.ui.texteditor.AbstractTextEditor.sanityCheckState\n(AbstractTextEditor.java:3575)\n\tat org.eclipse.ui.texteditor.StatusTextEditor.sanityCheckState\n(StatusTextEditor.java:193)\n\tat org.eclipse.ui.texteditor.AbstractTextEditor.safelySanityCheckState\n(AbstractTextEditor.java:3553)\n\tat \norg.eclipse.ui.texteditor.AbstractTextEditor$ActivationListener.handleActivation\n(AbstractTextEditor.java:834)\n\tat \norg.eclipse.ui.texteditor.AbstractTextEditor$ActivationListener.partActivated\n(AbstractTextEditor.java:796)\n\tat org.eclipse.ui.internal.PartListenerList$1.run\n(PartListenerList.java:72)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat org.eclipse.ui.internal.PartListenerList.fireEvent\n(PartListenerList.java:58)\n\tat org.eclipse.ui.internal.PartListenerList.firePartActivated\n(PartListenerList.java:70)\n\tat org.eclipse.ui.internal.PartService.firePartActivated\n(PartService.java:73)\n\tat org.eclipse.ui.internal.PartService.setActivePart\n(PartService.java:171)\n\tat org.eclipse.ui.internal.WWinPartService.updateActivePart\n(WWinPartService.java:124)\n\tat org.eclipse.ui.internal.WWinPartService.access$0\n(WWinPartService.java:115)\n\tat org.eclipse.ui.internal.WWinPartService$1.partDeactivated\n(WWinPartService.java:48)\n\tat org.eclipse.ui.internal.PartListenerList2$4.run\n(PartListenerList2.java:113)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat org.eclipse.ui.internal.PartListenerList2.fireEvent\n(PartListenerList2.java:54)\n\tat org.eclipse.ui.internal.PartListenerList2.firePartDeactivated\n(PartListenerList2.java:111)\n\tat org.eclipse.ui.internal.PartService.firePartDeactivated\n(PartService.java:116)\n\tat org.eclipse.ui.internal.PartService.setActivePart\n(PartService.java:165)\n\tat org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged\n(WorkbenchPagePartList.java:56)\n\tat org.eclipse.ui.internal.PartList.setActivePart(PartList.java:117)\n\tat org.eclipse.ui.internal.WorkbenchPage.setActivePart\n(WorkbenchPage.java:2910)\n\tat org.eclipse.ui.internal.WorkbenchPage.requestActivation\n(WorkbenchPage.java:2512)\n\tat org.eclipse.ui.internal.PartPane.requestActivation(PartPane.java:249)\n\tat org.eclipse.ui.internal.EditorPane.requestActivation\n(EditorPane.java:88)\n\tat org.eclipse.ui.internal.presentations.PresentablePart.setFocus\n(PresentablePart.java:137)\n\tat \norg.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent\n(TabbedStackPresentation.java:92)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:267)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent\n(AbstractTabFolder.java:272)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown\n(AbstractTabFolder.java:342)\n\tat \norg.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown\n(AbstractTabFolder.java:79)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:133)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench\n(Workbench.java:367)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run\n(IDEApplication.java:103)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run\n(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run\n(EclipseStarter.java:163)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n\tat org.eclipse.core.launcher.Main.run(Main.java:973)\n\tat org.eclipse.core.launcher.Main.main(Main.java:948)",
    "Throwing the exception has been added by Platform UI during the 3.1 dev cycle.\nI\u0027ve read the comment in WorkbenchPage.closeEditors(...) but this does not help\nme to resolve the issue: when an editor part gets activated we have to ask the\nuser whether the changed file should be considered or not. What does Platform UI\nsuggest clients to do in such situations? Isn\u0027t it a Platform UI bug to fire a\npartActivated event in cases where the part itself gets closed?\n\n\u003e// close operation. This usually occurs if someone tries to open a dialog in a   \n\u003e// method that isn\u0027t allowed to do so\nWhat are the methods where it isn\u0027t allowed?",
    "*** Bug 106582 has been marked as a duplicate of this bug. ***",
    "Adding nick.",
    "Looks like a race condition.  The activation happens on mouse down, the close\nhappens on mouse up, while the \"File has changed\" prompt is still up (still\nprocessing the activation).\n",
    "I think what happens is:\n- clicking the [x] tries to\n   - 1. send partActivated\n   - 2. perform close\n\n- 1. sends out partActivated on which the text editors listen and ask whether\n  to reload the changed file. This dialog spins the event loop and hence 2.\n  gets exectued which throws the exception. ",
    "\u003eThis dialog spins the event loop and hence 2.\n\u003egets exectued which throws the exception.\n\nTo be more precise: the event loop handles the other mouse event which triggers\nthe close.",
    "Is this still a problem in 3.3?\n\nPW\n",
    "Please try the provided steps and judge yourself.",
    "These are not on my list for 3.3\n\nPW\n",
    "Changes requested on bug 193523"
  ],
  "commentCreationDates": [
    "2005-10-18T15:52:11+02:00",
    "2005-10-18T18:12:54+02:00",
    "2005-10-18T18:14:05+02:00",
    "2005-10-18T19:27:12+02:00",
    "2005-10-18T20:21:54+02:00",
    "2005-10-19T09:15:56+02:00",
    "2005-10-19T12:15:14+02:00",
    "2006-09-28T21:15:35+02:00",
    "2006-10-09T11:57:45+02:00",
    "2006-10-10T03:23:09+02:00",
    "2007-06-22T15:33:07+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.RuntimeException",
      "message": "WARNING: Blocked recursive attempt to close part  org.eclipse.jdt.ui.CompilationUnitEditor while still in the middle of  activating it",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditors",
          "source": "WorkbenchPage.java:1151"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.closeEditor",
          "source": "WorkbenchPage.java:1279"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.doHide",
          "source": "EditorPane.java:54"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack.close",
          "source": "PartStack.java:495"
        },
        {
          "method": "org.eclipse.ui.internal.EditorStack.close",
          "source": "EditorStack.java:197"
        },
        {
          "method": "org.eclipse.ui.internal.PartStack$1.close",
          "source": "PartStack.java:102"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:81"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:276"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1",
          "source": "DefaultTabFolder.java:1"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$1.closeButtonPressed",
          "source": "DefaultTabFolder.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder.notifyCloseListeners",
          "source": "PaneFolder.java:584"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PaneFolder$3.close",
          "source": "PaneFolder.java:190"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouse",
          "source": "CTabFolder.java:2075"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:292"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:809"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:787"
        },
        {
          "method": "org.eclipse.jface.dialogs.MessageDialog.openQuestion",
          "source": "MessageDialog.java:368"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.handleEditorInputChanged",
          "source": "AbstractTextEditor.java:3445"
        },
        {
          "method": "org.eclipse.ui.texteditor.StatusTextEditor.handleEditorInputChanged",
          "source": "StatusTextEditor.java:203"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.sanityCheckState",
          "source": "AbstractTextEditor.java:3575"
        },
        {
          "method": "org.eclipse.ui.texteditor.StatusTextEditor.sanityCheckState",
          "source": "StatusTextEditor.java:193"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.safelySanityCheckState",
          "source": "AbstractTextEditor.java:3553"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor$ActivationListener.handleActivation",
          "source": "AbstractTextEditor.java:834"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor$ActivationListener.partActivated",
          "source": "AbstractTextEditor.java:796"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList$1.run",
          "source": "PartListenerList.java:72"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.fireEvent",
          "source": "PartListenerList.java:58"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList.firePartActivated",
          "source": "PartListenerList.java:70"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartActivated",
          "source": "PartService.java:73"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:171"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.updateActivePart",
          "source": "WWinPartService.java:124"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService.access$0",
          "source": "WWinPartService.java:115"
        },
        {
          "method": "org.eclipse.ui.internal.WWinPartService$1.partDeactivated",
          "source": "WWinPartService.java:48"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2$4.run",
          "source": "PartListenerList2.java:113"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.fireEvent",
          "source": "PartListenerList2.java:54"
        },
        {
          "method": "org.eclipse.ui.internal.PartListenerList2.firePartDeactivated",
          "source": "PartListenerList2.java:111"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.firePartDeactivated",
          "source": "PartService.java:116"
        },
        {
          "method": "org.eclipse.ui.internal.PartService.setActivePart",
          "source": "PartService.java:165"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged",
          "source": "WorkbenchPagePartList.java:56"
        },
        {
          "method": "org.eclipse.ui.internal.PartList.setActivePart",
          "source": "PartList.java:117"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.setActivePart",
          "source": "WorkbenchPage.java:2910"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.requestActivation",
          "source": "WorkbenchPage.java:2512"
        },
        {
          "method": "org.eclipse.ui.internal.PartPane.requestActivation",
          "source": "PartPane.java:249"
        },
        {
          "method": "org.eclipse.ui.internal.EditorPane.requestActivation",
          "source": "EditorPane.java:88"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.PresentablePart.setFocus",
          "source": "PresentablePart.java:137"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent",
          "source": "TabbedStackPresentation.java:92"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:267"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent",
          "source": "AbstractTabFolder.java:272"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder.handleMouseDown",
          "source": "AbstractTabFolder.java:342"
        },
        {
          "method": "org.eclipse.ui.internal.presentations.util.AbstractTabFolder$3.mouseDown",
          "source": "AbstractTabFolder.java:79"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:133"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1699"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1663"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:367"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:163"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "112926",
      "date": "2005-10-18T15:52:11+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "112926",
  "bugId": "112926",
  "date": "2005-10-18T15:52:11+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}