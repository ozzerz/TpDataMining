{
  "comments": [
    "This problem manifests itself in BIRT 2.1.1 as well as BIRT 2.2.0, M1.\n\nI posted this to the newsgroup:\n\nI played with this example some more and I\u0027m thinking there might be a bug with the way the word \"row\" is parsed.\n\nFor Task 3 of Tutorial 5 here is the script that is supposed to be typed into the onCreate method of the Script tab for the detailed row CUSTOMERNAME.\n\nrow\u003dthis.getRowData();\nCustName \u003d row.getExpressionValue(\"row[CUSTOMERNAME]\");\nif (CustName.indexOf(\"Mini\") !\u003d -1)\ncountOfMinis +\u003d1;\n\nAs I mentioned in my previous email, running this script causes this partial listing of the stack trace:\n(This is the primary source: org.mozilla.javascript.EcmaError: TypeError: Cannot call method \"indexOf\" of null (\u003cinline\u003e#3) at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3240) )\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.... lots of stuff cut out.....\n\nat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:828) at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:700) at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:584) at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:683) at java.lang.Thread.run(Thread.java:534)Caused by: org.mozilla.javascript.EcmaError: TypeError: Cannot call method \"indexOf\" of null (\u003cinline\u003e#3) at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3240) at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3230) at org.mozilla.javascript.ScriptRuntime.typeError(ScriptRuntime.java:3246) at org.mozilla.javascript.ScriptRuntime.typeError2(ScriptRuntime.java:3265) at org.mozilla.javascript.ScriptRuntime.undefCallError(ScriptRuntime.java:3284) at org.mozilla.javascript.ScriptRuntime.getPropFunctionAndThis(ScriptRuntime.java:1965) at org.mozilla.javascript.gen.c183._c0(\u003cinline\u003e:3) at org.mozilla.javascript.gen.c183.call(\u003cinline\u003e) at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:304) at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:2769) at org.mozilla.javascript.gen.c183.call(\u003cinline\u003e) at org.mozilla.javascript.gen.c183.exec(\u003cinline\u003e) at org.eclipse.birt.core.script.ScriptContext.eval(ScriptContext.java:224) at org.eclipse.birt.report.engine.executor.ExecutionContext.evaluate(ExecutionContext.java:549) ... 65 more\n\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nHowever, if you change the example to use this for the onCreate method:\n\nmyrow\u003dthis.getRowData();\nCustName \u003d myrow.getExpressionValue(\"row[CUSTOMERNAME]\");\nif (CustName.indexOf(\"Mini\") !\u003d -1)\ncountOfMinis +\u003d1;\n\nThe example executes correctly.  Also, I tried this for the script;\n\nCustName \u003d this.getRowData().getExpressionValue(\"row[CUSTOMERNAME]\");\nif (CustName.indexOf(\"Mini\") !\u003d -1)\ncountOfMinis +\u003d1;\n\nand it works fine as well.\n\nSo it appears like there might be some kind of parsing problem on the word \"row\" in the first example.  It looks like the word \"row\" in the getExpressionValue method is being confused with the JavaScript variable, row. \n\nand Don French made this comment:\n\nYou are correct that there is a problem with the variable name, \"row\".  It appears that \"row\" is now a prohibited variable name.\n\nThere is another problem with the tutorial, however. It is no longer possible to access a variable within one handler if that varialbe was created in different event handler. Well, there is a way, but the tutorial tries to use the old method. The variable \"countOfMinis\" must be a serializable Java object and the methods that save and retrieve the serializable object are reportContext.setPersistentGlobalVariable( ) and reportContext.getPersistentGlobalVariable( ). The correct code for the three event handlers is:\n\n\n\nTable.onCreate:\n\ncountOfMinis \u003d new Packages.java.lang.Integer(\"1\");\n\nreportContext.setPersistentGlobalVariable(\"cmKey\", countOfMinis);\n\n\n\n\n\nRow.onCreate:\n\ncountOfMinis \u003d reportContext.getPersistentGlobalVariable(\"cmKey\");\n\nrow_Data \u003d this.getRowData();\n\nCustName \u003d row_Data.getExpressionValue( \"row[CUSTOMERNAME]\" );\n\nif(CustName.indexOf(\"Mini\") !\u003d -1){\n\n    mCount \u003d countOfMinis.intValue();\n\n    mCount +\u003d 1;\n\n    countOfMinis \u003d new Packages.java.lang.Integer(mCount);\n\n    reportContext.setPersistentGlobalVariable(\"cmKey\", countOfMinis);\n\n}\n\n\n\nReportDesign.afterFactory:\n\nimportPackage( Packages.javax.swing );\n\ncountOfMinis \u003d reportContext.getPersistentGlobalVariable(\"cmKey\").intValue();\n\nframe \u003d new JFrame( \"Count of Minis \u003d \" + countOfMinis );\n\nframe.setBounds( 310, 220, 300, 20 );\n\nframe.show( );",
    "Fixed in Head and 2.2.0 branches"
  ],
  "commentCreationDates": [
    "2006-11-27T23:03:00+01:00",
    "2007-06-19T06:03:33+02:00"
  ],
  "traces": [
    {
      "exceptionType": "TypeError",
      "message": "Cannot call method \"indexOf\" of null (\u003cinline\u003e#3)",
      "elements": [
        {
          "method": "org.mozilla.javascript.ScriptRuntime.constructError",
          "source": "ScriptRuntime.java:3240"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "165982",
      "date": "2006-11-27T23:03:00+01:00",
      "product": "BIRT",
      "component": "Documentation",
      "severity": "normal"
    },
    {
      "exceptionType": "TypeError",
      "message": "Cannot call method \"indexOf\" of null (\u003cinline\u003e#3)",
      "elements": [
        {
          "method": "org.mozilla.javascript.ScriptRuntime.constructError",
          "source": "ScriptRuntime.java:3240"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.constructError",
          "source": "ScriptRuntime.java:3230"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.typeError",
          "source": "ScriptRuntime.java:3246"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.typeError2",
          "source": "ScriptRuntime.java:3265"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.undefCallError",
          "source": "ScriptRuntime.java:3284"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.getPropFunctionAndThis",
          "source": "ScriptRuntime.java:1965"
        },
        {
          "method": "org.mozilla.javascript.gen.c183._c0",
          "source": "\u003cinline\u003e:3"
        },
        {
          "method": "org.mozilla.javascript.gen.c183.call",
          "source": "\u003cinline\u003e"
        },
        {
          "method": "org.mozilla.javascript.ContextFactory.doTopCall",
          "source": "ContextFactory.java:304"
        },
        {
          "method": "org.mozilla.javascript.ScriptRuntime.doTopCall",
          "source": "ScriptRuntime.java:2769"
        },
        {
          "method": "org.mozilla.javascript.gen.c183.call",
          "source": "\u003cinline\u003e"
        },
        {
          "method": "org.mozilla.javascript.gen.c183.exec",
          "source": "\u003cinline\u003e"
        },
        {
          "method": "org.eclipse.birt.core.script.ScriptContext.eval",
          "source": "ScriptContext.java:224"
        },
        {
          "method": "org.eclipse.birt.report.engine.executor.ExecutionContext.evaluate",
          "source": "ExecutionContext.java:549"
        }
      ],
      "number": 1,
      "commentIndex": 0,
      "bugId": "165982",
      "date": "2006-11-27T23:03:00+01:00",
      "product": "BIRT",
      "component": "Documentation",
      "severity": "normal"
    }
  ],
  "groupId": "165982",
  "bugId": "165982",
  "date": "2006-11-27T23:03:00+01:00",
  "product": "BIRT",
  "component": "Documentation",
  "severity": "normal"
}