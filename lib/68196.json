{
  "comments": [
    "Launch Eclipse,\nPress F1, (do not launch help in a browser)\nExit Eclipse\n\nFollowing gets written to the log:\n!SESSION Jun 22, 2004 11:23:19.846 --------------------------------------------\n-\neclipse.buildId\u003dI200406192000\njava.version\u003d1.4.2_04\njava.vendor\u003dSun Microsystems Inc.\nBootLoader constants: OS\u003dwin32, ARCH\u003dx86, WS\u003dwin32, NL\u003den_US\n\n!ENTRY org.eclipse.osgi Jun 22, 2004 11:23:19.856\n!MESSAGE The class \"org.eclipse.core.internal.plugins.InternalPlatform\" cannot \nbe loaded because the system is shutting down and the plug-\nin \"org.eclipse.core.runtime.compatibility\" has already been stopped.\n!STACK 0\njava.lang.ClassNotFoundException: The \nclass \"org.eclipse.core.internal.plugins.InternalPlatform\" cannot be loaded \nbecause the system is shutting down and the plug-\nin \"org.eclipse.core.runtime.compatibility\" has already been stopped.\n\tat \norg.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor\n(EclipseClassLoader.java:147)\n\tat org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass\n(EclipseClassLoader.java:62)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass\n(BundleLoader.java:371)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass\n(BundleLoader.java:402)\n\tat \norg.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass\n(AbstractClassLoader.java:93)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:235)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.loadClass\n(BundleLoader.java:307)\n\tat org.eclipse.osgi.framework.internal.core.BundleHost.loadClass\n(BundleHost.java:336)\n\tat org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass\n(AbstractBundle.java:1313)\n\tat \norg.eclipse.core.internal.runtime.CompatibilityHelper.getPluginDescriptor\n(CompatibilityHelper.java:56)\n\tat org.eclipse.core.runtime.Plugin.initializeDescriptor\n(Plugin.java:647)\n\tat org.eclipse.core.runtime.Plugin.start(Plugin.java:633)\n\tat org.eclipse.help.internal.appserver.AppserverPlugin.start\n(AppserverPlugin.java:65)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run\n(BundleContextImpl.java:958)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat \norg.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator\n(BundleContextImpl.java:954)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl.start\n(BundleContextImpl.java:937)\n\tat org.eclipse.osgi.framework.internal.core.BundleHost.startWorker\n(BundleHost.java:421)\n\tat org.eclipse.osgi.framework.internal.core.AbstractBundle.start\n(AbstractBundle.java:293)\n\tat org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass\n(EclipseClassLoader.java:110)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass\n(BundleLoader.java:371)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.requireClass\n(BundleLoader.java:336)\n\tat \norg.eclipse.osgi.framework.internal.core.BundleLoader.findRequiredClass\n(BundleLoader.java:914)\n\tat org.eclipse.osgi.framework.internal.core.BundleLoader.findClass\n(BundleLoader.java:399)\n\tat \norg.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass\n(AbstractClassLoader.java:93)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:235)\n\tat java.lang.ClassLoader.loadClassInternal(ClassLoader.java:302)\n\tat org.eclipse.help.internal.base.BaseHelpSystem.shutdown\n(BaseHelpSystem.java:126)\n\tat org.eclipse.help.internal.base.HelpBasePlugin.stop\n(HelpBasePlugin.java:93)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run\n(BundleContextImpl.java:994)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop\n(BundleContextImpl.java:990)\n\tat org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker\n(BundleHost.java:502)\n\tat org.eclipse.osgi.framework.internal.core.AbstractBundle.stop\n(AbstractBundle.java:437)\n\tat org.eclipse.core.runtime.adaptor.BundleStopper.basicStopBundles\n(BundleStopper.java:75)\n\tat org.eclipse.core.runtime.adaptor.BundleStopper.stopBundles\n(BundleStopper.java:62)\n\tat org.eclipse.core.runtime.adaptor.EclipseAdaptor.frameworkStopping\n(EclipseAdaptor.java:551)\n\tat org.eclipse.osgi.framework.internal.core.Framework.shutdown\n(Framework.java:457)\n\tat org.eclipse.osgi.framework.internal.core.SystemBundle$1.run\n(SystemBundle.java:182)\n\tat java.lang.Thread.run(Thread.java:534)\n\nBaseHelpSystem is already keeping track whether webapp got started or not, but \nthe variable is not being read during shutdown, so help attempts to call \nshutdown from the Appserver plug-in that is not started, and runtime refuses \nto start it because it is in shutting down state.\n\nThe bug is not major, but there is very simple and safe fix for this behavior \nand poluting the log:\nJust add if (getInstance().webappStarted) { check before calling WebappManager \nstop.\n\nThe patch:\n\n\nIndex: BaseHelpSystem.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS \nfile: /home/eclipse/org.eclipse.help.base/src/org/eclipse/help/internal/base/Ba\nseHelpSystem.java,v\nretrieving revision 1.19\ndiff -u -r1.19 BaseHelpSystem.java\n--- BaseHelpSystem.java\t22 May 2004 11:19:21 -0000\t1.19\n+++ BaseHelpSystem.java\t22 Jun 2004 16:39:15 -0000\n@@ -122,10 +122,12 @@\n \t\tif (getInstance().searchManager !\u003d null) {\n \t\t\tgetInstance().searchManager.close();\n \t\t}\n-\t\t// stop the web apps\n-\t\tWebappManager.stop(\"help\"); //$NON-NLS-1$\n-\t\tif (getMode() !\u003d MODE_WORKBENCH)\n-\t\t\tWebappManager.stop(\"helpControl\"); //$NON-NLS-1$\n+\t\tif (getInstance().webappStarted) {\n+\t\t\t// stop the web apps\n+\t\t\tWebappManager.stop(\"help\"); //$NON-NLS-1$\n+\t\t\tif (getMode() !\u003d MODE_WORKBENCH)\n+\t\t\t\tWebappManager.stop(\"helpControl\"); //$NON-NLS-1\n$\n+\t\t}\n \n \t\tif (HelpBasePlugin.DEBUG) {\n \t\t\tSystem.out.println(\"Help System is shut down.\"); //\n$NON-NLS-1$",
    "This also happens after viewing help preference page, without launching help.  \nBasically any activation of help without launching help server will lead to \nthis problem on shutdown.\n\nLooking forward to releasing this simple fix for RC4.  It is not major \nproblem, but the fix is trivial, so I see no reason to withhold.",
    "+1",
    "+1",
    "I am looking for more votes.  Thanks.",
    "The patch is ok.\n+1",
    "Released for noon build.",
    "*** Bug 68480 has been marked as a duplicate of this bug. ***",
    "Verified in I20040624-1200"
  ],
  "commentCreationDates": [
    "2004-06-22T18:59:18+02:00",
    "2004-06-22T20:33:59+02:00",
    "2004-06-22T21:14:14+02:00",
    "2004-06-22T22:28:33+02:00",
    "2004-06-23T01:06:58+02:00",
    "2004-06-23T04:05:23+02:00",
    "2004-06-23T15:53:24+02:00",
    "2004-06-24T17:02:01+02:00",
    "2004-06-24T23:09:09+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassNotFoundException",
      "message": "The  class \"org.eclipse.core.internal.plugins.InternalPlatform\" cannot be loaded  because the system is shutting down and the plug- in \"org.eclipse.core.runtime.compatibility\" has already been stopped.",
      "elements": [
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.shouldActivateFor",
          "source": "EclipseClassLoader.java:147"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass",
          "source": "EclipseClassLoader.java:62"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:371"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:402"
        },
        {
          "method": "org.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass",
          "source": "AbstractClassLoader.java:93"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:235"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.loadClass",
          "source": "BundleLoader.java:307"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.loadClass",
          "source": "BundleHost.java:336"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass",
          "source": "AbstractBundle.java:1313"
        },
        {
          "method": "org.eclipse.core.internal.runtime.CompatibilityHelper.getPluginDescriptor",
          "source": "CompatibilityHelper.java:56"
        },
        {
          "method": "org.eclipse.core.runtime.Plugin.initializeDescriptor",
          "source": "Plugin.java:647"
        },
        {
          "method": "org.eclipse.core.runtime.Plugin.start",
          "source": "Plugin.java:633"
        },
        {
          "method": "org.eclipse.help.internal.appserver.AppserverPlugin.start",
          "source": "AppserverPlugin.java:65"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run",
          "source": "BundleContextImpl.java:958"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator",
          "source": "BundleContextImpl.java:954"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.start",
          "source": "BundleContextImpl.java:937"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.startWorker",
          "source": "BundleHost.java:421"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.start",
          "source": "AbstractBundle.java:293"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass",
          "source": "EclipseClassLoader.java:110"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass",
          "source": "BundleLoader.java:371"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.requireClass",
          "source": "BundleLoader.java:336"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findRequiredClass",
          "source": "BundleLoader.java:914"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleLoader.findClass",
          "source": "BundleLoader.java:399"
        },
        {
          "method": "org.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass",
          "source": "AbstractClassLoader.java:93"
        },
        {
          "method": "java.lang.ClassLoader.loadClass",
          "source": "ClassLoader.java:235"
        },
        {
          "method": "java.lang.ClassLoader.loadClassInternal",
          "source": "ClassLoader.java:302"
        },
        {
          "method": "org.eclipse.help.internal.base.BaseHelpSystem.shutdown",
          "source": "BaseHelpSystem.java:126"
        },
        {
          "method": "org.eclipse.help.internal.base.HelpBasePlugin.stop",
          "source": "HelpBasePlugin.java:93"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run",
          "source": "BundleContextImpl.java:994"
        },
        {
          "method": "java.security.AccessController.doPrivileged",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop",
          "source": "BundleContextImpl.java:990"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker",
          "source": "BundleHost.java:502"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.AbstractBundle.stop",
          "source": "AbstractBundle.java:437"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.BundleStopper.basicStopBundles",
          "source": "BundleStopper.java:75"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.BundleStopper.stopBundles",
          "source": "BundleStopper.java:62"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseAdaptor.frameworkStopping",
          "source": "EclipseAdaptor.java:551"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.Framework.shutdown",
          "source": "Framework.java:457"
        },
        {
          "method": "org.eclipse.osgi.framework.internal.core.SystemBundle$1.run",
          "source": "SystemBundle.java:182"
        },
        {
          "method": "java.lang.Thread.run",
          "source": "Thread.java:534"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "68196",
      "date": "2004-06-22T18:59:18+02:00",
      "product": "Platform",
      "component": "User Assistance",
      "severity": "normal"
    }
  ],
  "groupId": "68196",
  "bugId": "68196",
  "date": "2004-06-22T18:59:18+02:00",
  "product": "Platform",
  "component": "User Assistance",
  "severity": "normal"
}