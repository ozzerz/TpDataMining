{
  "comments": [
    "On Redhat Linux 8 with the default GTK version (gtk2-2.0.6-8 and\ngtk+-1.2.10-22), most dialogs that directly derive from org.eclipse.jface.Dialog\nremain empty (gray on gray). For instance, this affects the \"Filter Markers\"\ndialog which is available from the Problems or Tasks view when pressing the\nfilter button and also some dialogs in the Preferences.\n\nThis is a regression since Eclipse-3.1. It worked OK in Eclipse-3.0.1 as well as\n3.0.2.\n\nBy investigation it turned out that when a dialog is marked resizeable, the bug\ndoes not appear. Therefore, a valid workaround is to change the constructor of\norg.eclipse.jface.Dialog such that setShellStyle() includes the SWT.RESIZE flag:\n\n        setShellStyle(SWT.RESIZE | SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL |\ngetDefaultOrientation());\n\nWe suspect, however, that a correct fix must be made somewhere else, since with\nEclipse-3.1 or later on Redhat 8 another problem is that most dialogs are not\ncorrectly sized on open. They always appear in a default size, which is pretty\nlarge, so that dialogs with only little content look bad. This affects the\nstartup progress monitor, all other progress monitors, the startup workspace\nselection dialog, and all \"simple\" dialogs. It does not affect wizards,\nPreferences, TitleAreaDialogs and other complex dialogs.\n\nThe same problem with empty dialogs appears on Redhat9 with GTK 2.0.6-8.\n\nI\u0027m marking severity as \"major\" since this problem makes Eclipse-3.1 unusable on\nRedhat8 and 9, and there are Eclipse users (Nortel) which cannot upgrade to\nnewer gtk due to other software or company restrictions.",
    "While SWT has made an effort to not break running under GTK+ 2.0.6, the 2.0.x\nseries was rather buggy and not widely deployed.  Red Hat 9 shipped with GTK+\n2.2.1, so I\u0027m not sure how you have a RH9 machine with 2.0.6 installed\n(half-finished upgrade?).  The release notes for Eclipse 3.0 and higher have all\nlisted 2.2.1 as the official minimum version.  Adding McQ to the CC in case he\nwants to comment on this, see the part about some users being unable to upgrade.\n\nWe don\u0027t have any RH8 machines here but I can help debug the problem.  The Shell\nsizing code changed in 3.1 to address some blank-dialog races and improve the\nefficiency of resizing.  In Shell.java, try adding a print in the size allocate\ncallback here:\n\nint /*long*/ gtk_size_allocate (int /*long*/ widget, int /*long*/ allocation) {\n\tint width \u003d OS.GTK_WIDGET_WIDTH (shellHandle);\n\tint height \u003d OS.GTK_WIDGET_HEIGHT (shellHandle);\n\nFor a dialog that appears blank, what are the values for width and height that\nare reported here?",
    "Following exception is also seen on Redhat8 with the same GTK version, it might\nbe connected to the \"empty dialog\" problem:\n\njava.lang.ArithmeticException: / by zero\n\tat org.eclipse.swt.custom.SashFormLayout.computeSize(SashFormLayout.java:73)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:192)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:489)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:459)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:192)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:489)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:459)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:192)\n\tat org.eclipse.swt.layout.GridData.computeSize(GridData.java:489)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:459)\n\tat org.eclipse.swt.layout.GridLayout.computeSize(GridLayout.java:155)\n\tat org.eclipse.swt.widgets.Composite.computeSize(Composite.java:192)\n\tat org.eclipse.swt.layout.FormData.computeSize(FormData.java:127)\n\tat org.eclipse.swt.layout.FormLayout.layout(FormLayout.java:318)\n\tat org.eclipse.swt.layout.FormLayout.layout(FormLayout.java:284)\n\tat org.eclipse.swt.widgets.Composite.updateLayout(Composite.java:1133)\n\tat org.eclipse.swt.widgets.Shell.resizeBounds(Shell.java:1071)\n\tat org.eclipse.swt.widgets.Shell.setBounds(Shell.java:1115)\n\tat org.eclipse.swt.widgets.Control.setSize(Control.java:753)\n\tat\norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.setShellSize(LaunchConfigurationsDialog.java:941)\n\tat\norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.resize(LaunchConfigurationsDialog.java:886)\n\tat\norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.initializeBounds(LaunchConfigurationsDialog.java:1590)\n\tat org.eclipse.jface.window.Window.create(Window.java:422)\n\tat org.eclipse.jface.dialogs.Dialog.create(Dialog.java:996)\n\tat\norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.create(LaunchConfigurationsDialog.java:1597)\n\tat org.eclipse.jface.window.Window.open(Window.java:776)\n\tat\norg.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.open(LaunchConfigurationsDialog.java:439)\n\tat org.eclipse.debug.ui.DebugUITools$1.run(DebugUITools.java:356)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat\norg.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialogOnGroup(DebugUITools.java:360)\n\tat\norg.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialogOnGroup(DebugUITools.java:302)\n...",
    "Veronika, remember this \"/ by zero\" thing ... ?",
    "See bug 105751 for the division by zero error, which was also regarding Red Hat\n8 and GTK+ 2.0.6.  A check for this was added in 3.1.1, can you try with this\nrelease?",
    "We would like to check the 3.1.1 version for the / by zero problem, but\nunfortunately we cannot easily exchange the entire platform because Wind River\nis doing some magic on the Event Loop in order to achieve SWT / Swing\nintegration, and this magic is partially bound to 3.1.\n\nWhich plugins / libraries should we exchange to check the / by zero fix?",
    "BTW, I verified that the \"Empty Dialog\" problem appears with Eclipse 3.1.1 as well.",
    "(In reply to comment #1)\n\u003e We don\u0027t have any RH8 machines here but I can help debug the problem.  The \nShell\n\u003e sizing code changed in 3.1 to address some blank-dialog races and improve the\n\u003e efficiency of resizing.  In Shell.java, try adding a print in the size \nallocate\n\u003e callback here:\n\u003e int /*long*/ gtk_size_allocate (int /*long*/ widget, int /*long*/ \nallocation) {\n\u003e \tint width \u003d OS.GTK_WIDGET_WIDTH (shellHandle);\n\u003e \tint height \u003d OS.GTK_WIDGET_HEIGHT (shellHandle);\n\u003e For a dialog that appears blank, what are the values for width and height \nthat\n\u003e are reported here?\n\nWhen opening the About Dialog, the trace yields following output (old values \nin parenthesis):\n\nShell.gtk_size_allocate() width\u003d800 (0)  height\u003d640 (0)  resized\u003dfalse\nShell.gtk_size_allocate() width\u003d800 (800)  height\u003d640 (640)  resized\u003dtrue\n\nWhen forcing the SWT.RESIZE flag, it looks a bit different:\n\nShell.gtk_size_allocate() width\u003d1 (0)  height\u003d1 (0)  resized\u003dfalse\nShell.gtk_size_allocate() width\u003d800 (1)  height\u003d640 (1)  resized\u003dtrue\nShell.gtk_size_allocate() width\u003d800 (800)  height\u003d640 (640)  resized\u003dtrue\n\nDoes this help?",
    "*** Bug 112580 has been marked as a duplicate of this bug. ***",
    "With a little hackery, I was able to get GTK+ 2.0.6 to compile on a modern\ndistribution, and can reproduce the problems.  So, this confirms that the\nproblem is with GTK+ and not with something else like the window manager.",
    "Created an attachment (id\u003d28274)\nPatch\n\nThe patch is to HEAD but the (one-line) fix is the same for 3.1.\n\nWhen a GtkWindow is realized, the widget generates a size allocate event,\ncausing SWT to send an SWT.Resize event.  JFace will only layout its contents\nif the application code has not set a size on the window first, and it detects\nthis by listening for SWT.Resize.  Under GTK+ 2.0.6, the window is realized\nafter JFace has hooked their listener, confusing JFace into thinking that the\napplication code has resized the window, causing its layout and window\npositioning to fail.\n\nThis is specific to GTK+ before 2.2 because Control.getMonitor(), triggered by\nShell.setInitialBounds(), caused the window to be realized, but only for\nversions of GTK+ supporting the gdk_screen_get_default call added in GTK+ 2.2.\n\nThis is specific to SWT 3.1 because of bug 90326.  We tried to avoid realizing\nthe Shell too early to improve performance.  Unfortunately, I did not know that\nrealizing could trigger a size allocation.",
    "*** Bug 111315 has been marked as a duplicate of this bug. ***",
    "Fixed \u003e 20051014\n\nI\u0027m leaving bug 90326 to decide where best to do the realize to  ensure the best\nperformance without breaking dialog sizing :)",
    "Shouldn\u0027t we only realize early under GTK 2.0.6 and leave the old code alone?",
    "We\u0027re already realizing early on newer versions, it\u0027s just hidden in a call to\ngetMonitor().  It is better to make it explicit on all versions, and just try to\nbetter plan when it happens.",
    "*** Bug 100777 has been marked as a duplicate of this bug. ***",
    "*** Bug 114847 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2005-10-07T16:49:42+02:00",
    "2005-10-07T17:31:13+02:00",
    "2005-10-07T22:56:32+02:00",
    "2005-10-07T23:02:46+02:00",
    "2005-10-07T23:04:32+02:00",
    "2005-10-08T20:03:04+02:00",
    "2005-10-08T20:10:12+02:00",
    "2005-10-11T13:11:24+02:00",
    "2005-10-14T03:53:34+02:00",
    "2005-10-14T04:14:31+02:00",
    "2005-10-14T07:18:47+02:00",
    "2005-10-14T17:39:39+02:00",
    "2005-10-14T18:03:12+02:00",
    "2005-10-14T19:00:02+02:00",
    "2005-10-14T19:58:48+02:00",
    "2005-10-20T05:26:31+02:00",
    "2005-11-03T03:09:56+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArithmeticException",
      "message": "/ by zero",
      "elements": [
        {
          "method": "org.eclipse.swt.custom.SashFormLayout.computeSize",
          "source": "SashFormLayout.java:73"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:192"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:489"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:459"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:192"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:489"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:459"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:192"
        },
        {
          "method": "org.eclipse.swt.layout.GridData.computeSize",
          "source": "GridData.java:489"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:459"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.computeSize",
          "source": "GridLayout.java:155"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.computeSize",
          "source": "Composite.java:192"
        },
        {
          "method": "org.eclipse.swt.layout.FormData.computeSize",
          "source": "FormData.java:127"
        },
        {
          "method": "org.eclipse.swt.layout.FormLayout.layout",
          "source": "FormLayout.java:318"
        },
        {
          "method": "org.eclipse.swt.layout.FormLayout.layout",
          "source": "FormLayout.java:284"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.updateLayout",
          "source": "Composite.java:1133"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.resizeBounds",
          "source": "Shell.java:1071"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.setBounds",
          "source": "Shell.java:1115"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setSize",
          "source": "Control.java:753"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.setShellSize",
          "source": "LaunchConfigurationsDialog.java:941"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.resize",
          "source": "LaunchConfigurationsDialog.java:886"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.initializeBounds",
          "source": "LaunchConfigurationsDialog.java:1590"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:422"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:996"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.create",
          "source": "LaunchConfigurationsDialog.java:1597"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:776"
        },
        {
          "method": "org.eclipse.debug.internal.ui.launchConfigurations.LaunchConfigurationsDialog.open",
          "source": "LaunchConfigurationsDialog.java:439"
        },
        {
          "method": "org.eclipse.debug.ui.DebugUITools$1.run",
          "source": "DebugUITools.java:356"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialogOnGroup",
          "source": "DebugUITools.java:360"
        },
        {
          "method": "org.eclipse.debug.ui.DebugUITools.openLaunchConfigurationDialogOnGroup",
          "source": "DebugUITools.java:302"
        }
      ],
      "number": 0,
      "commentIndex": 2,
      "bugId": "111910",
      "date": "2005-10-07T22:56:32+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "major"
    }
  ],
  "groupId": "111910",
  "bugId": "111910",
  "date": "2005-10-07T16:49:42+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "major"
}