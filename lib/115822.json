{
  "comments": [
    "SWTError when creating an org.eclipse.swt.widgets.Display on Linux.\n\nCreating an org.eclipse.swt.widgets.Display object on RHEL v4 with the IBM JRE \nv1.4.2 throws the following exception:\n\norg.eclipse.swt.SWTError: No more handles [gtk_init_check() failed]\n\tat org.eclipse.swt.SWT.error(SWT.java:2968)\n\tat org.eclipse.swt.widgets.Display.createDisplay(Display.java:757)\n\tat org.eclipse.swt.widgets.Display.create(Display.java:746)\n\tat org.eclipse.swt.graphics.Device.\u003cinit\u003e(Device.java:141)\n\tat org.eclipse.swt.widgets.Display.\u003cinit\u003e(Display.java:429)\n\tat org.eclipse.swt.widgets.Display.\u003cinit\u003e(Display.java:420)\n\tat\norg.eclipse.tptp.test.manual.runner.ui.internal.ManualTestView.\u003cinit\u003e\n(ManualTestView.java:125)\n\tat\norg.eclipse.tptp.test.manual.runner.core.internal.ManualTestRunner.main\n(ManualTestRunner.java:194)\n\nThis line of code in the Manual Test View \n(org.eclipse.tptp.test.manual.runner.ui.internal.ManualTestView.\u003cinit\u003e\n(ManualTestView.java:125)) simply creates a new org.eclipse.swt.widgets.Display \nobject:\n\nDisplay display \u003d new Display();\n\nThe test machine has the following configuration:\n\nOS: Linux purple 2.6.9-5.ELsmp #1 SMP Wed Jan 5 19:30:39 EST 2005 i686 i686 \ni386 GNU/Linux\nGTK: gtk2-2.4.13-12\nATK: atk-1.8.0-2\nglib: glib-1.2.10-15/glib2-2.4.7-1\nPango: pango-1.6.0-7\nFreetype: freetype-2.1.9-1\n \nNOTE:  The machine producing the symptoms is a multiprocessor machine with a \ndifferent Linux kernel.\n\nSteps to reproduce:\n\n1) Download the TPTP v4.1 run-time (http://www.eclipse.org/tptp/ \u003e\u003e Latest \nDownloads \u003e\u003e Release Under Development (or Latest Release): 4.1.0 \u003e\u003e \n[Development Build] \u003e\u003e TPTP Run-time and SDK \u003e\u003e Testing Tools)\n\n2) Download Eclipse SDK 3.1.0.\n\n3) Run the following command:\n\njava -classpath \n$PLUGINS_DIRECTORY/org.eclipse.hyades.test.tools.core_4.1.0/manual.runner.jar:$P\nLUGINS_DIRECTORY/org.eclipse.hyades.test.tools.core_4.1.0/common.runner.jar:$PLU\nGINS_DIRECTORY/org.eclipse.swt_3.1.0.jar:$PLUGINS_DIRECTORY/org.eclipse.swt.gtk.\nlinux.x86_3.1.0.jar:$PLUGINS_DIRECTORY/org.eclipse.jface_3.1.0.jar:$PLUGINS_DIRE\nCTORY/org.eclipse.core.runtime_3.1.0.jar \norg.eclipse.tptp.test.manual.runner.ui.internal.ManualTestView\n\nWhere PLUGINS_DIRECTORY is the absolute directory of the Eclipse/TPTP plugins.\n\nNOTE: This command expects the JRE v1.4.2 on the system\u0027s path.",
    "What is the DISPLAY environment variable set to?  Can you run other X\napplications such as \"gedit\" or \"xterm\"?",
    "Is this a dup of bug 106396?",
    "Probably not given bug 115648.  I mean, bug 106396 is insane.  This report is\nfor RHEL4 and Linux 2.6.  gtk_init_check should really only fail if it can\u0027t\nconnect to the X server, which is what I suspect is happening here.",
    "(In reply to comment #1)\n\n$DISPLAY\u003d:0.0\n\nYes, we can run xterm from a terminal.\n\n\n",
    "(In reply to comment #2)\n\nI don\u0027t think so since we tested the workaround (export JAVA_HIGH_ZIPFDS\u003d500) \nwithout success.\n\n\n",
    "I installed an IBM 1.4.2 JRE on a RHEL4 machine (non-SMP).  I followed the\nsteps, with the following variations.  I had to extract the SWT DLLs to a\nseparate directory and add a -Djava.library.path option to the command to point\nat them, and I had to set the MOZILLA_FIVE_HOME and LD_LIBRARY_PATH environment\nvariables to point at my mozilla install.  Once this was done, the test\napplication launched successfully.\n\nCan you think of anything that might be unique about your system and its X\nconfiguration?  Can you confirm that other GTK+ applications launch successfully\nfrom the same command line prompt you are using to run this test command?  Are\nyou running this command from inside Eclipse?",
    "(In reply to comment #6)\n\n\u003eCan you think of anything that might be unique about your system and its X\nconfiguration?  \n\nAs mentioned in defect #115648, the machine causing the problems is a SMP \nmachine with the Linux 2.6.9-5 kernel.  We tested on a non-SMP machine with the \nthe Linux 2.6.9-11 kernel and the test application worked.\n\n\u003eCan you confirm that other GTK+ applications launch successfully\nfrom the same command line prompt you are using to run this test command?  \n\nYes, we successfully ran the test class attached to the defect #115648 on the \nSMP machine.\n\n\u003eAre you running this command from inside Eclipse?\nNo, stand-alone SWT application.",
    "Is there any status update on this defect?  TPTP defect #115648 is currently blocked by this defect.",
    "I have not been able to get an SMP machine to test on, however this problem\nis quite strange.  gtk_init_check() only fails if you are out of memory or if the\nconnection to the X server fails.\n\nIs there any way you can check the same machine but with a non-SMP kernel?\nCould you also try with a different VM, is this problem specific to the 1.4.2 IBM\nVM?",
    "(In reply to comment #9)\n\u003e Is there any way you can check the same machine but with a non-SMP kernel?\n\nWe have reproduced this problem on both non-/SMP machines.  Most recently, Debian 2.4.27-2-386 (single processor).\n\n\u003e Could you also try with a different VM, is this problem specific to the 1.4.2\n\u003e IBM VM?\n\nWe have reproduced this problem with the IBM V1.5.0 GA and Sun V1.5.0_02 JVMs.\n\n",
    "Increasing the severity since this defect is blocking the TPTP Manual Test View on Linux and no progress has been achieved for nearly 4 months.",
    "gtk_init_check() only fails if it cannot open a socket to the X server\n(XOpenDisplay fails), or if we are out of memory.  I suspect we are\nnot out of memory.\n\nThe connection to the X server can fail in the following ways:\n 1. The DISPLAY environment variable is unset\n 2. The host/port information is wrong\n 3. The X server is down\n 4. The socket to the X server is on too high of a file descriptor\n\nIt seems the only option we have left is that you have too many files\nopen at the time the X connection is opened.  Is there any way the\ntests could create the Display as soon as possible?",
    "Paul, are you still having this problem? Your you able to run the simple SWT testcase?",
    "(In reply to comment #13)\n\nHi Silenio, I am still having problems configuring the test machine with a Mozilla browser that uses GTK2.  I will keep you up to date and I progress.",
    "Please see https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d115648#c26 for example of this behavior.",
    "Although we have seen this problem on both non-/SMP machines (e.g. Debian 2.4.27-2-386 (single processor) and https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d115648#c26), using the TPTP-4.2.0-200605290100 TPTP workbench and Agent Controller (SWT V3.2 RC6)\non the SMP test machine (Linux purple 2.6.9-5.ELsmp #1 SMP Wed Jan 5 19:30:39\nEST 2005 i686 i686 i386 GNU/Linux), non-SMP test machine (Linux paules 2.4.27-2-386 #1 Mon May 16 16:47:51 JST 2005 i686 GNU/Linux) and IBM JRE V1.5.0 (SR 2), the Manual Test View is working as designed after verifying the following:\n\n 1. The DISPLAY environment variable is set.\n 2. The host/port information is correct (e.g. added to /etc/hosts). \n 3. The X server is up.\n",
    "Closing."
  ],
  "commentCreationDates": [
    "2005-11-10T15:07:03+01:00",
    "2005-11-10T15:22:15+01:00",
    "2005-11-10T15:25:27+01:00",
    "2005-11-10T15:31:40+01:00",
    "2005-11-10T15:52:23+01:00",
    "2005-11-10T15:53:38+01:00",
    "2005-11-10T20:54:56+01:00",
    "2005-11-10T21:26:13+01:00",
    "2006-02-20T17:43:53+01:00",
    "2006-02-21T05:06:30+01:00",
    "2006-04-11T18:34:12+02:00",
    "2006-04-11T18:35:14+02:00",
    "2006-04-11T18:52:05+02:00",
    "2006-04-18T22:22:35+02:00",
    "2006-04-19T01:08:42+02:00",
    "2006-05-31T22:30:00+02:00",
    "2006-05-31T22:55:16+02:00",
    "2006-06-01T18:30:40+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "No more handles [gtk_init_check() failed]",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2968"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.createDisplay",
          "source": "Display.java:757"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.create",
          "source": "Display.java:746"
        },
        {
          "method": "org.eclipse.swt.graphics.Device.\u003cinit\u003e",
          "source": "Device.java:141"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.\u003cinit\u003e",
          "source": "Display.java:429"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.\u003cinit\u003e",
          "source": "Display.java:420"
        },
        {
          "method": "org.eclipse.tptp.test.manual.runner.ui.internal.ManualTestView.\u003cinit\u003e",
          "source": "ManualTestView.java:125"
        },
        {
          "method": "org.eclipse.tptp.test.manual.runner.core.internal.ManualTestRunner.main",
          "source": "ManualTestRunner.java:194"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "115822",
      "date": "2005-11-10T15:07:03+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "115822",
  "bugId": "115822",
  "date": "2005-11-10T15:07:03+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}