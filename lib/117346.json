{
  "comments": [
    "I got a NPE when creating an EAR/web project if the a runtime id and the runtime name are not the same. The project creation wizard will not allow you to go to beyond the first page and you simply cannot create a project.\n\nWhen the RuntimeManagerImpl is trying to build a bridge, it does not build the stub entry correctly.  In RuntimeManagerImpl.bridge(), it puts the exported runtime names into a HashSet exported (line 328):\n                exported \u003d br.getExportedRuntimeNames();\n\nThe code then loop through the \"exported\" list and get the entry. However, the code thinks that it is a id instead of the runtime names (line 361):\n                final String id \u003d (String) itr2.next();\n\nHowever, when the code is trying to build the stub, it uses the runtime name to try to build the bridge (line 367):\n                        final IRuntimeBridge.IStub stub \u003d br.bridge( id );\n\nwhich causes the follwing NPE since the bridge will fail to find the runtime if the runtime id and the name are not the same.\n\n!ENTRY org.eclipse.ui 4 4 2005-11-21 14:04:52.131\n!MESSAGE Unhandled event loop exception\nUnhandled event loop exception\nReason:\n\n!ENTRY org.eclipse.ui 4 0 2005-11-21 14:04:52.201\n!MESSAGE java.lang.NullPointerException\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.jst.server.core.internal.RuntimeBridge$Stub.getRuntimeComponents(RuntimeBridge.java)\n\tat org.eclipse.wst.common.project.facet.core.runtime.internal.BridgedRuntime.getRuntimeComponents(BridgedRuntime.java:55)\n\tat org.eclipse.wst.common.project.facet.core.runtime.internal.RuntimeManagerImpl.getSupportedFacets(RuntimeManagerImpl.java:269)\n\tat org.eclipse.wst.common.project.facet.core.runtime.internal.BridgedRuntime.supports(BridgedRuntime.java:65)\n\tat org.eclipse.wst.common.project.facet.core.runtime.internal.RuntimeManagerImpl.getRuntimes(RuntimeManagerImpl.java:144)\n\tat org.eclipse.wst.common.project.facet.core.runtime.RuntimeManager.getRuntimes(RuntimeManager.java:92)\n\tat org.eclipse.wst.common.componentcore.datamodel.FacetProjectCreationDataModelProvider.getValidPropertyDescriptors(FacetProjectCreationDataModelProvider.java:189)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.DataModelImpl.getValidPropertyDescriptors(DataModelImpl.java:318)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.setWidgetValue(DataModelSynchHelper.java:298)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper$1.run(DataModelSynchHelper.java:221)\n\tat org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:152)\n\tat org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:28)\n\tat org.eclipse.swt.widgets.Display.syncExec(Display.java:3413)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchUIWithModel(DataModelSynchHelper.java:212)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchComposite(DataModelSynchHelper.java:435)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchCombo(DataModelSynchHelper.java:472)\n\tat org.eclipse.wst.web.ui.internal.wizards.DataModelFacetCreationWizardPage.createServerTargetComposite(DataModelFacetCreationWizardPage.java:102)\n\tat org.eclipse.wst.web.ui.internal.wizards.DataModelFacetCreationWizardPage.createTopLevelComposite(DataModelFacetCreationWizardPage.java:51)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelWizardPage.createControl(DataModelWizardPage.java:95)\n\tat org.eclipse.jface.wizard.Wizard.createPageControls(Wizard.java:179)\n\tat org.eclipse.wst.common.project.facet.ui.AddRemoveFacetsWizard.createPageControls(AddRemoveFacetsWizard.java:250)\n\tat org.eclipse.jface.wizard.WizardDialog.createPageControls(WizardDialog.java:611)\n\tat org.eclipse.jface.wizard.WizardDialog.setWizard(WizardDialog.java:965)\n\tat org.eclipse.jface.wizard.WizardDialog.updateForPage(WizardDialog.java:1016)\n\tat org.eclipse.jface.wizard.WizardDialog.access$2(WizardDialog.java:1013)\n\tat org.eclipse.jface.wizard.WizardDialog$4.run(WizardDialog.java:1003)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:69)\n\tat org.eclipse.jface.wizard.WizardDialog.showPage(WizardDialog.java:1001)\n\tat org.eclipse.jface.wizard.WizardDialog.nextPressed(WizardDialog.java:753)\n\tat org.eclipse.jface.wizard.WizardDialog.buttonPressed(WizardDialog.java:345)\n\tat org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:556)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:90)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.jface.window.Window.runEventLoop(Window.java:809)\n\tat org.eclipse.jface.window.Window.open(Window.java:787)\n\tat org.eclipse.ui.actions.NewProjectAction.run(NewProjectAction.java:114)\n\tat org.eclipse.jface.action.Action.runWithEvent(Action.java:996)\n\tat org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:538)\n\tat org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:488)\n\tat org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:400)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1699)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1663)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:367)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:163)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n\tat java.lang.reflect.Method.invoke(Method.java:391)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:334)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:278)\n\tat org.eclipse.core.launcher.Main.run(Main.java:973)\n\tat org.eclipse.core.launcher.Main.main(Main.java:948)",
    "Sending this to you Tim?  Kosta is out this week....",
    "Hi Sinan,\n\nI am also seeing this exception using the IBM WAS runtime....\n\nThe java vm asociated with this runtime seems to be returning null in this method",
    "*** Bug 116290 has been marked as a duplicate of this bug. ***",
    "This has nothing to do with WAS or any other particular server. It is a regression caused by the recent changes to the runtime facet bridge. I am checking in a patch for M9 that should fix this, at least temporarily.\n\nKonstantin - You need to take a look at this. The new runtime bridge made the (incorrect) assumption that server runtime ids always match the server runtime name. I\u0027ve patched up the code in jst.server to account for this, but I had to use the names instead of the ids. We should be ok for M9 but this should be investigated further to make sure that the facets are going to work in all scenarios.",
    "Change dropped to HEAD and released for I-build.",
    "Tim,\n\nWhat\u0027s the difference between id and name in your IRuntime interface? \n\nWhen I designed the IRuntime interface for the facets framework, I chose to have just a name that is both a unique identifier and a user-presentable label. I did it this way because runtimes are always created by the user, so I wouldn\u0027t expect the user to supply me with an id and a name separately.\n\nI haven\u0027t looked at what changes you\u0027ve made, but will your fix work in the long term or do we need to change something?",
    "Server runtimes have both an id and a name. When a user creates them, by default the name and the id match (which is why we didn\u0027t see problems before). However, other tools can also create runtimes via the API, and the name and runtime don\u0027t need to match. An example of this is creating a \u0027known\u0027 runtime in multiple user\u0027s workspaces - a tool could use a common id so that the runtime can easily be found and managed, but translate the runtime name into the user\u0027s native language.\n\nThe problem was that the new runtime bridge was alternately using the name and id, causing major problems when they didn\u0027t match. I\u0027m feeling more comfortable about the fix I made now (always using the server runtime name) now that I know you only have a name-id and I\u0027ve been able to run through a few scenarios. I did open another bug though b/c facets support still fails badly when the user renames a runtime.",
    "There are still places where the usage of runtime ID and the runtime name are mixed up.  In the method, org.eclipse.jst.server.core.internal.RuntimeClasspathContainerInitializer.initialize(),\n\nOn line 40,\n  String runtimeId \u003d containerPath.segment(2);\n  if (runtimeId !\u003d null)\n     runtime \u003d ServerCore.findRuntime(runtimeId);\n\nHowever, containerPath.segment(2) is the runtime name instead of the runtime id.  This causes the runtime to be null in the case where the runtime id and the runtime name are not the same.  This in turn causes the classpath container failed to be resolved and therefore, the correct classpath cannot be set on the project.",
    "Setting to P2 and 1.0 M10 since this is a Hot Bug. Pls fix by RC2.",
    "Luckily this second bug has already been found and fixed via bug 118460.\n\n*** This bug has been marked as a duplicate of 118460 ***",
    "Closing old bugs."
  ],
  "commentCreationDates": [
    "2005-11-21T19:08:33+01:00",
    "2005-11-22T13:50:02+01:00",
    "2005-11-22T16:03:03+01:00",
    "2005-11-22T16:04:52+01:00",
    "2005-11-22T18:20:52+01:00",
    "2005-11-22T22:48:49+01:00",
    "2005-11-24T16:37:20+01:00",
    "2005-11-24T17:23:19+01:00",
    "2005-11-30T04:38:48+01:00",
    "2005-11-30T18:08:48+01:00",
    "2005-11-30T22:46:45+01:00",
    "2006-11-21T19:28:34+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jst.server.core.internal.RuntimeBridge$Stub.getRuntimeComponents",
          "source": "RuntimeBridge.java"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.runtime.internal.BridgedRuntime.getRuntimeComponents",
          "source": "BridgedRuntime.java:55"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.runtime.internal.RuntimeManagerImpl.getSupportedFacets",
          "source": "RuntimeManagerImpl.java:269"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.runtime.internal.BridgedRuntime.supports",
          "source": "BridgedRuntime.java:65"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.runtime.internal.RuntimeManagerImpl.getRuntimes",
          "source": "RuntimeManagerImpl.java:144"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.runtime.RuntimeManager.getRuntimes",
          "source": "RuntimeManager.java:92"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.datamodel.FacetProjectCreationDataModelProvider.getValidPropertyDescriptors",
          "source": "FacetProjectCreationDataModelProvider.java:189"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.DataModelImpl.getValidPropertyDescriptors",
          "source": "DataModelImpl.java:318"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.setWidgetValue",
          "source": "DataModelSynchHelper.java:298"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper$1.run",
          "source": "DataModelSynchHelper.java:221"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.syncExec",
          "source": "Synchronizer.java:152"
        },
        {
          "method": "org.eclipse.ui.internal.UISynchronizer.syncExec",
          "source": "UISynchronizer.java:28"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.syncExec",
          "source": "Display.java:3413"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchUIWithModel",
          "source": "DataModelSynchHelper.java:212"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchComposite",
          "source": "DataModelSynchHelper.java:435"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelSynchHelper.synchCombo",
          "source": "DataModelSynchHelper.java:472"
        },
        {
          "method": "org.eclipse.wst.web.ui.internal.wizards.DataModelFacetCreationWizardPage.createServerTargetComposite",
          "source": "DataModelFacetCreationWizardPage.java:102"
        },
        {
          "method": "org.eclipse.wst.web.ui.internal.wizards.DataModelFacetCreationWizardPage.createTopLevelComposite",
          "source": "DataModelFacetCreationWizardPage.java:51"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ui.DataModelWizardPage.createControl",
          "source": "DataModelWizardPage.java:95"
        },
        {
          "method": "org.eclipse.jface.wizard.Wizard.createPageControls",
          "source": "Wizard.java:179"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.ui.AddRemoveFacetsWizard.createPageControls",
          "source": "AddRemoveFacetsWizard.java:250"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.createPageControls",
          "source": "WizardDialog.java:611"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.setWizard",
          "source": "WizardDialog.java:965"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.updateForPage",
          "source": "WizardDialog.java:1016"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.access$2",
          "source": "WizardDialog.java:1013"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog$4.run",
          "source": "WizardDialog.java:1003"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:69"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.showPage",
          "source": "WizardDialog.java:1001"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.nextPressed",
          "source": "WizardDialog.java:753"
        },
        {
          "method": "org.eclipse.jface.wizard.WizardDialog.buttonPressed",
          "source": "WizardDialog.java:345"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog$2.widgetSelected",
          "source": "Dialog.java:556"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:90"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.jface.window.Window.runEventLoop",
          "source": "Window.java:809"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:787"
        },
        {
          "method": "org.eclipse.ui.actions.NewProjectAction.run",
          "source": "NewProjectAction.java:114"
        },
        {
          "method": "org.eclipse.jface.action.Action.runWithEvent",
          "source": "Action.java:996"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection",
          "source": "ActionContributionItem.java:538"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem.access$2",
          "source": "ActionContributionItem.java:488"
        },
        {
          "method": "org.eclipse.jface.action.ActionContributionItem$5.handleEvent",
          "source": "ActionContributionItem.java:400"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:843"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3080"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2713"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1699"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1663"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:367"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:226"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:376"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:163"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:85"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:58"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:60"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:391"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:334"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:278"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:973"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:948"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "117346",
      "duplicateId": "118460",
      "date": "2005-11-21T19:08:33+01:00",
      "product": "Web Tools",
      "component": "jst.server",
      "severity": "critical"
    }
  ],
  "groupId": "118460",
  "bugId": "117346",
  "duplicateId": "118460",
  "date": "2005-11-21T19:08:33+01:00",
  "product": "Web Tools",
  "component": "jst.server",
  "severity": "critical"
}