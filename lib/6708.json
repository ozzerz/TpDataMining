{
  "comments": [
    "Build 20011206\n\nAttempting to set the contents of a file that has just been created through a \ncopy operation fails with a ResourceException.\n\nTo reproduce, evaluate the following code snippet in a scrapbook page:\n\norg.eclipse.core.boot.BootLoader.startup(null, \"c:/temp/test\", new String[] {});\norg.eclipse.core.runtime.IPluginRegistry pr \u003d \norg.eclipse.core.runtime.Platform.getPluginRegistry();\norg.eclipse.core.runtime.IPluginDescriptor pd \u003d pr.getPluginDescriptor\n(\"org.eclipse.core.resources\");\npd.getPlugin();\norg.eclipse.core.resources.IWorkspace workspace \u003d \norg.eclipse.core.resources.ResourcesPlugin.getWorkspace();\n\norg.eclipse.core.resources.IProject sourceProj \u003d workspace.getRoot().getProject\n(\"P1\");\nsourceProj.create(null);\nsourceProj.open(null);\norg.eclipse.core.resources.IFile source \u003d sourceProj.getFile(\"Source.txt\");\nsource.create(new java.io.ByteArrayInputStream(\"abcdef\".getBytes()), false, \nnull);\n\norg.eclipse.core.resources.IProject destProj \u003d workspace.getRoot().getProject\n(\"P2\");\ndestProj.create(null);\ndestProj.open(null);\norg.eclipse.core.resources.IFile dest \u003d destProj.getFile(\"Dest.txt\");\n\nsource.copy(dest.getFullPath(), false, null);\ndest.setContents(new java.io.ByteArrayInputStream(\"ghijkl\".getBytes()), false, \ntrue, null);",
    "Unable to reproduce.  If I try to run the code below in a scrapbook page, I get \nan error (entered bug 6736).  When I run this in our test harness, it works with \nno problems.\n\nWhat does the core exception look like?  Can you get a stack trace?  Does it \nonly happen when run in a scrapbook page?",
    "I just noticed that this happens only if the core_2_0_5.dll is on the library \npath. To force it to be on the library path when running from the scrapbook \npage, I had to copy it to the root of my eclipse install.\n\nAnyway, if this dll is present, here is the stack trace (sorry, no line number):\norg.eclipse.core.internal.resources.ResourceException: Resource is out of sync \nwith the file system: /P2/Dest.txt.\n\nStack trace:\n   java/lang/Throwable.\u003cinit\u003e()V\n   java/lang/Throwable.\u003cinit\u003e(Ljava/lang/String;)V\n   org/eclipse/core/runtime/CoreException.\u003cinit\u003e\n(Lorg/eclipse/core/runtime/IStatus;)V\n   org/eclipse/core/internal/resources/ResourceException.\u003cinit\u003e\n(ILorg/eclipse/core/runtime/IPath;Ljava/lang/String;Ljava/lang/Throwable;)V\n   org/eclipse/core/internal/localstore/FileSystemResourceManager.write\n(Lorg/eclipse/core/resources/IFile;Lorg/eclipse/core/runtime/IPath;Ljava/io/Inpu\ntStream;ZZZLorg/eclipse/core/runtime/IProgressMonitor;)V\n   org/eclipse/core/internal/resources/File.internalSetContents\n(Ljava/io/InputStream;Lorg/eclipse/core/runtime/IPath;ZZZLorg/eclipse/core/runti\nme/IProgressMonitor;)V\n   org/eclipse/core/internal/resources/File.setContents\n(Ljava/io/InputStream;ZZLorg/eclipse/core/runtime/IProgressMonitor;)V\n   org/eclipse/CodeSnippet_4.run()V\n   org/eclipse/jdt/internal/debug/ui/snippeteditor/ScrapbookMain1.eval\n(Ljava/lang/Class;)V\n   java/lang/reflect/Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)\nLjava/lang/Object;\n   org/eclipse/jdt/internal/debug/ui/snippeteditor/ScrapbookMain.evalLoop\n([Ljava/net/URL;)V\n   org/eclipse/jdt/internal/debug/ui/snippeteditor/ScrapbookMain.main\n([Ljava/lang/String;)V",
    "Unable to reproduce problem on Win98 using the 2001-12-11 build. Will try Win2K.\n",
    "Unable to reproduce in 20020115 build on Win2000.  Cannot reproduce in a \nscrapbook page or in a test case.  Closing.",
    "I still get the problem in 20020115. Maybe I was not clear on the steps I \nfollowed. Let me try to explain again:\n\n1. Unzip eclipse-SDK-20020115-win32.zip to D:\\eclipse20020115\n2. Unzip org.eclipse.pde.selfhosting_1.13.zip to D:\\eclipse20020115\n\\eclipse\\plugins\n3. Copy D:\\eclipse20020115\\eclipse\\plugins\\org.eclipse.core.resources\\os\\win32\n\\core_2_0_5.dll to D:\\eclipse20020115\\eclipse\n4. Run D:\\eclipse20020115\\eclipse\\eclipse.exe -vm D:\\jdk1.3.1\\bin\\javaw.exe\n5. File-\u003eImport-\u003ePlugins-\u003eEnter D:\\eclipse20020115\\eclipse\\plugins-\u003eNext-\n\u003eSelect All-\u003eFinish\n6. Perspective-\u003eOpen-\u003eJava\n7. File-\u003eNew-\u003eProject-\u003eJava Project-\u003eNext-\u003eEnter Test-\u003eNext-\u003eProjects tab-\n\u003eSelect All-\u003eFinish\n8. Select project Test\n9. File-\u003eNew-\u003eJava Scrapbook Page-\u003eEnter Page1-\u003eFinish\n10. Paste the above code snippet\n11. Edit-\u003eSelect All\n12. Edit-\u003eRun\nObserve: You get the following stack trace in the console:\norg.eclipse.core.internal.resources.ResourceException(null)[4]: \njava.lang.NullPointerException\n\tat org.eclipse.team.core.internal.FileModificationValidator.validateSave\n(FileModificationValidator.java:49)\n\tat org.eclipse.core.internal.resources.Workspace$4.run\n(Workspace.java:1569)\n\tat org.eclipse.core.internal.runtime.InternalPlatform.run\n(InternalPlatform.java:821)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:395)\n\tat org.eclipse.core.internal.resources.Workspace.validateSave\n(Workspace.java:1575)\n\tat org.eclipse.core.internal.resources.File.setContents(File.java:206)\n\tat CodeSnippet_1.run(CodeSnippet_1.java:27)\n\tat org.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain1.eval\n(ScrapbookMain1.java:14)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat \norg.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain.evalLoop\n(ScrapbookMain.java:46)\n\tat org.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain.main\n(ScrapbookMain.java:27)\n\n",
    "Are you sure that this is the same exception that you were getting before? This \none is a NPE in VCM code. (they are the ones who provide a file validator into \nthe hook that we provide)\n\nIf you don\u0027t move around the DLL, do you still get an exception? ",
    "Sorry, you\u0027re right. It\u0027s a different exception and I get it even if I don\u0027t \nput the core dll on the path. Should I move it to VCM?",
    "Moving to Platform/VCM.\n\nJerome, please open new bug (or reopen and reassign this one) if original \nproblem persists after NPE problem is fixed.\n",
    "This has been fixed since we turn all 5 plug-ins off by default now.",
    "Reopening since the original problem is not fixed in build 20020212",
    "Moving to Platform/Core",
    "Jerome, we haven\u0027t been able to reproduce this. Is this still a problem for \nyou?",
    "No this is not a problem any more since we switch our tests to use the pde \nJunit support.\nYou can close.",
    "Closing at originator\u0027s request."
  ],
  "commentCreationDates": [
    "2001-12-08T14:15:20+01:00",
    "2001-12-10T16:52:07+01:00",
    "2001-12-10T17:13:50+01:00",
    "2001-12-14T21:14:52+01:00",
    "2002-01-18T15:42:14+01:00",
    "2002-01-18T16:36:07+01:00",
    "2002-01-18T16:45:02+01:00",
    "2002-01-18T17:09:53+01:00",
    "2002-01-18T17:49:15+01:00",
    "2002-02-11T20:21:27+01:00",
    "2002-02-13T16:58:17+01:00",
    "2002-02-13T16:59:21+01:00",
    "2002-09-27T16:31:32+02:00",
    "2002-09-27T17:37:02+02:00",
    "2002-09-27T17:51:17+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.team.core.internal.FileModificationValidator.validateSave",
          "source": "FileModificationValidator.java:49"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace$4.run",
          "source": "Workspace.java:1569"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:821"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:395"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.validateSave",
          "source": "Workspace.java:1575"
        },
        {
          "method": "org.eclipse.core.internal.resources.File.setContents",
          "source": "File.java:206"
        },
        {
          "method": "CodeSnippet_1.run",
          "source": "CodeSnippet_1.java:27"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain1.eval",
          "source": "ScrapbookMain1.java:14"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain.evalLoop",
          "source": "ScrapbookMain.java:46"
        },
        {
          "method": "org.eclipse.jdt.internal.debug.ui.snippeteditor.ScrapbookMain.main",
          "source": "ScrapbookMain.java:27"
        }
      ],
      "number": 0,
      "commentIndex": 5,
      "bugId": "6708",
      "date": "2002-01-18T16:36:07+01:00",
      "product": "Platform",
      "component": "Resources",
      "severity": "normal"
    }
  ],
  "groupId": "6708",
  "bugId": "6708",
  "date": "2001-12-08T14:15:20+01:00",
  "product": "Platform",
  "component": "Resources",
  "severity": "normal"
}