{
  "comments": [
    "Build 3.1.1rc2\n\nWhen compiling java/util/Currency.java from sources 1.6 against JRE1.6, the\ncompiler terminates with following exception:\n\nSeverity\tDescription\tResource\tIn Folder\tLocation\tCreation Time\tId\n2\tInternal compiler error\njava.lang.ArrayIndexOutOfBoundsException: 3\n\tat\norg.eclipse.jdt.internal.compiler.lookup.Scope.parameterCompatibilityLevel(Scope.java:3494)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.findMethod(Scope.java:1211)\n\tat org.eclipse.jdt.internal.compiler.lookup.Scope.getMethod(Scope.java:2102)\n\tat\norg.eclipse.jdt.internal.compiler.ast.MessageSend.resolveType(MessageSend.java:314)\n\tat\norg.eclipse.jdt.internal.compiler.ast.LocalDeclaration.resolve(LocalDeclaration.java:199)\n\tat org.eclipse.jdt.internal.compiler.ast.Block.resolve(Block.java:101)\n\tat org.eclipse.jdt.internal.compiler.ast.IfStatement.resolve(IfStatement.java:225)\n\tat org.eclipse.jdt.internal.compiler.ast.Block.resolveUsing(Block.java:115)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TryStatement.resolve(TryStatement.java:504)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolveStatements(AbstractMethodDeclaration.java:418)\n\tat\norg.eclipse.jdt.internal.compiler.ast.MethodDeclaration.resolveStatements(MethodDeclaration.java:178)\n\tat\norg.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolve(AbstractMethodDeclaration.java:396)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:1072)\n\tat\norg.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:1121)\n\tat\norg.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.resolve(CompilationUnitDeclaration.java:305)\n\tat org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:512)\n\tat org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:329)\n\tat\norg.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:248)\n\tat\norg.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:221)\n\tat\norg.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:50)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:213)\n\tat org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:136)\n\tat org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202)\n\tat org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231)\n\tat\norg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)\n\tat org.eclipse.core.runtime.Platform.run(Platform.java:783)\n\tat org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234)\n\tat\norg.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:253)\n\tat org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:282)\n\tat org.eclipse.core.internal.resources.Workspace.build(Workspace.java:211)\n\tat org.eclipse.ui.actions.GlobalBuildAction$1.run(GlobalBuildAction.java:182)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)\n\tCurrency.java\tJRE Source libs 1.6/src/java/util\tline 0\tSeptember 26, 2005\n11:11:52 PM\t10068114",
    "It seems the following check is missing; but still javac 1.6 accepts the code\nand we reject it complaining about an ambiguous method; though it should be fine\ndue to presence of varargs method, only one allowing a 4 args invocation.\n\nIndex: Scope.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file:\n/home/eclipse/org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/Scope.java,v\nretrieving revision 1.231.2.12\ndiff -u -r1.231.2.12 Scope.java\n--- Scope.java\t26 Sep 2005 14:13:48 -0000\t1.231.2.12\n+++ Scope.java\t26 Sep 2005 21:55:40 -0000\n@@ -3488,8 +3488,10 @@\n \t\t\t\t}\n \t\t\t\tlevel \u003d VARARGS_COMPATIBLE; // varargs support needed\n \t\t\t}\n-\t\t\t// now compare standard arguments from 0 to lastIndex\n+\t\t} else \tif (paramLength !\u003d argLength) {\n+\t\t\t\treturn NOT_COMPATIBLE;\n \t\t}\n+\t\t// now compare standard arguments from 0 to lastIndex\n \t\tfor (int i \u003d 0; i \u003c lastIndex; i++) {\n \t\t\tTypeBinding param \u003d parameters[i];\n \t\t\tTypeBinding arg \u003d arguments[i];\n",
    "Simpler testcase:\n\npublic class X {\nvoid bar() {\n\tthis.foo(\"\", this, null, \"\");\n}\nObject foo(String s, X x, Object... obs) { return s; }\t\nObject foo(String s, X x, String r, Object o, Object... obs) { return s; }\t\n}",
    "Released patch to 3.1 maintenance stream, still we shouldn\u0027t reject the code.",
    "It seems precedence is given to varargs methods with \u003c\u003d parameters than\narguments, for instance the following produces ambiguity due to first 2 methods:\n\npublic class X {\n\nvoid bar() {\n\tSystem.out.println(this.foo(null, \"\"));\n}\nObject foo(Object... obs) { return \"1\"; }\t\nObject foo(String r, Object... obs) { return \"2\"; }\t\nObject foo(String r, Object o, Object... obs) { return \"3\"; }\t\n}",
    "Proposed patch:\n\nIndex: Scope.java\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nRCS file:\n/home/eclipse/org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/Scope.java,v\nretrieving revision 1.231.2.13\ndiff -u -r1.231.2.13 Scope.java\n--- Scope.java\t26 Sep 2005 22:18:15 -0000\t1.231.2.13\n+++ Scope.java\t26 Sep 2005 22:35:13 -0000\n@@ -40,7 +40,7 @@\n \tpublic final static int COMPATIBLE \u003d 0;\n \tpublic final static int AUTOBOX_COMPATIBLE \u003d 1;\n \tpublic final static int VARARGS_COMPATIBLE \u003d 2;\n-\n+\t\n \tpublic int kind;\n \tpublic Scope parent;\n \n@@ -2798,9 +2798,9 @@\n \t\t\treturn true;\n \t\t}\n \n-\t\tif (one.isVarargs() \u0026\u0026 two.isVarargs() \u0026\u0026 oneParamsLength - 1 \u003d\u003d\ntwoParamsLength) {\n+\t\tif (one.isVarargs() \u0026\u0026 two.isVarargs() \u0026\u0026 oneParamsLength \u003e twoParamsLength) {\n \t\t\t// special case when autoboxing makes (int, int...) better than (Object...)\nbut not (int...) or (Integer, int...)\n-\t\t\tif (((ArrayBinding) twoParams[twoParamsLength - 1]).elementsType().id !\u003d\nTypeIds.T_JavaLangObject)\n+\t\t\tif (oneParamsLength - 1 \u003d\u003d twoParamsLength \u0026\u0026 ((ArrayBinding)\ntwoParams[twoParamsLength - 1]).elementsType().id !\u003d TypeIds.T_JavaLangObject)\n \t\t\t\treturn false;\n \t\t\t// check that each parameter before the vararg parameters are compatible (no\nautoboxing allowed here)\n \t\t\tfor (int i \u003d twoParamsLength - 2; i \u003e\u003d 0; i--)\n\n\n\n\n",
    "Add Varargs test37\n\nReleased into 3.1.1 stream AND HEAD.",
    "Verified in  M20050923-1430 + JDT/Core 3.1.1RC3 candidate"
  ],
  "commentCreationDates": [
    "2005-09-26T23:54:56+02:00",
    "2005-09-26T23:57:08+02:00",
    "2005-09-27T00:11:19+02:00",
    "2005-09-27T00:14:21+02:00",
    "2005-09-27T00:26:50+02:00",
    "2005-09-27T00:36:13+02:00",
    "2005-09-27T19:27:09+02:00",
    "2005-09-27T21:30:58+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "3",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.parameterCompatibilityLevel",
          "source": "Scope.java:3494"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.findMethod",
          "source": "Scope.java:1211"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.Scope.getMethod",
          "source": "Scope.java:2102"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.MessageSend.resolveType",
          "source": "MessageSend.java:314"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.LocalDeclaration.resolve",
          "source": "LocalDeclaration.java:199"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.Block.resolve",
          "source": "Block.java:101"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.IfStatement.resolve",
          "source": "IfStatement.java:225"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.Block.resolveUsing",
          "source": "Block.java:115"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TryStatement.resolve",
          "source": "TryStatement.java:504"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolveStatements",
          "source": "AbstractMethodDeclaration.java:418"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.MethodDeclaration.resolveStatements",
          "source": "MethodDeclaration.java:178"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.resolve",
          "source": "AbstractMethodDeclaration.java:396"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve",
          "source": "TypeDeclaration.java:1072"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve",
          "source": "TypeDeclaration.java:1121"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.resolve",
          "source": "CompilationUnitDeclaration.java:305"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.process",
          "source": "Compiler.java:512"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:329"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile",
          "source": "AbstractImageBuilder.java:248"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile",
          "source": "AbstractImageBuilder.java:221"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build",
          "source": "BatchImageBuilder.java:50"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll",
          "source": "JavaBuilder.java:213"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.build",
          "source": "JavaBuilder.java:136"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:593"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:168"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:202"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:231"
        },
        {
          "method": "org.eclipse.core.internal.runtime.InternalPlatform.run",
          "source": "InternalPlatform.java:1044"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:783"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:234"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuildLoop",
          "source": "BuildManager.java:253"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:282"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.build",
          "source": "Workspace.java:211"
        },
        {
          "method": "org.eclipse.ui.actions.GlobalBuildAction$1.run",
          "source": "GlobalBuildAction.java:182"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "110738",
      "date": "2005-09-26T23:54:56+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "110738",
  "bugId": "110738",
  "date": "2005-09-26T23:54:56+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}