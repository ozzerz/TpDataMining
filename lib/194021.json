{
  "comments": [
    "I have the following simple setup\n\n\u003d\u003d\u003d test.h \u003d\u003d\u003d\n#define chop foo\n\n\u003d\u003d\u003d test.c \u003d\u003d\u003d\n#include \"test.h\"\n\nint foo() {\n    chop();\n}\n\nWhen I select \"chop\" in test.c and select declarations-\u003eworkspace from the context menu I get the following exception (F3 works though)...\n\n\njava.lang.ArrayIndexOutOfBoundsException: 1840\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.getChunk(Database.java:179)\n\tat org.eclipse.cdt.internal.core.pdom.db.Database.getInt(Database.java:336)\n\tat org.eclipse.cdt.internal.core.pdom.db.DBProperties$2.compare(DBProperties.java:218)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:548)\n\tat org.eclipse.cdt.internal.core.pdom.db.BTree.accept(BTree.java:524)\n\tat org.eclipse.cdt.internal.core.pdom.db.DBProperties$DBProperty.search(DBProperties.java:216)\n\tat org.eclipse.cdt.internal.core.pdom.db.DBProperties.getProperty(DBProperties.java:61)\n\tat org.eclipse.cdt.internal.core.pdom.PDOM.getProperty(PDOM.java:755)\n\tat org.eclipse.cdt.internal.core.index.IndexFactory.safeAddFragment(IndexFactory.java:205)\n\tat org.eclipse.cdt.internal.core.index.IndexFactory.getIndex(IndexFactory.java:69)\n\tat org.eclipse.cdt.internal.core.pdom.PDOMManager.getIndex(PDOMManager.java:1059)\n\tat org.eclipse.cdt.internal.ui.search.PDOMSearchQuery.run(PDOMSearchQuery.java:132)\n\tat org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:94)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)",
    "Mike, \nwhat version of CDT did you use?\nIs this reproducable after closing and reopening the workbench?\nI assume that this is not reproducable after you rebuild the index?",
    "(In reply to comment #1)\n\u003e Mike, \n\u003e what version of CDT did you use?\n\u003e Is this reproducable after closing and reopening the workbench?\n\u003e I assume that this is not reproducable after you rebuild the index?\n\nI\u0027m launching CDT from my development workspace using the latest HEAD.\n\nIt is reproducible for me, even after reopening the workbench and rebuilding the index. Even if I set up a new project, using the contents of the files listed above I can reproduce this.\n\nThe problem occurs with both parsers so I don\u0027t think its related to the parsers.\n\nIs there any other information I can provide?\n\n",
    "Actually, the exception only occurs when I select declarations-\u003eworkspace, and not declarations-\u003eproject, so the problem must be one of the other projects that I have open in the workspace that I\u0027m testing with. I\u0027m seeing the problem in another project, let me investigate further.",
    "Ok, the problem was happening on a project that I had in my workspace in order to investigate bug 193185. Every time I tried to rebuild the index for this project I got the same exception. I copied the entire project and I did not get any problems on the copied project. So, I deleted the .pdom file for the original project and then rebuilt the index, and now I can\u0027t reproduce anymore. \n\nI think we should chalk this one up to a corrupted pdom, sorry about the wild goose chase.",
    "(In reply to comment #4)\n\u003e I think we should chalk this one up to a corrupted pdom, sorry about the wild\n\u003e goose chase.\n\nI am interested in how the pdom got corrupted though. The potential reasons I know of are:\n(a) terminating IDE while an indexer is running.\n(b) bug 193505, concurrency problem which is fixed by now.\n\nI think I should implement a guard against (a), which could be a flag in the database that is set as long as the index is partially written to disk.\n\n",
    "(In reply to comment #5)\n\nI think in this case (a) is the very likely cause."
  ],
  "commentCreationDates": [
    "2007-06-22T19:59:07+02:00",
    "2007-06-25T11:20:44+02:00",
    "2007-06-25T16:21:28+02:00",
    "2007-06-25T16:29:07+02:00",
    "2007-06-25T16:38:25+02:00",
    "2007-06-25T16:46:25+02:00",
    "2007-06-25T16:52:28+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "message": "1840",
      "elements": [
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.getChunk",
          "source": "Database.java:179"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.Database.getInt",
          "source": "Database.java:336"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.DBProperties$2.compare",
          "source": "DBProperties.java:218"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:548"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.BTree.accept",
          "source": "BTree.java:524"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.DBProperties$DBProperty.search",
          "source": "DBProperties.java:216"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.db.DBProperties.getProperty",
          "source": "DBProperties.java:61"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.PDOM.getProperty",
          "source": "PDOM.java:755"
        },
        {
          "method": "org.eclipse.cdt.internal.core.index.IndexFactory.safeAddFragment",
          "source": "IndexFactory.java:205"
        },
        {
          "method": "org.eclipse.cdt.internal.core.index.IndexFactory.getIndex",
          "source": "IndexFactory.java:69"
        },
        {
          "method": "org.eclipse.cdt.internal.core.pdom.PDOMManager.getIndex",
          "source": "PDOMManager.java:1059"
        },
        {
          "method": "org.eclipse.cdt.internal.ui.search.PDOMSearchQuery.run",
          "source": "PDOMSearchQuery.java:132"
        },
        {
          "method": "org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run",
          "source": "InternalSearchUI.java:94"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "194021",
      "date": "2007-06-22T19:59:07+02:00",
      "product": "CDT",
      "component": "cdt-core",
      "severity": "normal"
    }
  ],
  "groupId": "194021",
  "bugId": "194021",
  "date": "2007-06-22T19:59:07+02:00",
  "product": "CDT",
  "component": "cdt-core",
  "severity": "normal"
}