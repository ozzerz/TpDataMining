{
  "comments": [
    "Build I20030422\n\nSetup:\n0) start dev workbench with I20030422\n1) have JDT UI plug-in and JDT UI Refactoring tests as source\n2) have I20030422 as binaries\n3) rebuild all with 1.3 compliance level against 1.3.1 JRE\n4) run \"ExtractTempTests\" as JUnit Plugin Test \n\n\u003d\u003d\u003e many verify errors \"Illegal target of jump or branch\" (see trace below)\n\nThe problem does not appear if R2.1 is used in step 0.\n\n\njava.lang.VerifyError: (class:\norg/eclipse/jdt/internal/corext/dom/fragments/ASTFragmentFactory$FragmentForSubPartBySourceRangeFactory,\nmethod: visit signature: (Lorg/eclipse/jdt/core/dom/InfixExpression;)Z) Illegal\ntarget of jump or branch\n\tat\norg.eclipse.jdt.internal.corext.dom.fragments.ASTFragmentFactory.createFragmentForSubPartBySourceRange(ASTFragmentFactory.java:103)\n\tat\norg.eclipse.jdt.internal.corext.dom.fragments.ASTFragmentFactory.createFragmentForSourceRange(ASTFragmentFactory.java:81)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.getSelectedExpression(ExtractTempRefactoring.java:685)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.checkSelection(ExtractTempRefactoring.java:186)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.checkActivation(ExtractTempRefactoring.java:176)\n\tat\norg.eclipse.jdt.internal.corext.refactoring.base.Refactoring.checkPreconditions(Refactoring.java:76)\n\tat\norg.eclipse.jdt.ui.tests.refactoring.RefactoringTest.performRefactoring(RefactoringTest.java:133)\n\tat\norg.eclipse.jdt.ui.tests.refactoring.ExtractTempTests.failHelper1(ExtractTempTests.java:122)\n\tat\norg.eclipse.jdt.ui.tests.refactoring.ExtractTempTests.testFail25(ExtractTempTests.java:550)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat junit.framework.TestCase.runTest(TestCase.java:154)\n\tat junit.framework.TestCase.runBare(TestCase.java:127)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:118)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\n\tat\norg.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:392)\n\tat\norg.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:276)\n\tat\norg.eclipse.pde.internal.junit.ui.RemotePluginTestRunner.main(RemotePluginTestRunner.java:30)\n\tat\norg.eclipse.pde.internal.junit.ui.UITestApplication.runEventLoop(UITestApplication.java:35)\n\tat org.eclipse.ui.internal.Workbench.run(Workbench.java:1385)\n\tat\norg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:845)\n\tat org.eclipse.core.boot.BootLoader.run(BootLoader.java:431)\n\tat EclipseRuntimeLauncher.main(EclipseRuntimeLauncher.java:24)",
    "Reproduced with simpler testcase:\n\npublic class X {\n\n\tThrowable ex;\n\tpublic static void main(String[] args) {\n\t\tnew X().visit(\"hello world\");\n\t}\n\tpublic boolean visit(Object node) {\n\t\ttry {\n\t\t\tSystem.out.println(node);\n\t\t} catch (Throwable e) {\n\t\t\tex \u003d e;\n\t\t} finally {\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\n\nProblem got introduced since R2.1, when moving the natural exit in codegen of \ntry-statement (to save one bytecode). The last catch block is branching too far \nif the subroutine doesn\u0027t complete normally.",
    "Fixed",
    "*** Bug 37247 has been marked as a duplicate of this bug. ***",
    "Verified."
  ],
  "commentCreationDates": [
    "2003-04-29T11:26:30+02:00",
    "2003-04-29T11:31:10+02:00",
    "2003-04-29T11:31:42+02:00",
    "2003-05-06T11:35:32+02:00",
    "2003-06-05T15:34:31+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.VerifyError",
      "message": "(class: org/eclipse/jdt/internal/corext/dom/fragments/ASTFragmentFactory$FragmentForSubPartBySourceRangeFactory, method: visit signature: (Lorg/eclipse/jdt/core/dom/InfixExpression;)Z) Illegal target of jump or branch",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.corext.dom.fragments.ASTFragmentFactory.createFragmentForSubPartBySourceRange",
          "source": "ASTFragmentFactory.java:103"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.dom.fragments.ASTFragmentFactory.createFragmentForSourceRange",
          "source": "ASTFragmentFactory.java:81"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.getSelectedExpression",
          "source": "ExtractTempRefactoring.java:685"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.checkSelection",
          "source": "ExtractTempRefactoring.java:186"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.code.ExtractTempRefactoring.checkActivation",
          "source": "ExtractTempRefactoring.java:176"
        },
        {
          "method": "org.eclipse.jdt.internal.corext.refactoring.base.Refactoring.checkPreconditions",
          "source": "Refactoring.java:76"
        },
        {
          "method": "org.eclipse.jdt.ui.tests.refactoring.RefactoringTest.performRefactoring",
          "source": "RefactoringTest.java:133"
        },
        {
          "method": "org.eclipse.jdt.ui.tests.refactoring.ExtractTempTests.failHelper1",
          "source": "ExtractTempTests.java:122"
        },
        {
          "method": "org.eclipse.jdt.ui.tests.refactoring.ExtractTempTests.testFail25",
          "source": "ExtractTempTests.java:550"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "junit.framework.TestCase.runTest",
          "source": "TestCase.java:154"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:127"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:106"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:109"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:118"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:208"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:203"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:22"
        },
        {
          "method": "junit.extensions.TestSetup$1.protect",
          "source": "TestSetup.java:19"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.extensions.TestSetup.run",
          "source": "TestSetup.java:23"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:392"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:276"
        },
        {
          "method": "org.eclipse.pde.internal.junit.ui.RemotePluginTestRunner.main",
          "source": "RemotePluginTestRunner.java:30"
        },
        {
          "method": "org.eclipse.pde.internal.junit.ui.UITestApplication.runEventLoop",
          "source": "UITestApplication.java:35"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1385"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:845"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:431"
        },
        {
          "method": "EclipseRuntimeLauncher.main",
          "source": "EclipseRuntimeLauncher.java:24"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "37040",
      "date": "2003-04-29T11:26:30+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "major"
    }
  ],
  "groupId": "37040",
  "bugId": "37040",
  "date": "2003-04-29T11:26:30+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "major"
}