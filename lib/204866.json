{
  "comments": [
    "If a feature description contains the \u0026 character, the feature description displays properly in the update dialogs when installing, and in the Product Configuration \"Properties\" dialog for a feature, but clicking the feature, will cause the right pane of the Product Configuration dialog to refresh and display a org.eclipse.jface plug-in error log entry:\n\njava.lang.IllegalArgumentException: Argument not valid\nat org.eclipse.swt.SWT.error(SWT.java:3358)\nat org.eclipse.swt.SWT.error(SWT.java:3297)\nat org.eclipse.ui.internal.forms.widgets.FormTextModel.parseInputStream(FormTextModel.java:114)\nat org.eclipse.ui.internal.forms.widgets.FormTextModel.parseTaggedText(FormTextModel.java:93)\nat org.eclipse.ui.forms.widgets.FormText.setText(FormText.java:661)\nat org.eclipse.update.internal.ui.views.ConfigurationPreview.setSelection(ConfigurationPreview.java:106)\nat org.eclipse.update.internal.ui.views.ConfigurationView.handleSelectionChanged(ConfigurationView.java:1154)\nat org.eclipse.update.internal.ui.views.ConfigurationView.handleSelectionChanged(ConfigurationView.java:1158)\nat org.eclipse.update.internal.ui.views.ConfigurationView$11.selectionChanged(ConfigurationView.java:959)\nat org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:162)\nat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\nat org.eclipse.core.runtime.Platform.run(Platform.java:843)\nat org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:44)\nat org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:149)\nat org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:160)\nat org.eclipse.jface.viewers.StructuredViewer.updateSelection(StructuredViewer.java:1976)\nat org.eclipse.jface.viewers.StructuredViewer.handleSelect(StructuredViewer.java:1128)\nat org.eclipse.jface.viewers.StructuredViewer$4.widgetSelected(StructuredViewer.java:1154)\nat org.eclipse.jface.util.OpenStrategy.fireSelectionEvent(OpenStrategy.java:213)\nat org.eclipse.jface.util.OpenStrategy.access$3(OpenStrategy.java:207)\nat org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:374)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3348)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2968)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1930)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1894)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:422)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\nat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\nat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\nat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:400)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.core.launcher.Main.invokeFramework(Main.java:336)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:280)\nat org.eclipse.core.launcher.Main.run(Main.java:977)\nat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "Feature description cannot contain an ampersand that is not escaped as per XML spec. You should use \u0026amp; instead.",
    "One thing though, I typed the \u0026 character in the PDE feature editor, I didn\u0027t mean to say I hand edited the feature.xml; testing just now I see the feature editor does serialize to \u0026amp; in the feature.xml file, like it should. It would appear that the bug stands, though I\u0027m not certain why it would.",
    "In that case, PDE should escape the ampersand before accepting your input.\n\nMoving to PDE - make sure you escape special characters for user input for anything stored as XML element body.",
    "I\u0027ve browsed through the PDE code and I didn\u0027t find nothing that can be source of your problem. Illegal characters in feature xml are replaced via org.eclipse.pde.internal.core.util.PDEXMLHelper class. this is done both when switching the tabs between source view and forms view and when file is saved (FeatureInfo is accessed both times). The only thing that I\u0027ve observed is a fact that when you\u0027ll put escaped \u0027\u0026\u0027 into feature.xml and then build update site, update manager don\u0027t replaces \u0026amp; with \u0027\u0026\u0027 in description. \nso I can add bug to the Update Manager but as long as they work at the new version I won\u0027t to disturb with this little, minor issue ;).\nbut if you think that there i\u0027ve missed something please show me the starting point and assign this bug.",
    "The error message is coming from an ANT class (AntLaunchShortcut).  PDE calls the method \"findExistingLaunchConfigurations(IFile)\".  Inside this function, there is an if statement as follows \"configs !\u003d null \u0026\u0026 configs.length \u003e 0 \u0026\u0026 filePath !\u003d null\".  If this statement returns false, an error is reported.  On a new workspace, configs.length \u003d\u003d 0 since there are no previous configs.  This is what is throwing the error. \n\nThis seems to be a side effect from the fix for bug 154138.  I would suggest not displaying an error if configs.length \u003d\u003d 0.",
    "(In reply to comment #5)\n\u003e The error message is coming from an ANT class (AntLaunchShortcut).  PDE calls\n\u003e the method \"findExistingLaunchConfigurations(IFile)\".  Inside this function,\n\u003e there is an if statement as follows \"configs !\u003d null \u0026\u0026 configs.length \u003e 0 \u0026\u0026\n\u003e filePath !\u003d null\".  If this statement returns false, an error is reported.  On\n\u003e a new workspace, configs.length \u003d\u003d 0 since there are no previous configs.  This\n\u003e is what is throwing the error. \n\u003e \n\u003e This seems to be a side effect from the fix for bug 154138.  I would suggest\n\u003e not displaying an error if configs.length \u003d\u003d 0.\n\u003e \n\nSorry, wrong browser tab.  As you were :)",
    "I can confirm Bartosz\u0027s findings.  PDE is encoding the \u0026 correctly when the user enters it in the Feature Editor.\n\nI also saw what he mentioned about the \u0026amp not being decoded during the installation process when the feature\u0027s description was displayed during the installation.\n\nLastly, I recreated the user\u0027s problem during my simple test case.  I went to confirm the feature.xml was not changed during installation and confirmed the feature.xml in question still contained the encoded version of ampersand (\u0026amp).  I will attach my update site to the bug report to help reproduce this bug easier.  \n\nReassigning it to Update for further investigation.",
    "Created an attachment (id\u003d79914)\nUpdate Site that causes error\n\nThis is the update site I created which caused the same exception discussed in the original bug report.  Note how the description of test.feature properly encodes the \u0027\u0026\u0027 character.  \n\nJust for the record, this update site was installed in directory form instead of zip file form, simply zipped it up for easy attachment."
  ],
  "commentCreationDates": [
    "2007-09-27T22:42:21+02:00",
    "2007-09-27T23:11:58+02:00",
    "2007-09-27T23:24:48+02:00",
    "2007-09-27T23:48:47+02:00",
    "2007-10-08T17:47:38+02:00",
    "2007-10-08T18:31:27+02:00",
    "2007-10-08T20:57:03+02:00",
    "2007-10-08T21:28:40+02:00",
    "2007-10-08T21:30:47+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Argument not valid",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3358"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3297"
        },
        {
          "method": "org.eclipse.ui.internal.forms.widgets.FormTextModel.parseInputStream",
          "source": "FormTextModel.java:114"
        },
        {
          "method": "org.eclipse.ui.internal.forms.widgets.FormTextModel.parseTaggedText",
          "source": "FormTextModel.java:93"
        },
        {
          "method": "org.eclipse.ui.forms.widgets.FormText.setText",
          "source": "FormText.java:661"
        },
        {
          "method": "org.eclipse.update.internal.ui.views.ConfigurationPreview.setSelection",
          "source": "ConfigurationPreview.java:106"
        },
        {
          "method": "org.eclipse.update.internal.ui.views.ConfigurationView.handleSelectionChanged",
          "source": "ConfigurationView.java:1154"
        },
        {
          "method": "org.eclipse.update.internal.ui.views.ConfigurationView.handleSelectionChanged",
          "source": "ConfigurationView.java:1158"
        },
        {
          "method": "org.eclipse.update.internal.ui.views.ConfigurationView$11.selectionChanged",
          "source": "ConfigurationView.java:959"
        },
        {
          "method": "org.eclipse.jface.viewers.Viewer$2.run",
          "source": "Viewer.java:162"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java:843"
        },
        {
          "method": "org.eclipse.ui.internal.JFaceUtil$1.run",
          "source": "JFaceUtil.java:44"
        },
        {
          "method": "org.eclipse.jface.util.SafeRunnable.run",
          "source": "SafeRunnable.java:149"
        },
        {
          "method": "org.eclipse.jface.viewers.Viewer.fireSelectionChanged",
          "source": "Viewer.java:160"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.updateSelection",
          "source": "StructuredViewer.java:1976"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer.handleSelect",
          "source": "StructuredViewer.java:1128"
        },
        {
          "method": "org.eclipse.jface.viewers.StructuredViewer$4.widgetSelected",
          "source": "StructuredViewer.java:1154"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy.fireSelectionEvent",
          "source": "OpenStrategy.java:213"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy.access$3",
          "source": "OpenStrategy.java:207"
        },
        {
          "method": "org.eclipse.jface.util.OpenStrategy$1.handleEvent",
          "source": "OpenStrategy.java:374"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:3348"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2968"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1930"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1894"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:422"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:78"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:400"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:177"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Unknown Source"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:336"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:280"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "204866",
      "date": "2007-09-27T22:42:21+02:00",
      "product": "Platform",
      "component": "Update",
      "severity": "normal"
    }
  ],
  "groupId": "204866",
  "bugId": "204866",
  "date": "2007-09-27T22:42:21+02:00",
  "product": "Platform",
  "component": "Update",
  "severity": "normal"
}