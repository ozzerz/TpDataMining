{
  "comments": [
    "Using -repeat 5 with the batch compiler is broken when jar files are used on the\nclasspath.\n\njava.lang.IllegalStateException: zip file closed\n   at java.util.zip.ZipFile.ensureOpen(ZipFile.java:519)\n   at java.util.zip.ZipFile.entries(ZipFile.java:407)\n   at\norg.eclipse.jdt.internal.compiler.batch.ClasspathJar.isPackage(ClasspathJar.java:59)\n   at\norg.eclipse.jdt.internal.compiler.batch.ClasspathJar.findClass(ClasspathJar.java:40)\n   at\norg.eclipse.jdt.internal.compiler.batch.FileSystem.findClass(FileSystem.java:147)\n   at\norg.eclipse.jdt.internal.compiler.batch.FileSystem.findType(FileSystem.java:171)\n   at\norg.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createPackage(LookupEnvironment.java:517)\n   at\norg.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.buildTypeBindings(CompilationUnitScope.java:83)\n   at\norg.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.buildTypeBindings(LookupEnvironment.java:144)\n   at org.eclipse.jdt.internal.compiler.Compiler.beginToCompile(Compiler.java:292)\n   at org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:315)\n   at\norg.eclipse.jdt.internal.compiler.batch.Main.performCompilation(Main.java:2692)\n   at\norg.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1151)[repetition 2/5]\n \n   at org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1048)\n   at org.eclipse.jdt.internal.compiler.batch.Main.compile(Main.java:1040)\n   at org.eclipse.jdt.core.tools.compiler.Compile.main(Compile.java:19)\n\nThe first compilation resets the internal zip file of the ClasspathJar object.",
    "Created an attachment (id\u003d25132)\nProposed fix\n\nI simply use the zipFile internally. The zipFile is created again using the\nfile in the second iteration.",
    "I am working on a better patch.",
    "Created an attachment (id\u003d25135)\nProposed fix\n\nNew patch. The zip file is created in an initialize method. This is called only\nwhen the library is retrieved, so this doesn\u0027t penalize any subsequent calls to\nisPackage(...) or findClass(...).",
    "Fixed and released in HEAD.\nRegression test in\norg.eclipse.jdt.core.tests.compiler.regression.BatchCompilerTest.test033",
    "Backported to 3.1 maintenance stream.",
    "Verified with 3.2 M1",
    "Verified for 3.2 M2 with build I20050920-0010.",
    "Verified using M20050923-1430 for 3.1.1"
  ],
  "commentCreationDates": [
    "2005-07-21T16:28:13+02:00",
    "2005-07-21T16:32:03+02:00",
    "2005-07-21T17:04:50+02:00",
    "2005-07-21T17:16:13+02:00",
    "2005-07-25T16:26:08+02:00",
    "2005-07-25T17:16:44+02:00",
    "2005-08-11T16:33:31+02:00",
    "2005-09-21T15:16:07+02:00",
    "2005-09-26T18:38:33+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "zip file closed",
      "elements": [
        {
          "method": "java.util.zip.ZipFile.ensureOpen",
          "source": "ZipFile.java:519"
        },
        {
          "method": "java.util.zip.ZipFile.entries",
          "source": "ZipFile.java:407"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.ClasspathJar.isPackage",
          "source": "ClasspathJar.java:59"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.ClasspathJar.findClass",
          "source": "ClasspathJar.java:40"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.FileSystem.findClass",
          "source": "FileSystem.java:147"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.FileSystem.findType",
          "source": "FileSystem.java:171"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createPackage",
          "source": "LookupEnvironment.java:517"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.CompilationUnitScope.buildTypeBindings",
          "source": "CompilationUnitScope.java:83"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.buildTypeBindings",
          "source": "LookupEnvironment.java:144"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.beginToCompile",
          "source": "Compiler.java:292"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.Compiler.compile",
          "source": "Compiler.java:315"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.performCompilation",
          "source": "Main.java:2692"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.batch.Main.compile",
          "source": "Main.java:1151"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "104664",
      "date": "2005-07-21T16:28:13+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "104664",
  "bugId": "104664",
  "date": "2005-07-21T16:28:13+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}