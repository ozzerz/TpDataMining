{
  "comments": [
    "A NPE will be thrown if the RenderImageFactory returns null to the lastRenderedImage class variable in ScalableImageFactory, this is a result of the instanceMap holding WeakReferences to the RenderedImage. This means that the GC can clean up the RenderedImage without the knowledge of the instanceMap; resulting in null being returned for what is a valid key...\n\nThe exception is as follows - \njava.lang.NullPointerException\n        at org.eclipse.gmf.runtime.draw2d.ui.render.figures.ScalableImageFigure.getRenderedImage(ScalableImageFigure.java:307)\n        at org.eclipse.gmf.runtime.draw2d.ui.render.figures.ScalableImageFigure.setBounds(ScalableImageFigure.java:281)\n        at org.eclipse.draw2d.StackLayout.layout(StackLayout.java:89)\n        at org.eclipse.draw2d.Figure.layout(Figure.java:1029)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1739)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Viewport.validate(Viewport.java:363)\n        at org.eclipse.gmf.runtime.draw2d.ui.internal.figures.AnimatableScrollPane.validate(AnimatableScrollPane.java:127)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.gmf.runtime.diagram.ui.figures.ResizableCompartmentFigure.validate(ResizableCompartmentFigure.java:451)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemsAwareFreeFormLayer.validate(BorderItemsAwareFreeFormLayer.java:169)\n        at org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart$1.validate(DiagramEditPart.java:157)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemsAwareFreeFormLayer.validate(BorderItemsAwareFreeFormLayer.java:169)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Figure.validate(Figure.java:1741)\n        at org.eclipse.draw2d.Viewport.validate(Viewport.java:363)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeContents(DiagramEditor.java:1347)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeGraphicalViewerContents(DiagramEditor.java:858)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeGraphicalViewer(DiagramEditor.java:850)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorWithFlyOutPalette.initializeGraphicalViewer(DiagramEditorWithFlyOutPalette.java:112)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.createGraphicalViewer(DiagramEditor.java:794)\n        at org.eclipse.gef.ui.parts.GraphicalEditor.createPartControl(GraphicalEditor.java:163)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.createPartControl(DiagramEditor.java:1548)\n        at org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorWithFlyOutPalette.createPartControl(DiagramEditorWithFlyOutPalette.java:310)\n        at org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditor.createPartControl(DiagramDocumentEditor.java:1459)",
    "Created an attachment (id\u003d81847)\nProposed patch for NPE in ScalableImageFigure\n\nBasically added a check to determine if the RenderedImage held as a WeakReference in the instanceMap is null - if it is then that entry is removed from the map and a new one created."
  ],
  "commentCreationDates": [
    "2007-11-01T11:00:50+01:00",
    "2007-11-01T11:43:43+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.gmf.runtime.draw2d.ui.render.figures.ScalableImageFigure.getRenderedImage",
          "source": "ScalableImageFigure.java:307"
        },
        {
          "method": "org.eclipse.gmf.runtime.draw2d.ui.render.figures.ScalableImageFigure.setBounds",
          "source": "ScalableImageFigure.java:281"
        },
        {
          "method": "org.eclipse.draw2d.StackLayout.layout",
          "source": "StackLayout.java:89"
        },
        {
          "method": "org.eclipse.draw2d.Figure.layout",
          "source": "Figure.java:1029"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1739"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Viewport.validate",
          "source": "Viewport.java:363"
        },
        {
          "method": "org.eclipse.gmf.runtime.draw2d.ui.internal.figures.AnimatableScrollPane.validate",
          "source": "AnimatableScrollPane.java:127"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.figures.ResizableCompartmentFigure.validate",
          "source": "ResizableCompartmentFigure.java:451"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemsAwareFreeFormLayer.validate",
          "source": "BorderItemsAwareFreeFormLayer.java:169"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart$1.validate",
          "source": "DiagramEditPart.java:157"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemsAwareFreeFormLayer.validate",
          "source": "BorderItemsAwareFreeFormLayer.java:169"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Figure.validate",
          "source": "Figure.java:1741"
        },
        {
          "method": "org.eclipse.draw2d.Viewport.validate",
          "source": "Viewport.java:363"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeContents",
          "source": "DiagramEditor.java:1347"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeGraphicalViewerContents",
          "source": "DiagramEditor.java:858"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.initializeGraphicalViewer",
          "source": "DiagramEditor.java:850"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorWithFlyOutPalette.initializeGraphicalViewer",
          "source": "DiagramEditorWithFlyOutPalette.java:112"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.createGraphicalViewer",
          "source": "DiagramEditor.java:794"
        },
        {
          "method": "org.eclipse.gef.ui.parts.GraphicalEditor.createPartControl",
          "source": "GraphicalEditor.java:163"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor.createPartControl",
          "source": "DiagramEditor.java:1548"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorWithFlyOutPalette.createPartControl",
          "source": "DiagramEditorWithFlyOutPalette.java:310"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditor.createPartControl",
          "source": "DiagramDocumentEditor.java:1459"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "208374",
      "date": "2007-11-01T11:00:50+01:00",
      "product": "GMF",
      "component": "Runtime Diagram",
      "severity": "minor"
    }
  ],
  "groupId": "208374",
  "bugId": "208374",
  "date": "2007-11-01T11:00:50+01:00",
  "product": "GMF",
  "component": "Runtime Diagram",
  "severity": "minor"
}