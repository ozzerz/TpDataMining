{
  "comments": [
    "I20051123-1200\n\nI have the following setup:\n1. install I20051123-1200\n2. start fresh workspace\n3. load org.eclipse.jdt.text.tests checked out from HEAD\n4. load all its required test projects from HEAD\n5. load org.eclipse.jface.text from HEAD\n6. *** only needed to run against SWT from 3.2 M1 - see later step ***\n  - replace \"gc.getDevice()\" with \"\" in all *.java files\n  - in AnnotationPainter.java replace \"getLineHeight(offset)\" with \n    \"getLineHeight()\"\n7. run JdtTextTestSuite as JUnit Plug-in Test (ignore the error in jdt.ui.tests)\n\u003d\u003d\u003e no more handles occurrs (at different places on each run)\n\u003d\u003d\u003e several tests fail as consequence\n\nWorks on Linux and also on releng WinXP machine but fails on several of our machines here in the lab.\n\nIntegrated SWT\u0027s sleak tool code into the test runner to dump object info for each test. Before the error the figures are about the following:\n221 Color(s)\n8 Cursor(s)\n10 Font(s)\n154 Image(s)\n\nThe interesting part comes now:\n- use the PDE importer to import SWT from 3.2 M1 and repeat step 7.\n\u003d\u003d\u003e no SWTError\n\n- use the PDE importer to import SWT from 3.2 M2 (or newer) and repeat step 7.\n\u003d\u003d\u003e SWTError is back\n\n\nHere\u0027s one such stack trace:\nError while informing user about event loop exception:\norg.eclipse.swt.SWTError: No more handles\n\tat org.eclipse.swt.SWT.error(SWT.java:3277)\n\tat org.eclipse.swt.SWT.error(SWT.java:3174)\n\tat org.eclipse.swt.SWT.error(SWT.java:3145)\n\tat org.eclipse.swt.widgets.Widget.error(Widget.java:407)\n\tat org.eclipse.swt.widgets.Control.createHandle(Control.java:482)\n\tat org.eclipse.swt.widgets.Label.createHandle(Label.java:170)\n\tat org.eclipse.swt.widgets.Control.createWidget(Control.java:497)\n\tat org.eclipse.swt.widgets.Control.\u003cinit\u003e(Control.java:97)\n\tat org.eclipse.swt.widgets.Label.\u003cinit\u003e(Label.java:89)\n\tat org.eclipse.ui.internal.progress.NewProgressViewer$JobItem.\u003cinit\u003e(NewProgressViewer.java:524)\n\tat org.eclipse.ui.internal.progress.NewProgressViewer.createItem(NewProgressViewer.java:1344)\n\tat org.eclipse.ui.internal.progress.NewProgressViewer.refresh(NewProgressViewer.java:1652)\n\tat org.eclipse.ui.internal.progress.NewProgressViewer.setInput(NewProgressViewer.java:1886)\n\tat org.eclipse.ui.internal.progress.BlockedJobsDialog.showJobDetails(BlockedJobsDialog.java:317)\n\tat org.eclipse.ui.internal.progress.BlockedJobsDialog.createDialogArea(BlockedJobsDialog.java:287)\n\tat org.eclipse.jface.dialogs.IconAndMessageDialog.createDialogAndButtonArea(IconAndMessageDialog.java:199)\n\tat org.eclipse.jface.dialogs.IconAndMessageDialog.createContents(IconAndMessageDialog.java:188)\n\tat org.eclipse.jface.window.Window.create(Window.java:417)\n\tat org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1051)\n\tat org.eclipse.jface.window.Window.open(Window.java:775)\n\tat org.eclipse.ui.internal.progress.BlockedJobsDialog$1.runInUIThread(BlockedJobsDialog.java:224)\n\tat org.eclipse.ui.progress.UIJob$1.run(UIJob.java:93)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3171)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2826)\n\tat org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.runEventLoop(EventLoopProgressMonitor.java:123)\n\tat org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.isCanceled(EventLoopProgressMonitor.java:97)\n\tat org.eclipse.core.internal.jobs.ThreadJob.isCanceled(ThreadJob.java:126)\n\tat org.eclipse.core.internal.jobs.ThreadJob.joinRun(ThreadJob.java:161)\n\tat org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:87)\n\tat org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:217)\n\tat org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:96)\n\tat org.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:1659)\n\tat org.eclipse.core.internal.resources.File.create(File.java:107)\n\tat org.eclipse.jdt.internal.core.JavaProject.setSharedProperty(JavaProject.java:2952)\n\tat org.eclipse.jdt.internal.core.JavaProject.saveClasspath(JavaProject.java:2722)\n\tat org.eclipse.jdt.internal.core.SetClasspathOperation.saveClasspathIfNecessary(SetClasspathOperation.java:610)\n\tat org.eclipse.jdt.internal.core.SetClasspathOperation.executeOperation(SetClasspathOperation.java:257)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:724)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1704)\n\tat org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:788)\n\tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:2892)\n\tat org.eclipse.jdt.internal.core.JavaProject.setRawClasspath(JavaProject.java:2908)\n\tat org.eclipse.jdt.testplugin.JavaProjectHelper.createJavaProject(JavaProjectHelper.java:141)\n\tat org.eclipse.jdt.text.tests.contentassist.JavadocCompletionTest.setUp(JavadocCompletionTest.java:113)\n\tat junit.framework.TestCase.runBare(TestCase.java:125)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:118)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:236)\n\tat junit.framework.TestSuite.run(TestSuite.java:226)\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:236)\n\tat junit.framework.TestSuite.run(TestSuite.java:226)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:236)\n\tat junit.framework.TestSuite.run(TestSuite.java:226)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:478)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:344)\n\tat org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:57)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run(UITestApplication.java:105)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:123)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3171)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2826)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1794)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1758)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:381)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:106)\n\tat org.eclipse.pde.internal.junit.runtime.UITestApplication.run(UITestApplication.java:45)\n\tat org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:109)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:167)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:338)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:282)\n\tat org.eclipse.core.launcher.Main.run(Main.java:977)\n\tat org.eclipse.core.launcher.Main.main(Main.java:952)",
    "I can provide you with the workspace that contains this setup if you need it, just tell me where to put/send it (20MB).",
    "I wanted to nail it down to a specific build but unfortunately all old I- and N-builds are already deleted from the download server.",
    "SN and BB to investigate.",
    "Fixed \u003e 20051125\n\nThanks for entering this bug report.  It turns out that we were explicitly free\u0027ing submenus internally in SWT by calling dispose() prior to M2 and using RemoveMenu() to remove the menu item from the parent.  We changed the way dispose worked to allow the operating system to dispose submenus (the same way we allow the operating system to dispose control children), however, we needed to call DeleteMenu() rather than RemoveMenu() to dispose the root.\n\nGood catch!",
    "Verified using N20051127-0010.",
    "*** Bug 118058 has been marked as a duplicate of this bug. ***",
    "*** Bug 118695 has been marked as a duplicate of this bug. ***",
    "*** Bug 118893 has been marked as a duplicate of this bug. ***",
    "*** Bug 119079 has been marked as a duplicate of this bug. ***"
  ],
  "commentCreationDates": [
    "2005-11-24T17:16:27+01:00",
    "2005-11-24T17:37:48+01:00",
    "2005-11-24T20:42:36+01:00",
    "2005-11-24T22:52:52+01:00",
    "2005-11-25T20:28:32+01:00",
    "2005-11-28T09:15:16+01:00",
    "2005-11-29T01:51:55+01:00",
    "2005-12-01T15:47:24+01:00",
    "2005-12-03T06:20:34+01:00",
    "2005-12-03T06:21:40+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTError",
      "message": "No more handles",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3277"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3174"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:3145"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.error",
          "source": "Widget.java:407"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.createHandle",
          "source": "Control.java:482"
        },
        {
          "method": "org.eclipse.swt.widgets.Label.createHandle",
          "source": "Label.java:170"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.createWidget",
          "source": "Control.java:497"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.\u003cinit\u003e",
          "source": "Control.java:97"
        },
        {
          "method": "org.eclipse.swt.widgets.Label.\u003cinit\u003e",
          "source": "Label.java:89"
        },
        {
          "method": "org.eclipse.ui.internal.progress.NewProgressViewer$JobItem.\u003cinit\u003e",
          "source": "NewProgressViewer.java:524"
        },
        {
          "method": "org.eclipse.ui.internal.progress.NewProgressViewer.createItem",
          "source": "NewProgressViewer.java:1344"
        },
        {
          "method": "org.eclipse.ui.internal.progress.NewProgressViewer.refresh",
          "source": "NewProgressViewer.java:1652"
        },
        {
          "method": "org.eclipse.ui.internal.progress.NewProgressViewer.setInput",
          "source": "NewProgressViewer.java:1886"
        },
        {
          "method": "org.eclipse.ui.internal.progress.BlockedJobsDialog.showJobDetails",
          "source": "BlockedJobsDialog.java:317"
        },
        {
          "method": "org.eclipse.ui.internal.progress.BlockedJobsDialog.createDialogArea",
          "source": "BlockedJobsDialog.java:287"
        },
        {
          "method": "org.eclipse.jface.dialogs.IconAndMessageDialog.createDialogAndButtonArea",
          "source": "IconAndMessageDialog.java:199"
        },
        {
          "method": "org.eclipse.jface.dialogs.IconAndMessageDialog.createContents",
          "source": "IconAndMessageDialog.java:188"
        },
        {
          "method": "org.eclipse.jface.window.Window.create",
          "source": "Window.java:417"
        },
        {
          "method": "org.eclipse.jface.dialogs.Dialog.create",
          "source": "Dialog.java:1051"
        },
        {
          "method": "org.eclipse.jface.window.Window.open",
          "source": "Window.java:775"
        },
        {
          "method": "org.eclipse.ui.internal.progress.BlockedJobsDialog$1.runInUIThread",
          "source": "BlockedJobsDialog.java:224"
        },
        {
          "method": "org.eclipse.ui.progress.UIJob$1.run",
          "source": "UIJob.java:93"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3171"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2826"
        },
        {
          "method": "org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.runEventLoop",
          "source": "EventLoopProgressMonitor.java:123"
        },
        {
          "method": "org.eclipse.ui.internal.dialogs.EventLoopProgressMonitor.isCanceled",
          "source": "EventLoopProgressMonitor.java:97"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.isCanceled",
          "source": "ThreadJob.java:126"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ThreadJob.joinRun",
          "source": "ThreadJob.java:161"
        },
        {
          "method": "org.eclipse.core.internal.jobs.ImplicitJobs.begin",
          "source": "ImplicitJobs.java:87"
        },
        {
          "method": "org.eclipse.core.internal.jobs.JobManager.beginRule",
          "source": "JobManager.java:217"
        },
        {
          "method": "org.eclipse.core.internal.resources.WorkManager.checkIn",
          "source": "WorkManager.java:96"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.prepareOperation",
          "source": "Workspace.java:1659"
        },
        {
          "method": "org.eclipse.core.internal.resources.File.create",
          "source": "File.java:107"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setSharedProperty",
          "source": "JavaProject.java:2952"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.saveClasspath",
          "source": "JavaProject.java:2722"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SetClasspathOperation.saveClasspathIfNecessary",
          "source": "SetClasspathOperation.java:610"
        },
        {
          "method": "org.eclipse.jdt.internal.core.SetClasspathOperation.executeOperation",
          "source": "SetClasspathOperation.java:257"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:724"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1704"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:788"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setRawClasspath",
          "source": "JavaProject.java:2892"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.setRawClasspath",
          "source": "JavaProject.java:2908"
        },
        {
          "method": "org.eclipse.jdt.testplugin.JavaProjectHelper.createJavaProject",
          "source": "JavaProjectHelper.java:141"
        },
        {
          "method": "org.eclipse.jdt.text.tests.contentassist.JavadocCompletionTest.setUp",
          "source": "JavadocCompletionTest.java:113"
        },
        {
          "method": "junit.framework.TestCase.runBare",
          "source": "TestCase.java:125"
        },
        {
          "method": "junit.framework.TestResult$1.protect",
          "source": "TestResult.java:106"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.framework.TestResult.run",
          "source": "TestResult.java:109"
        },
        {
          "method": "junit.framework.TestCase.run",
          "source": "TestCase.java:118"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:236"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:226"
        },
        {
          "method": "junit.extensions.TestDecorator.basicRun",
          "source": "TestDecorator.java:22"
        },
        {
          "method": "junit.extensions.TestSetup$1.protect",
          "source": "TestSetup.java:19"
        },
        {
          "method": "junit.framework.TestResult.runProtected",
          "source": "TestResult.java:124"
        },
        {
          "method": "junit.extensions.TestSetup.run",
          "source": "TestSetup.java:23"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:236"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:226"
        },
        {
          "method": "junit.framework.TestSuite.runTest",
          "source": "TestSuite.java:236"
        },
        {
          "method": "junit.framework.TestSuite.run",
          "source": "TestSuite.java:226"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests",
          "source": "RemoteTestRunner.java:478"
        },
        {
          "method": "org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run",
          "source": "RemoteTestRunner.java:344"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main",
          "source": "RemotePluginTestRunner.java:57"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run",
          "source": "UITestApplication.java:105"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:123"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:3171"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2826"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1794"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1758"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:381"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:106"
        },
        {
          "method": "org.eclipse.pde.internal.junit.runtime.UITestApplication.run",
          "source": "UITestApplication.java:45"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:109"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:92"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:68"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:369"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:167"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:338"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:282"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:977"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:952"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "117928",
      "date": "2005-11-24T17:16:27+01:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "major"
    }
  ],
  "groupId": "117928",
  "bugId": "117928",
  "date": "2005-11-24T17:16:27+01:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "major"
}