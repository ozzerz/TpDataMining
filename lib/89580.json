{
  "comments": [
    "I20050329-2000 (seen on both WinXP and GTK)\n\nThe following steps are about 50% reliable.\n\n- Enable folding\n- Create the two classes below\n- Have all editor closed but \u0027View.java\u0027\n- fold away the header comment\n- Put the caret towards the end of the constructor invocation inside foo\n  (third-last character or so)\n(- dirty View.java - not sure about this one)\n- invoke the \u0027Rename\u0027 refactoring on the label provider, renaming it to \u0027Lort\u0027\n\n-\u003e sometimes, the header comment will unfold\n-\u003e sometimes, the syntax coloring will be lost\n\n----------- View.java -------------\n/************************************************\n * Copyright (c) 2005 IBM Corporation and others.\n *************************************************/\npackage coloring;\n\npublic class View {\n\tvoid foo() {\n\t\tLabelProviderLong lp\u003d new LabelProviderLong();\n\t}\n}\n\n-------------------- LabelProviderLong.java ----------\npackage coloring;\n\npublic class LabelProviderLong {\n}\n------------------------------------------------------",
    "I also got the following exception when editing the CU a little after doing the\noperations described in comment 0. Not sure whether it is related:\n\norg.eclipse.swt.SWTException: Failed to execute runnable\n(java.lang.IllegalArgumentException: Index out of bounds)\n\tat org.eclipse.swt.SWT.error(SWT.java:2860)\n\tat org.eclipse.swt.SWT.error(SWT.java:2783)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:121)\n\tat org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:2755)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2475)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1570)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1534)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:306)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103)\n\tat\norg.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:228)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:338)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:151)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:268)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:260)\n\tat org.eclipse.core.launcher.Main.run(Main.java:887)\n\tat org.eclipse.core.launcher.Main.main(Main.java:871)\nCaused by: java.lang.IllegalArgumentException: Index out of bounds\n\tat org.eclipse.swt.SWT.error(SWT.java:2844)\n\tat org.eclipse.swt.SWT.error(SWT.java:2783)\n\tat org.eclipse.swt.SWT.error(SWT.java:2754)\n\tat org.eclipse.swt.custom.StyledText.replaceStyleRanges(StyledText.java:6309)\n\tat org.eclipse.jface.text.TextViewer.addPresentation(TextViewer.java:4233)\n\tat org.eclipse.jface.text.TextViewer.changeTextPresentation(TextViewer.java:4312)\n\tat\norg.eclipse.jdt.internal.ui.javaeditor.SemanticHighlightingPresenter.updatePresentation(SemanticHighlightingPresenter.java:434)\n\tat\norg.eclipse.jdt.internal.ui.javaeditor.SemanticHighlightingPresenter$1.run(SemanticHighlightingPresenter.java:347)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n\t... 18 more",
    "see also bug 72425",
    "This is a regression - cannot be reproduced with 3.0.2",
    "When setting a breakpoint on BadLocationException, I get into the following\ninteresting stacktrace:\n\nThread [main] (Suspended (exception BadLocationException))\n\tPartiallySynchronizedDocument(AbstractDocument).getPartition(String, int,\nboolean) line: 1288\n\tTextUtilities.getPartition(IDocument, String, int, boolean) line: 395\n\tJavaPresentationReconciler(PresentationReconciler).getPartition(IDocument, int)\nline: 586\n\n\n-- this is interesting - PresentationReconciler.fRememberedPosition is invalid,\nbut still queried.\n\n\tJavaPresentationReconciler(PresentationReconciler).getDamageEndOffset(DocumentEvent)\nline: 542\n\tJavaPresentationReconciler(PresentationReconciler).getDamage(DocumentEvent,\nboolean) line: 497\n\tPresentationReconciler.access$9(PresentationReconciler, DocumentEvent, boolean)\nline: 473\n\tPresentationReconciler$InternalListener.textChanged(TextEvent) line: 212\n\tCompilationUnitEditor$AdaptedSourceViewer(TextViewer).updateTextListeners(TextViewer$WidgetCommand)\nline: 2370\n\tTextViewer$VisibleDocumentListener.documentChanged(DocumentEvent) line: 327\n\tProjectionDocument(AbstractDocument).doFireDocumentChanged2(DocumentEvent)\nline: 714\n\tProjectionDocument(AbstractDocument).doFireDocumentChanged(DocumentEvent,\nboolean, IRegion) line: 677\n\tProjectionDocument(AbstractDocument).doFireDocumentChanged(DocumentEvent) line: 662\n\tProjectionDocument(AbstractDocument).fireDocumentChanged(DocumentEvent) line: 739\n\tProjectionDocument.internalAddMasterDocumentRange(int, int, DocumentEvent)\nline: 329\n\tProjectionDocument.addMasterDocumentRange(int, int, DocumentEvent) line: 549\n\tProjectionDocument.addMasterDocumentRange(int, int) line: 517\n\tCompilationUnitEditor$AdaptedSourceViewer(ProjectionViewer).addMasterDocumentRange(ProjectionDocument,\nint, int) line: 610\n\tCompilationUnitEditor$AdaptedSourceViewer(ProjectionViewer).executeProjectionCommands(ProjectionViewer$ProjectionCommandQueue,\nboolean) line: 991\n\tCompilationUnitEditor$AdaptedSourceViewer(ProjectionViewer).catchupWithProjectionAnnotationModel(AnnotationModelEvent)\nline: 954\n\tCompilationUnitEditor$AdaptedSourceViewer(ProjectionViewer).processCatchupRequest(AnnotationModelEvent)\nline: 818\n\tProjectionViewer$AnnotationModelListener.processModelChanged(IAnnotationModel,\nAnnotationModelEvent) line: 110\n\tProjectionViewer$AnnotationModelListener.modelChanged(AnnotationModelEvent)\nline: 102\n\tAnnotationModel.fireModelChanged(AnnotationModelEvent) line: 452\n\tAnnotationModel$InternalModelListener.modelChanged(AnnotationModelEvent) line: 106\n\tProjectionAnnotationModel(AnnotationModel).fireModelChanged(AnnotationModelEvent)\nline: 452\n\tProjectionAnnotationModel(AnnotationModel).fireModelChanged() line: 418\n\tProjectionAnnotationModel.modifyAnnotations(Annotation[], Map, Annotation[])\nline: 150\n\tDefaultJavaFoldingStructureProvider.processDelta(IJavaElementDelta) line: 808\n\tDefaultJavaFoldingStructureProvider$ElementChangedListener.elementChanged(ElementChangedEvent)\nline: 132\n\tDeltaProcessor$2.run() line: 1426\n\tInternalPlatform.run(ISafeRunnable) line: 1021\n\tPlatform.run(ISafeRunnable) line: 757\n\tDeltaProcessor.notifyListeners(IJavaElementDelta, int,\nIElementChangedListener[], int[], int) line: 1421\n\tDeltaProcessor.firePostChangeDelta(IJavaElementDelta,\nIElementChangedListener[], int[], int) line: 1269\n\tDeltaProcessor.fire(IJavaElementDelta, int) line: 1248\n\tDeltaProcessor.resourceChanged(IResourceChangeEvent) line: 1791\n\tDeltaProcessingState.resourceChanged(IResourceChangeEvent) line: 414\n\tNotificationManager$2.run() line: 276\n\tInternalPlatform.run(ISafeRunnable) line: 1021\n\tPlatform.run(ISafeRunnable) line: 757\n\tNotificationManager.notify(ResourceChangeListenerList$ListenerEntry[],\nIResourceChangeEvent, boolean) line: 270\n\tNotificationManager.broadcastChanges(ElementTree, ResourceChangeEvent, boolean)\nline: 144\n\tWorkspace.broadcastPostChange() line: 180\n\tWorkspace.checkpoint(boolean) line: 243\n\tPerformChangeOperation$1.run(IProgressMonitor) line: 237\n\tWorkspace.run(IWorkspaceRunnable, ISchedulingRule, int, IProgressMonitor) line:\n1714\n\tWorkspace.run(IWorkspaceRunnable, IProgressMonitor) line: 1734\n\tUIPerformChangeOperation(PerformChangeOperation).executeChange(IProgressMonitor)\nline: 280\n\tUIPerformChangeOperation.access$1(UIPerformChangeOperation, IProgressMonitor)\nline: 1\n\tUIPerformChangeOperation$1.run() line: 60\n\tRunnableLock.run() line: 35\n\tUISynchronizer(Synchronizer).runAsyncMessages(boolean) line: 118\n\tDisplay.runAsyncMessages(boolean) line: 2755\n\tDisplay.readAndDispatch() line: 2475\n\tModalContext$ModalContextThread.block() line: 153\n\tModalContext.run(IRunnableWithProgress, boolean, IProgressMonitor, Display)\nline: 303\n\tRefactoringWizardDialog2.run(boolean, boolean, IRunnableWithProgress) line: 282\n\tRenameTypeWizard(RefactoringWizard).internalPerformFinish(InternalAPI,\nPerformChangeOperation) line: 544\n\tRenameRefactoringWizard$1(UserInputWizardPage).performFinish() line: 153\n\tRenameTypeWizard(RefactoringWizard).performFinish() line: 610\n\tRefactoringWizardDialog2.okPressed() line: 406\n\tRefactoringWizardDialog2(Dialog).buttonPressed(int) line: 409\n\tDialog$2.widgetSelected(SelectionEvent) line: 556\n\tTypedListener.handleEvent(Event) line: 89\n\tEventTable.sendEvent(Event) line: 82\n\tButton(Widget).sendEvent(Event) line: 1012\n\tDisplay.runDeferredEvents() line: 2778\n\tDisplay.readAndDispatch() line: 2472\n\tRefactoringWizardDialog2(Window).runEventLoop(Shell) line: 803\n\tRefactoringWizardDialog2(Window).open() line: 781\n\tRefactoringWizardOpenOperation$1.run() line: 125\n\tBusyIndicator.showWhile(Display, Runnable) line: 69\n\tRefactoringWizardOpenOperation.run(Shell, String) line: 138\n\tRefactoringStarter.activate(Refactoring, RefactoringWizard, Shell, String,\nboolean) line: 40\n\tRenameUserInterfaceStarter(UserInterfaceStarter).activate(Refactoring, Shell,\nboolean) line: 56\n\tRenameUserInterfaceStarter.activate(Refactoring, Shell, boolean) line: 113\n\tRenameSupport.openDialog(Shell) line: 114\n\tRenameJavaElementAction.run(IJavaElement, RenameSupport) line: 180\n\tRenameJavaElementAction.run(ITextSelection) line: 133\n\tRenameAction.run(ITextSelection) line: 116\n\tRenameAction(SelectionDispatchAction).dispatchRun(ISelection) line: 216\n\tRenameAction(SelectionDispatchAction).run() line: 188\n\tRenameAction(Action).runWithEvent(Event) line: 996\n\tActionHandler.execute(Map) line: 182\n\tLegacyHandlerWrapper.execute(ExecutionEvent) line: 108\n\tCommand.execute(ExecutionEvent) line: 331\n\tParameterizedCommand.execute(Object, Object) line: 396\n\tWorkbenchKeyboard.executeCommand(Binding, Object) line: 452\n\tWorkbenchKeyboard.press(List, Event) line: 741\n\tWorkbenchKeyboard.processKeyEvent(List, Event) line: 784\n\tWorkbenchKeyboard.filterKeySequenceBindings(Event) line: 543\n\tWorkbenchKeyboard.access$3(WorkbenchKeyboard, Event) line: 486\n\tWorkbenchKeyboard$KeyDownFilter.handleEvent(Event) line: 110\n\tEventTable.sendEvent(Event) line: 82\n\tDisplay.filterEvent(Event) line: 1125\n\tStyledText(Widget).sendEvent(Event) line: 1011\n\tStyledText(Widget).sendEvent(int, Event, boolean) line: 1036\n\tStyledText(Widget).sendEvent(int, Event) line: 1021\n\tStyledText(Widget).sendKeyEvent(int, GdkEventKey) line: 1048\n\tStyledText(Widget).gtk_key_press_event(int, int) line: 612\n\tStyledText(Control).gtk_key_press_event(int, int) line: 1960\n\tStyledText(Composite).gtk_key_press_event(int, int) line: 555\n\tStyledText(Widget).windowProc(int, int, int) line: 1348\n\tDisplay.windowProc(int, int, int) line: 3338\n\tOS._gtk_main_do_event(int) line: not available [native method]\n\tOS.gtk_main_do_event(int) line: 4703\n\tDisplay.eventProc(int, int) line: 942\n\tOS._g_main_context_iteration(int, boolean) line: not available [native method]\n\tOS.g_main_context_iteration(int, boolean) line: 1129\n\tDisplay.readAndDispatch() line: 2470\n\tWorkbench.runEventLoop(Window$IExceptionHandler, Display) line: 1570\n\tWorkbench.runUI() line: 1534\n\tWorkbench.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 306\n\tPlatformUI.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 143\n\tIDEApplication.run(Object) line: 103\n\tPlatformActivator$1.run(Object) line: 228\n\tEclipseStarter.run(Object) line: 338\n\tEclipseStarter.run(String[], Runnable) line: 151\n\tNativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available\n[native method]\n\tNativeMethodAccessorImpl.invoke(Object, Object[]) line: 39\n\tDelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 25\n\tMethod.invoke(Object, Object.............................................)\nline: 585\n\tMain.invokeFramework(String[], URL[]) line: 268\n\tMain.basicRun(String[]) line: 260\n\tMain.run(String[]) line: 887\n\tMain.main(String[]) line: 871\n",
    "*** Bug 90368 has been marked as a duplicate of this bug. ***",
    "\n\n*** This bug has been marked as a duplicate of 78385 ***"
  ],
  "commentCreationDates": [
    "2005-03-30T17:15:01+02:00",
    "2005-03-30T17:16:06+02:00",
    "2005-03-30T18:12:12+02:00",
    "2005-03-30T18:12:49+02:00",
    "2005-03-31T08:53:20+02:00",
    "2005-04-06T14:14:04+02:00",
    "2005-06-05T13:34:20+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalArgumentException",
      "message": "Index out of bounds)",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2860"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:2783"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:121"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runAsyncMessages",
          "source": "Display.java:2755"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:2475"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1570"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1534"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:306"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:103"
        },
        {
          "method": "org.eclipse.core.internal.runtime.PlatformActivator$1.run",
          "source": "PlatformActivator.java:228"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:338"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:151"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:585"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:268"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:260"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:887"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:871"
        }
      ],
      "causedBy": {
        "exceptionType": "java.lang.IllegalArgumentException",
        "message": "Index out of bounds",
        "elements": [
          {
            "method": "org.eclipse.swt.SWT.error",
            "source": "SWT.java:2844"
          },
          {
            "method": "org.eclipse.swt.SWT.error",
            "source": "SWT.java:2783"
          },
          {
            "method": "org.eclipse.swt.SWT.error",
            "source": "SWT.java:2754"
          },
          {
            "method": "org.eclipse.swt.custom.StyledText.replaceStyleRanges",
            "source": "StyledText.java:6309"
          },
          {
            "method": "org.eclipse.jface.text.TextViewer.addPresentation",
            "source": "TextViewer.java:4233"
          },
          {
            "method": "org.eclipse.jface.text.TextViewer.changeTextPresentation",
            "source": "TextViewer.java:4312"
          },
          {
            "method": "org.eclipse.jdt.internal.ui.javaeditor.SemanticHighlightingPresenter.updatePresentation",
            "source": "SemanticHighlightingPresenter.java:434"
          },
          {
            "method": "org.eclipse.jdt.internal.ui.javaeditor.SemanticHighlightingPresenter$1.run",
            "source": "SemanticHighlightingPresenter.java:347"
          },
          {
            "method": "org.eclipse.swt.widgets.RunnableLock.run",
            "source": "RunnableLock.java:35"
          },
          {
            "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
            "source": "Synchronizer.java:118"
          }
        ],
        "number": 0,
        "commentIndex": 0
      },
      "number": 0,
      "commentIndex": 1,
      "bugId": "89580",
      "duplicateId": "78385",
      "date": "2005-03-30T17:16:06+02:00",
      "product": "JDT",
      "component": "Text",
      "severity": "normal"
    }
  ],
  "groupId": "78385",
  "bugId": "89580",
  "duplicateId": "78385",
  "date": "2005-03-30T17:15:01+02:00",
  "product": "JDT",
  "component": "Text",
  "severity": "normal"
}