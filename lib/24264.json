{
  "comments": [
    "build 200209230010\n\nWhile playing with the ControlExample in org.eclipse.swt.examples a NPE was \nthrown. I can not reproduce this and do not remeber what I did exactly. \nBasically I changed the style of a text part to bold and changed the size.\nPerhaps the stacktrace is useful anyway.\n\njava.lang.ArrayIndexOutOfBoundsException\n\tat org.eclipse.swt.custom.WrappedContent.getLine(WrappedContent.java:94)\n\tat org.eclipse.swt.custom.StyledText.wordWrapResize\n(StyledText.java:7666)\n\tat org.eclipse.swt.custom.StyledText.handleResize(StyledText.java:4946)\n\tat org.eclipse.swt.custom.StyledText$15.handleEvent\n(StyledText.java:4582)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:77)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:849)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:854)\n\tat org.eclipse.swt.widgets.Control.WM_SIZE(Control.java:3881)\n\tat org.eclipse.swt.widgets.Scrollable.WM_SIZE(Scrollable.java:300)\n\tat org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:759)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:2747)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:2104)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:1274)\n\tat org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:73)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:2759)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:2104)\n\tat org.eclipse.swt.internal.win32.OS.SetWindowPos(Native Method)\n\tat org.eclipse.swt.widgets.Control.setBounds(Control.java:1767)\n\tat org.eclipse.swt.widgets.Control.setBounds(Control.java:1739)\n\tat org.eclipse.swt.layout.GridLayout.layout(GridLayout.java:683)\n\tat org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:768)\n\tat org.eclipse.swt.widgets.Group.WM_SIZE(Group.java:359)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:2747)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:2104)\n\tat org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:1212)\n\tat org.eclipse.swt.widgets.Group.callWindowProc(Group.java:125)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:2759)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:2104)\n\tat org.eclipse.swt.internal.win32.OS.EndDeferWindowPos(Native Method)\n\tat org.eclipse.swt.widgets.Composite.resizeChildren(Composite.java:355)\n\tat org.eclipse.swt.widgets.Composite.resizeChildren(Composite.java:321)\n\tat org.eclipse.swt.widgets.Composite.setResizeChildren\n(Composite.java:441)\n\tat org.eclipse.swt.widgets.Composite.layout(Composite.java:294)\n\tat org.eclipse.swt.widgets.Composite.layout(Composite.java:269)\n\tat org.eclipse.swt.examples.controlexample.Tab.setExampleWidgetSize\n(Tab.java:486)\n\tat org.eclipse.swt.examples.controlexample.Tab$8.widgetSelected\n(Tab.java:291)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent\n(TypedListener.java:87)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:77)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:833)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1622)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1368)\n\tat org.eclipse.swt.examples.controlexample.ControlExample.main\n(ControlExample.java:103)\nException in thread \"main\"",
    "Can\u0027t reproduce this one yet but did get a similar walkback while playing with \nbold \u0026 size in the ControlExample. See bug 24372.",
    "Steps to reproduce this ArrayIndexOutOfBoundsException:\n-Go to the text tab of the ControlExample\n-Enable SWT.WRAP style\n-Set size to 50x50\n-Scroll StyledText widget all the way down\n-Select the last character (\u0027e\u0027 in \"Three\")\n-Set size to 100x100\n-\u003eArrayIndexOutOfBoundsException in WrappedContent.getLine",
    "The problem is that StyledText.wordWrapResize assumes that the content has not \nbeen wrapped to the new size yet. It queries the text of the old caret line. \nThe old caret line is no longer valid because lines have already been wrapped \nin computeSize (fix for bug 20377). \ncomputeSize is called before handleResize/wordWrapResize as part of relayout \nwhen the widgets size changes. The plain text widget above StyledText is sized \nfirst which causes a relayout of both text widgets. Only then is the StyledText \nwidget sized at which point the exception occurs.",
    "There is actually a larger problem related to mainting the caret line separate \nfrom the caret offset. The two can get out of sync anywhere were the line \nwrapping changes. We handle this in most but not all cases. We may want to \nrevisit whether we can do away with the caretLine. Opened bug 24426 for this.\nIndependent of what happens with the caretLine field, we still need to address \nupdating the top line in wordWrapResize which is the main purpose of the method.",
    "Created an attachment (id\u003d2183)\nfixed StyledText\n",
    "Created an attachment (id\u003d2184)\nfixed WrappedContent\n",
    "The attached StyledText.java fixes the top line problem. The fix is on top of \nthe one attached to bug 24426 with a minor change in showCaret(int) in addition \nto the top line changes.\nWrappedContent now notifies StyledText when the content has been wrapped. \nStyledText then compares the line index at the top offset (the offset of the \nbeginning of the top line) to the top index and adjusts the top index when \nnecessary. Wrap notification does not take place on text changes since text \nchanges should not affect top index.\nwordWrapResize only rewraps now.\nTo be released after M2.\nLynne, please review. \n",
    "StyledText.handleResize should be changed to call calculateTopIndex at the very \nend. Relevant new code snippet is as follows:\n\n\tsetScrollBars();\n\tclaimBottomFreeSpace();\n\tclaimRightFreeSpace();\t\n\tif (oldHeight !\u003d clientAreaHeight) {\n\t\tcalculateTopIndex();\n\t}\n",
    "Created an attachment (id\u003d2211)\nFix, merged with HEAD stream as of 20021016\n",
    "The attached fix replaces the StyledText/WrappedContent fix combo. \nWrappedContent now remains as released in HEAD.\nStyledText now calls setCaretLocation during resize and computeSize. It does \nnot update the caret location during a redraw because StyledText does redraws \nduring text changes internally. In that case the caret offset may not be in \nsync with the text change and setCaretLocation must not be called. This issue \ncould be worked around but will be addressed by a separate PR. It is not \nspecific to wordwrap.",
    "bug 25008 tracks caret location updates on style changes.",
    "Attachment 2211 exposes a bug in calculateTopIndex. \nOne scenario to reproduce is to resize the Eclipse console so that the text \nwidget height is 0 and run a program that prints to the console.\nThe other scenario is described in bug 15088. The fix for bug 15088 was \nincomplete and omitted the failing scenario, a widget with height \u003d\u003d 0.\n",
    "Created an attachment (id\u003d2245)\nStack trace for the calculateTopIndex problem described above and in bug 15088.\n",
    "Created an attachment (id\u003d2246)\nNew fix for this bug with fix for calculateTopIndex problem\n",
    "Released a fix that differs slightly from the last attachment. The fix to \ncalculateTopIndex was wrong.\nIn addition, the setTopIndex API spec changed as outline in a posting to the \nplatform-swt-dev mailing list.\nFixed in build \u003e 20021025"
  ],
  "commentCreationDates": [
    "2002-10-01T15:46:25+02:00",
    "2002-10-04T02:18:45+02:00",
    "2002-10-04T02:45:57+02:00",
    "2002-10-04T03:16:54+02:00",
    "2002-10-05T00:27:31+02:00",
    "2002-10-15T20:47:25+02:00",
    "2002-10-15T20:47:40+02:00",
    "2002-10-15T21:01:10+02:00",
    "2002-10-16T17:46:27+02:00",
    "2002-10-17T19:51:48+02:00",
    "2002-10-17T20:01:42+02:00",
    "2002-10-17T20:15:25+02:00",
    "2002-10-22T00:08:36+02:00",
    "2002-10-22T00:09:34+02:00",
    "2002-10-22T00:15:04+02:00",
    "2002-10-25T18:37:28+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ArrayIndexOutOfBoundsException",
      "elements": [
        {
          "method": "org.eclipse.swt.custom.WrappedContent.getLine",
          "source": "WrappedContent.java:94"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.wordWrapResize",
          "source": "StyledText.java:7666"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText.handleResize",
          "source": "StyledText.java:4946"
        },
        {
          "method": "org.eclipse.swt.custom.StyledText$15.handleEvent",
          "source": "StyledText.java:4582"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:849"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:854"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_SIZE",
          "source": "Control.java:3881"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.WM_SIZE",
          "source": "Scrollable.java:300"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_SIZE",
          "source": "Composite.java:759"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2747"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:2104"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:1274"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java:73"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2759"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:2104"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.SetWindowPos",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setBounds",
          "source": "Control.java:1767"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setBounds",
          "source": "Control.java:1739"
        },
        {
          "method": "org.eclipse.swt.layout.GridLayout.layout",
          "source": "GridLayout.java:683"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_SIZE",
          "source": "Composite.java:768"
        },
        {
          "method": "org.eclipse.swt.widgets.Group.WM_SIZE",
          "source": "Group.java:359"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2747"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:2104"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.CallWindowProc",
          "source": "OS.java:1212"
        },
        {
          "method": "org.eclipse.swt.widgets.Group.callWindowProc",
          "source": "Group.java:125"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2759"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:2104"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.EndDeferWindowPos",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.resizeChildren",
          "source": "Composite.java:355"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.resizeChildren",
          "source": "Composite.java:321"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.setResizeChildren",
          "source": "Composite.java:441"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.layout",
          "source": "Composite.java:294"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.layout",
          "source": "Composite.java:269"
        },
        {
          "method": "org.eclipse.swt.examples.controlexample.Tab.setExampleWidgetSize",
          "source": "Tab.java:486"
        },
        {
          "method": "org.eclipse.swt.examples.controlexample.Tab$8.widgetSelected",
          "source": "Tab.java:291"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:87"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:77"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:833"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1622"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1368"
        },
        {
          "method": "org.eclipse.swt.examples.controlexample.ControlExample.main",
          "source": "ControlExample.java:103"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "24264",
      "date": "2002-10-01T15:46:25+02:00",
      "product": "Platform",
      "component": "SWT",
      "severity": "normal"
    }
  ],
  "groupId": "24264",
  "bugId": "24264",
  "date": "2002-10-01T15:46:25+02:00",
  "product": "Platform",
  "component": "SWT",
  "severity": "normal"
}