{
  "comments": [
    "When closing an editor whose input is an IStorageEditorInput, there is an\nassertion failure in ModelManagerImpl.releaseFromEdit() and an error dialog is\ndisplayed (the message simply says \"Error\").  The problem seems to be that when\nthe editor is closed, releaseFromEdit() gets called twice.  I have included\nbelow the stack trace from the log file and the two stack traces showing\nreleaseFromEdit() being called twice.  This is causing a problem for the\ndebugger because it reuses the same editor as the user clicks on different stack\nframes (the input just gets reset), after the failure happens the source for the\ndebugger will no longer display.\n\nSTACK TRACE FROM LOG:\n\nCaused by: org.eclipse.wst.sse.core.internal.util.Assert$AssertionFailedException\n\tat org.eclipse.wst.sse.core.internal.util.Assert.isNotNull(Assert.java:125)\n\tat org.eclipse.wst.sse.core.internal.util.Assert.isNotNull(Assert.java:107)\n\tat\norg.eclipse.wst.sse.core.internal.model.ModelManagerImpl.releaseFromEdit(ModelManagerImpl.java:1402)\n\tat\norg.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.releaseFromEdit(AbstractStructuredModel.java:1028)\n\tat\norg.eclipse.wst.xml.core.internal.document.DOMModelImpl.releaseFromEdit(DOMModelImpl.java:802)\n\tat\norg.eclipse.wst.sse.ui.internal.StructuredTextEditor.doSetInput(StructuredTextEditor.java:1167)\n\tat\norg.eclipse.ui.texteditor.AbstractTextEditor.setInput(AbstractTextEditor.java:3019)\n\tat\norg.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.openEditor(SourceLookupFacility.java:282)\n\tat\norg.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.display(SourceLookupFacility.java:209)\n\tat org.eclipse.debug.ui.DebugUITools.displaySource(DebugUITools.java:673)\n\tat\norg.eclipse.debug.internal.ui.views.launch.LaunchView$SourceDisplayJob.runInUIThread(LaunchView.java:204)\n\tat org.eclipse.ui.progress.UIJob$1.run(UIJob.java:93)\n\tat org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n\tat org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:118)\n\t... 30 more\n\nSTACK TRACE OF FIRST CALL TO \"releaseFromEdit\":\n\nThread [main] (Suspended (breakpoint at line 1401 in ModelManagerImpl))\n\towns: ModelManagerImpl  (id\u003d205)\n\towns: RunnableLock  (id\u003d688)\n\tModelManagerImpl.releaseFromEdit(Object) line: 1401\n\tDOMModelImpl(AbstractStructuredModel).releaseFromEdit() line: 1028\n\tDOMModelImpl.releaseFromEdit() line: 802\n\tStructuredTextEditorXML(StructuredTextEditor).doSetInput(IEditorInput) line: 1167\n\tStructuredTextEditorXML(AbstractTextEditor).setInput(IEditorInput) line: 3019\n\tSourceLookupFacility.openEditor(ISourceLookupResult, IWorkbenchPage) line: 282\n\tSourceLookupFacility.display(ISourceLookupResult, IWorkbenchPage) line: 209\n\tDebugUITools.displaySource(ISourceLookupResult, IWorkbenchPage) line: 673\n\tLaunchView$SourceDisplayJob.runInUIThread(IProgressMonitor) line: 204\n\tUIJob$1.run() line: 93\n\tRunnableLock.run() line: 35\n\tUISynchronizer(Synchronizer).runAsyncMessages(boolean) line: 118\n\tDisplay.runAsyncMessages(boolean) line: 2871\n\tDisplay.readAndDispatch() line: 2530\n\tWorkbench.runEventLoop(Window$IExceptionHandler, Display) line: 1570\n\tWorkbench.runUI() line: 1534\n\tWorkbench.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 306\n\tPlatformUI.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 143\n\tIDEApplication.run(Object) line: 103\n\tPlatformActivator$1.run(Object) line: 228\n\tEclipseStarter.run(Object) line: 344\n\tEclipseStarter.run(String[], Runnable) line: 156\n\tNativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available\n[native method]\n\tNativeMethodAccessorImpl.invoke(Object, Object[]) line: 85\n\tNativeMethodAccessorImpl.invoke(Method, Object, Object[]) line: 58\n\tDelegatingMethodAccessorImpl.invoke(Method, Object, Object[]) line: 60\n\tMethod.invoke(Object, Object[]) line: 391\n\tMain.invokeFramework(String[], URL[]) line: 315\n\tMain.basicRun(String[]) line: 268\n\tMain.run(String[]) line: 942\n\tMain.main(String[]) line: 926\n\nSTACK TRACE OF SECOND CALL TO \"releaseFromEdit\":\n\nThread [main] (Suspended (breakpoint at line 1401 in ModelManagerImpl))\n\towns: ModelManagerImpl  (id\u003d205)\n\towns: RunnableLock  (id\u003d688)\n\tModelManagerImpl.releaseFromEdit(Object) line: 1401\n\tDOMModelImpl(AbstractStructuredModel).releaseFromEdit() line: 1028\n\tDOMModelImpl.releaseFromEdit() line: 802\n\tStorageModelProvider.disposeModelInfo(StorageModelProvider$ModelInfo) line: 516\n\tStorageModelProvider.disposeElementInfo(Object,\nAbstractDocumentProvider$ElementInfo) line: 486\n\tStorageModelProvider(AbstractDocumentProvider).disconnect(Object) line: 435\n\tStructuredTextEditorXML(AbstractTextEditor).doSetInput(IEditorInput) line: 2981\n\tStructuredTextEditorXML(StatusTextEditor).doSetInput(IEditorInput) line: 173\n\tStructuredTextEditorXML(AbstractDecoratedTextEditor).doSetInput(IEditorInput)\nline: 1253\n\tStructuredTextEditorXML(TextEditor).doSetInput(IEditorInput) line: 262\n\tStructuredTextEditorXML(StructuredTextEditor).doSetInput(IEditorInput) line: 1170\n\tStructuredTextEditorXML(AbstractTextEditor).setInput(IEditorInput) line: 3019\n\tSourceLookupFacility.openEditor(ISourceLookupResult, IWorkbenchPage) line: 282\n\tSourceLookupFacility.display(ISourceLookupResult, IWorkbenchPage) line: 209\n\tDebugUITools.displaySource(ISourceLookupResult, IWorkbenchPage) line: 673\n\tLaunchView$SourceDisplayJob.runInUIThread(IProgressMonitor) line: 204\n\tUIJob$1.run() line: 93\n\tRunnableLock.run() line: 35\n\tUISynchronizer(Synchronizer).runAsyncMessages(boolean) line: 118\n\tDisplay.runAsyncMessages(boolean) line: 2871\n\tDisplay.readAndDispatch() line: 2530\n\tWorkbench.runEventLoop(Window$IExceptionHandler, Display) line: 1570\n\tWorkbench.runUI() line: 1534\n\tWorkbench.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 306\n\tPlatformUI.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 143\n\tIDEApplication.run(Object) line: 103\n\tPlatformActivator$1.run(Object) line: 228\n\tEclipseStarter.run(Object) line: 344\n\tEclipseStarter.run(String[], Runnable) line: 156\n\tNativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available\n[native method]\n\tNativeMethodAccessorImpl.invoke(Object, Object[]) line: 85\n\tNativeMethodAccessorImpl.invoke(Method, Object, Object[]) line: 58\n\tDelegatingMethodAccessorImpl.invoke(Method, Object, Object[]) line: 60\n\tMethod.invoke(Object, Object[]) line: 391\n\tMain.invokeFramework(String[], URL[]) line: 315\n\tMain.basicRun(String[]) line: 268\n\tMain.run(String[]) line: 942\n\tMain.main(String[]) line: 926",
    "Correct, the release should not be called when an IModelProvider is in use.  For\na non-IModelProvider, the releaseFromEdit pairs with a getModelForEdit on the\ndocument.  IModelProviders require nothing more than the usual IDocumentProvider\nconnect/disconnect--they do the get/release themselves.",
    "Fixed in HEAD.  StructuredTextEditor will only release when the current document\nprovider is not an IModelProvider.\n\nAlso added support for reusing editors to the\norg.eclipse.wst.sse.ui.tests.ExtendedStorageEditorInputView testing view.  ",
    "Changed Version field given new release numbering.\n",
    "Marking as verified as I know this issue is fixed (or correctly categorized).\nIf, as originator, you disagree or still see, please re-open, or open a new bug. \n\nThanks very much for reporting and helping make WTP better. \n",
    "Closing"
  ],
  "commentCreationDates": [
    "2005-05-25T23:04:18+02:00",
    "2005-05-27T11:21:02+02:00",
    "2005-05-27T11:29:26+02:00",
    "2005-06-15T07:33:13+02:00",
    "2005-07-25T17:46:10+02:00",
    "2005-08-26T11:56:52+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.wst.sse.core.internal.util.Assert$AssertionFailedException",
      "elements": [
        {
          "method": "org.eclipse.wst.sse.core.internal.util.Assert.isNotNull",
          "source": "Assert.java:125"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.util.Assert.isNotNull",
          "source": "Assert.java:107"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.releaseFromEdit",
          "source": "ModelManagerImpl.java:1402"
        },
        {
          "method": "org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.releaseFromEdit",
          "source": "AbstractStructuredModel.java:1028"
        },
        {
          "method": "org.eclipse.wst.xml.core.internal.document.DOMModelImpl.releaseFromEdit",
          "source": "DOMModelImpl.java:802"
        },
        {
          "method": "org.eclipse.wst.sse.ui.internal.StructuredTextEditor.doSetInput",
          "source": "StructuredTextEditor.java:1167"
        },
        {
          "method": "org.eclipse.ui.texteditor.AbstractTextEditor.setInput",
          "source": "AbstractTextEditor.java:3019"
        },
        {
          "method": "org.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.openEditor",
          "source": "SourceLookupFacility.java:282"
        },
        {
          "method": "org.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.display",
          "source": "SourceLookupFacility.java:209"
        },
        {
          "method": "org.eclipse.debug.ui.DebugUITools.displaySource",
          "source": "DebugUITools.java:673"
        },
        {
          "method": "org.eclipse.debug.internal.ui.views.launch.LaunchView$SourceDisplayJob.runInUIThread",
          "source": "LaunchView.java:204"
        },
        {
          "method": "org.eclipse.ui.progress.UIJob$1.run",
          "source": "UIJob.java:93"
        },
        {
          "method": "org.eclipse.swt.widgets.RunnableLock.run",
          "source": "RunnableLock.java:35"
        },
        {
          "method": "org.eclipse.swt.widgets.Synchronizer.runAsyncMessages",
          "source": "Synchronizer.java:118"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "96705",
      "date": "2005-05-25T23:04:18+02:00",
      "product": "Web Tools",
      "component": "wst.sse",
      "severity": "normal"
    }
  ],
  "groupId": "96705",
  "bugId": "96705",
  "date": "2005-05-25T23:04:18+02:00",
  "product": "Web Tools",
  "component": "wst.sse",
  "severity": "normal"
}