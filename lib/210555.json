{
  "comments": [
    "Connect to remote SSH Only host.\nSelect a file, right-click \u003e delete\n--\u003e Delete fails due to an NPE in AbstractFileService.deleteBatch()\n\nThe problem is that in the course of changes for TM 3.0, deleteBatch() was changed and now includes this code:\n    SystemMessage msg \u003d getMessage(\"RSEF1315\");   //$NON-NLS-1$\n\nbut the default implementation of getMessage() just returns null, so this code is bound to fail.\n\nI think the right solution is to add the following method to IFileService and AbstractFileService:\n    setMessageProvider(IMessageProvider m)\nand have this method called right after creating the service. Store the provider in AbstractFileService just like for Local. Same should be done for the Process service -- see also bug 199871 where this came up originally for Local.\n\nThis change is backward compatible because IFileService class Javadoc says that clients must extend AbstractFileService rather than implementing IFileService directly.\n\n\n-----------Enter bugs above this line-----------\nTM 3.0M3 Testing\ninstallation : eclipse-SDK-3.4M3-win32, cdt-5.0.0M3, emf-sdo-xsd-2.4.0M3\n     Download RSE-I20071108-0100: RSE-SDK,tests,discovery,terminal,remotecdt\njava.runtime : Sun 1.5.0_11-b03, mixed mode\nos.name:     : Windows XP 5.1, Service Pack 1\n------------------------------------------------\nsystemtype   : SSH Only\ntargetos1    : Linux RHEL4, Sun 1.5.0_11\n------------------------------------------------",
    "Here is the NPE for reference:\n\njava.lang.NullPointerException\n\tat org.eclipse.rse.services.files.AbstractFileService.deleteBatch(AbstractFileService.java:134)\n\tat org.eclipse.rse.subsystems.files.core.servicesubsystem.FileServiceSubSystem.deleteBatch(FileServiceSubSystem.java:831)\n\tat org.eclipse.rse.internal.files.ui.view.SystemViewRemoteFileAdapter.doDeleteBatch(SystemViewRemoteFileAdapter.java:2556)\n\tat org.eclipse.rse.internal.ui.actions.SystemCommonDeleteAction$DeleteJob.run(SystemCommonDeleteAction.java:148)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)",
    "Xuan, I see that you added the getMessage(\"RSEF1315\") call in when you worked on bug 160775.  Looking at the IBM RSE code, we used to call getPluginMessage(ISystemMessages.FILEMSG_DELETING) so I can see you were attempting to port that.  I think, for this defect, we need to get rid of this getMessage() call so that we don\u0027t have a major bug on our hands.\n\nRegarding the IMessageProvider idea, I think we\u0027re looking at an enhancement along with some more refactoring that ought to be carried out via a different defect.  If we tried to fix this defect by introducing the suggested approach, there are a number of issues we would face.\n\nThe message required here is stored in systemmessages.xml which is part of the rse.ui plugin.  Rse.ui is certainly not the right place to be storing file-specific messages so we would need to consider dividing up these messages to go in the appropriate plugins.  We could still get the job done, without dividing up the messages, however, that leaves stuck with a service that uses message ids for messages that are defined outside of the service\u0027s plugin and it\u0027s dependencies.  \n\nAs an aside, the use of SystemMessage versus other types of messages is still, in my mind, a bit questionable - at some point, are we going to  try to change to a more standard message format?\n   ",
    "To fix this particular problem (NPE), I think we probably need to provide the deleteBatch() method in LocalFileService to override the default implementation of deleteBatch() in AbstractFileService. \nWe may need to open a separate bug to discuss the message processing change mentioned in this bug.",
    "I\u0027ve always wanted to get rid of SystemMessages since nobody in Open Source really understands them. A separate bug for this task seems a good idea.\n\nIn the short term, I need this NPE regression fixed soon, best for the next I-build. The suggestion outlined in the bug description seemed a proper short-term workaround for me.",
    "Created an attachment (id\u003d83866)\nFix for the NPE\n\n",
    "I\u0027ve committed the changes to cvs.",
    "Bug #211067 has been opened for message retrieving enhancement."
  ],
  "commentCreationDates": [
    "2007-11-21T17:23:30+01:00",
    "2007-11-21T17:24:39+01:00",
    "2007-11-26T18:15:13+01:00",
    "2007-11-26T22:11:21+01:00",
    "2007-11-27T12:20:53+01:00",
    "2007-11-27T15:03:53+01:00",
    "2007-11-27T15:04:57+01:00",
    "2007-11-27T15:12:35+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.rse.services.files.AbstractFileService.deleteBatch",
          "source": "AbstractFileService.java:134"
        },
        {
          "method": "org.eclipse.rse.subsystems.files.core.servicesubsystem.FileServiceSubSystem.deleteBatch",
          "source": "FileServiceSubSystem.java:831"
        },
        {
          "method": "org.eclipse.rse.internal.files.ui.view.SystemViewRemoteFileAdapter.doDeleteBatch",
          "source": "SystemViewRemoteFileAdapter.java:2556"
        },
        {
          "method": "org.eclipse.rse.internal.ui.actions.SystemCommonDeleteAction$DeleteJob.run",
          "source": "SystemCommonDeleteAction.java:148"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:55"
        }
      ],
      "number": 0,
      "commentIndex": 1,
      "bugId": "210555",
      "date": "2007-11-21T17:24:39+01:00",
      "product": "Target Management",
      "component": "RSE",
      "severity": "major"
    }
  ],
  "groupId": "210555",
  "bugId": "210555",
  "date": "2007-11-21T17:23:30+01:00",
  "product": "Target Management",
  "component": "RSE",
  "severity": "major"
}