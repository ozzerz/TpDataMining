{
  "comments": [
    "Ran into the following NPE:\n\njava.lang.NullPointerException\n    at org.eclipse.jdt.internal.core.DeltaProcessingState.addElementChangedListener(DeltaProcessingState.java:171)\n    at org.eclipse.jdt.core.JavaCore.addElementChangedListener(JavaCore.java:1087)\n    at org.eclipse.jem.internal.adapters.jdom.JavaModelListener.\u003cinit\u003e(JavaModelListener.java:38)\n    at org.eclipse.jem.internal.adapters.jdom.JavaModelListener.\u003cinit\u003e(JavaModelListener.java:34)\n    at org.eclipse.jem.internal.adapters.jdom.JavaReflectionSynchronizer.\u003cinit\u003e(JavaReflectionSynchronizer.java:45)\n    at org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.initializeSynchronizer(JavaJDOMAdapterFactory.java:191)\n    at org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.setJavaProject(JavaJDOMAdapterFactory.java:231)\n    at org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.\u003cinit\u003e(JavaJDOMAdapterFactory.java:45)\n    at org.eclipse.jem.internal.plugin.JavaEMFNature.addJavaReflectionAdapterFactories(JavaEMFNature.java:177)\n    at org.eclipse.jem.internal.plugin.JavaEMFNature.addAdapterFactories(JavaEMFNature.java:165)\n    at org.eclipse.jem.internal.plugin.JavaEMFNature.primaryContributeToContext(JavaEMFNature.java:141)\n    at org.eclipse.jem.internal.util.emf.workbench.EMFWorkbenchContextFactory.initializeEMFContextFromContributors(EMFWorkbenchContextFactory.java:127)\n    at org.eclipse.jem.internal.util.emf.workbench.EMFWorkbenchContextFactory.createEMFContext(EMFWorkbenchContextFactory.java:110)\n    at org.eclipse.jem.util.emf.workbench.WorkbenchResourceHelperBase.createEMFContext(WorkbenchResourceHelperBase.java:222)\n    at org.eclipse.jem.util.emf.workbench.nature.EMFNature.createEmfContext(EMFNature.java:105)\n    at org.eclipse.jem.util.emf.workbench.nature.EMFNature.getEmfContextBase(EMFNature.java:229)\n    at org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEmfContext(EditModelNature.java:61)\n    at org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEditModelForRead(EditModelNature.java:48)\n    at org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEditModelForRead(EditModelNature.java:39)\n    at org.eclipse.wst.common.componentcore.ModuleCoreNature.getModuleStructuralModelForRead(ModuleCoreNature.java:238)\n    at org.eclipse.wst.common.componentcore.internal.StructureEdit.\u003cinit\u003e(StructureEdit.java:315)\n    at org.eclipse.wst.common.componentcore.internal.StructureEdit.getStructureEditForRead(StructureEdit.java:114)\n    at org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.exists(VirtualComponent.java:87)\n    at com.bea.wlw.webproject.core.util.WebProject.refreshWebProjectInfo(WebProject.java:747)\n    at com.bea.wlw.webproject.core.util.WebProjectManager.rescanWebProject(WebProjectManager.java:366)\n    at com.bea.wlw.webproject.core.util.WebProjectManager.access$0(WebProjectManager.java:362)\n    at com.bea.wlw.webproject.core.util.WebProjectManager$1.run(WebProjectManager.java:188)\n    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)\n\nAs far as I can tell, this looks like a race condition between adding and/or removing element change listeners on different threads. It could be fixed by adding synchronization in either JavaCore or DeltaProcessingState.",
    "I should mention that I tried adding a null check for the argument passed in to DeltaProcessingState.addElementChangedListener(), but it was not triggered before I saw the NPE later.\n\nThe NPE happens periodically, but I do not have a reliable repro.",
    "Synchronized DeltaProcessingState#addElementChangedListener() and removeElementChangedListener() as well as the access to those fields in DeltaProcessor#fire(IJavaElementDelta,int) and resourceChanged(IResourceChangedEvent)",
    "Verified for 3.2M6 using build I20060327-0010."
  ],
  "commentCreationDates": [
    "2006-03-07T01:36:01+01:00",
    "2006-03-07T18:02:21+01:00",
    "2006-03-09T11:46:39+01:00",
    "2006-03-28T10:11:53+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.DeltaProcessingState.addElementChangedListener",
          "source": "DeltaProcessingState.java:171"
        },
        {
          "method": "org.eclipse.jdt.core.JavaCore.addElementChangedListener",
          "source": "JavaCore.java:1087"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaModelListener.\u003cinit\u003e",
          "source": "JavaModelListener.java:38"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaModelListener.\u003cinit\u003e",
          "source": "JavaModelListener.java:34"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaReflectionSynchronizer.\u003cinit\u003e",
          "source": "JavaReflectionSynchronizer.java:45"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.initializeSynchronizer",
          "source": "JavaJDOMAdapterFactory.java:191"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.setJavaProject",
          "source": "JavaJDOMAdapterFactory.java:231"
        },
        {
          "method": "org.eclipse.jem.internal.adapters.jdom.JavaJDOMAdapterFactory.\u003cinit\u003e",
          "source": "JavaJDOMAdapterFactory.java:45"
        },
        {
          "method": "org.eclipse.jem.internal.plugin.JavaEMFNature.addJavaReflectionAdapterFactories",
          "source": "JavaEMFNature.java:177"
        },
        {
          "method": "org.eclipse.jem.internal.plugin.JavaEMFNature.addAdapterFactories",
          "source": "JavaEMFNature.java:165"
        },
        {
          "method": "org.eclipse.jem.internal.plugin.JavaEMFNature.primaryContributeToContext",
          "source": "JavaEMFNature.java:141"
        },
        {
          "method": "org.eclipse.jem.internal.util.emf.workbench.EMFWorkbenchContextFactory.initializeEMFContextFromContributors",
          "source": "EMFWorkbenchContextFactory.java:127"
        },
        {
          "method": "org.eclipse.jem.internal.util.emf.workbench.EMFWorkbenchContextFactory.createEMFContext",
          "source": "EMFWorkbenchContextFactory.java:110"
        },
        {
          "method": "org.eclipse.jem.util.emf.workbench.WorkbenchResourceHelperBase.createEMFContext",
          "source": "WorkbenchResourceHelperBase.java:222"
        },
        {
          "method": "org.eclipse.jem.util.emf.workbench.nature.EMFNature.createEmfContext",
          "source": "EMFNature.java:105"
        },
        {
          "method": "org.eclipse.jem.util.emf.workbench.nature.EMFNature.getEmfContextBase",
          "source": "EMFNature.java:229"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEmfContext",
          "source": "EditModelNature.java:61"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEditModelForRead",
          "source": "EditModelNature.java:48"
        },
        {
          "method": "org.eclipse.wst.common.internal.emfworkbench.integration.EditModelNature.getEditModelForRead",
          "source": "EditModelNature.java:39"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.ModuleCoreNature.getModuleStructuralModelForRead",
          "source": "ModuleCoreNature.java:238"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.\u003cinit\u003e",
          "source": "StructureEdit.java:315"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.StructureEdit.getStructureEditForRead",
          "source": "StructureEdit.java:114"
        },
        {
          "method": "org.eclipse.wst.common.componentcore.internal.resources.VirtualComponent.exists",
          "source": "VirtualComponent.java:87"
        },
        {
          "method": "com.bea.wlw.webproject.core.util.WebProject.refreshWebProjectInfo",
          "source": "WebProject.java:747"
        },
        {
          "method": "com.bea.wlw.webproject.core.util.WebProjectManager.rescanWebProject",
          "source": "WebProjectManager.java:366"
        },
        {
          "method": "com.bea.wlw.webproject.core.util.WebProjectManager.access$0",
          "source": "WebProjectManager.java:362"
        },
        {
          "method": "com.bea.wlw.webproject.core.util.WebProjectManager$1.run",
          "source": "WebProjectManager.java:188"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "130683",
      "date": "2006-03-07T01:36:01+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "130683",
  "bugId": "130683",
  "date": "2006-03-07T01:36:01+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}