{
  "comments": [
    "Build ID: I20070222-0951\n\nSteps To Reproduce:\n1. Set up a diagram to support shotcuts, that is the \"Gen Diagram\" part of   ***.gmfgen should be tagged with something like this: \u003ccontainsShortcutsTo\u003eflow\u003c/containsShortcutsTo\u003e    \u003cshortcutsProvidedFor\u003eFlow\u003c/shortcutsProvidedFor\u003e\n\n2. Grab any file from Prj. Expl. and drag it over the canvas of a this diagram\u0027s editor instance.\n\n3. The following exception is thrown in the getDropObjectsCommand() method of the DiagramDragDropEditPolicy() installed on the generated content EditPart :\n\njava.lang.ClassCastException: java.lang.String\nat com.lumisolve.flow.diagram.edit.parts.FlowEditPart$1.getDropObjectsCommand(FlowEditPart.java:64)\nat org.eclipse.gmf.runtime.diagram.ui.editpolicies.DragDropEditPolicy.getCommand(DragDropEditPolicy.java:80)\nat org.eclipse.gef.editparts.AbstractEditPart.getCommand(AbstractEditPart.java:473)\nat org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart.access$1(GraphicalEditPart.java:1)\nat org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart$1.run(GraphicalEditPart.java:456)\nat org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.runExclusive(TransactionalEditingDomainImpl.java:260)\nat org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart.getCommand(GraphicalEditPart.java:451)\nat org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener$1.evaluate(DiagramDropTargetListener.java:203)\nat org.eclipse.gef.ui.parts.GraphicalViewerImpl$1$ConditionalTreeSearch.accept(GraphicalViewerImpl.java:168)\nat org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart$1.findFigureAt(DiagramEditPart.java:148)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.draw2d.Layer.findFigureAt(Layer.java:52)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.draw2d.Layer.findFigureAt(Layer.java:52)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.draw2d.Layer.findFigureAt(Layer.java:52)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.draw2d.Layer.findFigureAt(Layer.java:52)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.draw2d.Figure.findDescendantAtExcluding(Figure.java:336)\nat org.eclipse.draw2d.Figure.findFigureAt(Figure.java:367)\nat org.eclipse.gef.ui.parts.GraphicalViewerImpl.findObjectAtExcluding(GraphicalViewerImpl.java:173)\nat org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.calculateTargetEditPart(DiagramDropTargetListener.java:198)\nat org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.updateTargetEditPart(DiagramDropTargetListener.java:189)\nat org.eclipse.gef.dnd.AbstractTransferDropTargetListener.isEnabled(AbstractTransferDropTargetListener.java:368)\nat org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.isEnabled(DiagramDropTargetListener.java:178)\nat org.eclipse.gmf.runtime.diagram.ui.internal.parts.ImageFileDropTargetListener.isEnabled(ImageFileDropTargetListener.java:87)\nat org.eclipse.jface.util.DelegatingDropAdapter.updateCurrentListener(DelegatingDropAdapter.java:365)\nat org.eclipse.jface.util.DelegatingDropAdapter.dragEnter(DelegatingDropAdapter.java:128)\nat org.eclipse.swt.dnd.DNDListener.handleEvent(DNDListener.java:60)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:938)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:962)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:947)\nat org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:706)\nat org.eclipse.swt.dnd.DropTarget.DragEnter(DropTarget.java:267)\nat org.eclipse.swt.dnd.DropTarget$3.method3(DropTarget.java:234)\nat org.eclipse.swt.internal.ole.win32.COMObject.callback3(COMObject.java:90)\nat org.eclipse.swt.internal.ole.win32.COM.DoDragDrop(Native Method)\nat org.eclipse.swt.dnd.DragSource.drag(DragSource.java:308)\nat org.eclipse.swt.dnd.DragSource.access$0(DragSource.java:281)\nat org.eclipse.swt.dnd.DragSource$1.handleEvent(DragSource.java:165)\n\n\nMore information:\nThe problem is that the object wrapped in the request is just a String - the full path of the resource being dragged - therefore (EObject)it.next() throws.\n\nThe problem occurs in a freshly generated editor. BTW, the same problem can be spotted in the Taipan example as well.\n\nI am not sure who and where creates the request. Most likely the culprit is the createTargrtRequest() of the DiagramDropTargetListener installed on the generated editor:\n\nprotected void initializeGraphicalViewer() {\n   super.initializeGraphicalViewer();\n   getDiagramGraphicalViewer().addDropTargetListener( new DropTargetListener(getDiagramGraphicalViewer(), LocalSelectionTransfer.getTransfer()) {  ...\n\nHope this helps somewhat,\nT. M.",
    "Sorry, missed the milestone - 2.0 M5",
    "Just found something relevant from the BPMN guys:\n\nDiagramDragDropEditPolicy \nWhen implementing our own drag and drop edit policy, we had to make it a delegate to the DiagramDragDropEditPolicy, so that we don\u0027t lose the possiility to drop objects on the diagram. The problem is that it casts the selection of the LocalSelectioTransfer into EObjects, creating ClassCastExceptions. We are for now extending it through DiagramDragDropEditPolicyEx. See http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.stp.bpmn/org.eclipse.stp.bpmn.diagram/customsrc/org/eclipse/stp/bpmn/policies/DiagramDragDropEditPolicyEx.java?cvsroot\u003dSTP_Project \n\nRegards,\nTheo\n",
    "DiagramEditPart template corrected to check instanceof before custing - there could be some other dropTergetListeners installed (in particular - ImageFileDropTargetListener)"
  ],
  "commentCreationDates": [
    "2007-05-01T16:38:55+02:00",
    "2007-05-01T21:35:13+02:00",
    "2007-05-01T21:36:58+02:00",
    "2007-06-05T19:44:13+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "java.lang.String",
      "elements": [
        {
          "method": "com.lumisolve.flow.diagram.edit.parts.FlowEditPart$1.getDropObjectsCommand",
          "source": "FlowEditPart.java:64"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editpolicies.DragDropEditPolicy.getCommand",
          "source": "DragDropEditPolicy.java:80"
        },
        {
          "method": "org.eclipse.gef.editparts.AbstractEditPart.getCommand",
          "source": "AbstractEditPart.java:473"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart.access$1",
          "source": "GraphicalEditPart.java:1"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart$1.run",
          "source": "GraphicalEditPart.java:456"
        },
        {
          "method": "org.eclipse.emf.transaction.impl.TransactionalEditingDomainImpl.runExclusive",
          "source": "TransactionalEditingDomainImpl.java:260"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart.getCommand",
          "source": "GraphicalEditPart.java:451"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener$1.evaluate",
          "source": "DiagramDropTargetListener.java:203"
        },
        {
          "method": "org.eclipse.gef.ui.parts.GraphicalViewerImpl$1$ConditionalTreeSearch.accept",
          "source": "GraphicalViewerImpl.java:168"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart$1.findFigureAt",
          "source": "DiagramEditPart.java:148"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.draw2d.Layer.findFigureAt",
          "source": "Layer.java:52"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.draw2d.Layer.findFigureAt",
          "source": "Layer.java:52"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.draw2d.Layer.findFigureAt",
          "source": "Layer.java:52"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.draw2d.Layer.findFigureAt",
          "source": "Layer.java:52"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findDescendantAtExcluding",
          "source": "Figure.java:336"
        },
        {
          "method": "org.eclipse.draw2d.Figure.findFigureAt",
          "source": "Figure.java:367"
        },
        {
          "method": "org.eclipse.gef.ui.parts.GraphicalViewerImpl.findObjectAtExcluding",
          "source": "GraphicalViewerImpl.java:173"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.calculateTargetEditPart",
          "source": "DiagramDropTargetListener.java:198"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.updateTargetEditPart",
          "source": "DiagramDropTargetListener.java:189"
        },
        {
          "method": "org.eclipse.gef.dnd.AbstractTransferDropTargetListener.isEnabled",
          "source": "AbstractTransferDropTargetListener.java:368"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.parts.DiagramDropTargetListener.isEnabled",
          "source": "DiagramDropTargetListener.java:178"
        },
        {
          "method": "org.eclipse.gmf.runtime.diagram.ui.internal.parts.ImageFileDropTargetListener.isEnabled",
          "source": "ImageFileDropTargetListener.java:87"
        },
        {
          "method": "org.eclipse.jface.util.DelegatingDropAdapter.updateCurrentListener",
          "source": "DelegatingDropAdapter.java:365"
        },
        {
          "method": "org.eclipse.jface.util.DelegatingDropAdapter.dragEnter",
          "source": "DelegatingDropAdapter.java:128"
        },
        {
          "method": "org.eclipse.swt.dnd.DNDListener.handleEvent",
          "source": "DNDListener.java:60"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:938"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:962"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:947"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:706"
        },
        {
          "method": "org.eclipse.swt.dnd.DropTarget.DragEnter",
          "source": "DropTarget.java:267"
        },
        {
          "method": "org.eclipse.swt.dnd.DropTarget$3.method3",
          "source": "DropTarget.java:234"
        },
        {
          "method": "org.eclipse.swt.internal.ole.win32.COMObject.callback3",
          "source": "COMObject.java:90"
        },
        {
          "method": "org.eclipse.swt.internal.ole.win32.COM.DoDragDrop",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource.drag",
          "source": "DragSource.java:308"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource.access$0",
          "source": "DragSource.java:281"
        },
        {
          "method": "org.eclipse.swt.dnd.DragSource$1.handleEvent",
          "source": "DragSource.java:165"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "184869",
      "date": "2007-05-01T16:38:55+02:00",
      "product": "GMF",
      "component": "Generation",
      "severity": "normal"
    }
  ],
  "groupId": "184869",
  "bugId": "184869",
  "date": "2007-05-01T16:38:55+02:00",
  "product": "GMF",
  "component": "Generation",
  "severity": "normal"
}