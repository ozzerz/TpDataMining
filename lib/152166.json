{
  "comments": [
    "The following exception is generated when I attempt to load the instance document below:\n\nCaused by: org.eclipse.emf.ecore.xmi.FeatureNotFoundException: Feature \u0027zipcode\u0027 not found. (http:///temp.xml, 20, 19)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.reportUnknownFeature(XMLHandler.java:1728)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleUnknownFeature(XMLHandler.java:1692)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleFeature(XMLHandler.java:1636)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.processElement(XMLHandler.java:876)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement(XMLHandler.java:854)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement(XMLHandler.java:626)\nat org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)\n...\nat org.eclipse.emf.ecore.xmi.impl.XMLLoadImpl.load(XMLLoadImpl.java:264)\n\nI believe this might be another namespace scoping problem. When I move the \u0027info\u0027 element after the \u0027zipcode\u0027 element, the problem disappears. I suspect the default namespace isn\u0027t being restored after the \u0027info\u0027 element empty namespace is processed.\n\nThanks in advance for your assistance,\n\n- Ron\n\nSample Instance (chapter04.xml)\n\u003corder xmlns\u003d\"\u003chttp://example.org/ord\u003e\"\nxmlns:xsi\u003d\"\u003chttp://www.w3.org/2001/XMLSchema-instance\u003e\"\nxsi:schemaLocation\u003d\"\u003chttp://example.org/ord\u003e chapter04ord1.xsd\"\u003e\n\u003cnumber\u003e123ABBCC123\u003c/ord:number\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePat Walmsley\u003c/ord:name\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/zipcode\u003e\"\u003e\n\u003czipcode\u003e21043\u003c/zipcode\u003e\n\u003c/info\u003e\n\u003cnumber\u003e15465\u003c/ord:number\u003e\n\u003c/customer\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePriscilla Walmsley\u003c/ord:name\u003e\n\u003cnumber\u003e15466\u003c/ord:number\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/street\u003e\"\u003e\n\u003cstreet\u003e341 Duckworth Way\u003c/street\u003e\n\u003c/info\u003e\n\u003c/customer\u003e\n\u003citems\u003e\n\u003cproduct xmlns\u003d\"\"\u003e\n\u003cnumber\u003e557\u003c/number\u003e\n\u003cname\u003eShort-Sleeved Linen Blouse\u003c/name\u003e\n\u003csize system\u003d\"US-DRESS\"\u003e10\u003c/size\u003e\n\u003ccolor value\u003d\"blue\"/\u003e\n\u003c/product\u003e\n\u003citems\u003e\n\u003c/order\u003e\n\nSchema Document 1 (chapter04ord1.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns:prod\u003d\"\u003chttp://example.org/prod\u003e\";\n           elementFormDefault\u003d\"qualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/prod\u003e\";\nschemaLocation\u003d\"chapter04prod.xsd\"/\u003e\n \u003cxsd:simpleType name\u003d\"OrderNumType\"\u003e\n   \u003cxsd:restriction base\u003d\"xsd:string\"/\u003e\n \u003c/xsd:simpleType\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"/\u003e\n \u003cxsd:complexType name\u003d\"CustomerType\"\u003e\n   \u003cxsd:all\u003e\n     \u003cxsd:element name\u003d\"name\" type\u003d\"CustNameType\"/\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"xsd:integer\"/\u003e\n     \u003cxsd:element name\u003d\"info\" type\u003d\"InfoType\" form\u003d\"unqualified\"/\u003e\n   \u003c/xsd:all\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:simpleType name\u003d\"CustNameType\"\u003e\n   \u003cxsd:restriction base\u003d\"xsd:string\"/\u003e\n \u003c/xsd:simpleType\u003e\n \u003cxsd:element name\u003d\"order\" type\u003d\"OrderType\"/\u003e\n \u003cxsd:complexType name\u003d\"OrderType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"OrderNumType\"/\u003e\n     \u003cxsd:element name\u003d\"customer\" type\u003d\"CustomerType\" \n          maxOccurs\u003d\"unbounded\"/\u003e\n               \u003cxsd:element name\u003d\"items\" type\u003d\"prod:ItemsType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 2 (chapter04infozipcode.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns:ord\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/info/zipcode\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/info/zipcode\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/ord\u003e\";\nschemaLocation\u003d\"chapter04ord1.xsd\"/\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"\u003e\n     \u003cxsd:complexContent\u003e\n        \u003cxsd:extension base\u003d\"ord:InfoType\"\u003e\n           \u003cxsd:sequence\u003e\n              \u003cxsd:element name\u003d\"zipcode\" type\u003d\"xsd:string\"/\u003e\n           \u003c/xsd:sequence\u003e\n        \u003c/xsd:extension\u003e\n     \u003c/xsd:complexContent\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 3 (chapter04infostreet.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns:ord\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/info/street\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/info/street\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/ord\u003e\";\nschemaLocation\u003d\"chapter04ord1.xsd\"/\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"\u003e\n     \u003cxsd:complexContent\u003e\n        \u003cxsd:extension base\u003d\"ord:InfoType\"\u003e\n           \u003cxsd:sequence\u003e\n              \u003cxsd:element name\u003d\"street\" type\u003d\"xsd:string\"/\u003e\n           \u003c/xsd:sequence\u003e\n        \u003c/xsd:extension\u003e\n     \u003c/xsd:complexContent\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 4 (chapter04prod.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/prod\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/prod\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n \u003cxsd:complexType name\u003d\"ItemsType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"product\" type\u003d\"ProductType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"ProductType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"xsd:integer\"/\u003e\n     \u003cxsd:element name\u003d\"name\" type\u003d\"xsd:string\"/\u003e\n     \u003cxsd:element name\u003d\"size\" type\u003d\"SizeType\"/\u003e\n     \u003cxsd:element name\u003d\"color\" type\u003d\"ColorType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"SizeType\"\u003e\n   \u003cxsd:simpleContent\u003e\n     \u003cxsd:extension base\u003d\"xsd:integer\"\u003e\n       \u003cxsd:attribute name\u003d\"system\" type\u003d\"xsd:string\"/\u003e\n     \u003c/xsd:extension\u003e\n   \u003c/xsd:simpleContent\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"ColorType\"\u003e\n   \u003cxsd:attribute name\u003d\"value\" type\u003d\"xsd:string\"/\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e",
    "Oops, I meant to say when I move the \u0027info\u0027 element after the \u0027number\u0027 element, not the \u0027zipcode\u0027 element, the problem disappears. Also, the instance document in my original note is incorrect. Please use the corrected version below.\n\nThanks,\n\n- Ron\n\n\nSample Instance (chapter04.xml)\n\u003corder xmlns\u003d\"\u003chttp://example.org/ord\u003e\"\nxmlns:xsi\u003d\"\u003chttp://www.w3.org/2001/XMLSchema-instance\u003e\"\nxsi:schemaLocation\u003d\"\u003chttp://example.org/ord\u003e chapter04ord1.xsd\"\u003e\n\u003cnumber\u003e123ABBCC123\u003c/number\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePat Walmsley\u003c/name\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/zipcode\u003e\"\u003e\n\u003czipcode\u003e21043\u003c/zipcode\u003e\n\u003c/info\u003e\n\u003cnumber\u003e15465\u003c/number\u003e\n\u003c/customer\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePriscilla Walmsley\u003c/name\u003e\n\u003cnumber\u003e15466\u003c/number\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/street\u003e\"\u003e\n\u003cstreet\u003e341 Duckworth Way\u003c/street\u003e\n\u003c/info\u003e\n\u003c/customer\u003e\n\u003citems\u003e\n\u003cproduct xmlns\u003d\"\"\u003e\n\u003cnumber\u003e557\u003c/number\u003e\n\u003cname\u003eShort-Sleeved Linen Blouse\u003c/name\u003e\n\u003csize system\u003d\"US-DRESS\"\u003e10\u003c/size\u003e\n\u003ccolor value\u003d\"blue\"/\u003e\n\u003c/product\u003e\n\u003citems\u003e\n\u003c/order\u003e\n",
    "Alright, let\u0027s try this again. Please disregard my two previous comments and use this one.\n\nThe following exception is generated when I attempt to load the instance\ndocument below:\n\nCaused by: org.eclipse.emf.ecore.xmi.FeatureNotFoundException: Feature\n\u0027number\u0027 not found. (http:///temp.xml, 20, 19)\nat\norg.eclipse.emf.ecore.xmi.impl.XMLHandler.reportUnknownFeature(XMLHandler.java:1728)\nat\norg.eclipse.emf.ecore.xmi.impl.XMLHandler.handleUnknownFeature(XMLHandler.java:1692)\nat\norg.eclipse.emf.ecore.xmi.impl.XMLHandler.handleFeature(XMLHandler.java:1636)\nat\norg.eclipse.emf.ecore.xmi.impl.XMLHandler.processElement(XMLHandler.java:876)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement(XMLHandler.java:854)\nat org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement(XMLHandler.java:626)\nat org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)\n...\nat org.eclipse.emf.ecore.xmi.impl.XMLLoadImpl.load(XMLLoadImpl.java:264)\n\nI believe this might be another namespace scoping problem. When I move the customer \u0027info\u0027 element after the \u0027number\u0027 element, the problem disappears. I suspect the default namespace isn\u0027t being restored after the \u0027info\u0027 element\u0027s empty namespace is processed.\n\nThanks in advance for your assistance,\n\n- Ron\n\nSample Instance (chapter04.xml)\n\u003corder xmlns\u003d\"\u003chttp://example.org/ord\u003e\"\nxmlns:xsi\u003d\"\u003chttp://www.w3.org/2001/XMLSchema-instance\u003e\"\nxsi:schemaLocation\u003d\"\u003chttp://example.org/ord\u003e chapter04ord1.xsd\"\u003e\n\u003cnumber\u003e123ABBCC123\u003c/number\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePat Walmsley\u003c/name\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/zipcode\u003e\"\u003e\n\u003czipcode\u003e21043\u003c/zipcode\u003e\n\u003c/info\u003e\n\u003cnumber\u003e15465\u003c/number\u003e\n\u003c/customer\u003e\n\u003ccustomer\u003e\n\u003cname\u003ePriscilla Walmsley\u003c/name\u003e\n\u003cnumber\u003e15466\u003c/number\u003e\n\u003cinfo xsi:type\u003d\"ns1:InfoType\" xmlns\u003d\"\"\nxmlns:ns1\u003d\"\u003chttp://example.org/info/street\u003e\"\u003e\n\u003cstreet\u003e341 Duckworth Way\u003c/street\u003e\n\u003c/info\u003e\n\u003c/customer\u003e\n\u003citems\u003e\n\u003cproduct xmlns\u003d\"\"\u003e\n\u003cnumber\u003e557\u003c/number\u003e\n\u003cname\u003eShort-Sleeved Linen Blouse\u003c/name\u003e\n\u003csize system\u003d\"US-DRESS\"\u003e10\u003c/size\u003e\n\u003ccolor value\u003d\"blue\"/\u003e\n\u003c/product\u003e\n\u003citems\u003e\n\u003c/order\u003e\n\nSchema Document 1 (chapter04ord1.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns:prod\u003d\"\u003chttp://example.org/prod\u003e\";\n           elementFormDefault\u003d\"qualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/prod\u003e\";\nschemaLocation\u003d\"chapter04prod.xsd\"/\u003e\n \u003cxsd:simpleType name\u003d\"OrderNumType\"\u003e\n   \u003cxsd:restriction base\u003d\"xsd:string\"/\u003e\n \u003c/xsd:simpleType\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"/\u003e\n \u003cxsd:complexType name\u003d\"CustomerType\"\u003e\n   \u003cxsd:all\u003e\n     \u003cxsd:element name\u003d\"name\" type\u003d\"CustNameType\"/\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"xsd:integer\"/\u003e\n     \u003cxsd:element name\u003d\"info\" type\u003d\"InfoType\" form\u003d\"unqualified\"/\u003e\n   \u003c/xsd:all\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:simpleType name\u003d\"CustNameType\"\u003e\n   \u003cxsd:restriction base\u003d\"xsd:string\"/\u003e\n \u003c/xsd:simpleType\u003e\n \u003cxsd:element name\u003d\"order\" type\u003d\"OrderType\"/\u003e\n \u003cxsd:complexType name\u003d\"OrderType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"OrderNumType\"/\u003e\n     \u003cxsd:element name\u003d\"customer\" type\u003d\"CustomerType\" \n          maxOccurs\u003d\"unbounded\"/\u003e\n               \u003cxsd:element name\u003d\"items\" type\u003d\"prod:ItemsType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 2 (chapter04infozipcode.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns:ord\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/info/zipcode\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/info/zipcode\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/ord\u003e\";\nschemaLocation\u003d\"chapter04ord1.xsd\"/\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"\u003e\n     \u003cxsd:complexContent\u003e\n        \u003cxsd:extension base\u003d\"ord:InfoType\"\u003e\n           \u003cxsd:sequence\u003e\n              \u003cxsd:element name\u003d\"zipcode\" type\u003d\"xsd:string\"/\u003e\n           \u003c/xsd:sequence\u003e\n        \u003c/xsd:extension\u003e\n     \u003c/xsd:complexContent\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 3 (chapter04infostreet.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns:ord\u003d\"\u003chttp://example.org/ord\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/info/street\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/info/street\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n\u003cxsd:import namespace\u003d\"\u003chttp://example.org/ord\u003e\";\nschemaLocation\u003d\"chapter04ord1.xsd\"/\u003e\n \u003cxsd:complexType name\u003d\"InfoType\"\u003e\n     \u003cxsd:complexContent\u003e\n        \u003cxsd:extension base\u003d\"ord:InfoType\"\u003e\n           \u003cxsd:sequence\u003e\n              \u003cxsd:element name\u003d\"street\" type\u003d\"xsd:string\"/\u003e\n           \u003c/xsd:sequence\u003e\n        \u003c/xsd:extension\u003e\n     \u003c/xsd:complexContent\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\nSchema Document 4 (chapter04prod.xsd)\n\u003cxsd:schema xmlns:xsd\u003d\"\u003chttp://www.w3.org/2001/XMLSchema\u003e\";\n           xmlns\u003d\"\u003chttp://example.org/prod\u003e\";\n           targetNamespace\u003d\"\u003chttp://example.org/prod\u003e\";\n           elementFormDefault\u003d\"unqualified\"\u003e\n \u003cxsd:complexType name\u003d\"ItemsType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"product\" type\u003d\"ProductType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"ProductType\"\u003e\n   \u003cxsd:sequence\u003e\n     \u003cxsd:element name\u003d\"number\" type\u003d\"xsd:integer\"/\u003e\n     \u003cxsd:element name\u003d\"name\" type\u003d\"xsd:string\"/\u003e\n     \u003cxsd:element name\u003d\"size\" type\u003d\"SizeType\"/\u003e\n     \u003cxsd:element name\u003d\"color\" type\u003d\"ColorType\"/\u003e\n   \u003c/xsd:sequence\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"SizeType\"\u003e\n   \u003cxsd:simpleContent\u003e\n     \u003cxsd:extension base\u003d\"xsd:integer\"\u003e\n       \u003cxsd:attribute name\u003d\"system\" type\u003d\"xsd:string\"/\u003e\n     \u003c/xsd:extension\u003e\n   \u003c/xsd:simpleContent\u003e\n \u003c/xsd:complexType\u003e\n \u003cxsd:complexType name\u003d\"ColorType\"\u003e\n   \u003cxsd:attribute name\u003d\"value\" type\u003d\"xsd:string\"/\u003e\n \u003c/xsd:complexType\u003e\n\u003c/xsd:schema\u003e\n\n",
    "Created an attachment (id\u003d46968)\nGenerated model and test project\n\nRon,\n\nTrying to copy these schemas full of extraneous \u003c and ; is annoying and so is having to fix the XML errors in the sample document. :-(\n\nI\u0027ve attached the generated model and tests projects.  Running the StreetExample.java loads the sample file.  It works properly for me.\n\nPlease turn this into a failing test case that reproduces the problem you are seeing.",
    "Ed,\n\nThanks for your help and patience. I\u0027ll take the project you so kindly created for me, reproduce the error, and submit the failing test case as an attachment.\n\nThanks again,\n\n- Ron",
    "Ron,\n\nI\u0027ll reduce the severity, at least for now, so that I don\u0027t have to see red in the list of open bugs.  It\u0027s not necessary to mark things as critical to get attention. ;-)",
    "Hi Ed,\n\nAfter some EMF/Xerces debugging, I finally reproduced the problem. I am using EMF 2.2.0, Sun JDK 1.4.2_11, and Apache Xerces 2.8.0. \n\nThe out-of-the-box StreetExample loads the \"data/sample.xml\" file fine because the parser feature \"http://xml.org/sax/features/namespaces\" is false. XMLLoadImpl.makeParser() creates the parser with this feature set to false. \n\nMy environment is a bit different because I am using EMF\u0027s XMLParserPoolImpl to pool parsers. Unlike XMLLoadImpl.makeParser(), XMLParserPoolImpl.makeParser() creates a parser with this feature set to true. \n\nIn order to reproduce the problem, please modify the first few lines of StreetExample.main() as follows:\n\n{\n   System.setProperty(\"javax.xml.parser.DocumentBuilderFactory\", \"org.apache.xerces.jaxp.DocumentBuilderFactoryImpl\");\n   System.setProperty(\"javax.xml.parser.SAXParserFactory\", \"org.apache.xerces.jaxp.SAXParserFactoryImpl\");\n   args \u003d new String[] {\"data/sample.xml\"};\n   \n   // Create a resource set to hold the resources\n   //\n   ResourceSet resourceSet \u003d new ResourceSetImpl();\n   resourceSet.getLoadOptions().put(XMLResource.OPTION_USE_PARSER_POOL, new XMLParserPoolImpl());\n\n   // Register...\n   ...\n}\n\nIt appears when namespaces are enabled in the parser, the XMLHelperImpl.NamespaceSupport.pushContext gets invoked once instead of twice when parsing the document element. This causes problems later on when popContext gets invoked and namespaces are supposed to be removed from the prefixesToFactories map.\n\nUnfortunately, I am unable to work around this problem in my environment by explicitly setting the parser namespaces feature to false because this causes various other types of problems. Since this is a show-stopper problem for us with no known workaround, I hope you don\u0027t mind that I bumped the priority back to critical. I\u0027ll be glad to reduce the severity if you know of a workaround.\n\nPlease let me know if you have trouble reproducing the problem. Much thanks for the exemplary support.\n\n- Ron",
    "Created an attachment (id\u003d47023)\nPatches for XMLHandler\n\nSo the problem is as you concluded the difference in namespace aware handling when declaring prefixes because of startPrefixMapping callbacks before the helper\u0027s namespace context is pushed by the startElement callback verses after when handling xmlns declarations directly as attributes.\n\nThe best I could think of is to keep a boolean in XMLHandler to indicate if a pushContext call is needed so that I can make sure to push the context during startPrefixMapping, but only for the first one, and then not again when the element starts.",
    "Hi Ed,\n\nAs always, thanks for the quick feedback. I\u0027ll try to test your patch and confirm that it fixes my problem.\n\nBTW, is there a reason why the two \"makeParser\" methods behave differently? This inconsistency seems quite confusing.\n\n- Ron",
    "Ron,\n\nEMF\u0027s history goes back a long time to the days when turning on namespace awareness in the parser made it run a heck of a lot slower, so handling namespaces directly ourselves in the handler is kind of a legacy thing we need to do to keep long standing clients from being adversely impacted by our improvements.",
    "I\u0027ve committed the fix so that we can run a build and fully test this.",
    "Fixed in M200608030000."
  ],
  "commentCreationDates": [
    "2006-07-28T18:10:58+02:00",
    "2006-07-28T18:16:40+02:00",
    "2006-07-28T18:25:23+02:00",
    "2006-07-28T19:18:00+02:00",
    "2006-07-28T21:09:43+02:00",
    "2006-07-28T21:14:15+02:00",
    "2006-07-30T04:52:49+02:00",
    "2006-07-30T16:11:22+02:00",
    "2006-07-31T04:51:35+02:00",
    "2006-07-31T13:00:54+02:00",
    "2006-08-01T20:38:20+02:00",
    "2006-08-03T07:10:48+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.emf.ecore.xmi.FeatureNotFoundException",
      "message": "Feature \u0027zipcode\u0027 not found. (http:///temp.xml, 20, 19)",
      "elements": [
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.reportUnknownFeature",
          "source": "XMLHandler.java:1728"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleUnknownFeature",
          "source": "XMLHandler.java:1692"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleFeature",
          "source": "XMLHandler.java:1636"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.processElement",
          "source": "XMLHandler.java:876"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement",
          "source": "XMLHandler.java:854"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement",
          "source": "XMLHandler.java:626"
        },
        {
          "method": "org.apache.xerces.parsers.AbstractSAXParser.startElement",
          "source": "Unknown Source"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "152166",
      "date": "2006-07-28T18:10:58+02:00",
      "product": "EMF",
      "component": "XML/XMI",
      "severity": "major"
    },
    {
      "exceptionType": "org.eclipse.emf.ecore.xmi.FeatureNotFoundException",
      "message": "Feature \u0027number\u0027 not found. (http:///temp.xml, 20, 19)",
      "elements": [
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.reportUnknownFeature",
          "source": "XMLHandler.java:1728"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleUnknownFeature",
          "source": "XMLHandler.java:1692"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.handleFeature",
          "source": "XMLHandler.java:1636"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.processElement",
          "source": "XMLHandler.java:876"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement",
          "source": "XMLHandler.java:854"
        },
        {
          "method": "org.eclipse.emf.ecore.xmi.impl.XMLHandler.startElement",
          "source": "XMLHandler.java:626"
        },
        {
          "method": "org.apache.xerces.parsers.AbstractSAXParser.startElement",
          "source": "Unknown Source"
        }
      ],
      "number": 1,
      "commentIndex": 2,
      "bugId": "152166",
      "date": "2006-07-28T18:25:23+02:00",
      "product": "EMF",
      "component": "XML/XMI",
      "severity": "major"
    }
  ],
  "groupId": "152166",
  "bugId": "152166",
  "date": "2006-07-28T18:10:58+02:00",
  "product": "EMF",
  "component": "XML/XMI",
  "severity": "major"
}