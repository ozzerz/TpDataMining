{
  "comments": [
    "Hi,\n\nI always get a NullPointerException when I try to validate a schema with XSD. I\nattached the stack trace of the exception and the used schema\n(xsd_npexception.xsd). I also attached a very similar schema where this\nexception doesn\u0027t appear (xsd_no_npexception.xsd).\n\nI think the main reason for this exception is that XSD couldn\u0027t resolve the\ndefinition of \"xml:lang\" in \"xsd_npexception.xsd\". This NullPointerException\nonly seems to be thrown when XSD couldn\u0027t resolve a definition from the\n\"xml\"-namespace. When I try to validate \"xsd_no_npexception.xsd\" I get a correct\ndiagnostic and not a NullPointerException.\n\nWhen I start the debugger he shows me this line\n(XSDComplexTypeDefinitionImpl.java:1838):\nXSDTypeDefinition badType \u003d\nxsdAttributeDeclaration.getTypeDefinition().getBadTypeDerivation(baseXSDAttributeDeclaration.getTypeDefinition(),\ntrue, true);\n\nWhen I get the exception xsdAttributeDeclaration.getTypeDefinition() returns a\nnull-pointer and xsdAttributeDeclaration currently contains the attribute\ndeclaration of \"xml:lang\"\u0027s attribute use.\n \nRegards\nKlaas Dellschaft\n\n\nStack trace:\njava.lang.NullPointerException\n\tat\norg.eclipse.xsd.impl.XSDComplexTypeDefinitionImpl.validateAttributeGroup(XSDComplexTypeDefinitionImpl.java:1838)\n\tat\norg.eclipse.xsd.impl.XSDComplexTypeDefinitionImpl.validate(XSDComplexTypeDefinitionImpl.java:1675)\n\tat\norg.eclipse.xsd.impl.XSDConcreteComponentImpl.validate(XSDConcreteComponentImpl.java:541)\n\tat org.eclipse.xsd.impl.XSDSchemaImpl.validate(XSDSchemaImpl.java:1493)",
    "Created an attachment (id\u003d13233)\nSchema where the NullPointerException appears\n",
    "Created an attachment (id\u003d13234)\nSchema where no NullPointerException appears\n",
    "I can\u0027t reproduce a problem using the Sample XML Schema Editor nor by running\norg.eclipse.xsd.test/test/xsd-test -validate.  Can you reproduce the problem in\neither of these ways?  Is it possible that you are using a bad DOM\nimplementation, such as the Crimson DOM in the Sun JDK?",
    "Yes, that\u0027s right. I used the Crimson implementation of the Sun SDK. When I\nstart Eclipse with Xerces in the endorsed dirs I couldn\u0027t reproduce this bug, too.",
    "Created an attachment (id\u003d13293)\nCorrected XML Schema where the NullPointerException appears\n\nThe file xsd-npexception.xsd doesn\u0027t reproduce the exception because the\nderived type didn\u0027t use \"someType\" as the base type. This file corrects the\nerror and now produces the NullPointerException.",
    "I still can\u0027t produce a problem. Some versions of DOM will barf over xmlns:xml\nbecause the xml prefix is defined by default so maybe that\u0027s what you are seeing...",
    "I submitted a wrong test example for reproducing the NullPointerException. I\ntested this schema with java.endorsed.dirs set to a Xerces 2.6.2 distribution. I\nhad problems running org.eclipse.xsd.test/test/xsd-test -validate and the Sample\nXML Schema Editor so I wasn\u0027t able to use them for reproducing this bug.\n\nI think it is important that XSD can not resolve \"xml:lang\" so if there doesn\u0027t\ncome the NullPointerException at least there has to be a diagnostic that he\ncouldn\u0027t resolve this definition.",
    "Created an attachment (id\u003d13302)\nImagine showing the same loads fine.\n\nI can\u0027t fix a problem that I can\u0027t reproduce.",
    "I really need a way to reproduce your problem to fix it so you either need to\nprovide steps I can follow to reproduce it or to provide a test case that I can\nrun which reproduces the problem (i.e., Eclipse projects with a JUnit test or\nmain() application).",
    "I added a short example which loads and validates schemas. It takes the schema\nwhich should be loaded as an argument. I also included two schemas in the\nzip-file. The first schema tries to include \"xml:lang\" and the second tries to\ninclude an attribute from a namespace whose schema couldn\u0027t be found by XSD.\n\nBoth test case produce a NullPointerException. Is there a way to see whether I\nreally use another implementation than Crimson DOM? So I can see whether I\nsuccessfuly load Xerces-J or whether I still use Crimson DOM although I set\njava.endorsed.dirs.",
    "Created an attachment (id\u003d13349)\nA java test class and two schemas which reprodurce the NullPointerException\n",
    "I ran it without any problems:\n\n\u003c!-- Loading\n\"d:/sandbox/unpackage1_3.0/eclipse/workspace/test/xsd_npexception.xsd\" --\u003e\n\nLoaded 2 schema(s):\n  [0] \u003d xsd_npexception.xsd\nValidating xsd_npexception.xsd\n  [1] \u003d http://www.w3.org/2001/03/xml.xsd\nValidating http://www.w3.org/2001/03/xml.xsd\n\n\u003c!-- Done --\u003e\n\n\n\u003c!-- Loading\n\"d:/sandbox/unpackage1_3.0/eclipse/workspace/test/xsd_npexception2.xsd\" --\u003e\n\nLoaded 1 schema(s):\n  [0] \u003d xsd_npexception2.xsd\nValidating xsd_npexception2.xsd\n\nSo it still sounds like a bad DOM implementation problem. \n\nLooking at the name of the implemention class for a Node produced by the DOM\nimplementation should tell you who the provider of the implementation is...",
    "When I stop at the NullPointerException I get \n\"org.apache.xerces.dom.DeferredElementNSImpl\" as the value of \nxsdConcreteComponent.getElement().getClass().getName(). So I\u0027m using Xerces and\nnot Crimson.\n\nBut now I discovered the first difference between my and your test environment:\nYou are connected to the internet while validating xsd_npexception.xsd and I\u0027m\nnormaly not. So you are able to download http://www.w3.org/2001/xml.xsd and I\u0027m\nnot. This would explain why you don\u0027t get an exception while validating the\nfirst example. When I\u0027m connected to the internet I also successfuly validate\nthe first example.\n\nBut this doesn\u0027t explain the different results when validating\nxsd_npexception2.xsd. Could you set a breakpoint where the NullPointerException\nappears in my case? It is the first stop at this line where the\nNullPointerException appears. What information contains the type returned by\nxsdAttributeDeclaration.getTypeDefinition()? Which type should XSD insert into\nXSDAttributeDeclaration when it isn\u0027t possible to resolve the attribute\ndeclaration? Probably this is a hint where your and my test environment are\ndifferent.\n\nWhy isn\u0027t there a diagnostic in your copied output of the program run with\nxsd_npexception2.xsd? There should be at least a message that XSD couldn\u0027t\nresolve the \"mns:lang\"-attribute.",
    "I was able to reproduce it, so now I can fix it too.  Sorry it took so many\niterations.",
    "The fix is committed to CVS in the 2.0.1 stream.",
    "The fix is available in the M200407280859 build."
  ],
  "commentCreationDates": [
    "2004-07-14T11:53:36+02:00",
    "2004-07-14T11:54:58+02:00",
    "2004-07-14T11:55:28+02:00",
    "2004-07-14T13:56:36+02:00",
    "2004-07-15T13:43:02+02:00",
    "2004-07-15T15:54:02+02:00",
    "2004-07-15T16:00:40+02:00",
    "2004-07-15T16:04:48+02:00",
    "2004-07-15T18:02:49+02:00",
    "2004-07-15T18:07:06+02:00",
    "2004-07-16T09:38:55+02:00",
    "2004-07-16T09:40:40+02:00",
    "2004-07-16T14:27:05+02:00",
    "2004-07-17T17:08:41+02:00",
    "2004-07-19T16:44:03+02:00",
    "2004-07-19T16:50:20+02:00",
    "2004-07-28T18:54:59+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.xsd.impl.XSDComplexTypeDefinitionImpl.validateAttributeGroup",
          "source": "XSDComplexTypeDefinitionImpl.java:1838"
        },
        {
          "method": "org.eclipse.xsd.impl.XSDComplexTypeDefinitionImpl.validate",
          "source": "XSDComplexTypeDefinitionImpl.java:1675"
        },
        {
          "method": "org.eclipse.xsd.impl.XSDConcreteComponentImpl.validate",
          "source": "XSDConcreteComponentImpl.java:541"
        },
        {
          "method": "org.eclipse.xsd.impl.XSDSchemaImpl.validate",
          "source": "XSDSchemaImpl.java:1493"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "69999",
      "date": "2004-07-14T11:53:36+02:00",
      "product": "MDT",
      "component": "XSD",
      "severity": "normal"
    }
  ],
  "groupId": "69999",
  "bugId": "69999",
  "date": "2004-07-14T11:53:36+02:00",
  "product": "MDT",
  "component": "XSD",
  "severity": "normal"
}