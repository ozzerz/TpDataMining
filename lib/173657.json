{
  "comments": [
    "Build ID: Eclipse 3.3M4\n\nSteps To Reproduce:\nIt seems the new code added in Eclipse 3.3M4 is not checking for a Nullpointer.\n\nIn WorkbenchMenuService.releaseContributions(ContributionManager mgr), the first line of the code needs to do a nullpointer check.\n\nIn the ToolBarContributionItem that we have created, always has a null ToolbarManager for some reason, even though we call super(). It would be better if Eclipse would check for the null so that the Workbench can exist nicely.\n\nMore information:\nStacktrace of what happens without the null check\n\n!ENTRY org.eclipse.ui.workbench 4 2 2007-02-09 10:41:59.707\n!MESSAGE Problems occurred when invoking code from plug-in: \"org.eclipse.ui.workbench\".\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.ui.internal.menus.WorkbenchMenuService.releaseContributions(WorkbenchMenuService.java)\n\tat org.eclipse.ui.internal.menus.WorkbenchMenuService.releaseContributions(WorkbenchMenuService.java)\n\tat org.eclipse.ui.internal.menus.WindowMenuService.releaseContributions(WindowMenuService.java:125)\n\tat org.eclipse.ui.internal.ViewReference.doDisposePart(ViewReference.java:101)\n\tat org.eclipse.ui.internal.WorkbenchPartReference.dispose(WorkbenchPartReference.java:642)\n\tat org.eclipse.ui.internal.WorkbenchPage.disposePart(WorkbenchPage.java:1533)\n\tat org.eclipse.ui.internal.WorkbenchPage.partRemoved(WorkbenchPage.java:1525)\n\tat org.eclipse.ui.internal.ViewFactory.releaseView(ViewFactory.java:252)\n\tat org.eclipse.ui.internal.Perspective.dispose(Perspective.java:259)\n\tat org.eclipse.ui.internal.WorkbenchPage.dispose(WorkbenchPage.java:1589)\n\tat org.eclipse.ui.internal.WorkbenchWindow.closeAllPages(WorkbenchWindow.java:747)\n\tat org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:1481)\n\tat org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:621)\n\tat org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:597)\n\tat org.eclipse.ui.internal.WorkbenchWindow$2.run(WorkbenchWindow.java:712)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n\tat org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:710)\n\tat org.eclipse.jface.window.WindowManager.close(WindowManager.java:109)\n\tat org.eclipse.ui.internal.Workbench$12.run(Workbench.java:719)\n\tat org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)\n\tat org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:716)\n\tat org.eclipse.ui.internal.Workbench.access$8(Workbench.java:645)\n\tat org.eclipse.ui.internal.Workbench$15.run(Workbench.java:863)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n\tat org.eclipse.ui.internal.Workbench.close(Workbench.java:861)\n\tat org.eclipse.ui.internal.Workbench.close(Workbench.java:833)\n\tat org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:618)\n\tat org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:597)\n\tat org.eclipse.ui.internal.WorkbenchWindow$2.run(WorkbenchWindow.java:712)\n\tat org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)\n\tat org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:710)\n\tat org.eclipse.jface.window.Window.handleShellCloseEvent(Window.java:736)\n\tat org.eclipse.jface.window.Window$3.shellClosed(Window.java:682)\n\tat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:159)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:928)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:952)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:937)\n\tat org.eclipse.swt.widgets.Decorations.closeWidget(Decorations.java:301)\n\tat org.eclipse.swt.widgets.Decorations.WM_CLOSE(Decorations.java:1621)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3374)\n\tat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1554)\n\tat org.eclipse.swt.widgets.Shell.windowProc(Shell.java:1728)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4134)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2171)\n\tat org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:456)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3460)\n\tat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1554)\n\tat org.eclipse.swt.widgets.Shell.windowProc(Shell.java:1728)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4134)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2171)\n\tat org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:456)\n\tat org.eclipse.swt.widgets.Control.windowProc(Control.java:3460)\n\tat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1554)\n\tat org.eclipse.swt.widgets.Shell.windowProc(Shell.java:1728)\n\tat org.eclipse.swt.widgets.Display.windowProc(Display.java:4134)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)\n\tat org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2176)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3077)\n\tat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1945)\n\tat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1909)\n\tat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:425)\n\tat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n\tat org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:615)\n\tat org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:522)\n\tat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:147)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:104)\n\tat org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:74)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)\n\tat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:170)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:615)\n\tat org.eclipse.core.launcher.Main.invokeFramework(Main.java:339)\n\tat org.eclipse.core.launcher.Main.basicRun(Main.java:283)\n\tat org.eclipse.core.launcher.Main.run(Main.java:984)\n\tat org.eclipse.core.launcher.Main.main(Main.java:959)",
    "Sorry, that toolbar manager is coming from the ViewActionBars ... which should be fileld from IActionBarPresentationFactory#createViewToolBarManager() ... are you providing your own presentation factory?  What do you return from this method?\n\nPW\n",
    "Please re-open with info.\nPW\n",
    "(In reply to comment #0)\n\u003e \n\u003e In the ToolBarContributionItem that we have created, always has a null\n\u003e ToolbarManager for some reason, even though we call super(). It would be better\n\u003e if Eclipse would check for the null so that the Workbench can exist nicely.\n\nIt is possible for getToolBarManager() to return null if the contribution item has been disposed.  If your TBCI always returns null that\u0027s bad, but this particular problem is likely caused by workbench event ordering.\n\nInvestigating.\n\nPW\n",
    "Created an attachment (id\u003d68006)\nNPE protect v01\n\n",
    "Tod and Kim, could you please review?\nPW\n",
    "I\u0027d like some clarification before I give a +1 to this.  This seems to be implying that some of our managers are being disposed outside of the normal lifecycle for IMenuService.  If we\u0027ve previously called populateContributionManager with a given manager and later are unable to call releaseContributions we will have leaked the manager - it\u0027s used as a key to a map within the WorkbenchMenuService.  Are we sure this isn\u0027t happening in this case?",
    "I\u0027ve gone back over the view dispose cycle and it by itself will not cause an NPE.\n\nPlease provide more info ASAP if you would like this addressed for 3.3.\n\nWhat object is being passed into releaseContributions(*) in ViewReference.doDisposePart(ViewReference.java:101).\n\nWhat does it contain?\n\nPlease re-open with more info.\n\n\nPW\n"
  ],
  "commentCreationDates": [
    "2007-02-09T15:47:12+01:00",
    "2007-02-09T16:28:08+01:00",
    "2007-02-16T12:28:03+01:00",
    "2007-02-20T13:37:59+01:00",
    "2007-05-21T20:01:42+02:00",
    "2007-05-22T15:20:31+02:00",
    "2007-05-22T15:43:03+02:00",
    "2007-05-22T15:54:19+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.ui.internal.menus.WorkbenchMenuService.releaseContributions",
          "source": "WorkbenchMenuService.java"
        },
        {
          "method": "org.eclipse.ui.internal.menus.WorkbenchMenuService.releaseContributions",
          "source": "WorkbenchMenuService.java"
        },
        {
          "method": "org.eclipse.ui.internal.menus.WindowMenuService.releaseContributions",
          "source": "WindowMenuService.java:125"
        },
        {
          "method": "org.eclipse.ui.internal.ViewReference.doDisposePart",
          "source": "ViewReference.java:101"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPartReference.dispose",
          "source": "WorkbenchPartReference.java:642"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.disposePart",
          "source": "WorkbenchPage.java:1533"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.partRemoved",
          "source": "WorkbenchPage.java:1525"
        },
        {
          "method": "org.eclipse.ui.internal.ViewFactory.releaseView",
          "source": "ViewFactory.java:252"
        },
        {
          "method": "org.eclipse.ui.internal.Perspective.dispose",
          "source": "Perspective.java:259"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPage.dispose",
          "source": "WorkbenchPage.java:1589"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.closeAllPages",
          "source": "WorkbenchWindow.java:747"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.hardClose",
          "source": "WorkbenchWindow.java:1481"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.busyClose",
          "source": "WorkbenchWindow.java:621"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.access$0",
          "source": "WorkbenchWindow.java:597"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow$2.run",
          "source": "WorkbenchWindow.java:712"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.close",
          "source": "WorkbenchWindow.java:710"
        },
        {
          "method": "org.eclipse.jface.window.WindowManager.close",
          "source": "WindowManager.java:109"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$12.run",
          "source": "Workbench.java:719"
        },
        {
          "method": "org.eclipse.core.runtime.SafeRunner.run",
          "source": "SafeRunner.java:37"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.busyClose",
          "source": "Workbench.java:716"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$8",
          "source": "Workbench.java:645"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$15.run",
          "source": "Workbench.java:863"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.close",
          "source": "Workbench.java:861"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.close",
          "source": "Workbench.java:833"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.busyClose",
          "source": "WorkbenchWindow.java:618"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.access$0",
          "source": "WorkbenchWindow.java:597"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow$2.run",
          "source": "WorkbenchWindow.java:712"
        },
        {
          "method": "org.eclipse.swt.custom.BusyIndicator.showWhile",
          "source": "BusyIndicator.java:67"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchWindow.close",
          "source": "WorkbenchWindow.java:710"
        },
        {
          "method": "org.eclipse.jface.window.Window.handleShellCloseEvent",
          "source": "Window.java:736"
        },
        {
          "method": "org.eclipse.jface.window.Window$3.shellClosed",
          "source": "Window.java:682"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:159"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:66"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:928"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:952"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:937"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.closeWidget",
          "source": "Decorations.java:301"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.WM_CLOSE",
          "source": "Decorations.java:1621"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3374"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1554"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.windowProc",
          "source": "Shell.java:1728"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4134"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2171"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.callWindowProc",
          "source": "Shell.java:456"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3460"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1554"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.windowProc",
          "source": "Shell.java:1728"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4134"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProcW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "OS.java:2171"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.callWindowProc",
          "source": "Shell.java:456"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:3460"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1554"
        },
        {
          "method": "org.eclipse.swt.widgets.Shell.windowProc",
          "source": "Shell.java:1728"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:4134"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessageW",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DispatchMessage",
          "source": "OS.java:2176"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:3077"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1945"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runUI",
          "source": "Workbench.java:1909"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.createAndRunWorkbench",
          "source": "Workbench.java:425"
        },
        {
          "method": "org.eclipse.ui.PlatformUI.createAndRunWorkbench",
          "source": "PlatformUI.java:149"
        },
        {
          "method": "org.eclipse.ui.internal.ide.IDEApplication.run",
          "source": "IDEApplication.java:95"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod",
          "source": "EclipseAppContainer.java:522"
        },
        {
          "method": "org.eclipse.equinox.internal.app.EclipseAppHandle.run",
          "source": "EclipseAppHandle.java:147"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication",
          "source": "EclipseAppLauncher.java:104"
        },
        {
          "method": "org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start",
          "source": "EclipseAppLauncher.java:74"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:354"
        },
        {
          "method": "org.eclipse.core.runtime.adaptor.EclipseStarter.run",
          "source": "EclipseStarter.java:170"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:64"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:43"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:615"
        },
        {
          "method": "org.eclipse.core.launcher.Main.invokeFramework",
          "source": "Main.java:339"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:283"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:984"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:959"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "173657",
      "date": "2007-02-09T15:47:12+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "173657",
  "bugId": "173657",
  "date": "2007-02-09T15:47:12+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}