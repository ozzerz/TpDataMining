{
  "comments": [
    "Driver:  WTP 1.5.4 20070406 driver\n\nWhen invoking the popup for \"generate sample JSP\", there\u0027s a NPE:\n\nIWAB0014E Unexpected exception occured.\n  \n      java.lang.NullPointerException\n      at org.eclipse.jst.ws.internal.consumption.ui.command.data.EclipseIPath2URLStringTransformer.transform(EclipseIPath2URLStringTransformer.java:23)\n      at org.eclipse.wst.command.internal.env.core.data.DataFlowManager.invokeMethod(DataFlowManager.java:264)\n      at org.eclipse.wst.command.internal.env.core.data.DataFlowManager.process(DataFlowManager.java:124)\n      at org.eclipse.wst.command.internal.env.core.fragment.CommandFragmentEngine.runCommand(CommandFragmentEngine.java:407)",
    "The Problem:\n\nNPE when selecting \"Generate sample JSPs\" on a Java bean.\n\nThe Cause:\n\nWhen the \"generate sample JSPs\" popup is selected on a proxy bean in the Java prespective, the initial selection is a compilation unit.  The GenSampleWidgetBinding calls WSDLSelectionWidgetDefaultingCommand, which used to return a empty string \"\" since it\u0027s not a type the WSDLSelectionWidgetDefaultingCommand recognize and can turn into a WSDL uri in getWebServiceURI().  With the newly added call to AdatperUtils.getAdaptedWSDL() for types that WSDLSelectionWidgetDefaultingCommand does not recognize, it\u0027s now returning null since no adapter is found for ICompilationUnit.  This null value returned by getWebServiceURI() is causing a NPE when this WebServiceURI gets passed down to other commands.\n\nThe Fix:\n\nCheck for non-null value before assigning the Web service URI.  If AdatperUtils.getAdaptedWSDL() returns null, WSDLSelectionWidgetDefaultingCommand would now returns \"\" as before.\n\nThe fix is a 2 line change in WSDLSelectionWidgetDefaultingCommand (patch will be attached in the following comment).\n\nTesting:\n\nThis has been tested in WTP 1.5.4 and in the adopter product where this problem was found.  I\u0027ve tested \"Generate sample JSP\", \"Generate Client\" on an IFile and ICompilationUnit.  I\u0027ve also tested to make sure when a non-null value is actually returned by AdapterUtils.getAdaptedWSDL(), the code is working as expected.\n\nIn addiiton, I\u0027ve searched for other cases where AdapterUtils.getAdaptedWSDL() and getAdaptedObject() is called to make sure that nulls are handled correctly. WSDLSelectionWidgetDefaultingCommand is the only command that needs to change as indicated above.\n \nPlease review and bring it up for PMC approval for WTP 1.5.4.\n",
    "Created an attachment (id\u003d63423)\npatch\n\n",
    "Kathy, the net effect of the fix as I\u0027m reading it is to not accidentally degrade a \"\" URI string to a null when no adapter is found. Let me know if I haven\u0027t grokked this right. Otherwise, the fix is simple and clean.\n\nFYI, I\u0027ve double checked PopupTestWSDL and PopupTestService, the only other classes that use getAdaptedWSDL similarly to WSDLSelectionWidgetDefaultingCommand, and am satisfied that they are/were already able to handle nulls (and, besides, are not called from another operation the way WSDLSelectionWidgetDefaultCommand is called by GenSampleWidgetBinding).\n\nPMC, would you please approve this fix so that we can restore the Generate Sample JSPs popup action to a happy state?\n\nThanks, CB.",
    "Yes, Chris.  You\u0027re correct. The net effect of the fix is to not accidentally\ndegrade a \"\" URI string to a null when no adapter is found.",
    "+1\n",
    "+1",
    "Patch committed to R1_5_maintenance and HEAD.  Released to WTP 1.5.4 as v200704111854 and to WTP 2.0 as v200704112139.",
    "Verified on WTP 2.0 04/26 driver.",
    "Also verified on WTP 1.5.4 04/26 driver."
  ],
  "commentCreationDates": [
    "2007-04-10T21:08:25+02:00",
    "2007-04-10T21:49:58+02:00",
    "2007-04-10T21:50:44+02:00",
    "2007-04-10T22:24:45+02:00",
    "2007-04-10T22:38:15+02:00",
    "2007-04-10T23:56:39+02:00",
    "2007-04-11T19:27:25+02:00",
    "2007-04-11T23:50:33+02:00",
    "2007-05-01T20:10:49+02:00",
    "2007-05-01T20:22:37+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jst.ws.internal.consumption.ui.command.data.EclipseIPath2URLStringTransformer.transform",
          "source": "EclipseIPath2URLStringTransformer.java:23"
        },
        {
          "method": "org.eclipse.wst.command.internal.env.core.data.DataFlowManager.invokeMethod",
          "source": "DataFlowManager.java:264"
        },
        {
          "method": "org.eclipse.wst.command.internal.env.core.data.DataFlowManager.process",
          "source": "DataFlowManager.java:124"
        },
        {
          "method": "org.eclipse.wst.command.internal.env.core.fragment.CommandFragmentEngine.runCommand",
          "source": "CommandFragmentEngine.java:407"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "181827",
      "date": "2007-04-10T21:08:25+02:00",
      "product": "Web Tools",
      "component": "jst.ws",
      "severity": "critical"
    }
  ],
  "groupId": "181827",
  "bugId": "181827",
  "date": "2007-04-10T21:08:25+02:00",
  "product": "Web Tools",
  "component": "jst.ws",
  "severity": "critical"
}