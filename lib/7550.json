{
  "comments": [
    "Build 137\n\nFrom EC post \"Re: Problems with ScrolledComposite\" by Paul T. Keyser:\n\nOr maybe this should be entitled \"is this an Eclipse-gui bug?\"  Still R1.0,\nbuild 137, Win2K\n\nThanks to Veronica Irvine, I now have the ScrolledComposite working, but in\nthe process I staggered over another problem, in fact caused by my\nforgetting a line of code -- but the response of the Eclipse was odd (threw\nan exception deep in its own code and did strange things with the Tasks\nView) so I wondered if there were a bug or something. (Running my new View\nin the runtime workspace; no deployment.)\n\nI was trying to copy and play with the code from the\norg.eclipse.swt.examples.controlexample.TableTab, and so I made a little\nview with a Table and a Button(SWT.CHECK) which toggled the Table between\nSINGLE and MULTI selection (they were both inside the ScrolledComposite);\njust as in the example, to do that I disposed the widgets and recreated\nthem.  When I do it correctly, it works; but when I (throiugh sheer\nabsentmindedness) forgot to dispose the ScrolledComposite, the redrawn View\nsure enough showed an extra empty ScrolledComposite -- and ONLY when I\nperformed certain other gui operations did any error occur (a MessageBox\npops up saying \"An internal error has occurred. Widget is disposed. See\nerror log for more details.\"); stack trace below.\n\nA) If I have my new View tiled atop the ErrorLog or the Tasks View, then the\nerror occurs when I select either of those Views, AND then (once I dismiss\nthe dialog and move the mouse to over the area covered by the new View) the\n*selected* View (i.e., Tasks or ErrorLog) is being dragged (only the tiling\nor docking cursor appears) -- I can see the call stack below once I stop\ndragging;\n\nB) If I have my new View docked and not tiled, then the error occurs when I\ndrag and tile my new View (atop the ErrorLog, or atop the Tasks View, or\natop the tiled both of them), AND then the runtime workspace appears frozen\n(in fact I cannot get to the ErrorLog to view the stack trace); if I drag\nand dock or float my new View, then the gui is not frozen, and the call\nstack is as below.\n\nHere is the code from my View (it is in the \"general\" category of\norg.eclipse.ui), minus the table-populating code (which I assume is\nirrelevant to this issue); uncomment the line marked @@@@@@@@@ to see it\nwork correctly, leave that line commented out to see it bomb (as before, the\nmethods of the class Utils do just what you\u0027d expect):\n\npublic class Disposer extends ViewPart {\n    public Disposer() {\n    }\n\n    public void createPartControl(Composite parent)  {\n        this.parent \u003d parent;\n        this.parent.setLayout(Utils.createGridLayout(2, true));\n        createWidgets();\n    }\n\n    private void createWidgets() {\n        this.widgets.clear();\n\n        ScrolledComposite scroller \u003d new ScrolledComposite(this.parent,\n             SWT.H_SCROLL | SWT.V_SCROLL | SWT.BORDER);\n        scroller.setLayoutData(new GridData(GridData.FILL_BOTH));\n        Composite rhs \u003d new Composite(scroller, SWT.BORDER);\n        scroller.setContent(rhs);\n\n        rhs.setLayout(Utils.createGridLayout(1, true));\n        createSelectionButton(rhs, 1);\n        createTable(rhs, 1);\n\n        // these lines must come AFTER creation of Button \u0026 Table\n        scroller.setAlwaysShowScrollBars(true);\n        scroller.setExpandHorizontal(true);\n        scroller.setExpandVertical(true);\n        Point pt \u003d rhs.computeSize(SWT.DEFAULT, SWT.DEFAULT);\n        scroller.setMinHeight(pt.y); scroller.setMinWidth(pt.x);\n\n        this.widgets.add(rhs);\n        // this.widgets.add(scroller); @@@@@@@@@\n    }\n\n    private void createSelectionButton(Composite parent, int width) {\n        this.select \u003d new Button(parent, SWT.CHECK);\n        this.select.setText(\"allow multiple selection?\");\n        this.select.setSelection(this.allowMultiple);\n        this.select.addSelectionListener(new SelectionAdapter() {\n            public void widgetSelected(SelectionEvent event) {\n                Disposer.this.toggleSelectionState();\n            }\n        });\n        this.select.setLayoutData(\n            Utils.createGridData(GridData.FILL, GridData.FILL, width, 1,\ntrue, true));\n        // \"true, true\": grabExcess{H, V}Space\n        this.widgets.add(this.select);\n    }\n\n    private void createTable(Composite parent, int width) {\n        this.trapeza \u003d new Table(parent,\n                (allowMultiple ? SWT.MULTI : SWT.SINGLE) |\nSWT.FULL_SELECTION | SWT.BORDER);\n        this.trapeza.setHeaderVisible(true);\n        this.trapeza.setLinesVisible(true);\n        this.trapeza.setLayoutData(// w/out this, Table lacks scrollers\n            Utils.createGridData(GridData.FILL, GridData.FILL, width, 1,\ntrue, true));\n        /* Fill the table with data .... */\n        this.widgets.add(this.trapeza);\n    } // end createTable()\n\n    public void setFocus()  {\n        this.trapeza.setFocus();\n    }\n\n    private void redraw() {\n        for (int i \u003d 0; i \u003c this.widgets.size(); ++i) {\n            ((Control) this.widgets.elementAt(i)).dispose();\n        }\n        createWidgets();\n        for (int i \u003d 0; i \u003c this.widgets.size(); ++i) {\n            Control c \u003d (Control) this.widgets.elementAt(i);\n            c.setEnabled(true);\n            c.setVisible(true);\n        }\n        this.parent.layout();\n    } // end redraw()\n\n    private void toggleSelectionState() {\n        this.allowMultiple \u003d this.select.getSelection();\n        this.redraw();\n    }\n\n    private Composite parent;\n    private Table trapeza;\n    private Button select;\n\n    private Vector widgets \u003d new Vector(5);\n    private boolean allowMultiple \u003d false;\n\n} // end class Disposer\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\norg.eclipse.swt.SWTException: Widget is disposed\n at org.eclipse.swt.SWT.error(SWT.java:1708)\n at org.eclipse.swt.SWT.error(SWT.java:1642)\n at org.eclipse.swt.widgets.Widget.error(Widget.java:368)\n at org.eclipse.swt.widgets.Control.getDisplay(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Widget.isValidThread(Widget.java(Compiled Code))\n\n at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java(Compiled Code))\n at org.eclipse.swt.widgets.Control.getBounds(Control.java:552)\n at\norg.eclipse.swt.custom.ScrolledComposite.resize(ScrolledComposite.java:198)\n at\norg.eclipse.swt.custom.ScrolledComposite.access$2(ScrolledComposite.java:193)\n\n at\norg.eclipse.swt.custom.ScrolledComposite$3.handleEvent\n(ScrolledComposite.java:125)\n\n at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:819)\n at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:810)\n at org.eclipse.swt.widgets.Control.WM_SIZE(Control.java:3253)\n at org.eclipse.swt.widgets.Scrollable.WM_SIZE(Scrollable.java:235)\n at org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:512)\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.DefWindowProc(Native Method)\n at\norg.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.EndDeferWindowPos(Native Method)\n at org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:526)\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.DefWindowProc(Native Method)\n at\norg.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.EndDeferWindowPos(Native Method)\n at org.eclipse.swt.widgets.Composite.WM_SIZE(Composite.java:526)\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.DefWindowProc(Native Method)\n at\norg.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))\n at org.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))\n at org.eclipse.swt.internal.win32.OS.SetWindowPos(Native Method)\n at org.eclipse.swt.widgets.Control.setBounds(Control.java:1484)\n at org.eclipse.swt.widgets.Control.setBounds(Control.java:1470)\n at org.eclipse.swt.widgets.Control.setBounds(Control.java:1517)\n at org.eclipse.ui.internal.LayoutPart.setBounds(LayoutPart.java:151)\n at org.eclipse.ui.internal.LayoutPart.setBounds(LayoutPart.java:143)\n at\norg.eclipse.ui.internal.PartTabFolder.setSelection(PartTabFolder.java:788)\n at org.eclipse.ui.internal.PartTabFolder.access$3(PartTabFolder.java:781)\n at\norg.eclipse.ui.internal.PartTabFolder$2.handleEvent(PartTabFolder.java:175)\n at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:634)\n at\norg.eclipse.swt.custom.CTabFolder.setSelectionNotify(CTabFolder.java:1533)\n at org.eclipse.swt.custom.CTabFolder.onMouseUp(CTabFolder.java:1012)\n at org.eclipse.swt.custom.CTabFolder.handleEvents(CTabFolder.java:613)\n at org.eclipse.swt.custom.CTabFolder.access$0(CTabFolder.java:601)\n at org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:182)\n at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled\nCode))\n at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:634)\n at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1282)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1092)\n at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:673)\n at org.eclipse.ui.internal.Workbench.run(Workbench.java:656)\n at\norg.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:815)\n\n at org.eclipse.core.boot.BootLoader.run(BootLoader.java:285)\n at java.lang.reflect.Method.invoke(Native Method)\n at org.eclipse.core.launcher.Main.basicRun(Main.java:151)\n at org.eclipse.core.launcher.Main.run(Main.java:433)\n at org.eclipse.core.launcher.UIMain.main(UIMain.java:52)",
    "Investigate whether this is still a problem in 2.0.\nIf so, we should make the workbench more resilient to parts\u0027 failure to dispose.",
    "I forgot to mention on the newsgroup that to see the effect, you must first \nclick the checkbox!  (dragging the view before you do that causes no problems) ",
    "Could not reproduce it in 2.0 (latest).\nGot the exception as expected but the workbench did not crash.\nI had to guess what Utils.*** does.\n\nPlease reopen this bug report if this is still a problem for you."
  ],
  "commentCreationDates": [
    "2002-01-14T17:01:54+01:00",
    "2002-01-14T17:03:13+01:00",
    "2002-01-14T18:17:28+01:00",
    "2002-02-12T18:44:51+01:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.swt.SWTException",
      "message": "Widget is disposed",
      "elements": [
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:1708"
        },
        {
          "method": "org.eclipse.swt.SWT.error",
          "source": "SWT.java:1642"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.error",
          "source": "Widget.java:368"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.getDisplay",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.isValidThread",
          "source": "Widget.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.checkWidget",
          "source": "Widget.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.getBounds",
          "source": "Control.java:552"
        },
        {
          "method": "org.eclipse.swt.custom.ScrolledComposite.resize",
          "source": "ScrolledComposite.java:198"
        },
        {
          "method": "org.eclipse.swt.custom.ScrolledComposite.access$2",
          "source": "ScrolledComposite.java:193"
        },
        {
          "method": "org.eclipse.swt.custom.ScrolledComposite$3.handleEvent",
          "source": "ScrolledComposite.java:125"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:819"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:810"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_SIZE",
          "source": "Control.java:3253"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.WM_SIZE",
          "source": "Scrollable.java:235"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_SIZE",
          "source": "Composite.java:512"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.EndDeferWindowPos",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_SIZE",
          "source": "Composite.java:526"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.EndDeferWindowPos",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Composite.WM_SIZE",
          "source": "Composite.java:526"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.DefWindowProc",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Scrollable.callWindowProc",
          "source": "Scrollable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.SetWindowPos",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setBounds",
          "source": "Control.java:1484"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setBounds",
          "source": "Control.java:1470"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.setBounds",
          "source": "Control.java:1517"
        },
        {
          "method": "org.eclipse.ui.internal.LayoutPart.setBounds",
          "source": "LayoutPart.java:151"
        },
        {
          "method": "org.eclipse.ui.internal.LayoutPart.setBounds",
          "source": "LayoutPart.java:143"
        },
        {
          "method": "org.eclipse.ui.internal.PartTabFolder.setSelection",
          "source": "PartTabFolder.java:788"
        },
        {
          "method": "org.eclipse.ui.internal.PartTabFolder.access$3",
          "source": "PartTabFolder.java:781"
        },
        {
          "method": "org.eclipse.ui.internal.PartTabFolder$2.handleEvent",
          "source": "PartTabFolder.java:175"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:634"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.setSelectionNotify",
          "source": "CTabFolder.java:1533"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.onMouseUp",
          "source": "CTabFolder.java:1012"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.handleEvents",
          "source": "CTabFolder.java:613"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder.access$0",
          "source": "CTabFolder.java:601"
        },
        {
          "method": "org.eclipse.swt.custom.CTabFolder$1.handleEvent",
          "source": "CTabFolder.java:182"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.notifyListeners",
          "source": "Widget.java:634"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runDeferredEvents",
          "source": "Display.java:1282"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1092"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:673"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:656"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:815"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:285"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:151"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:433"
        },
        {
          "method": "org.eclipse.core.launcher.UIMain.main",
          "source": "UIMain.java:52"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "7550",
      "date": "2002-01-14T17:01:54+01:00",
      "product": "Platform",
      "component": "UI",
      "severity": "normal"
    }
  ],
  "groupId": "7550",
  "bugId": "7550",
  "date": "2002-01-14T17:01:54+01:00",
  "product": "Platform",
  "component": "UI",
  "severity": "normal"
}