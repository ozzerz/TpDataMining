{
  "comments": [
    "I\u0027m working on moving the workspace selection data from a private file to some \nconfig area preferences.  I test this in the runtime workbench by putting a \nvalue of @noDefault into the Workspace Data, Location field.  Since \nIDEApplication will not run without a workspace, this will cause the \nIDEApplication to open the workspace selection dialog.\n\nThe problem I have is when I try to access a preference that does not exist yet. \n My code is something like this:\n\n    \tIPreferenceStore store \u003d new ScopedPreferenceStore(\n\t\t\t\tnew ConfigurationScope(), PlatformUI.PLUGIN_ID);\n    \tshowDialog \u003d store.getBoolean(\"SHOW_WORKSPACE_SELECTION_DIALOG\");\n\nWhen the value is looked up inside of #getBoolean, its not found in the config \narea (this is the first run) so the default area is examined.  It seems to be \nduring this part that there\u0027s an attempt to access the instance area, which \ndoesn\u0027t exist yet, which raises the following exception.\n\nPerhaps there could be a setting on ScopedPreferenceStore to avoid looking in \nthe default area?  Or perhaps there\u0027s a difference store that I should be using?\n\n------------------------------------------\n\njava.lang.IllegalStateException: The instance data location has not been \nspecified yet.\n\tat org.eclipse.core.internal.runtime.DataArea.\nassertLocationInitialized(DataArea.java:42)\n\tat org.eclipse.core.internal.runtime.DataArea.getStateLocation(DataArea.\njava:81)\n\tat org.eclipse.core.internal.preferences.InstancePreferences.\ngetBaseLocation(InstancePreferences.java:41)\n\tat org.eclipse.core.internal.preferences.InstancePreferences.\ninitializeChildren(InstancePreferences.java:187)\n\tat org.eclipse.core.internal.preferences.InstancePreferences.\n\u003cinit\u003e(InstancePreferences.java:55)\n\tat org.eclipse.core.internal.preferences.InstancePreferences.\ninternalCreate(InstancePreferences.java:197)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\ncreate(EclipsePreferences.java:272)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\ncreate(EclipsePreferences.java:268)\n\tat org.eclipse.core.internal.preferences.PreferencesService.\ncreateNode(PreferencesService.java:352)\n\tat org.eclipse.core.internal.preferences.RootPreferences.\ngetChild(RootPreferences.java:63)\n\tat org.eclipse.core.internal.preferences.RootPreferences.\nnode(RootPreferences.java:90)\n\tat org.eclipse.core.internal.preferences.AbstractScope.\ngetNode(AbstractScope.java:39)\n\tat org.eclipse.ui.preferences.ScopedPreferenceStore.\ngetStorePreferences(ScopedPreferenceStore.java:183)\n\tat org.eclipse.ui.preferences.ScopedPreferenceStore.\n\u003cinit\u003e(ScopedPreferenceStore.java:119)\n\tat org.eclipse.ui.plugin.AbstractUIPlugin.\ngetPreferenceStore(AbstractUIPlugin.java:279)\n\tat org.eclipse.ui.internal.UIPreferenceInitializer.\ninitializeDefaultPreferences(UIPreferenceInitializer.java:28)\n\tat org.eclipse.core.internal.preferences.DefaultPreferences.\nrunInitializer(DefaultPreferences.java:157)\n\tat org.eclipse.core.internal.preferences.DefaultPreferences.\napplyRuntimeDefaults(DefaultPreferences.java:189)\n\tat org.eclipse.core.internal.preferences.DefaultPreferences.\nloadDefaults(DefaultPreferences.java:321)\n\tat org.eclipse.core.internal.preferences.DefaultPreferences.\nload(DefaultPreferences.java:317)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\ncreate(EclipsePreferences.java:292)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\ngetChild(EclipsePreferences.java:381)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\ninternalNode(EclipsePreferences.java:518)\n\tat org.eclipse.core.internal.preferences.EclipsePreferences.\nnode(EclipsePreferences.java:650)\n\tat org.eclipse.core.internal.preferences.AbstractScope.\ngetNode(AbstractScope.java:39)\n\tat org.eclipse.ui.preferences.ScopedPreferenceStore.\ngetPreferenceNodes(ScopedPreferenceStore.java:221)\n\tat org.eclipse.ui.preferences.ScopedPreferenceStore.\ninternalGet(ScopedPreferenceStore.java:373)\n\tat org.eclipse.ui.preferences.ScopedPreferenceStore.\ngetBoolean(ScopedPreferenceStore.java:305)\n\tat org.eclipse.ui.internal.ide.ChooseWorkspaceData.\nreadPersistedData_pref(ChooseWorkspaceData.java:325)",
    "The problem isn\u0027t where I described before.  The class mentioned there is \nprovided by UI to manage our own preference lookup.  I\u0027ve changed my code so \nthat it doesn\u0027t use that class and fixed the problem.\n\nFor future reference...\n\n1. The prefs FAQ is at http://dev.eclipse.org/viewcvs/index.\ncgi/~checkout~/platform-core-home/documents/user_settings/faq.html\n\n2. My code looks like:\n\n    String qualifier \u003d PlatformUI.PLUGIN_ID;\n    Preferences node \u003d Platform.getPreferencesService().getRootNode().node(\n\t\t\t\tConfigurationScope.SCOPE).node(qualifier);\n\n    node.getBoolean(\n        IWorkbenchPreferenceConstants.SHOW_WORKSPACE_SELECTION_DIALOG,\n        true);",
    "Here\u0027s the stack trace for the code that seems to prevent me from getting a \ndefault configuration preference.",
    "Fixed when fixing bug 75209.\n\nOld code used to call Platform#getLocation and use the fact that it was null to\nindicate whether or not the instance area had been set. This is not good enough\nso we have changed the code to check for null and to call Location#isSet on the\nreturned non-null location object."
  ],
  "commentCreationDates": [
    "2004-09-28T16:48:54+02:00",
    "2004-09-28T18:40:26+02:00",
    "2004-09-29T16:56:26+02:00",
    "2004-09-29T21:05:34+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.IllegalStateException",
      "message": "The instance data location has not been  specified yet.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.runtime.DataArea.assertLocationInitialized",
          "source": "DataArea.java:42"
        },
        {
          "method": "org.eclipse.core.internal.runtime.DataArea.getStateLocation",
          "source": "DataArea. java:81"
        },
        {
          "method": "org.eclipse.core.internal.preferences.InstancePreferences.getBaseLocation",
          "source": "InstancePreferences.java:41"
        },
        {
          "method": "org.eclipse.core.internal.preferences.InstancePreferences.initializeChildren",
          "source": "InstancePreferences.java:187"
        },
        {
          "method": "org.eclipse.core.internal.preferences.InstancePreferences.\u003cinit\u003e",
          "source": "InstancePreferences.java:55"
        },
        {
          "method": "org.eclipse.core.internal.preferences.InstancePreferences.internalCreate",
          "source": "InstancePreferences.java:197"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.create",
          "source": "EclipsePreferences.java:272"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.create",
          "source": "EclipsePreferences.java:268"
        },
        {
          "method": "org.eclipse.core.internal.preferences.PreferencesService.createNode",
          "source": "PreferencesService.java:352"
        },
        {
          "method": "org.eclipse.core.internal.preferences.RootPreferences.getChild",
          "source": "RootPreferences.java:63"
        },
        {
          "method": "org.eclipse.core.internal.preferences.RootPreferences.node",
          "source": "RootPreferences.java:90"
        },
        {
          "method": "org.eclipse.core.internal.preferences.AbstractScope.getNode",
          "source": "AbstractScope.java:39"
        },
        {
          "method": "org.eclipse.ui.preferences.ScopedPreferenceStore.getStorePreferences",
          "source": "ScopedPreferenceStore.java:183"
        },
        {
          "method": "org.eclipse.ui.preferences.ScopedPreferenceStore.\u003cinit\u003e",
          "source": "ScopedPreferenceStore.java:119"
        },
        {
          "method": "org.eclipse.ui.plugin.AbstractUIPlugin.getPreferenceStore",
          "source": "AbstractUIPlugin.java:279"
        },
        {
          "method": "org.eclipse.ui.internal.UIPreferenceInitializer.initializeDefaultPreferences",
          "source": "UIPreferenceInitializer.java:28"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.runInitializer",
          "source": "DefaultPreferences.java:157"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.applyRuntimeDefaults",
          "source": "DefaultPreferences.java:189"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.loadDefaults",
          "source": "DefaultPreferences.java:321"
        },
        {
          "method": "org.eclipse.core.internal.preferences.DefaultPreferences.load",
          "source": "DefaultPreferences.java:317"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.create",
          "source": "EclipsePreferences.java:292"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.getChild",
          "source": "EclipsePreferences.java:381"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.internalNode",
          "source": "EclipsePreferences.java:518"
        },
        {
          "method": "org.eclipse.core.internal.preferences.EclipsePreferences.node",
          "source": "EclipsePreferences.java:650"
        },
        {
          "method": "org.eclipse.core.internal.preferences.AbstractScope.getNode",
          "source": "AbstractScope.java:39"
        },
        {
          "method": "org.eclipse.ui.preferences.ScopedPreferenceStore.getPreferenceNodes",
          "source": "ScopedPreferenceStore.java:221"
        },
        {
          "method": "org.eclipse.ui.preferences.ScopedPreferenceStore.internalGet",
          "source": "ScopedPreferenceStore.java:373"
        },
        {
          "method": "org.eclipse.ui.preferences.ScopedPreferenceStore.getBoolean",
          "source": "ScopedPreferenceStore.java:305"
        },
        {
          "method": "org.eclipse.ui.internal.ide.ChooseWorkspaceData.readPersistedData_pref",
          "source": "ChooseWorkspaceData.java:325"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "75175",
      "date": "2004-09-28T16:48:54+02:00",
      "product": "Platform",
      "component": "Runtime",
      "severity": "normal"
    }
  ],
  "groupId": "75175",
  "bugId": "75175",
  "date": "2004-09-28T16:48:54+02:00",
  "product": "Platform",
  "component": "Runtime",
  "severity": "normal"
}