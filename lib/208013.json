{
  "comments": [
    "Hello, I am using the Eclipse JDT DOM interface to parse and analyse Java projects.\n\nIn one of the projects I am working with I get the following exception:\n\njava.lang.ClassCastException: org.eclipse.jdt.internal.core.Initializer cannot be cast to org.eclipse.jdt.core.IType\n\tat org.eclipse.jdt.core.dom.MethodBinding.getUnresolvedJavaElement(MethodBinding.java:238)\n\tat org.eclipse.jdt.core.dom.MethodBinding.getJavaElement(MethodBinding.java:231)\n\tat org.eclipse.jdt.astview.views.Binding.getChildren(Binding.java:247)\n\tat org.eclipse.jdt.astview.views.ASTViewContentProvider.getChildren(ASTViewContentProvider.java:95)\n\tat org.eclipse.jdt.astview.views.ASTViewContentProvider.hasChildren(ASTViewContentProvider.java:252)\n\tat org.eclipse.jface.viewers.AbstractTreeViewer.isExpandable(AbstractTreeViewer.java:2021)\n\tat org.eclipse.jface.viewers.TreeViewer.isExpandable(TreeViewer.java:575)\n...\n\nI abstracted the problem to the following program:\n\npublic class Test\n{\n    Object t;\n    private void testMethod() {\n        t \u003d new Object() {\n            Object o; // put this after the Initialization block\n                      // or remove it to avoid error\n\t    {\n\t        Object m \u003d new Object() { // try to resolve the binding of\n                                          // the \"new\" (ClassInstanceCreation)\n                                          // and you get the exception\n                };\n\t    }\n        };\n    }\n}\n\nThe problem is not only in my own implementation using the DOM API, but you can reproduce it using the Eclipse AST Viewer (http://www.eclipse.org/jdt/ui/update-site). View the class above in the ASTView, select the innermost new Object() and click \"Show AST of active editor (F5)\" in the ASTView. You will get the exception described.\n\nThe problem seems to be, that the code in \"org.eclipse.jdt.core.dom.MethodBinding.getUnresolvedJavaElement(MethodBinding.java:238)\" does not expect to get an Initializer.\n\nI could not test the problem in older Eclipse versions.\n\nI would be happy if this problem could be fixed as soon as possible.\n\nThank you,\nR?diger",
    "Fix for bug 129584 fixed this problem. See bug 149853 for the same stack trace\n\n*** This bug has been marked as a duplicate of bug 129584 ***",
    "Are you sure that you are using 3.3.1?",
    "(In reply to comment #2)\n\u003e Are you sure that you are using 3.3.1?\n\nWell, Eclipse reports in the About Eclipse SDK Dialog Version: 3.3.1.1 Build id: M20071023-1652",
    "(In reply to comment #1)\n\u003e Fix for bug 129584 fixed this problem. See bug 149853 for the same stack trace\n\u003e *** This bug has been marked as a duplicate of bug 129584 ***\n\nHello again. Thank you for your fast feedback. :-)\n\nI don\u0027t think this is a duplicated bug. I was reading the bug reports 129584 and 149853.\n\nFor 129584, I do not see the relation.\n\n149853 seems somewhat related, but the exception comes from a different line number for a different type. The described problem is fixed in my version of Eclipse. I tested the situation also under Eclipse 3.2.2 (M20070212-1330). There bug 149853 does still exist, and my bug as well. I used the Eclipse AST View 1.1.3 in this case.\n\nBut the problem described by me still exists, and now I know it was already there in 3.2.2.\n\nCould anybody reproduce it?\n\nIs it ok, that I marked this bug as \"Reopen bug\"?",
    "(In reply to comment #4)\n\u003e I don\u0027t think this is a duplicated bug. I was reading the bug reports 129584\n\u003e and 149853.\nThis is why I asked what build you are using. If you got the problem with a build post 3.3M1, then this cannot be a duplicate of the bug 129584.",
    "Clear target milestone.",
    "(In reply to comment #6)\n\u003e Clear target milestone.\n\nThank you!",
    "(In reply to comment #4)\n\u003e I don\u0027t think this is a duplicated bug. I was reading the bug reports 129584\n\u003e and 149853.\nSorry I went to fast. I tested with the latest 3.4 build and could not reproduce. Since the trace in bug 149853 looked similar (even though for a different type) I assumed that was the same problem.\n\n\u003e Could anybody reproduce it?\nI could reproduce in the 3.3 maintenance stream. Not in HEAD (the 3.4 development stream). I will try to find out what change made it working in 3.4.\n \n\u003e Is it ok, that I marked this bug as \"Reopen bug\"?\nYes, you did the right thing. \n\n",
    "After investigation, the fix for bug 167357 fixed the problem in HEAD. I\u0027m not sure if we can backport this fix to R3_3_maintenance. We might want to add a workaround instead.",
    "Created an attachment (id\u003d83977)\nProposed workaround and regression test\n\nNote with this workaround, the returned element doesn\u0027t exist, but at least it doesn\u0027t throw a ClassCastException. The real fix would be to backport the fix for bug 167357 which I think is too risky.",
    "Asking PMC approval to add this workaround for 3.3.2. This workaround is safe and it avoids the ClassCastException.",
    "+1 for 3.3.2",
    "Workaround and test released for 3.3.2",
    "J?r?me, I would suggest that you also release ASTModelBridgeTest#testMethod11 in HEAD.",
    "Good suggestion. ASTModelBridgeTest#testMethod11 is now released in HEAD. Note that the expected Java element is different from the one in R3_3_maintenance because of bug 167357 that is fixed in HEAD.",
    "The test is here and runs OK.\nVerified for 3.4 M4 using build I20071211-0010."
  ],
  "commentCreationDates": [
    "2007-10-30T16:00:07+01:00",
    "2007-10-30T19:17:02+01:00",
    "2007-10-30T20:14:26+01:00",
    "2007-10-31T08:29:17+01:00",
    "2007-10-31T08:42:33+01:00",
    "2007-10-31T13:30:52+01:00",
    "2007-10-31T13:31:14+01:00",
    "2007-10-31T14:36:49+01:00",
    "2007-10-31T17:15:11+01:00",
    "2007-10-31T17:59:12+01:00",
    "2007-11-28T14:23:24+01:00",
    "2007-11-28T14:25:23+01:00",
    "2007-12-03T22:02:32+01:00",
    "2007-12-04T08:30:14+01:00",
    "2007-12-12T08:01:47+01:00",
    "2007-12-12T09:28:30+01:00",
    "2007-12-12T14:30:18+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.jdt.internal.core.Initializer cannot be cast to org.eclipse.jdt.core.IType",
      "elements": [
        {
          "method": "org.eclipse.jdt.core.dom.MethodBinding.getUnresolvedJavaElement",
          "source": "MethodBinding.java:238"
        },
        {
          "method": "org.eclipse.jdt.core.dom.MethodBinding.getJavaElement",
          "source": "MethodBinding.java:231"
        },
        {
          "method": "org.eclipse.jdt.astview.views.Binding.getChildren",
          "source": "Binding.java:247"
        },
        {
          "method": "org.eclipse.jdt.astview.views.ASTViewContentProvider.getChildren",
          "source": "ASTViewContentProvider.java:95"
        },
        {
          "method": "org.eclipse.jdt.astview.views.ASTViewContentProvider.hasChildren",
          "source": "ASTViewContentProvider.java:252"
        },
        {
          "method": "org.eclipse.jface.viewers.AbstractTreeViewer.isExpandable",
          "source": "AbstractTreeViewer.java:2021"
        },
        {
          "method": "org.eclipse.jface.viewers.TreeViewer.isExpandable",
          "source": "TreeViewer.java:575"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "208013",
      "date": "2007-10-30T16:00:07+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "208013",
  "bugId": "208013",
  "date": "2007-10-30T16:00:07+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}