{
  "comments": [
    "I200403161300 + new code to use AST on reconcile (not yet in HEAD). Difference\nis that we request the AST.\n\nThis time I have steps :-)\n1. started fresh workspace\n2. create Java project\n3. create package org.eclipse.swt.custom\n4. create empty file StyledText.java\n5. paste StyledText.java into a fresh workspace\n\u003d\u003d\u003e\njava.lang.NullPointerException\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java)\n\tat java.lang.Throwable.\u003cinit\u003e(Throwable.java)\n\tat java.lang.NullPointerException.\u003cinit\u003e(NullPointerException.java:60)\n\tat org.eclipse.jdt.core.dom.TypeBinding.getKey(TypeBinding.java)\n\tat org.eclipse.jdt.core.dom.MethodBinding.getKey(MethodBinding.java)\n\tat\norg.eclipse.jdt.core.dom.DefaultBindingResolver.resolveMethod(DefaultBindingResolver.java:470)\n\tat\norg.eclipse.jdt.core.dom.MethodDeclaration.resolveBinding(MethodDeclaration.java:869)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java)\n\tat\norg.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations(ASTConverter.java:1005)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1132)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java)\n\tat\norg.eclipse.jdt.core.dom.ASTConverter.convertToVariableDeclarationFragment(ASTConverter.java:2710)\n\tat\norg.eclipse.jdt.core.dom.ASTConverter.convertToVariableDeclarationStatement(ASTConverter.java:2737)\n\tat\norg.eclipse.jdt.core.dom.ASTConverter.checkAndAddMultipleLocalDeclaration(ASTConverter.java:384)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1859)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1764)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:2008)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:1788)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java)\n\tat\norg.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations(ASTConverter.java:330)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:268)\n\tat org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:146)\n\tat org.eclipse.jdt.core.dom.AST.convertCompilationUnit(AST.java:233)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.buildStructure(CompilationUnit.java:147)\n\tat org.eclipse.jdt.internal.core.Openable.generateInfos(Openable.java:169)\n\tat org.eclipse.jdt.internal.core.JavaElement.openWhenClosed(JavaElement.java:543)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.makeConsistent(CompilationUnit.java:931)\n\tat\norg.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation(ReconcileWorkingCopyOperation.java:56)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:700)\n\tat\norg.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:739)\n\tat\norg.eclipse.jdt.internal.core.CompilationUnit.reconcile(CompilationUnit.java:1043)\n\tat\norg.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:84)\n\tat\norg.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile(JavaReconcilingStrategy.java:109)\n\tat\norg.eclipse.jface.text.reconciler.CompositeReconcilingStrategy.reconcile(CompositeReconcilingStrategy.java:83)\n\tat\norg.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile(JavaCompositeReconcilingStrategy.java:97)\n\tat org.eclipse.jface.text.reconciler.MonoReconciler.process(MonoReconciler.java:76)\n\tat\norg.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:189)",
    "I will investigate.",
    "Do you have lots of compile error?\nAt step 5, do you mean I should paste the code from the swt plugin replacing the\nempty file StyledText.java?",
    "Yes to both questions.",
    "The problem is that I tried to do exactly this and I could not reproduce.\nI will continue to investigate.",
    "As stated the code is not yet in HEAD. Did you modify the code to reproduce? It\nworks for us when we use reconcile(false /*getAST*/, ...) but not when we use\nreconcile(true, /*getAST*/, ...)",
    "of course it should read: ...when we use reconcile(true /*getAST*/, ...)",
    "I tried to create an AST out of this compilation unit resolving the bindings for\nit and it worked. So far, I was unable to reproduce it.",
    "I will send you a plug-in export of JDT UI this morning where you can see this.",
    "The bug is in the reconcile working copy operation.\nReconcileWorkingCopyOperation Line 71, the call to process will clean up the\ncompilation unit. This clean up resets the scopes to null. But afterwards, the\nDOM/AST is created with binding resolution and this expects the scope to be\navailable.\nSo no scope are available when the getKey() is called on the bindings and this\nleads to a NPE.\nThe scope must be cleaned after the DOM/AST creation, not before.",
    "Changed ReconcileWorkingCopyOperation as well as CompilationUnit.buildStructure\n() to cleanup the compilation unit declaration only after building the AST.\n\nAdded regression tests ASTConverterTest2.test0538f() and test0538g()",
    "Thanks for the quick responcse. This now works and leads us to bug 55362 ;-)"
  ],
  "commentCreationDates": [
    "2004-03-17T15:14:54+01:00",
    "2004-03-17T16:18:48+01:00",
    "2004-03-17T17:05:03+01:00",
    "2004-03-17T17:20:05+01:00",
    "2004-03-17T17:49:27+01:00",
    "2004-03-17T17:56:48+01:00",
    "2004-03-17T18:04:35+01:00",
    "2004-03-17T18:51:44+01:00",
    "2004-03-18T07:32:14+01:00",
    "2004-03-18T18:42:24+01:00",
    "2004-03-19T12:41:40+01:00",
    "2004-03-19T13:47:12+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java"
        },
        {
          "method": "java.lang.Throwable.\u003cinit\u003e",
          "source": "Throwable.java"
        },
        {
          "method": "java.lang.NullPointerException.\u003cinit\u003e",
          "source": "NullPointerException.java:60"
        },
        {
          "method": "org.eclipse.jdt.core.dom.TypeBinding.getKey",
          "source": "TypeBinding.java"
        },
        {
          "method": "org.eclipse.jdt.core.dom.MethodBinding.getKey",
          "source": "MethodBinding.java"
        },
        {
          "method": "org.eclipse.jdt.core.dom.DefaultBindingResolver.resolveMethod",
          "source": "DefaultBindingResolver.java:470"
        },
        {
          "method": "org.eclipse.jdt.core.dom.MethodDeclaration.resolveBinding",
          "source": "MethodDeclaration.java:869"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations",
          "source": "ASTConverter.java:1005"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:1132"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convertToVariableDeclarationFragment",
          "source": "ASTConverter.java:2710"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convertToVariableDeclarationStatement",
          "source": "ASTConverter.java:2737"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.checkAndAddMultipleLocalDeclaration",
          "source": "ASTConverter.java:384"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:1859"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:1764"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:2008"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:1788"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.buildBodyDeclarations",
          "source": "ASTConverter.java:330"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:268"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTConverter.convert",
          "source": "ASTConverter.java:146"
        },
        {
          "method": "org.eclipse.jdt.core.dom.AST.convertCompilationUnit",
          "source": "AST.java:233"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.buildStructure",
          "source": "CompilationUnit.java:147"
        },
        {
          "method": "org.eclipse.jdt.internal.core.Openable.generateInfos",
          "source": "Openable.java:169"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaElement.openWhenClosed",
          "source": "JavaElement.java:543"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.makeConsistent",
          "source": "CompilationUnit.java:931"
        },
        {
          "method": "org.eclipse.jdt.internal.core.ReconcileWorkingCopyOperation.executeOperation",
          "source": "ReconcileWorkingCopyOperation.java:56"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.run",
          "source": "JavaModelOperation.java:700"
        },
        {
          "method": "org.eclipse.jdt.internal.core.JavaModelOperation.runOperation",
          "source": "JavaModelOperation.java:739"
        },
        {
          "method": "org.eclipse.jdt.internal.core.CompilationUnit.reconcile",
          "source": "CompilationUnit.java:1043"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:84"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.java.JavaReconcilingStrategy.reconcile",
          "source": "JavaReconcilingStrategy.java:109"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.CompositeReconcilingStrategy.reconcile",
          "source": "CompositeReconcilingStrategy.java:83"
        },
        {
          "method": "org.eclipse.jdt.internal.ui.text.JavaCompositeReconcilingStrategy.reconcile",
          "source": "JavaCompositeReconcilingStrategy.java:97"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.MonoReconciler.process",
          "source": "MonoReconciler.java:76"
        },
        {
          "method": "org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run",
          "source": "AbstractReconciler.java:189"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "55102",
      "date": "2004-03-17T15:14:54+01:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "55102",
  "bugId": "55102",
  "date": "2004-03-17T15:14:54+01:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}