{
  "comments": [
    "Although this is due to the refactoring logic calls, I think the changes need to be made in the server logic so I\u0027m assigning to that component; seeing errors of the following form when executing the following refactoring scenario with RC2 and our custom server:\n\n-Create a web project (add it to a new EAR)\n-Add the ear to a server instance\n-Delete the web project (this generates an NPE covered by a different bug)\n-Delete the EAR project (can generate exception below)\n\nAlthough this particular exception is the result of logic specific to the WeblogicServer class, I think the correct overall solution may involve modifications to wst server code to account for the fact that modules passed to ServerUtils.modifyModules() for removal may correspond to deleted projects (i.e. a call to getChildModules() would not be made)\n\norg.eclipse.core.internal.resources.ResourceException: Resource /EAR does not exist.\n\tat org.eclipse.core.internal.resources.Resource.checkExists(Resource.java:304)\n\tat org.eclipse.core.internal.resources.Resource.checkAccessible(Resource.java:172)\n\tat org.eclipse.core.internal.resources.Project.checkAccessible(Project.java:124)\n\tat org.eclipse.core.internal.resources.Project.isNatureEnabled(Project.java:689)\n\tat org.eclipse.wst.common.project.facet.core.internal.ProjectFacetsManagerImpl.create(ProjectFacetsManagerImpl.java:275)\n\tat org.eclipse.wst.common.project.facet.core.ProjectFacetsManager.create(ProjectFacetsManager.java:277)\n\tat com.bea.wlw.server.internal.core.WeblogicServer.getChildModules(WeblogicServer.java:308)\n\tat org.eclipse.wst.server.core.internal.Server.getChildModules(Server.java:1985)\n\tat org.eclipse.wst.server.core.internal.ServerWorkingCopy.resetPublishState(ServerWorkingCopy.java:477)\n\tat org.eclipse.wst.server.core.internal.ServerWorkingCopy.modifyModules(ServerWorkingCopy.java:451)\n\tat org.eclipse.wst.server.core.ServerUtil.modifyModules(ServerUtil.java:335)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorOperation.updateServerRefs(ProjectRefactorOperation.java:124)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectDeleteOperation.updateProject(ProjectDeleteOperation.java:34)\n\tat org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorOperation.execute(ProjectRefactorOperation.java:54)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl.doExecute(ExtendableOperationImpl.java:163)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl$1.run(ExtendableOperationImpl.java:131)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1719)\n\tat org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1739)\n\tat org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl.execute(ExtendableOperationImpl.java:137)\n\tat org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener$2.runInWorkspace(ProjectRefactoringListener.java:239)\n\tat org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38)",
    "Facets code should probably be catching this exception and throwing a checked exception or failing gracefully. I agree that this is a larger issue though, and we\u0027ll need to work through scenarios where parts of an application are missing from the workspace. This will probably impact several different components.",
    "ResourceException is a subclass of CoreException, which ProjectFacetsManager.create is declared to throw.",
    "Changing to critical; I think this should get addressed at some level for at least the 1.0.1 release (not certain how extensive such a fix should be or exactly where the changes should be made)",
    "Added to Hot List at the request of Ted Bashor and set priority to P2.",
    "Retargetting this to 1.0.1. Ted wanted bug 120881 considered for RC5.",
    "Similar problems can also occur when the module is associated with a closed project; here\u0027s the repro:\n\n-Create an EAR\n-Create a util, add it to the EAR\n-Add the EAR to a server instance\n-Do not expand the server instance yet\n-Close the EAR project\n-Expand the server instance\n\ngetChildModules() will be called on the server instance for an IModule associated with the closed project and, depending on the logic in the server impl, exceptions can be generated. \n",
    "hey Tim: some questions/thoughts:\n\nQ: should the refactoring logic be ensuring that a DeletedModule object is passed to ServerUtils.modifyModules() for the module associated with the deleted project? (I\u0027m currently computing and caching the associated IModule during the PRE_DELETE event)\n\nQ: should the server framework be passing DeletedModule objects to all server implementation class methods that accept IModule objects and are called as a result of a modifyModules() call for a deleted project? As long as sufficient information is contained in the DeletedModule object, would allow server implementations to handle this case as needed.\n\nQ: should there actually be a ClosedModule and a DeletedModule?\n\n",
    "Actually, based on some testing with a recent update from CVS, it looks like I now need to pass in a DeletedModule object for the modifyModules() call to work (if I don\u0027t, the DeletedModule contained in the ServerWorkingCopy\u0027s modules ArrayList is not removed); I\u0027ll put together a patch that at least addresses that issue; depending on the answer to my other questions below, this may address the bulk of the delete refactoring issues.",
    "Created an attachment (id\u003d33347)\nPatch for ProjectRefactorOperation that passes in a DeletedModule for deleted project\n\nWith this patch, the module ref is again removed from the servers.xml file; passing in DeletedModule here may address a good chunk of the issues covered by the bug.",
    "Per the 01-26 status telecon, we can remove this from the hot list.",
    "I\u0027ve been able to update our internal code to work with a fairly recent WTP build and have verified that most of the scenarios involving closed, renamed and deleted projects now work with the new DeletedModule logic; consequently, I\u0027m lowering the sev on this and I\u0027m giving the bug a more general name; one remaining issue is the following NPE that I\u0027m hitting when I attempt to execute a publish a server instance that includes previously published closed module and (this is due to the fact that DeletedModule.loadAdapter() returns null and ModulePublishInfo.fillCache() does not check for null; note: this can be hit earlier via the call to getPublishedResourceDelta() from ServerBehaviorDelegate.publish()):\n\n...\n!ENTRY org.eclipse.wst.server.core 4 0 2006-02-06 10:29:13.969\n!MESSAGE Could not publish to the server.\n!STACK 0\njava.lang.NullPointerException\n\tat org.eclipse.wst.server.core.internal.ModulePublishInfo.fillCache(ModulePublishInfo.java:209)\n\tat org.eclipse.wst.server.core.internal.ModulePublishInfo.fill(ModulePublishInfo.java:295)\n\tat org.eclipse.wst.server.core.internal.ServerPublishInfo.fill(ServerPublishInfo.java:243)\n\tat org.eclipse.wst.server.core.internal.Server$5.visit(Server.java:806)\n\tat org.eclipse.wst.server.core.internal.Server.visitModule(Server.java:2184)\n\tat org.eclipse.wst.server.core.internal.Server.visit(Server.java:2168)\n\tat org.eclipse.wst.server.core.internal.Server.doPublish(Server.java:803)\n\tat org.eclipse.wst.server.core.internal.Server.publish(Server.java:788)\n\tat org.eclipse.wst.server.core.internal.PublishServerJob.run(PublishServerJob.java:145)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)\n...",
    "NPE fixed and released.",
    "verified",
    "Closing."
  ],
  "commentCreationDates": [
    "2005-12-13T22:17:04+01:00",
    "2005-12-13T23:07:08+01:00",
    "2005-12-14T00:10:34+01:00",
    "2005-12-14T20:39:54+01:00",
    "2005-12-14T22:11:31+01:00",
    "2005-12-14T22:22:11+01:00",
    "2005-12-15T16:13:49+01:00",
    "2006-01-19T18:46:47+01:00",
    "2006-01-19T19:22:32+01:00",
    "2006-01-20T15:12:09+01:00",
    "2006-02-02T14:53:39+01:00",
    "2006-02-06T16:44:56+01:00",
    "2006-02-07T04:10:42+01:00",
    "2006-06-21T19:54:27+02:00",
    "2006-06-27T22:58:47+02:00"
  ],
  "traces": [
    {
      "exceptionType": "org.eclipse.core.internal.resources.ResourceException",
      "message": "Resource /EAR does not exist.",
      "elements": [
        {
          "method": "org.eclipse.core.internal.resources.Resource.checkExists",
          "source": "Resource.java:304"
        },
        {
          "method": "org.eclipse.core.internal.resources.Resource.checkAccessible",
          "source": "Resource.java:172"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.checkAccessible",
          "source": "Project.java:124"
        },
        {
          "method": "org.eclipse.core.internal.resources.Project.isNatureEnabled",
          "source": "Project.java:689"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.internal.ProjectFacetsManagerImpl.create",
          "source": "ProjectFacetsManagerImpl.java:275"
        },
        {
          "method": "org.eclipse.wst.common.project.facet.core.ProjectFacetsManager.create",
          "source": "ProjectFacetsManager.java:277"
        },
        {
          "method": "com.bea.wlw.server.internal.core.WeblogicServer.getChildModules",
          "source": "WeblogicServer.java:308"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.getChildModules",
          "source": "Server.java:1985"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.ServerWorkingCopy.resetPublishState",
          "source": "ServerWorkingCopy.java:477"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.ServerWorkingCopy.modifyModules",
          "source": "ServerWorkingCopy.java:451"
        },
        {
          "method": "org.eclipse.wst.server.core.ServerUtil.modifyModules",
          "source": "ServerUtil.java:335"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorOperation.updateServerRefs",
          "source": "ProjectRefactorOperation.java:124"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.operations.ProjectDeleteOperation.updateProject",
          "source": "ProjectDeleteOperation.java:34"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.operations.ProjectRefactorOperation.execute",
          "source": "ProjectRefactorOperation.java:54"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl.doExecute",
          "source": "ExtendableOperationImpl.java:163"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl$1.run",
          "source": "ExtendableOperationImpl.java:131"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1719"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1739"
        },
        {
          "method": "org.eclipse.wst.common.frameworks.internal.datamodel.ExtendableOperationImpl.execute",
          "source": "ExtendableOperationImpl.java:137"
        },
        {
          "method": "org.eclipse.jst.j2ee.refactor.listeners.ProjectRefactoringListener$2.runInWorkspace",
          "source": "ProjectRefactoringListener.java:239"
        },
        {
          "method": "org.eclipse.core.internal.resources.InternalWorkspaceJob.run",
          "source": "InternalWorkspaceJob.java:38"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "120754",
      "date": "2005-12-13T22:17:04+01:00",
      "product": "Web Tools",
      "component": "wst.server",
      "severity": "major"
    },
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.wst.server.core.internal.ModulePublishInfo.fillCache",
          "source": "ModulePublishInfo.java:209"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.ModulePublishInfo.fill",
          "source": "ModulePublishInfo.java:295"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.ServerPublishInfo.fill",
          "source": "ServerPublishInfo.java:243"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server$5.visit",
          "source": "Server.java:806"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.visitModule",
          "source": "Server.java:2184"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.visit",
          "source": "Server.java:2168"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.doPublish",
          "source": "Server.java:803"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.Server.publish",
          "source": "Server.java:788"
        },
        {
          "method": "org.eclipse.wst.server.core.internal.PublishServerJob.run",
          "source": "PublishServerJob.java:145"
        },
        {
          "method": "org.eclipse.core.internal.jobs.Worker.run",
          "source": "Worker.java:76"
        }
      ],
      "number": 1,
      "commentIndex": 11,
      "bugId": "120754",
      "date": "2006-02-06T16:44:56+01:00",
      "product": "Web Tools",
      "component": "wst.server",
      "severity": "major"
    }
  ],
  "groupId": "120754",
  "bugId": "120754",
  "date": "2005-12-13T22:17:04+01:00",
  "product": "Web Tools",
  "component": "wst.server",
  "severity": "major"
}