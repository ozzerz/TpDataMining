{
  "comments": [
    "+++ This bug was initially created as a clone of Bug #196352 +++\n\nI am attempting to run an RCP application using the standard IApplication start code:\n\n Display display \u003d PlatformUI.createDisplay();\n    try {\n      int code \u003d PlatformUI.createAndRunWorkbench(display,\n          new ChronosWorkbenchAdvisor());\n      // exit the application with an appropriate return code\n      return code \u003d\u003d PlatformUI.RETURN_RESTART\n          ? EXIT_RESTART\n          : EXIT_OK;\n    } finally {\n      if (display !\u003d null)\n        display.dispose();\n    }\n\nWith the addition of my own WorkbenchAdvisor. This very same application has worked since Eclipse 3.1, however, after some minor changes, such as switching to IApplication, I get the following error:\n\nException in thread \"Thread-2\" java.lang.NullPointerException\nException in thread \"Thread-2\" java.lang.NullPointerException\n\tat org.eclipse.jface.resource.JFaceResources.getResources(JFaceResources.java:203)\n\tat org.eclipse.jface.resource.ImageRegistry.\u003cinit\u003e(ImageRegistry.java:151)\n\tat org.eclipse.jface.resource.ImageRegistry.\u003cinit\u003e(ImageRegistry.java:123)\n\tat org.eclipse.ui.internal.WorkbenchImages.initializeImageRegistry(WorkbenchImages.java:568)\n\tat org.eclipse.ui.internal.WorkbenchImages.getDescriptors(WorkbenchImages.java:469)\n\tat org.eclipse.ui.internal.WorkbenchImages.getImageDescriptor(WorkbenchImages.java:499)\n\tat org.eclipse.ui.internal.registry.PerspectiveDescriptor.getImageDescriptor(PerspectiveDescriptor.java:236)\n\tat org.eclipse.ui.internal.registry.PerspectiveDescriptor.restoreState(PerspectiveDescriptor.java:337)\n\tat org.eclipse.ui.internal.registry.PerspectiveRegistry.loadCustom(PerspectiveRegistry.java:435)\n\tat org.eclipse.ui.internal.registry.PerspectiveRegistry.load(PerspectiveRegistry.java:395)\n\tat org.eclipse.ui.internal.WorkbenchPlugin.getPerspectiveRegistry(WorkbenchPlugin.java:561)\n\tat org.eclipse.ui.internal.Workbench.getPerspectiveRegistry(Workbench.java:1191)\n\tat org.eclipse.ui.internal.Workbench.doOpenFirstTimeWindow(Workbench.java:1844)\n\tat org.eclipse.ui.internal.Workbench.access$29(Workbench.java:1834)\n\tat org.eclipse.ui.internal.Workbench$45.run(Workbench.java:1794)\n\tat org.eclipse.ui.internal.Workbench.runStartupWithProgress(Workbench.java:1820)\n\tat org.eclipse.ui.internal.Workbench.openFirstTimeWindow(Workbench.java:1792)\n\tat org.eclipse.ui.internal.WorkbenchConfigurer.openFirstTimeWindow(WorkbenchConfigurer.java:190)\n\tat org.eclipse.ui.application.WorkbenchAdvisor$1.run(WorkbenchAdvisor.java:785)\n\nThe error stems from the creation of the Workbench ImageRegistry. Within the ImageRegistry constructor (line 123) we are retrieving the current display. \n\n   /**\n     * Creates an empty image registry.\n     * \u003cp\u003e\n     * There must be an SWT Display created in the current \n     * thread before calling this method.\n     * \u003c/p\u003e\n     */\n    public ImageRegistry() {\n        this(Display.getCurrent());\n    }\n\nThe thread is NULL. When it gets to the JFaceResources.getResources(final Display toQuery) method it throws the null pointer on this line:\n\n\ttoQuery.disposeExec(new Runnable() \n\nWhich makes sense, since \u0027toQuery\u0027 is null. The problem is, I have no idea why. I can\u0027t see that I am doing something incorrect. \n\nAdditional information:\n1) When I delete the entire application workspace and run it works fine. The second time I try to run it is when I get this error. Something written to disk?\n\n2) I tried a very basic application by using one of the Examples provided in the create new plugin project wizard. The same problem arose. Run once, ok. Run twice, problem occurs. Same error. I could easily upload that code.\n\nAny help would be appreciated.",
    "Fix in R3_3_maintenance",
    "Created an attachment (id\u003d73971)\nmylyn/context/zip\n\n",
    "Verified in M20070905-1045 using the example from bug 196352."
  ],
  "commentCreationDates": [
    "2007-07-16T21:35:37+02:00",
    "2007-07-17T18:53:59+02:00",
    "2007-07-17T18:54:00+02:00",
    "2007-09-06T15:13:08+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jface.resource.JFaceResources.getResources",
          "source": "JFaceResources.java:203"
        },
        {
          "method": "org.eclipse.jface.resource.ImageRegistry.\u003cinit\u003e",
          "source": "ImageRegistry.java:151"
        },
        {
          "method": "org.eclipse.jface.resource.ImageRegistry.\u003cinit\u003e",
          "source": "ImageRegistry.java:123"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchImages.initializeImageRegistry",
          "source": "WorkbenchImages.java:568"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchImages.getDescriptors",
          "source": "WorkbenchImages.java:469"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchImages.getImageDescriptor",
          "source": "WorkbenchImages.java:499"
        },
        {
          "method": "org.eclipse.ui.internal.registry.PerspectiveDescriptor.getImageDescriptor",
          "source": "PerspectiveDescriptor.java:236"
        },
        {
          "method": "org.eclipse.ui.internal.registry.PerspectiveDescriptor.restoreState",
          "source": "PerspectiveDescriptor.java:337"
        },
        {
          "method": "org.eclipse.ui.internal.registry.PerspectiveRegistry.loadCustom",
          "source": "PerspectiveRegistry.java:435"
        },
        {
          "method": "org.eclipse.ui.internal.registry.PerspectiveRegistry.load",
          "source": "PerspectiveRegistry.java:395"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchPlugin.getPerspectiveRegistry",
          "source": "WorkbenchPlugin.java:561"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.getPerspectiveRegistry",
          "source": "Workbench.java:1191"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.doOpenFirstTimeWindow",
          "source": "Workbench.java:1844"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.access$29",
          "source": "Workbench.java:1834"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench$45.run",
          "source": "Workbench.java:1794"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runStartupWithProgress",
          "source": "Workbench.java:1820"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.openFirstTimeWindow",
          "source": "Workbench.java:1792"
        },
        {
          "method": "org.eclipse.ui.internal.WorkbenchConfigurer.openFirstTimeWindow",
          "source": "WorkbenchConfigurer.java:190"
        },
        {
          "method": "org.eclipse.ui.application.WorkbenchAdvisor$1.run",
          "source": "WorkbenchAdvisor.java:785"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "196718",
      "date": "2007-07-16T21:35:37+02:00",
      "product": "Platform",
      "component": "UI",
      "severity": "major"
    }
  ],
  "groupId": "196718",
  "bugId": "196718",
  "date": "2007-07-16T21:35:37+02:00",
  "product": "Platform",
  "component": "UI",
  "severity": "major"
}