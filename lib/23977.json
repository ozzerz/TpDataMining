{
  "comments": [
    "Environment Info: \nOS: Windows 2000 SP2. \nWSAD Build: 20020712_2002\n\nProblem Description:  \n\nThe customer is using WSAD v5 beta and they observed that after adding Jar files \nusing the \"Java Jar Dependencies\"  editor to add jar files to the .manifest file\nthat the project would fail to build.  The .log file revealed the \nstackTrace listed below:  \n\n\u003cstack trace\u003e\n!MESSAGE Problems occurred when invoking code from plug-in: \n\"org.eclipse.core.resources\".\n!STACK 0\njava.lang.ClassCastException: org.eclipse.core.internal.resources.File\n       at \norg.eclipse.jdt.internal.core.JavaProject.computeExpandedClasspath(JavaProject.j\nava(Compiled Code))\n       at \norg.eclipse.jdt.internal.core.builder.NameEnvironment.computeLocations(NameEnvir\nonment.java(Compiled Code))\n       at \norg.eclipse.jdt.internal.core.builder.NameEnvironment.computeLocations(NameEnvir\nonment.java(Compiled Code))\n       at \norg.eclipse.jdt.internal.core.builder.JavaBuilder.initializeBuilder(JavaBuilder.\njava:417)\n       at \norg.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:90)\n       at \norg.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:392)\n       at org.eclipse.core.runtime.Platform.run(Platform.java(Compiled Code))\n       at org.eclipse.core.runtime.Platform.run(Platform.java(Compiled Code))\n       at \norg.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:120)\n       at \norg.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:176)\n       at \norg.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:186)\n       at \norg.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:146)\n       at org.eclipse.core.runtime.Platform.run(Platform.java(Compiled Code))\n       at org.eclipse.core.runtime.Platform.run(Platform.java(Compiled Code))\n       at \norg.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:160)\n       at \norg.eclipse.core.internal.events.BuildManager.build(BuildManager.java:211)\n       at \norg.eclipse.core.internal.resources.Workspace.endOperation(Workspace.java(Compil\ned Code))\n       at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1366)\n       at \norg.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.jav\na:78)\n       at \norg.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.jav\na:98)\n!ENTRY org.eclipse.core.resources 4 2 Sep 10, 2002 11:02:58.387\n\u003c/stack trace\u003e \n\nUpon further investigation it appears that certain Jar files when added to the \nmanifest file using the \"Java Jar Dependencies\" editor add the incorrect\n \"kind\" attribute in the .classpath file and this appears to cause the \nClassCast Exception in the stack trace.  The customer\u0027s .classpath looked like \nthe following after adding some jar files with the \"Java Jar Dependency\" editor: \n\n\u003c?xml version\u003d\"1.0\" encoding\u003d\"UTF-8\"?\u003e\n\u003cclasspath\u003e\n    \u003cclasspathentry kind\u003d\"var\" path\u003d\"JRE_LIB\" rootpath\u003d\"JRE_SRCROOT\" \nsourcepath\u003d\"JRE_SRC\"/\u003e\n    \u003cclasspathentry kind\u003d\"lib\" path\u003d\"/EntApp/Utility.jar\"/\u003e\n    \u003cclasspathentry exported\u003d\"true\" kind\u003d\"src\" path\u003d\"/PersistenceEJB\"/\u003e\n    \u003cclasspathentry exported\u003d\"true\" kind\u003d\"src\" path\u003d\"/UtilityJava\"/\u003e\n    \u003cclasspathentry kind\u003d\"var\" path\u003d\"WAS_PLUGINDIR/lib/j2ee.jar\"/\u003e\n    \u003cclasspathentry exported\u003d\"true\" kind\u003d\"src\" \npath\u003d\"/EntApp/lib/xalan_v2.3.1/xercesImpl.jar\"/\u003e\n    \u003cclasspathentry exported\u003d\"true\" kind\u003d\"src\" \npath\u003d\"/EntApp/lib/xalan_v2.3.1/xml-apis.jar\"/\u003e\n    \u003cclasspathentry kind\u003d\"src\" path\u003d\"src\"/\u003e\n    \u003cclasspathentry kind\u003d\"output\" path\u003d\"bin\"/\u003e\n\u003c/classpath\u003e\n\nNotice the xerces jar file has a kind attribute of \u0027src\u0027 instead of \u0027lib\u0027.  \nHowever, the other jar file that was \nadded--Utility.Jar-- has a kind attribute of \u0027lib\u0027.  If the customer changes the \nxercesImpl.jar file\u0027s kind attribute to \n\u0027lib\u0027 instead of \u0027src\u0027 and does the same for all jar files and then the project \nbuilds OK with out a problem.  \n\nWe then tracked down the exact procedure he was doing. This problem seems to \noccur when you do the following in WSADv5:  \n\n(TestCase)\n\n* Open the Project Properties \n* Java Build Path --\u003eLibraries Tab --\u003e Add Jar file and click OK.  \n* Project will rebuild. \n* Inspect .class path file.  Jar file will have the kind attribute of \"lib\". \n\n* Open  the Project Properties again\n* Go to the \"Java Jar Dependencies Page\"\n* Select the same file that you added to the build path above\n* Click OK on Properties Page and Project will rebuild but the Properties window \nwill NOT Close!! \n* Cancel out of the properties window and try to rebuild the project.  The \nrebuild fails with details of \"org.eclipse.core.internal.resources.File. \n* Inspect the .classpath file you will see that the Jar file now has a kind \nattribute of \u0027src\u0027 instead of \u0027lib\u0027. \n* If you change the kind attribute to \"lib\" in the .classpath file then \neverything works OK.",
    "First time I\u0027ve seen this behavior. Need to investigate asap.",
    "Sounds like an error scenario which we do not recover nicely from. I am also \nwondering about how we got into this state (WSAD bug?).",
    "Fixed in latest integration build.",
    "Verified.",
    "Backported to 2.0.2",
    "Verified in 2.0.2."
  ],
  "commentCreationDates": [
    "2002-09-23T17:22:24+02:00",
    "2002-09-24T11:34:52+02:00",
    "2002-09-24T11:36:31+02:00",
    "2002-09-24T15:37:35+02:00",
    "2002-10-17T16:03:16+02:00",
    "2002-10-22T00:00:20+02:00",
    "2002-10-31T08:25:12+01:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.ClassCastException",
      "message": "org.eclipse.core.internal.resources.File",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.core.JavaProject.computeExpandedClasspath",
          "source": "JavaProject.j ava(Compiled Code)"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.NameEnvironment.computeLocations",
          "source": "NameEnvir onment.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.NameEnvironment.computeLocations",
          "source": "NameEnvir onment.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.initializeBuilder",
          "source": "JavaBuilder. java:417"
        },
        {
          "method": "org.eclipse.jdt.internal.core.builder.JavaBuilder.build",
          "source": "JavaBuilder.java:90"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$2.run",
          "source": "BuildManager.java:392"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:120"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:176"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:186"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager$1.run",
          "source": "BuildManager.java:146"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.core.runtime.Platform.run",
          "source": "Platform.java(Compiled Code)"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.basicBuild",
          "source": "BuildManager.java:160"
        },
        {
          "method": "org.eclipse.core.internal.events.BuildManager.build",
          "source": "BuildManager.java:211"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.endOperation",
          "source": "Workspace.java(Compil ed Code)"
        },
        {
          "method": "org.eclipse.core.internal.resources.Workspace.run",
          "source": "Workspace.java:1366"
        },
        {
          "method": "org.eclipse.ui.actions.WorkspaceModifyOperation.run",
          "source": "WorkspaceModifyOperation.jav a:78"
        },
        {
          "method": "org.eclipse.jface.operation.ModalContext$ModalContextThread.run",
          "source": "ModalContext.jav a:98"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "23977",
      "date": "2002-09-23T17:22:24+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "23977",
  "bugId": "23977",
  "date": "2002-09-23T17:22:24+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}