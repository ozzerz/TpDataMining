{
  "comments": [
    "My plugin crashed from an NPE when I called binding.getDeclaredMethods() on \nan anonymous type binding.  The binding originates from a compilation unit with \nthe following error:  \n\"This compilation unit indirectly references the missing type \norg.eclipse.swt.events.SelectionEvent \n (typically some required class file is referencing a type outside the \nclasspath)\"\n\nThe NPE occurs at line 467 of MethodBinding because \"scope\" is null: \nAbstractMethodDeclaration[] methods \u003d sourceType.scope.referenceContext.methods;\n\nStack trace:  \njava.lang.NullPointerException\nat org.eclipse.jdt.internal.compiler.lookup.MethodBinding.sourceMethod\n(MethodBinding.java:467)\nat org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.resolveTypesFor\n(SourceTypeBinding.java:793)\nat org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.methods\n(SourceTypeBinding.java:687)\nat org.eclipse.jdt.core.dom.TypeBinding.getDeclaredMethods(TypeBinding.java:324)\nat ca.ubc.jquery.engine.context.TypeContext.exitContext(TypeContext.java:117)\nat ca.ubc.jquery.engine.FactsGenerator.endVisit(FactsGenerator.java:50)\nat org.eclipse.jdt.core.dom.TypeDeclaration.accept0(TypeDeclaration.java:163)\nat org.eclipse.jdt.core.dom.ASTNode.accept(ASTNode.java:1353)\nat ca.ubc.jquery.engine.FactsGenerator.visit(FactsGenerator.java:42)\nat org.eclipse.jdt.core.dom.TypeDeclaration.accept0(TypeDeclaration.java:154)\nat org.eclipse.jdt.core.dom.ASTNode.accept(ASTNode.java:1353)\nat org.eclipse.jdt.core.dom.ASTNode.acceptChildren(ASTNode.java:1423)\nat org.eclipse.jdt.core.dom.CompilationUnit.accept0(CompilationUnit.java:159)\nat org.eclipse.jdt.core.dom.ASTNode.accept(ASTNode.java:1353)\nat ca.ubc.jquery.engine.FactsGenerator.generate(FactsGenerator.java:417)\nat ca.ubc.jquery.engine.CodeFactBucket.update(CodeFactBucket.java:543)\nat tyRuBa.engine.RuleBaseBucket.doUpdate(RuleBaseBucket.java:95)\nat tyRuBa.engine.FrontEnd.updateBuckets(FrontEnd.java:272)\nat tyRuBa.engine.FrontEnd.autoUpdateBuckets(FrontEnd.java:295)\nat tyRuBa.engine.QueryEngine.frameQuery(QueryEngine.java:89)\nat ca.ubc.jquery.gui.QueryControl.addAvailableTopQueries(QueryControl.java:333)\nat ca.ubc.jquery.gui.QueryControl.addTopQueryItems(QueryControl.java:500)\nat ca.ubc.jquery.gui.QueryControl.fillContextMenu(QueryControl.java:494)\nat ca.ubc.jquery.gui.QueryControl$9.menuAboutToShow(QueryControl.java:566)\nat org.eclipse.jface.action.MenuManager.fireAboutToShow(MenuManager.java:255)\nat org.eclipse.jface.action.MenuManager.handleAboutToShow(MenuManager.java:334)\nat org.eclipse.jface.action.MenuManager.access$0(MenuManager.java:331)\nat org.eclipse.jface.action.MenuManager$2.menuShown(MenuManager.java:343)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:116)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:81)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:840)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:865)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:845)\nat org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP(Control.java:3141)\nat org.eclipse.swt.widgets.Control.windowProc(Control.java:2785)\nat org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1229)\nat org.eclipse.swt.widgets.Display.windowProc(Display.java:2361)\nat org.eclipse.swt.internal.win32.OS.TrackPopupMenu(Native Method)\nat org.eclipse.swt.widgets.Menu._setVisible(Menu.java:218)\nat org.eclipse.swt.widgets.Display.runPopups(Display.java:1863)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1538)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1402)\nat org.eclipse.ui.internal.Workbench.run(Workbench.java:1385)\nat org.eclipse.core.internal.boot.InternalBootLoader.run\n(InternalBootLoader.java:845)\nat org.eclipse.core.boot.BootLoader.run(BootLoader.java:461)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:324)\nat org.eclipse.core.launcher.Main.basicRun(Main.java:291)\nat org.eclipse.core.launcher.Main.run(Main.java:747)\nat org.eclipse.core.launcher.Main.main(Main.java:583)",
    "Please provide a test case. I will investigate.",
    "I tried the following test case:\npackage test0489;\n\npublic class A {\n\tObject foo () {\n\t\treturn new Y() {\n\t\t\tpublic void bar() {\n\t\t\t}\n\t\t};\n\t}\n}\nWhere Y implements Zork and I remove the .class file for Zork. I get a similar\nerror, but I can successfully get the declared methods.\nCould you please provide your test case for further investigation?\n",
    "Could you please provide your test case or let me know where I can get your\nplugin? What build are you using?",
    "I am using Eclipse: Version: 2.1.0, Build id: 200303272130\n\nI zipped the problematic project and emailed it to you directly.",
    "I reproduced it. Thanks for the test case.\nThe problem is that an abortCompilation exception is thrown during the import\nresolution because of the missing library (swt.jar). Then the types are not\nresolved and the method declarations have no resolved bindings. Because the\nscope has been nullified during the compilation unit cleanup, it is not possible\nto resolve the bindings afterwards.\nSo in this case, I think it is acceptable that no binding is returned for\nunresolved code. The classpath needs to be fixed in order to resolve properly\nall bindings.\nThe specs say that if a binding cannot be resolved, null can be returned. In\nyour case, the bug was that we didn\u0027t detect early enough that the bindings\ncould not be resolved because of a failure during the import resolution.\nIs this ok for you?",
    "Yes.  I would definately prefer a null return value over a null pointer\nexception.",
    "The fix will be to nullify all bindings that are not resolved. In this case you \nwon\u0027t get a binding for the type declaration.\nYour test case is a case where there is a problem with the import declarations. \nTherefore all declarations underneath are not resolvable. According to the \nspecs of the DOM/AST, it is acceptable in this case to return null for all \nbindings.\nI am testing my fix and I will release it shortly in HEAD.",
    "Fixed and released in HEAD.\nRegression tests added.",
    "Verified."
  ],
  "commentCreationDates": [
    "2003-07-26T01:13:22+02:00",
    "2003-07-28T16:54:43+02:00",
    "2003-07-28T19:10:34+02:00",
    "2003-07-29T20:05:34+02:00",
    "2003-07-29T22:12:05+02:00",
    "2003-07-30T16:46:56+02:00",
    "2003-07-30T17:04:17+02:00",
    "2003-07-30T18:23:45+02:00",
    "2003-07-30T18:53:34+02:00",
    "2003-08-28T12:22:56+02:00"
  ],
  "traces": [
    {
      "exceptionType": "java.lang.NullPointerException",
      "elements": [
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.MethodBinding.sourceMethod",
          "source": "MethodBinding.java:467"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.resolveTypesFor",
          "source": "SourceTypeBinding.java:793"
        },
        {
          "method": "org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding.methods",
          "source": "SourceTypeBinding.java:687"
        },
        {
          "method": "org.eclipse.jdt.core.dom.TypeBinding.getDeclaredMethods",
          "source": "TypeBinding.java:324"
        },
        {
          "method": "ca.ubc.jquery.engine.context.TypeContext.exitContext",
          "source": "TypeContext.java:117"
        },
        {
          "method": "ca.ubc.jquery.engine.FactsGenerator.endVisit",
          "source": "FactsGenerator.java:50"
        },
        {
          "method": "org.eclipse.jdt.core.dom.TypeDeclaration.accept0",
          "source": "TypeDeclaration.java:163"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.accept",
          "source": "ASTNode.java:1353"
        },
        {
          "method": "ca.ubc.jquery.engine.FactsGenerator.visit",
          "source": "FactsGenerator.java:42"
        },
        {
          "method": "org.eclipse.jdt.core.dom.TypeDeclaration.accept0",
          "source": "TypeDeclaration.java:154"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.accept",
          "source": "ASTNode.java:1353"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.acceptChildren",
          "source": "ASTNode.java:1423"
        },
        {
          "method": "org.eclipse.jdt.core.dom.CompilationUnit.accept0",
          "source": "CompilationUnit.java:159"
        },
        {
          "method": "org.eclipse.jdt.core.dom.ASTNode.accept",
          "source": "ASTNode.java:1353"
        },
        {
          "method": "ca.ubc.jquery.engine.FactsGenerator.generate",
          "source": "FactsGenerator.java:417"
        },
        {
          "method": "ca.ubc.jquery.engine.CodeFactBucket.update",
          "source": "CodeFactBucket.java:543"
        },
        {
          "method": "tyRuBa.engine.RuleBaseBucket.doUpdate",
          "source": "RuleBaseBucket.java:95"
        },
        {
          "method": "tyRuBa.engine.FrontEnd.updateBuckets",
          "source": "FrontEnd.java:272"
        },
        {
          "method": "tyRuBa.engine.FrontEnd.autoUpdateBuckets",
          "source": "FrontEnd.java:295"
        },
        {
          "method": "tyRuBa.engine.QueryEngine.frameQuery",
          "source": "QueryEngine.java:89"
        },
        {
          "method": "ca.ubc.jquery.gui.QueryControl.addAvailableTopQueries",
          "source": "QueryControl.java:333"
        },
        {
          "method": "ca.ubc.jquery.gui.QueryControl.addTopQueryItems",
          "source": "QueryControl.java:500"
        },
        {
          "method": "ca.ubc.jquery.gui.QueryControl.fillContextMenu",
          "source": "QueryControl.java:494"
        },
        {
          "method": "ca.ubc.jquery.gui.QueryControl$9.menuAboutToShow",
          "source": "QueryControl.java:566"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.fireAboutToShow",
          "source": "MenuManager.java:255"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.handleAboutToShow",
          "source": "MenuManager.java:334"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager.access$0",
          "source": "MenuManager.java:331"
        },
        {
          "method": "org.eclipse.jface.action.MenuManager$2.menuShown",
          "source": "MenuManager.java:343"
        },
        {
          "method": "org.eclipse.swt.widgets.TypedListener.handleEvent",
          "source": "TypedListener.java:116"
        },
        {
          "method": "org.eclipse.swt.widgets.EventTable.sendEvent",
          "source": "EventTable.java:81"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:840"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:865"
        },
        {
          "method": "org.eclipse.swt.widgets.Widget.sendEvent",
          "source": "Widget.java:845"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.WM_INITMENUPOPUP",
          "source": "Control.java:3141"
        },
        {
          "method": "org.eclipse.swt.widgets.Control.windowProc",
          "source": "Control.java:2785"
        },
        {
          "method": "org.eclipse.swt.widgets.Decorations.windowProc",
          "source": "Decorations.java:1229"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.windowProc",
          "source": "Display.java:2361"
        },
        {
          "method": "org.eclipse.swt.internal.win32.OS.TrackPopupMenu",
          "source": "Native Method"
        },
        {
          "method": "org.eclipse.swt.widgets.Menu._setVisible",
          "source": "Menu.java:218"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.runPopups",
          "source": "Display.java:1863"
        },
        {
          "method": "org.eclipse.swt.widgets.Display.readAndDispatch",
          "source": "Display.java:1538"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.runEventLoop",
          "source": "Workbench.java:1402"
        },
        {
          "method": "org.eclipse.ui.internal.Workbench.run",
          "source": "Workbench.java:1385"
        },
        {
          "method": "org.eclipse.core.internal.boot.InternalBootLoader.run",
          "source": "InternalBootLoader.java:845"
        },
        {
          "method": "org.eclipse.core.boot.BootLoader.run",
          "source": "BootLoader.java:461"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke0",
          "source": "Native Method"
        },
        {
          "method": "sun.reflect.NativeMethodAccessorImpl.invoke",
          "source": "NativeMethodAccessorImpl.java:39"
        },
        {
          "method": "sun.reflect.DelegatingMethodAccessorImpl.invoke",
          "source": "DelegatingMethodAccessorImpl.java:25"
        },
        {
          "method": "java.lang.reflect.Method.invoke",
          "source": "Method.java:324"
        },
        {
          "method": "org.eclipse.core.launcher.Main.basicRun",
          "source": "Main.java:291"
        },
        {
          "method": "org.eclipse.core.launcher.Main.run",
          "source": "Main.java:747"
        },
        {
          "method": "org.eclipse.core.launcher.Main.main",
          "source": "Main.java:583"
        }
      ],
      "number": 0,
      "commentIndex": 0,
      "bugId": "40804",
      "date": "2003-07-26T01:13:22+02:00",
      "product": "JDT",
      "component": "Core",
      "severity": "normal"
    }
  ],
  "groupId": "40804",
  "bugId": "40804",
  "date": "2003-07-26T01:13:22+02:00",
  "product": "JDT",
  "component": "Core",
  "severity": "normal"
}